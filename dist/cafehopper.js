var $m=Array.isArray,M3=Array.prototype.indexOf,K1=Array.from,Rv=Object.defineProperty,sl=Object.getOwnPropertyDescriptor,$D=Object.getOwnPropertyDescriptors,z3=Object.prototype,O3=Array.prototype,G1=Object.getPrototypeOf,bA=Object.isExtensible;function Ph(r){return typeof r=="function"}const xa=()=>{};function vA(r){return typeof r?.then=="function"}function V3(r){return r()}function c1(r){for(var i=0;i<r.length;i++)r[i]()}function ZD(){var r,i,s=new Promise((c,d)=>{r=c,i=d});return{promise:s,resolve:r,reject:i}}function U3(r,i){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const s=[];for(const c of r)if(s.push(c),s.length===i)break;return s}const Ms=2,$1=4,Gv=8,zc=16,dl=32,Oc=64,Z1=128,wo=256,Sv=512,es=1024,Ao=2048,fu=4096,Ko=8192,Vc=16384,H1=32768,Uc=65536,xA=1<<17,j3=1<<18,gf=1<<19,HD=1<<20,d1=1<<21,$v=1<<22,kc=1<<23,wa=Symbol("$state"),X1=Symbol("legacy props"),N3=Symbol(""),Sm=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"},F3=1,Zv=3,jc=8;function _f(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function q3(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function K3(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function G3(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function $3(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Z3(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function H3(){throw new Error("https://svelte.dev/e/get_abort_signal_outside_reaction")}function X3(){throw new Error("https://svelte.dev/e/hydration_failed")}function XD(r){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function W3(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Y3(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function J3(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Q3(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function eO(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Hv=1,Xv=2,WD=4,tO=8,rO=16,iO=1,nO=2,YD=4,sO=8,oO=16,aO=1,lO=2,JD="[",Zm="[!",W1="]",Pc={},fn=Symbol(),uO="http://www.w3.org/1999/xhtml",cO="http://www.w3.org/2000/svg",dO="@attach";function Hm(r){console.warn("https://svelte.dev/e/hydration_mismatch")}function pO(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function fO(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let ir=!1;function Tn(r){ir=r}let Cr;function hn(r){if(r===null)throw Hm(),Pc;return Cr=r}function Ro(){return hn(Zo(Cr))}function Zr(r){if(ir){if(Zo(Cr)!==null)throw Hm(),Pc;Cr=r}}function hO(r=1){if(ir){for(var i=r,s=Cr;i--;)s=Zo(s);Cr=s}}function zm(r=!0){for(var i=0,s=Cr;;){if(s.nodeType===jc){var c=s.data;if(c===W1){if(i===0)return s;i-=1}else(c===JD||c===Zm)&&(i+=1)}var d=Zo(s);r&&s.remove(),s=d}}function QD(r){if(!r||r.nodeType!==jc)throw Hm(),Pc;return r.data}function eI(r){return r===this.v}function Y1(r,i){return r!=r?i==i:r!==i||r!==null&&typeof r=="object"||typeof r=="function"}function tI(r){return!Y1(r,this.v)}let bf=!1;function mO(){bf=!0}let si=null;function du(r){si=r}function hu(r){return Wv().get(r)}function mu(r,i){return Wv().set(r,i),i}function yO(r){return Wv().has(r)}function gO(){return Wv()}function mn(r,i=!1,s){si={p:si,c:null,e:null,s:r,x:null,l:bf&&!i?{s:null,u:null,$:[]}:null}}function yn(r){var i=si,s=i.e;if(s!==null){i.e=null;for(var c of s)yI(c)}return r!==void 0&&(i.x=r),si=i.p,r??{}}function vf(){return!bf||si!==null&&si.l===null}function Wv(r){return si===null&&_f(),si.c??=new Map(_O(si)||void 0)}function _O(r){let i=r.p;for(;i!==null;){const s=i.c;if(s!==null)return s;i=i.p}return null}let Sc=[];function rI(){var r=Sc;Sc=[],c1(r)}function Aa(r){if(Sc.length===0&&!of){var i=Sc;queueMicrotask(()=>{i===Sc&&rI()})}Sc.push(r)}function bO(){for(;Sc.length>0;)rI()}const vO=new WeakMap;function iI(r){var i=Br;if(i===null)return Gr.f|=kc,r;if((i.f&H1)===0){if((i.f&Z1)===0)throw!i.parent&&r instanceof Error&&nI(r),r;i.b.error(r)}else pf(r,i)}function pf(r,i){for(;i!==null;){if((i.f&Z1)!==0)try{i.b.error(r);return}catch(s){r=s}i=i.parent}throw r instanceof Error&&nI(r),r}function nI(r){const i=vO.get(r);i&&(Rv(r,"message",{value:i.message}),Rv(r,"stack",{value:i.stack}))}const dg=new Set;let Zi=null,p1=new Set,ba=[],Yv=null,f1=!1,of=!1;class ro{current=new Map;#t=new Map;#e=new Set;#r=0;#i=null;#a=[];#o=[];#s=[];#n=[];#l=[];#c=[];skipped_effects=new Set;process(i){ba=[];var s=ro.apply(this);for(const m of i)this.#d(m);if(this.#r===0){this.#p();var c=this.#o,d=this.#s;this.#o=[],this.#s=[],this.#n=[],Zi=null,wA(c),wA(d),this.#i?.resolve()}else this.#u(this.#o),this.#u(this.#s),this.#u(this.#n);s();for(const m of this.#a)Um(m);this.#a=[]}#d(i){i.f^=es;for(var s=i.first;s!==null;){var c=s.f,d=(c&(dl|Oc))!==0,m=d&&(c&es)!==0,e=m||(c&Ko)!==0||this.skipped_effects.has(s);if(!e&&s.fn!==null){d?s.f^=es:(c&$1)!==0?this.#s.push(s):(c&es)===0&&((c&$v)!==0&&s.b?.is_pending()?this.#a.push(s):e0(s)&&((s.f&zc)!==0&&this.#n.push(s),Um(s)));var a=s.first;if(a!==null){s=a;continue}}var g=s.parent;for(s=s.next;s===null&&g!==null;)s=g.next,g=g.parent}}#u(i){for(const s of i)((s.f&Ao)!==0?this.#l:this.#c).push(s),bs(s,es);i.length=0}capture(i,s){this.#t.has(i)||this.#t.set(i,s),this.current.set(i,i.v)}activate(){Zi=this}deactivate(){Zi=null}flush(){if(ba.length>0){if(this.activate(),h1(),Zi!==null&&Zi!==this)return}else this.#r===0&&this.#p();this.deactivate();for(const i of p1)if(p1.delete(i),i(),Zi!==null)break}#p(){for(const i of this.#e)i();if(this.#e.clear(),dg.size>1){this.#t.clear();let i=!0;for(const s of dg){if(s===this){i=!1;continue}for(const[c,d]of this.current){if(s.current.has(c))if(i)s.current.set(c,d);else continue;sI(c)}if(ba.length>0){Zi=s;const c=ro.apply(s);for(const d of ba)s.#d(d);ba=[],c()}}Zi=null}dg.delete(this)}increment(){this.#r+=1}decrement(){this.#r-=1;for(const i of this.#l)bs(i,Ao),Lc(i);for(const i of this.#c)bs(i,fu),Lc(i);this.flush()}add_callback(i){this.#e.add(i)}settled(){return(this.#i??=ZD()).promise}static ensure(){if(Zi===null){const i=Zi=new ro;dg.add(Zi),of||ro.enqueue(()=>{Zi===i&&i.flush()})}return Zi}static enqueue(i){Aa(i)}static apply(i){return xa}}function Jv(r){var i=of;of=!0;try{var s;for(r&&(Zi!==null&&h1(),s=r());;){if(bO(),ba.length===0&&(Zi?.flush(),ba.length===0))return Yv=null,s;h1()}}finally{of=i}}function h1(){var r=af;f1=!0;try{var i=0;for(SA(!0);ba.length>0;){var s=ro.ensure();if(i++>1e3){var c,d;xO()}s.process(ba),uu.clear()}}finally{f1=!1,SA(r),Yv=null}}function xO(){try{Z3()}catch(r){pf(r,Yv)}}let Ec=null;function wA(r){var i=r.length;if(i!==0){for(var s=0;s<i;){var c=r[s++];if((c.f&(Vc|Ko))===0&&e0(c)&&(Ec=[],Um(c),c.deps===null&&c.first===null&&c.nodes_start===null&&(c.teardown===null&&c.ac===null?vI(c):c.fn=null),Ec?.length>0)){uu.clear();for(const d of Ec)Um(d);Ec=[]}}Ec=null}}function sI(r){if(r.reactions!==null)for(const i of r.reactions){const s=i.f;(s&Ms)!==0?sI(i):(s&($v|zc))!==0&&(bs(i,Ao),Lc(i))}}function Lc(r){for(var i=Yv=r;i.parent!==null;){i=i.parent;var s=i.f;if(f1&&i===Br&&(s&zc)!==0)return;if((s&(Oc|dl))!==0){if((s&es)===0)return;i.f^=es}}ba.push(i)}function wO(r){let i=0,s=$o(0),c;return()=>{BO()&&(Pe(s),rw(()=>(i===0&&(c=is(()=>r(()=>cu(s)))),i+=1,()=>{Aa(()=>{i-=1,i===0&&(c?.(),c=void 0,cu(s))})})))}}var EO=Uc|gf|Z1;function AO(r,i,s){new RO(r,i,s)}class RO{parent;#t=!1;#e;#r=ir?Cr:null;#i;#a;#o;#s=null;#n=null;#l=null;#c=null;#d=0;#u=0;#p=!1;#f=null;#g=()=>{this.#f&&ol(this.#f,this.#d)};#_=wO(()=>(this.#f=$o(this.#d),()=>{this.#f=null}));constructor(i,s,c){this.#e=i,this.#i=s,this.#a=c,this.parent=Br.b,this.#t=!!this.#i.pending,this.#o=pl(()=>{if(Br.b=this,ir){const d=this.#r;Ro(),d.nodeType===jc&&d.data===Zm?this.#v():this.#b()}else{try{this.#s=Sn(()=>c(this.#e))}catch(d){this.error(d)}this.#u>0?this.#m():this.#t=!1}},EO),ir&&(this.#e=Cr)}#b(){try{this.#s=Sn(()=>this.#a(this.#e))}catch(i){this.error(i)}this.#t=!1}#v(){const i=this.#i.pending;i&&(this.#n=Sn(()=>i(this.#e)),ro.enqueue(()=>{this.#s=this.#h(()=>(ro.ensure(),Sn(()=>this.#a(this.#e)))),this.#u>0?this.#m():(Go(this.#n,()=>{this.#n=null}),this.#t=!1)}))}is_pending(){return this.#t||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#i.pending}#h(i){var s=Br,c=Gr,d=si;rs(this.#o),In(this.#o),du(this.#o.ctx);try{return i()}catch(m){return iI(m),null}finally{rs(s),In(c),du(d)}}#m(){const i=this.#i.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),SO(this.#s,this.#c)),this.#n===null&&(this.#n=Sn(()=>i(this.#e)))}#y(i){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(i);return}this.#u+=i,this.#u===0&&(this.#t=!1,this.#n&&Go(this.#n,()=>{this.#n=null}),this.#c&&(this.#e.before(this.#c),this.#c=null),Aa(()=>{ro.ensure().flush()}))}update_pending_count(i){this.#y(i),this.#d+=i,p1.add(this.#g)}get_effect_pending(){return this.#_(),Pe(this.#f)}error(i){var s=this.#i.onerror;let c=this.#i.failed;if(this.#p||!s&&!c)throw i;this.#s&&(Fn(this.#s),this.#s=null),this.#n&&(Fn(this.#n),this.#n=null),this.#l&&(Fn(this.#l),this.#l=null),ir&&(hn(this.#r),hO(),hn(zm()));var d=!1,m=!1;const e=()=>{if(d){fO();return}d=!0,m&&eO(),ro.ensure(),this.#d=0,this.#l!==null&&Go(this.#l,()=>{this.#l=null}),this.#t=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#p=!1,Sn(()=>this.#a(this.#e)))),this.#u>0?this.#m():this.#t=!1};var a=Gr;try{In(null),m=!0,s?.(i,e),m=!1}catch(g){pf(g,this.#o&&this.#o.parent)}finally{In(a)}c&&Aa(()=>{this.#l=this.#h(()=>{this.#p=!0;try{return Sn(()=>{c(this.#e,()=>i,()=>e)})}catch(g){return pf(g,this.#o.parent),null}finally{this.#p=!1}})})}}function SO(r,i){for(var s=r.nodes_start,c=r.nodes_end;s!==null;){var d=s===c?null:Zo(s);i.append(s),s=d}}function oI(r,i,s){const c=vf()?Xm:Om;if(i.length===0){s(r.map(c));return}var d=Zi,m=Br,e=TO(),a=ir;Promise.all(i.map(g=>CO(g))).then(g=>{e();try{s([...r.map(c),...g])}catch(w){(m.f&Vc)===0&&pf(w,m)}a&&Tn(!1),d?.deactivate(),aI()}).catch(g=>{pf(g,m)})}function TO(){var r=Br,i=Gr,s=si,c=Zi,d=ir;if(d)var m=Cr;return function(){rs(r),In(i),du(s),c?.activate(),d&&(Tn(!0),hn(m))}}function aI(){rs(null),In(null),du(null)}function Xm(r){var i=Ms|Ao,s=Gr!==null&&(Gr.f&Ms)!==0?Gr:null;return Br===null||s!==null&&(s.f&wo)!==0?i|=wo:Br.f|=gf,{ctx:si,deps:null,effects:null,equals:eI,f:i,fn:r,reactions:null,rv:0,v:fn,wv:0,parent:s??Br,ac:null}}function CO(r,i){let s=Br;s===null&&q3();var c=s.b,d=void 0,m=$o(fn),e=!Gr,a=new Map;return zO(()=>{var g=ZD();d=g.promise;try{Promise.resolve(r()).then(g.resolve,g.reject)}catch(D){g.reject(D)}var w=Zi,R=c.is_pending();e&&(c.update_pending_count(1),R||(w.increment(),a.get(w)?.reject(Sm),a.set(w,g)));const S=(D,k=void 0)=>{R||w.activate(),k?k!==Sm&&(m.f|=kc,ol(m,k)):((m.f&kc)!==0&&(m.f^=kc),ol(m,D)),e&&(c.update_pending_count(-1),R||w.decrement()),aI()};g.promise.then(S,D=>S(null,D||"unknown"))}),Wm(()=>{for(const g of a.values())g.reject(Sm)}),new Promise(g=>{function w(R){function S(){R===d?g(m):w(d)}R.then(S,S)}w(d)})}function Hr(r){const i=Xm(r);return EI(i),i}function Om(r){const i=Xm(r);return i.equals=tI,i}function lI(r){var i=r.effects;if(i!==null){r.effects=null;for(var s=0;s<i.length;s+=1)Fn(i[s])}}function kO(r){for(var i=r.parent;i!==null;){if((i.f&Ms)===0)return i;i=i.parent}return null}function J1(r){var i,s=Br;rs(kO(r));try{lI(r),i=TI(r)}finally{rs(s)}return i}function uI(r){var i=J1(r);if(r.equals(i)||(r.v=i,r.wv=RI()),!Nc){var s=(lu||(r.f&wo)!==0)&&r.deps!==null?fu:es;bs(r,s)}}const uu=new Map;function $o(r,i){var s={f:0,v:r,reactions:null,equals:eI,rv:0,wv:0};return s}function Ar(r,i){const s=$o(r);return EI(s),s}function tl(r,i=!1,s=!0){const c=$o(r);return i||(c.equals=tI),bf&&s&&si!==null&&si.l!==null&&(si.l.s??=[]).push(c),c}function Xt(r,i,s=!1){Gr!==null&&(!qo||(Gr.f&xA)!==0)&&vf()&&(Gr.f&(Ms|zc|$v|xA))!==0&&!al?.includes(r)&&Q3();let c=s?il(i):i;return ol(r,c)}function ol(r,i){if(!r.equals(i)){var s=r.v;Nc?uu.set(r,i):uu.set(r,s),r.v=i;var c=ro.ensure();c.capture(r,s),(r.f&Ms)!==0&&((r.f&Ao)!==0&&J1(r),bs(r,(r.f&wo)===0?es:fu)),r.wv=RI(),cI(r,Ao),vf()&&Br!==null&&(Br.f&es)!==0&&(Br.f&(dl|Oc))===0&&(bo===null?VO([r]):bo.push(r))}return i}function EA(r,i=1){var s=Pe(r),c=i===1?s++:s--;return Xt(r,s),c}function cu(r){Xt(r,r.v+1)}function cI(r,i){var s=r.reactions;if(s!==null)for(var c=vf(),d=s.length,m=0;m<d;m++){var e=s[m],a=e.f;if(!(!c&&e===Br)){var g=(a&Ao)===0;g&&bs(e,i),(a&Ms)!==0?cI(e,fu):g&&((a&zc)!==0&&Ec!==null&&Ec.push(e),Lc(e))}}}function il(r){if(typeof r!="object"||r===null||wa in r)return r;const i=G1(r);if(i!==z3&&i!==O3)return r;var s=new Map,c=$m(r),d=Ar(0),m=ll,e=a=>{if(ll===m)return a();var g=Gr,w=ll;In(null),CA(m);var R=a();return In(g),CA(w),R};return c&&s.set("length",Ar(r.length)),new Proxy(r,{defineProperty(a,g,w){(!("value"in w)||w.configurable===!1||w.enumerable===!1||w.writable===!1)&&Y3();var R=s.get(g);return R===void 0?R=e(()=>{var S=Ar(w.value);return s.set(g,S),S}):Xt(R,w.value,!0),!0},deleteProperty(a,g){var w=s.get(g);if(w===void 0){if(g in a){const R=e(()=>Ar(fn));s.set(g,R),cu(d)}}else Xt(w,fn),cu(d);return!0},get(a,g,w){if(g===wa)return r;var R=s.get(g),S=g in a;if(R===void 0&&(!S||sl(a,g)?.writable)&&(R=e(()=>{var k=il(S?a[g]:fn),B=Ar(k);return B}),s.set(g,R)),R!==void 0){var D=Pe(R);return D===fn?void 0:D}return Reflect.get(a,g,w)},getOwnPropertyDescriptor(a,g){var w=Reflect.getOwnPropertyDescriptor(a,g);if(w&&"value"in w){var R=s.get(g);R&&(w.value=Pe(R))}else if(w===void 0){var S=s.get(g),D=S?.v;if(S!==void 0&&D!==fn)return{enumerable:!0,configurable:!0,value:D,writable:!0}}return w},has(a,g){if(g===wa)return!0;var w=s.get(g),R=w!==void 0&&w.v!==fn||Reflect.has(a,g);if(w!==void 0||Br!==null&&(!R||sl(a,g)?.writable)){w===void 0&&(w=e(()=>{var D=R?il(a[g]):fn,k=Ar(D);return k}),s.set(g,w));var S=Pe(w);if(S===fn)return!1}return R},set(a,g,w,R){var S=s.get(g),D=g in a;if(c&&g==="length")for(var k=w;k<S.v;k+=1){var B=s.get(k+"");B!==void 0?Xt(B,fn):k in a&&(B=e(()=>Ar(fn)),s.set(k+"",B))}if(S===void 0)(!D||sl(a,g)?.writable)&&(S=e(()=>Ar(void 0)),Xt(S,il(w)),s.set(g,S));else{D=S.v!==fn;var F=e(()=>il(w));Xt(S,F)}var K=Reflect.getOwnPropertyDescriptor(a,g);if(K?.set&&K.set.call(R,w),!D){if(c&&typeof g=="string"){var U=s.get("length"),ee=Number(g);Number.isInteger(ee)&&ee>=U.v&&Xt(U,ee+1)}cu(d)}return!0},ownKeys(a){Pe(d);var g=Reflect.ownKeys(a).filter(S=>{var D=s.get(S);return D===void 0||D.v!==fn});for(var[w,R]of s)R.v!==fn&&!(w in a)&&g.push(w);return g},setPrototypeOf(){J3()}})}function AA(r){try{if(r!==null&&typeof r=="object"&&wa in r)return r[wa]}catch{}return r}function PO(r,i){return Object.is(AA(r),AA(i))}var m1,dI,pI,fI;function y1(){if(m1===void 0){m1=window,dI=/Firefox/.test(navigator.userAgent);var r=Element.prototype,i=Node.prototype,s=Text.prototype;pI=sl(i,"firstChild").get,fI=sl(i,"nextSibling").get,bA(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),bA(s)&&(s.__t=void 0)}}function so(r=""){return document.createTextNode(r)}function _s(r){return pI.call(r)}function Zo(r){return fI.call(r)}function ei(r,i){if(!ir)return _s(r);var s=_s(Cr);if(s===null)s=Cr.appendChild(so());else if(i&&s.nodeType!==Zv){var c=so();return s?.before(c),hn(c),c}return hn(s),s}function Fr(r,i=!1){if(!ir){var s=_s(r);return s instanceof Comment&&s.data===""?Zo(s):s}if(i&&Cr?.nodeType!==Zv){var c=so();return Cr?.before(c),hn(c),c}return Cr}function Ji(r,i=1,s=!1){let c=ir?Cr:r;for(var d;i--;)d=c,c=Zo(c);if(!ir)return c;if(s&&c?.nodeType!==Zv){var m=so();return c===null?d?.after(m):c.before(m),hn(m),m}return hn(c),c}function hI(r){r.textContent=""}function Q1(){return!1}function LO(r,i){if(i){const s=document.body;r.autofocus=!0,Aa(()=>{document.activeElement===s&&r.focus()})}}let RA=!1;function DO(){RA||(RA=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const i of r.target.elements)i.__on_r?.()})},{capture:!0}))}function ew(r){var i=Gr,s=Br;In(null),rs(null);try{return r()}finally{In(i),rs(s)}}function mI(r){Br===null&&Gr===null&&$3(),Gr!==null&&(Gr.f&wo)!==0&&Br===null&&G3(),Nc&&K3()}function IO(r,i){var s=i.last;s===null?i.last=i.first=r:(s.next=r,r.prev=s,i.last=r)}function Ta(r,i,s,c=!0){var d=Br;d!==null&&(d.f&Ko)!==0&&(r|=Ko);var m={ctx:si,deps:null,nodes_start:null,nodes_end:null,f:r|Ao,first:null,fn:i,last:null,next:null,parent:d,b:d&&d.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(s)try{Um(m),m.f|=H1}catch(g){throw Fn(m),g}else i!==null&&Lc(m);if(c){var e=m;if(s&&e.deps===null&&e.teardown===null&&e.nodes_start===null&&e.first===e.last&&(e.f&gf)===0&&(e=e.first),e!==null&&(e.parent=d,d!==null&&IO(e,d),Gr!==null&&(Gr.f&Ms)!==0&&(r&Oc)===0)){var a=Gr;(a.effects??=[]).push(e)}}return m}function BO(){return Gr!==null&&!qo}function Wm(r){const i=Ta(Gv,null,!1);return bs(i,es),i.teardown=r,i}function xi(r){mI();var i=Br.f,s=!Gr&&(i&dl)!==0&&(i&H1)===0;if(s){var c=si;(c.e??=[]).push(r)}else return yI(r)}function yI(r){return Ta($1|HD,r,!1)}function tw(r){return mI(),Ta(Gv|HD,r,!0)}function MO(r){ro.ensure();const i=Ta(Oc|gf,r,!0);return(s={})=>new Promise(c=>{s.outro?Go(i,()=>{Fn(i),c(void 0)}):(Fn(i),c(void 0))})}function Qv(r){return Ta($1,r,!1)}function zO(r){return Ta($v|gf,r,!0)}function rw(r,i=0){return Ta(Gv|i,r,!0)}function no(r,i=[],s=[]){oI(i,s,c=>{Ta(Gv,()=>r(...c.map(Pe)),!0)})}function pl(r,i=0){var s=Ta(zc|i,r,!0);return s}function Sn(r,i=!0){return Ta(dl|gf,r,!0,i)}function gI(r){var i=r.teardown;if(i!==null){const s=Nc,c=Gr;TA(!0),In(null);try{i.call(null)}finally{TA(s),In(c)}}}function _I(r,i=!1){var s=r.first;for(r.first=r.last=null;s!==null;){const d=s.ac;d!==null&&ew(()=>{d.abort(Sm)});var c=s.next;(s.f&Oc)!==0?s.parent=null:Fn(s,i),s=c}}function OO(r){for(var i=r.first;i!==null;){var s=i.next;(i.f&dl)===0&&Fn(i),i=s}}function Fn(r,i=!0){var s=!1;(i||(r.f&j3)!==0)&&r.nodes_start!==null&&r.nodes_end!==null&&(bI(r.nodes_start,r.nodes_end),s=!0),_I(r,i&&!s),Tv(r,0),bs(r,Vc);var c=r.transitions;if(c!==null)for(const m of c)m.stop();gI(r);var d=r.parent;d!==null&&d.first!==null&&vI(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function bI(r,i){for(;r!==null;){var s=r===i?null:Zo(r);r.remove(),r=s}}function vI(r){var i=r.parent,s=r.prev,c=r.next;s!==null&&(s.next=c),c!==null&&(c.prev=s),i!==null&&(i.first===r&&(i.first=c),i.last===r&&(i.last=s))}function Go(r,i){var s=[];iw(r,s,!0),xI(s,()=>{Fn(r),i&&i()})}function xI(r,i){var s=r.length;if(s>0){var c=()=>--s||i();for(var d of r)d.out(c)}else i()}function iw(r,i,s){if((r.f&Ko)===0){if(r.f^=Ko,r.transitions!==null)for(const e of r.transitions)(e.is_global||s)&&i.push(e);for(var c=r.first;c!==null;){var d=c.next,m=(c.f&Uc)!==0||(c.f&dl)!==0;iw(c,i,m?s:!1),c=d}}}function ff(r){wI(r,!0)}function wI(r,i){if((r.f&Ko)!==0){r.f^=Ko,(r.f&es)===0&&(bs(r,Ao),Lc(r));for(var s=r.first;s!==null;){var c=s.next,d=(s.f&Uc)!==0||(s.f&dl)!==0;wI(s,d?i:!1),s=c}if(r.transitions!==null)for(const m of r.transitions)(m.is_global||i)&&m.in()}}let af=!1;function SA(r){af=r}let Nc=!1;function TA(r){Nc=r}let Gr=null,qo=!1;function In(r){Gr=r}let Br=null;function rs(r){Br=r}let al=null;function EI(r){Gr!==null&&(al===null?al=[r]:al.push(r))}let gs=null,Qs=0,bo=null;function VO(r){bo=r}let AI=1,Vm=0,ll=Vm;function CA(r){ll=r}let lu=!1;function RI(){return++AI}function e0(r){var i=r.f;if((i&Ao)!==0)return!0;if((i&fu)!==0){var s=r.deps,c=(i&wo)!==0;if(s!==null){var d,m,e=(i&Sv)!==0,a=c&&Br!==null&&!lu,g=s.length;if((e||a)&&(Br===null||(Br.f&Vc)===0)){var w=r,R=w.parent;for(d=0;d<g;d++)m=s[d],(e||!m?.reactions?.includes(w))&&(m.reactions??=[]).push(w);e&&(w.f^=Sv),a&&R!==null&&(R.f&wo)===0&&(w.f^=wo)}for(d=0;d<g;d++)if(m=s[d],e0(m)&&uI(m),m.wv>r.wv)return!0}(!c||Br!==null&&!lu)&&bs(r,es)}return!1}function SI(r,i,s=!0){var c=r.reactions;if(c!==null&&!al?.includes(r))for(var d=0;d<c.length;d++){var m=c[d];(m.f&Ms)!==0?SI(m,i,!1):i===m&&(s?bs(m,Ao):(m.f&es)!==0&&bs(m,fu),Lc(m))}}function TI(r){var i=gs,s=Qs,c=bo,d=Gr,m=lu,e=al,a=si,g=qo,w=ll,R=r.f;gs=null,Qs=0,bo=null,lu=(R&wo)!==0&&(qo||!af||Gr===null),Gr=(R&(dl|Oc))===0?r:null,al=null,du(r.ctx),qo=!1,ll=++Vm,r.ac!==null&&(ew(()=>{r.ac.abort(Sm)}),r.ac=null);try{r.f|=d1;var S=r.fn,D=S(),k=r.deps;if(gs!==null){var B;if(Tv(r,Qs),k!==null&&Qs>0)for(k.length=Qs+gs.length,B=0;B<gs.length;B++)k[Qs+B]=gs[B];else r.deps=k=gs;if(!lu||(R&Ms)!==0&&r.reactions!==null)for(B=Qs;B<k.length;B++)(k[B].reactions??=[]).push(r)}else k!==null&&Qs<k.length&&(Tv(r,Qs),k.length=Qs);if(vf()&&bo!==null&&!qo&&k!==null&&(r.f&(Ms|fu|Ao))===0)for(B=0;B<bo.length;B++)SI(bo[B],r);return d!==null&&d!==r&&(Vm++,bo!==null&&(c===null?c=bo:c.push(...bo))),(r.f&kc)!==0&&(r.f^=kc),D}catch(F){return iI(F)}finally{r.f^=d1,gs=i,Qs=s,bo=c,Gr=d,lu=m,al=e,du(a),qo=g,ll=w}}function UO(r,i){let s=i.reactions;if(s!==null){var c=M3.call(s,r);if(c!==-1){var d=s.length-1;d===0?s=i.reactions=null:(s[c]=s[d],s.pop())}}s===null&&(i.f&Ms)!==0&&(gs===null||!gs.includes(i))&&(bs(i,fu),(i.f&(wo|Sv))===0&&(i.f^=Sv),lI(i),Tv(i,0))}function Tv(r,i){var s=r.deps;if(s!==null)for(var c=i;c<s.length;c++)UO(r,s[c])}function Um(r){var i=r.f;if((i&Vc)===0){bs(r,es);var s=Br,c=af;Br=r,af=!0;try{(i&zc)!==0?OO(r):_I(r),gI(r);var d=TI(r);r.teardown=typeof d=="function"?d:null,r.wv=AI;var m}finally{af=c,Br=s}}}async function Cv(){await Promise.resolve(),Jv()}function jO(){return ro.ensure().settled()}function Pe(r){var i=r.f,s=(i&Ms)!==0;if(Gr!==null&&!qo){var c=Br!==null&&(Br.f&Vc)!==0;if(!c&&!al?.includes(r)){var d=Gr.deps;if((Gr.f&d1)!==0)r.rv<Vm&&(r.rv=Vm,gs===null&&d!==null&&d[Qs]===r?Qs++:gs===null?gs=[r]:(!lu||!gs.includes(r))&&gs.push(r));else{(Gr.deps??=[]).push(r);var m=r.reactions;m===null?r.reactions=[Gr]:m.includes(Gr)||m.push(Gr)}}}else if(s&&r.deps===null&&r.effects===null){var e=r,a=e.parent;a!==null&&(a.f&wo)===0&&(e.f^=wo)}if(Nc){if(uu.has(r))return uu.get(r);if(s){e=r;var g=e.v;return((e.f&es)===0&&e.reactions!==null||CI(e))&&(g=J1(e)),uu.set(e,g),g}}else s&&(e=r,e0(e)&&uI(e));if((r.f&kc)!==0)throw r.v;return r.v}function CI(r){if(r.v===fn)return!0;if(r.deps===null)return!1;for(const i of r.deps)if(uu.has(i)||(i.f&Ms)!==0&&CI(i))return!0;return!1}function is(r){var i=qo;try{return qo=!0,r()}finally{qo=i}}const NO=-7169;function bs(r,i){r.f=r.f&NO|i}function eo(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(wa in r)g1(r);else if(!Array.isArray(r))for(let i in r){const s=r[i];typeof s=="object"&&s&&wa in s&&g1(s)}}}function g1(r,i=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!i.has(r)){i.add(r),r instanceof Date&&r.getTime();for(let c in r)try{g1(r[c],i)}catch{}const s=G1(r);if(s!==Object.prototype&&s!==Array.prototype&&s!==Map.prototype&&s!==Set.prototype&&s!==Date.prototype){const c=$D(s);for(let d in c){const m=c[d].get;if(m)try{m.call(r)}catch{}}}}}function FO(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const qO=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function KO(r){return qO.includes(r)}const GO={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function $O(r){return r=r.toLowerCase(),GO[r]??r}const ZO=["touchstart","touchmove"];function HO(r){return ZO.includes(r)}const XO=["textarea","script","style","title"];function WO(r){return XO.includes(r)}const kI=new Set,_1=new Set;function PI(r,i,s,c={}){function d(m){if(c.capture||Am.call(i,m),!m.cancelBubble)return ew(()=>s?.call(this,m))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Aa(()=>{i.addEventListener(r,d,c)}):i.addEventListener(r,d,c),d}function Dc(r,i,s,c,d){var m={capture:c,passive:d},e=PI(r,i,s,m);(i===document.body||i===window||i===document||i instanceof HTMLMediaElement)&&Wm(()=>{i.removeEventListener(r,e,m)})}function nw(r){for(var i=0;i<r.length;i++)kI.add(r[i]);for(var s of _1)s(r)}let kA=null;function Am(r){var i=this,s=i.ownerDocument,c=r.type,d=r.composedPath?.()||[],m=d[0]||r.target;kA=r;var e=0,a=kA===r&&r.__root;if(a){var g=d.indexOf(a);if(g!==-1&&(i===document||i===window)){r.__root=i;return}var w=d.indexOf(i);if(w===-1)return;g<=w&&(e=g)}if(m=d[e]||r.target,m!==i){Rv(r,"currentTarget",{configurable:!0,get(){return m||s}});var R=Gr,S=Br;In(null),rs(null);try{for(var D,k=[];m!==null;){var B=m.assignedSlot||m.parentNode||m.host||null;try{var F=m["__"+c];if(F!=null&&(!m.disabled||r.target===m))if($m(F)){var[K,...U]=F;K.apply(m,[r,...U])}else F.call(m,r)}catch(ee){D?k.push(ee):D=ee}if(r.cancelBubble||B===i||B===null)break;m=B}if(D){for(let ee of k)queueMicrotask(()=>{throw ee});throw D}}finally{r.__root=i,delete r.currentTarget,In(R),rs(S)}}}function t0(r){var i=document.createElement("template");return i.innerHTML=r.replaceAll("<!>","<!---->"),i.content}function Is(r,i){var s=Br;s.nodes_start===null&&(s.nodes_start=r,s.nodes_end=i)}function Bn(r,i){var s=(i&aO)!==0,c=(i&lO)!==0,d,m=!r.startsWith("<!>");return()=>{if(ir)return Is(Cr,null),Cr;d===void 0&&(d=t0(m?r:"<!>"+r),s||(d=_s(d)));var e=c||dI?document.importNode(d,!0):d.cloneNode(!0);if(s){var a=_s(e),g=e.lastChild;Is(a,g)}else Is(e,e);return e}}function YO(r,i,s="svg"){var c=!r.startsWith("<!>"),d=`<${s}>${c?r:"<!>"+r}</${s}>`,m;return()=>{if(ir)return Is(Cr,null),Cr;if(!m){var e=t0(d),a=_s(e);m=_s(a)}var g=m.cloneNode(!0);return Is(g,g),g}}function JO(r,i){return YO(r,i,"svg")}function LI(r=""){if(!ir){var i=so(r+"");return Is(i,i),i}var s=Cr;return s.nodeType!==Zv&&(s.before(s=so()),hn(s)),Is(s,s),s}function ai(){if(ir)return Is(Cr,null),Cr;var r=document.createDocumentFragment(),i=document.createComment(""),s=so();return r.append(i,s),Is(i,s),r}function fr(r,i){if(ir){Br.nodes_end=Cr,Ro();return}r!==null&&r.before(i)}function Ea(r,i){var s=i==null?"":typeof i=="object"?i+"":i;s!==(r.__t??=r.nodeValue)&&(r.__t=s,r.nodeValue=s+"")}function sw(r,i){return II(r,i)}function DI(r,i){y1(),i.intro=i.intro??!1;const s=i.target,c=ir,d=Cr;try{for(var m=_s(s);m&&(m.nodeType!==jc||m.data!==JD);)m=Zo(m);if(!m)throw Pc;Tn(!0),hn(m);const e=II(r,{...i,anchor:m});return Tn(!1),e}catch(e){if(e instanceof Error&&e.message.split(`
`).some(a=>a.startsWith("https://svelte.dev/e/")))throw e;return e!==Pc&&console.warn("Failed to hydrate: ",e),i.recover===!1&&X3(),y1(),hI(s),Tn(!1),sw(r,i)}finally{Tn(c),hn(d)}}const Hd=new Map;function II(r,{target:i,anchor:s,props:c={},events:d,context:m,intro:e=!0}){y1();var a=new Set,g=S=>{for(var D=0;D<S.length;D++){var k=S[D];if(!a.has(k)){a.add(k);var B=HO(k);i.addEventListener(k,Am,{passive:B});var F=Hd.get(k);F===void 0?(document.addEventListener(k,Am,{passive:B}),Hd.set(k,1)):Hd.set(k,F+1)}}};g(K1(kI)),_1.add(g);var w=void 0,R=MO(()=>{var S=s??i.appendChild(so());return AO(S,{pending:()=>{}},D=>{if(m){mn({});var k=si;k.c=m}if(d&&(c.$$events=d),ir&&Is(D,null),w=r(D,c)||{},ir&&(Br.nodes_end=Cr,Cr===null||Cr.nodeType!==jc||Cr.data!==W1))throw Hm(),Pc;m&&yn()}),()=>{for(var D of a){i.removeEventListener(D,Am);var k=Hd.get(D);--k===0?(document.removeEventListener(D,Am),Hd.delete(D)):Hd.set(D,k)}_1.delete(g),S!==s&&S.parentNode?.removeChild(S)}});return b1.set(w,R),w}let b1=new WeakMap;function BI(r,i){const s=b1.get(r);return s?(b1.delete(r),s(i)):Promise.resolve()}const Ex=0,pg=1,Ax=2;function QO(r,i,s,c,d){ir&&Ro();var m=r,e=vf(),a=si,g=fn,w,R,S,D=e?$o(void 0):tl(void 0,!1,!1),k=e?$o(void 0):tl(void 0,!1,!1),B=!1;function F(U,ee){B=!0,ee&&(rs(K),In(K),du(a));try{U===pg&&c&&(R?ff(R):R=Sn(()=>c(m,D))),U===Ax&&d&&(S?ff(S):S=Sn(()=>d(m,k))),U!==Ex&&w&&Go(w,()=>w=null),U!==pg&&R&&Go(R,()=>R=null),U!==Ax&&S&&Go(S,()=>S=null)}finally{ee&&(du(null),In(null),rs(null),of||Jv())}}var K=pl(()=>{if(g===(g=i()))return;let U=ir&&vA(g)===(m.data===Zm);if(U&&(m=zm(),hn(m),Tn(!1),U=!0),vA(g)){var ee=g;B=!1,ee.then(le=>{ee===g&&(ol(D,le),F(pg,!0))},le=>{if(ee===g&&(ol(k,le),F(Ax,!0),!d))throw k.v}),ir||Aa(()=>{B||F(Ex,!0)})}else ol(D,g),F(pg,!1);return U&&Tn(!0),()=>g=fn});ir&&(m=Cr)}function Qi(r,i,s=!1){ir&&Ro();var c=r,d=null,m=null,e=fn,a=s?Uc:0,g=!1;const w=(k,B=!0)=>{g=!0,D(B,k)};var R=null;function S(){R!==null&&(R.lastChild.remove(),c.before(R),R=null);var k=e?d:m,B=e?m:d;k&&ff(k),B&&Go(B,()=>{e?m=null:d=null})}const D=(k,B)=>{if(e===(e=k))return;let F=!1;if(ir){const Te=QD(c)===Zm;!!e===Te&&(c=zm(),hn(c),Tn(!1),F=!0)}var K=Q1(),U=c;if(K&&(R=document.createDocumentFragment(),R.append(U=so())),e?d??=B&&Sn(()=>B(U)):m??=B&&Sn(()=>B(U)),K){var ee=Zi,le=e?d:m,Q=e?m:d;le&&ee.skipped_effects.delete(le),Q&&ee.skipped_effects.add(Q),ee.add_callback(S)}else S();F&&Tn(!0)};pl(()=>{g=!1,i(w),g||D(null,null)},a),ir&&(c=Cr)}function Tc(r,i){return i}function eV(r,i,s){for(var c=r.items,d=[],m=i.length,e=0;e<m;e++)iw(i[e].e,d,!0);var a=m>0&&d.length===0&&s!==null;if(a){var g=s.parentNode;hI(g),g.append(s),c.clear(),ga(r,i[0].prev,i[m-1].next)}xI(d,()=>{for(var w=0;w<m;w++){var R=i[w];a||(c.delete(R.k),ga(r,R.prev,R.next)),Fn(R.e,!a)}})}function Cc(r,i,s,c,d,m=null){var e=r,a={flags:i,items:new Map,first:null},g=(i&WD)!==0;if(g){var w=r;e=ir?hn(_s(w)):w.appendChild(so())}ir&&Ro();var R=null,S=!1,D=new Map,k=Om(()=>{var U=s();return $m(U)?U:U==null?[]:K1(U)}),B,F;function K(){tV(F,B,a,D,e,d,i,c,s),m!==null&&(B.length===0?R?ff(R):R=Sn(()=>m(e)):R!==null&&Go(R,()=>{R=null}))}pl(()=>{F??=Br,B=Pe(k);var U=B.length;if(S&&U===0)return;S=U===0;let ee=!1;if(ir){var le=QD(e)===Zm;le!==(U===0)&&(e=zm(),hn(e),Tn(!1),ee=!0)}if(ir){for(var Q=null,Te,pe=0;pe<U;pe++){if(Cr.nodeType===jc&&Cr.data===W1){e=Cr,ee=!0,Tn(!1);break}var _e=B[pe],Xe=c(_e,pe);Te=v1(Cr,a,Q,null,_e,Xe,pe,d,i,s),a.items.set(Xe,Te),Q=Te}U>0&&hn(zm())}if(ir)U===0&&m&&(R=Sn(()=>m(e)));else if(Q1()){var dt=new Set,He=Zi;for(pe=0;pe<U;pe+=1){_e=B[pe],Xe=c(_e,pe);var et=a.items.get(Xe)??D.get(Xe);et?(i&(Hv|Xv))!==0&&MI(et,_e,pe,i):(Te=v1(null,a,null,null,_e,Xe,pe,d,i,s,!0),D.set(Xe,Te)),dt.add(Xe)}for(const[rt,te]of a.items)dt.has(rt)||He.skipped_effects.add(te.e);He.add_callback(K)}else K();ee&&Tn(!0),Pe(k)}),ir&&(e=Cr)}function tV(r,i,s,c,d,m,e,a,g){var w=(e&tO)!==0,R=(e&(Hv|Xv))!==0,S=i.length,D=s.items,k=s.first,B=k,F,K=null,U,ee=[],le=[],Q,Te,pe,_e;if(w)for(_e=0;_e<S;_e+=1)Q=i[_e],Te=a(Q,_e),pe=D.get(Te),pe!==void 0&&(pe.a?.measure(),(U??=new Set).add(pe));for(_e=0;_e<S;_e+=1){if(Q=i[_e],Te=a(Q,_e),pe=D.get(Te),pe===void 0){var Xe=c.get(Te);if(Xe!==void 0){c.delete(Te),D.set(Te,Xe);var dt=K?K.next:B;ga(s,K,Xe),ga(s,Xe,dt),Rx(Xe,dt,d),K=Xe}else{var He=B?B.e.nodes_start:d;K=v1(He,s,K,K===null?s.first:K.next,Q,Te,_e,m,e,g)}D.set(Te,K),ee=[],le=[],B=K.next;continue}if(R&&MI(pe,Q,_e,e),(pe.e.f&Ko)!==0&&(ff(pe.e),w&&(pe.a?.unfix(),(U??=new Set).delete(pe))),pe!==B){if(F!==void 0&&F.has(pe)){if(ee.length<le.length){var et=le[0],rt;K=et.prev;var te=ee[0],Be=ee[ee.length-1];for(rt=0;rt<ee.length;rt+=1)Rx(ee[rt],et,d);for(rt=0;rt<le.length;rt+=1)F.delete(le[rt]);ga(s,te.prev,Be.next),ga(s,K,te),ga(s,Be,et),B=et,K=Be,_e-=1,ee=[],le=[]}else F.delete(pe),Rx(pe,B,d),ga(s,pe.prev,pe.next),ga(s,pe,K===null?s.first:K.next),ga(s,K,pe),K=pe;continue}for(ee=[],le=[];B!==null&&B.k!==Te;)(B.e.f&Ko)===0&&(F??=new Set).add(B),le.push(B),B=B.next;if(B===null)continue;pe=B}ee.push(pe),K=pe,B=pe.next}if(B!==null||F!==void 0){for(var fe=F===void 0?[]:K1(F);B!==null;)(B.e.f&Ko)===0&&fe.push(B),B=B.next;var ye=fe.length;if(ye>0){var nt=(e&WD)!==0&&S===0?d:null;if(w){for(_e=0;_e<ye;_e+=1)fe[_e].a?.measure();for(_e=0;_e<ye;_e+=1)fe[_e].a?.fix()}eV(s,fe,nt)}}w&&Aa(()=>{if(U!==void 0)for(pe of U)pe.a?.apply()}),r.first=s.first&&s.first.e,r.last=K&&K.e;for(var gt of c.values())Fn(gt.e);c.clear()}function MI(r,i,s,c){(c&Hv)!==0&&ol(r.v,i),(c&Xv)!==0?ol(r.i,s):r.i=s}function v1(r,i,s,c,d,m,e,a,g,w,R){var S=(g&Hv)!==0,D=(g&rO)===0,k=S?D?tl(d,!1,!1):$o(d):d,B=(g&Xv)===0?e:$o(e),F={i:B,v:k,k:m,a:null,e:null,prev:s,next:c};try{if(r===null){var K=document.createDocumentFragment();K.append(r=so())}return F.e=Sn(()=>a(r,k,B,w),ir),F.e.prev=s&&s.e,F.e.next=c&&c.e,s===null?R||(i.first=F):(s.next=F,s.e.next=F.e),c!==null&&(c.prev=F,c.e.prev=F.e),F}finally{}}function Rx(r,i,s){for(var c=r.next?r.next.e.nodes_start:s,d=i?i.e.nodes_start:s,m=r.e.nodes_start;m!==null&&m!==c;){var e=Zo(m);d.before(m),m=e}}function ga(r,i,s){i===null?r.first=s:(i.next=s,i.e.next=s&&s.e),s!==null&&(s.prev=i,s.e.prev=i&&i.e)}function rV(r,i,s=!1,c=!1,d=!1){var m=r,e="";no(()=>{var a=Br;if(e===(e=i()??"")){ir&&Ro();return}if(a.nodes_start!==null&&(bI(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),e!==""){if(ir){Cr.data;for(var g=Ro(),w=g;g!==null&&(g.nodeType!==jc||g.data!=="");)w=g,g=Zo(g);if(g===null)throw Hm(),Pc;Is(Cr,w),m=hn(g);return}var R=e+"";s?R=`<svg>${R}</svg>`:c&&(R=`<math>${R}</math>`);var S=t0(R);if((s||c)&&(S=_s(S)),Is(_s(S),S.lastChild),s||c)for(;_s(S);)m.before(_s(S));else m.before(S)}})}function zI(r,i,s,c,d){ir&&Ro();var m=i.$$slots?.[s],e=!1;m===!0&&(m=i.children,e=!0),m===void 0||m(r,e?()=>c:c)}function hf(r,i,...s){var c=r,d=xa,m;pl(()=>{d!==(d=i())&&(m&&(Fn(m),m=null),m=Sn(()=>d(c,...s)))},Uc),ir&&(c=Cr)}function iV(r){return(i,...s)=>{var c=r(...s),d;if(ir)d=Cr,Ro();else{var m=c.render().trim(),e=t0(m);d=_s(e),i.before(d)}const a=c.setup?.(d);Is(d,d),typeof a=="function"&&Wm(a)}}function Tm(r,i,s){ir&&Ro();var c=r,d,m,e=null,a=null;function g(){m&&(Go(m),m=null),e&&(e.lastChild.remove(),c.before(e),e=null),m=a,a=null}pl(()=>{if(d!==(d=i())){var w=Q1();if(d){var R=c;w&&(e=document.createDocumentFragment(),e.append(R=so()),m&&Zi.skipped_effects.add(m)),a=Sn(()=>s(R,d))}w?Zi.add_callback(g):g()}},Uc),ir&&(c=Cr)}function Rm(r,i,s,c,d,m){let e=ir;ir&&Ro();var a,g,w=null;ir&&Cr.nodeType===F3&&(w=Cr,Ro());var R=ir?Cr:r,S;pl(()=>{const D=i()||null;var k=s||D==="svg"?cO:null;D!==a&&(S&&(D===null?Go(S,()=>{S=null,g=null}):D===g?ff(S):Fn(S)),D&&D!==g&&(S=Sn(()=>{if(w=ir?w:k?document.createElementNS(k,D):document.createElement(D),Is(w,w),c){ir&&WO(D)&&w.append(document.createComment(""));var B=ir?_s(w):w.appendChild(so());ir&&(B===null?Tn(!1):hn(B)),c(w,B)}Br.nodes_end=w,R.before(w)})),a=D,a&&(g=a))},Uc),e&&(Tn(!0),hn(R))}function x1(r,i,s){Qv(()=>{var c=is(()=>i(r,s?.())||{});if(s&&c?.update){var d=!1,m={};rw(()=>{var e=s();eo(e),d&&Y1(m,e)&&(m=e,c.update(e))}),d=!0}if(c?.destroy)return()=>c.destroy()})}function OI(r,i){var s=void 0,c;pl(()=>{s!==(s=i())&&(c&&(Fn(c),c=null),s&&(c=Sn(()=>{Qv(()=>s(r))})))})}function VI(r){var i,s,c="";if(typeof r=="string"||typeof r=="number")c+=r;else if(typeof r=="object")if(Array.isArray(r)){var d=r.length;for(i=0;i<d;i++)r[i]&&(s=VI(r[i]))&&(c&&(c+=" "),c+=s)}else for(s in r)r[s]&&(c&&(c+=" "),c+=s);return c}function nV(){for(var r,i,s=0,c="",d=arguments.length;s<d;s++)(r=arguments[s])&&(i=VI(r))&&(c&&(c+=" "),c+=i);return c}function UI(r){return typeof r=="object"?nV(r):r??""}const PA=[...` 	
\r\f \v\uFEFF`];function sV(r,i,s){var c=r==null?"":""+r;if(i&&(c=c?c+" "+i:i),s){for(var d in s)if(s[d])c=c?c+" "+d:d;else if(c.length)for(var m=d.length,e=0;(e=c.indexOf(d,e))>=0;){var a=e+m;(e===0||PA.includes(c[e-1]))&&(a===c.length||PA.includes(c[a]))?c=(e===0?"":c.substring(0,e))+c.substring(a+1):e=a}}return c===""?null:c}function LA(r,i=!1){var s=i?" !important;":";",c="";for(var d in r){var m=r[d];m!=null&&m!==""&&(c+=" "+d+": "+m+s)}return c}function Sx(r){return r[0]!=="-"||r[1]!=="-"?r.toLowerCase():r}function oV(r,i){if(i){var s="",c,d;if(Array.isArray(i)?(c=i[0],d=i[1]):c=i,r){r=String(r).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var m=!1,e=0,a=!1,g=[];c&&g.push(...Object.keys(c).map(Sx)),d&&g.push(...Object.keys(d).map(Sx));var w=0,R=-1;const F=r.length;for(var S=0;S<F;S++){var D=r[S];if(a?D==="/"&&r[S-1]==="*"&&(a=!1):m?m===D&&(m=!1):D==="/"&&r[S+1]==="*"?a=!0:D==='"'||D==="'"?m=D:D==="("?e++:D===")"&&e--,!a&&m===!1&&e===0){if(D===":"&&R===-1)R=S;else if(D===";"||S===F-1){if(R!==-1){var k=Sx(r.substring(w,R).trim());if(!g.includes(k)){D!==";"&&S++;var B=r.substring(w,S).trim();s+=" "+B+";"}}w=S+1,R=-1}}}}return c&&(s+=LA(c)),d&&(s+=LA(d,!0)),s=s.trim(),s===""?null:s}return r==null?null:String(r)}function jI(r,i,s,c,d,m){var e=r.__className;if(ir||e!==s||e===void 0){var a=sV(s,c,m);(!ir||a!==r.getAttribute("class"))&&(a==null?r.removeAttribute("class"):i?r.className=a:r.setAttribute("class",a)),r.__className=s}else if(m&&d!==m)for(var g in m){var w=!!m[g];(d==null||w!==!!d[g])&&r.classList.toggle(g,w)}return m}function Tx(r,i={},s,c){for(var d in s){var m=s[d];i[d]!==m&&(s[d]==null?r.style.removeProperty(d):r.style.setProperty(d,m,c))}}function NI(r,i,s,c){var d=r.__style;if(ir||d!==i){var m=oV(i,c);(!ir||m!==r.getAttribute("style"))&&(m==null?r.removeAttribute("style"):r.style.cssText=m),r.__style=i}else c&&(Array.isArray(c)?(Tx(r,s?.[0],c[0]),Tx(r,s?.[1],c[1],"important")):Tx(r,s,c));return c}function w1(r,i,s=!1){if(r.multiple){if(i==null)return;if(!$m(i))return pO();for(var c of r.options)c.selected=i.includes(DA(c));return}for(c of r.options){var d=DA(c);if(PO(d,i)){c.selected=!0;return}}(!s||i!==void 0)&&(r.selectedIndex=-1)}function aV(r){var i=new MutationObserver(()=>{w1(r,r.__value)});i.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Wm(()=>{i.disconnect()})}function DA(r){return"__value"in r?r.__value:r.value}const Lh=Symbol("class"),Dh=Symbol("style"),FI=Symbol("is custom element"),qI=Symbol("is html");function lV(r){if(ir){var i=!1,s=()=>{if(!i){if(i=!0,r.hasAttribute("value")){var c=r.value;Ra(r,"value",null),r.value=c}if(r.hasAttribute("checked")){var d=r.checked;Ra(r,"checked",null),r.checked=d}}};r.__on_r=s,Aa(s),DO()}}function uV(r,i){i?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ra(r,i,s,c){var d=KI(r);ir&&(d[i]=r.getAttribute(i),i==="src"||i==="srcset"||i==="href"&&r.nodeName==="LINK")||d[i]!==(d[i]=s)&&(i==="loading"&&(r[N3]=s),s==null?r.removeAttribute(i):typeof s!="string"&&ow(r).includes(i)?r[i]=s:r.setAttribute(i,s))}function cV(r,i,s){var c=Gr,d=Br;let m=ir;ir&&Tn(!1),In(null),rs(null);try{i!=="style"&&(E1.has(r.getAttribute("is")||r.nodeName)||!customElements||customElements.get(r.getAttribute("is")||r.tagName.toLowerCase())?ow(r).includes(i):s&&typeof s=="object")?r[i]=s:Ra(r,i,s==null?s:String(s))}finally{In(c),rs(d),m&&Tn(!0)}}function dV(r,i,s,c,d=!1,m=!1){if(ir&&d&&r.tagName==="INPUT"){var e=r,a=e.type==="checkbox"?"defaultChecked":"defaultValue";a in s||lV(e)}var g=KI(r),w=g[FI],R=!g[qI];let S=ir&&w;S&&Tn(!1);var D=i||{},k=r.tagName==="OPTION";for(var B in i)B in s||(s[B]=null);s.class?s.class=UI(s.class):s[Lh]&&(s.class=null),s[Dh]&&(s.style??=null);var F=ow(r);for(const pe in s){let _e=s[pe];if(k&&pe==="value"&&_e==null){r.value=r.__value="",D[pe]=_e;continue}if(pe==="class"){var K=r.namespaceURI==="http://www.w3.org/1999/xhtml";jI(r,K,_e,c,i?.[Lh],s[Lh]),D[pe]=_e,D[Lh]=s[Lh];continue}if(pe==="style"){NI(r,_e,i?.[Dh],s[Dh]),D[pe]=_e,D[Dh]=s[Dh];continue}var U=D[pe];if(!(_e===U&&!(_e===void 0&&r.hasAttribute(pe)))){D[pe]=_e;var ee=pe[0]+pe[1];if(ee!=="$$")if(ee==="on"){const Xe={},dt="$$"+pe;let He=pe.slice(2);var le=KO(He);if(FO(He)&&(He=He.slice(0,-7),Xe.capture=!0),!le&&U){if(_e!=null)continue;r.removeEventListener(He,D[dt],Xe),D[dt]=null}if(_e!=null)if(le)r[`__${He}`]=_e,nw([He]);else{let et=function(rt){D[pe].call(this,rt)};D[dt]=PI(He,r,et,Xe)}else le&&(r[`__${He}`]=void 0)}else if(pe==="style")Ra(r,pe,_e);else if(pe==="autofocus")LO(r,!!_e);else if(!w&&(pe==="__value"||pe==="value"&&_e!=null))r.value=r.__value=_e;else if(pe==="selected"&&k)uV(r,_e);else{var Q=pe;R||(Q=$O(Q));var Te=Q==="defaultValue"||Q==="defaultChecked";if(_e==null&&!w&&!Te)if(g[pe]=null,Q==="value"||Q==="checked"){let Xe=r;const dt=i===void 0;if(Q==="value"){let He=Xe.defaultValue;Xe.removeAttribute(Q),Xe.defaultValue=He,Xe.value=Xe.__value=dt?He:null}else{let He=Xe.defaultChecked;Xe.removeAttribute(Q),Xe.defaultChecked=He,Xe.checked=dt?He:!1}}else r.removeAttribute(pe);else Te||F.includes(Q)&&(w||typeof _e!="string")?(r[Q]=_e,Q in g&&(g[Q]=fn)):typeof _e!="function"&&Ra(r,Q,_e)}}}return S&&Tn(!0),D}function sf(r,i,s=[],c=[],d,m=!1,e=!1){oI(s,c,a=>{var g=void 0,w={},R=r.nodeName==="SELECT",S=!1;if(pl(()=>{var k=i(...a.map(Pe)),B=dV(r,g,k,d,m,e);S&&R&&"value"in k&&w1(r,k.value);for(let K of Object.getOwnPropertySymbols(w))k[K]||Fn(w[K]);for(let K of Object.getOwnPropertySymbols(k)){var F=k[K];K.description===dO&&(!g||F!==g[K])&&(w[K]&&Fn(w[K]),w[K]=Sn(()=>OI(r,()=>F))),B[K]=F}g=B}),R){var D=r;Qv(()=>{w1(D,g.value,!0),aV(D)})}S=!0})}function KI(r){return r.__attributes??={[FI]:r.nodeName.includes("-"),[qI]:r.namespaceURI===uO}}var E1=new Map;function ow(r){var i=r.getAttribute("is")||r.nodeName,s=E1.get(i);if(s)return s;E1.set(i,s=[]);for(var c,d=r,m=Element.prototype;m!==d;){c=$D(d);for(var e in c)c[e].set&&s.push(e);d=G1(d)}return s}function Ym(r,i,s){var c=sl(r,i);c&&c.set&&(r[i]=s,Wm(()=>{r[i]=null}))}function IA(r,i){return r===i||r?.[wa]===i}function Cm(r={},i,s,c){return Qv(()=>{var d,m;return rw(()=>{d=m,m=[],is(()=>{r!==s(...m)&&(i(r,...m),d&&IA(s(...d),r)&&i(null,...d))})}),()=>{Aa(()=>{m&&IA(s(...m),r)&&i(null,...m)})}}),r}function kv(r){return function(...i){var s=i[0];return s.preventDefault(),r?.apply(this,i)}}function xf(r=!1){const i=si,s=i.l.u;if(!s)return;let c=()=>eo(i.s);if(r){let d=0,m={};const e=Xm(()=>{let a=!1;const g=i.s;for(const w in g)g[w]!==m[w]&&(m[w]=g[w],a=!0);return a&&d++,d});c=()=>Pe(e)}s.b.length&&tw(()=>{BA(i,c),c1(s.b)}),xi(()=>{const d=is(()=>s.m.map(V3));return()=>{for(const m of d)typeof m=="function"&&m()}}),s.a.length&&xi(()=>{BA(i,c),c1(s.a)})}function BA(r,i){if(r.l.s)for(const s of r.l.s)Pe(s);i()}const Xd=[];function aw(r,i=xa){let s=null;const c=new Set;function d(a){if(Y1(r,a)&&(r=a,s)){const g=!Xd.length;for(const w of c)w[1](),Xd.push(w,r);if(g){for(let w=0;w<Xd.length;w+=2)Xd[w][0](Xd[w+1]);Xd.length=0}}}function m(a){d(a(r))}function e(a,g=xa){const w=[a,g];return c.add(w),c.size===1&&(s=i(d,m)||xa),a(r),()=>{c.delete(w),c.size===0&&s&&(s(),s=null)}}return{set:d,update:m,subscribe:e}}let fg=!1;function pV(r){var i=fg;try{return fg=!1,[r(),fg]}finally{fg=i}}const fV={get(r,i){if(!r.exclude.includes(i))return r.props[i]},set(r,i){return!1},getOwnPropertyDescriptor(r,i){if(!r.exclude.includes(i)&&i in r.props)return{enumerable:!0,configurable:!0,value:r.props[i]}},has(r,i){return r.exclude.includes(i)?!1:i in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(i=>!r.exclude.includes(i))}};function GI(r,i,s){return new Proxy({props:r,exclude:i},fV)}const hV={get(r,i){if(!r.exclude.includes(i))return Pe(r.version),i in r.special?r.special[i]():r.props[i]},set(r,i,s){if(!(i in r.special)){var c=Br;try{rs(r.parent_effect),r.special[i]=St({get[i](){return r.props[i]}},i,YD)}finally{rs(c)}}return r.special[i](s),EA(r.version),!0},getOwnPropertyDescriptor(r,i){if(!r.exclude.includes(i)&&i in r.props)return{enumerable:!0,configurable:!0,value:r.props[i]}},deleteProperty(r,i){return r.exclude.includes(i)||(r.exclude.push(i),EA(r.version)),!0},has(r,i){return r.exclude.includes(i)?!1:i in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(i=>!r.exclude.includes(i))}};function A1(r,i){return new Proxy({props:r,exclude:i,special:{},version:$o(0),parent_effect:Br},hV)}const mV={get(r,i){let s=r.props.length;for(;s--;){let c=r.props[s];if(Ph(c)&&(c=c()),typeof c=="object"&&c!==null&&i in c)return c[i]}},set(r,i,s){let c=r.props.length;for(;c--;){let d=r.props[c];Ph(d)&&(d=d());const m=sl(d,i);if(m&&m.set)return m.set(s),!0}return!1},getOwnPropertyDescriptor(r,i){let s=r.props.length;for(;s--;){let c=r.props[s];if(Ph(c)&&(c=c()),typeof c=="object"&&c!==null&&i in c){const d=sl(c,i);return d&&!d.configurable&&(d.configurable=!0),d}}},has(r,i){if(i===wa||i===X1)return!1;for(let s of r.props)if(Ph(s)&&(s=s()),s!=null&&i in s)return!0;return!1},ownKeys(r){const i=[];for(let s of r.props)if(Ph(s)&&(s=s()),!!s){for(const c in s)i.includes(c)||i.push(c);for(const c of Object.getOwnPropertySymbols(s))i.includes(c)||i.push(c)}return i}};function R1(...r){return new Proxy({props:r},mV)}function St(r,i,s,c){var d=!bf||(s&nO)!==0,m=(s&sO)!==0,e=(s&oO)!==0,a=c,g=!0,w=()=>(g&&(g=!1,a=e?is(c):c),a),R;if(m){var S=wa in r||X1 in r;R=sl(r,i)?.set??(S&&i in r?le=>r[i]=le:void 0)}var D,k=!1;m?[D,k]=pV(()=>r[i]):D=r[i],D===void 0&&c!==void 0&&(D=w(),R&&(d&&W3(),R(D)));var B;if(d?B=()=>{var le=r[i];return le===void 0?w():(g=!0,le)}:B=()=>{var le=r[i];return le!==void 0&&(a=void 0),le===void 0?a:le},d&&(s&YD)===0)return B;if(R){var F=r.$$legacy;return(function(le,Q){return arguments.length>0?((!d||!Q||F||k)&&R(Q?B():le),le):B()})}var K=!1,U=((s&iO)!==0?Xm:Om)(()=>(K=!1,B()));m&&Pe(U);var ee=Br;return(function(le,Q){if(arguments.length>0){const Te=Q?Pe(U):d&&m?il(le):le;return Xt(U,Te),K=!0,a!==void 0&&(a=Te),le}return Nc&&K||(ee.f&Vc)!==0?U.v:Pe(U)})}function yV(r){return class extends gV{constructor(i){super({component:r,...i})}}}class gV{#t;#e;constructor(i){var s=new Map,c=(m,e)=>{var a=tl(e,!1,!1);return s.set(m,a),a};const d=new Proxy({...i.props||{},$$events:{}},{get(m,e){return Pe(s.get(e)??c(e,Reflect.get(m,e)))},has(m,e){return e===X1?!0:(Pe(s.get(e)??c(e,Reflect.get(m,e))),Reflect.has(m,e))},set(m,e,a){return Xt(s.get(e)??c(e,a),a),Reflect.set(m,e,a)}});this.#e=(i.hydrate?DI:sw)(i.component,{target:i.target,anchor:i.anchor,props:d,context:i.context,intro:i.intro??!1,recover:i.recover}),(!i?.props?.$$host||i.sync===!1)&&Jv(),this.#t=d.$$events;for(const m of Object.keys(this.#e))m==="$set"||m==="$destroy"||m==="$on"||Rv(this,m,{get(){return this.#e[m]},set(e){this.#e[m]=e},enumerable:!0});this.#e.$set=m=>{Object.assign(d,m)},this.#e.$destroy=()=>{BI(this.#e)}}$set(i){this.#e.$set(i)}$on(i,s){this.#t[i]=this.#t[i]||[];const c=(...d)=>s.call(this,...d);return this.#t[i].push(c),()=>{this.#t[i]=this.#t[i].filter(d=>d!==c)}}$destroy(){this.#e.$destroy()}}function _V(){return Gr===null&&H3(),(Gr.ac??=new AbortController).signal}function Ic(r){si===null&&_f(),bf&&si.l!==null?lw(si).m.push(r):xi(()=>{const i=is(r);if(typeof i=="function")return i})}function Bc(r){si===null&&_f(),Ic(()=>()=>is(r))}function bV(r,i,{bubbles:s=!1,cancelable:c=!1}={}){return new CustomEvent(r,{detail:i,bubbles:s,cancelable:c})}function vV(){const r=si;return r===null&&_f(),(i,s,c)=>{const d=r.s.$$events?.[i];if(d){const m=$m(d)?d.slice():[d],e=bV(i,s,c);for(const a of m)a.call(r.x,e);return!e.defaultPrevented}return!0}}function xV(r){si===null&&_f(),si.l===null&&XD(),lw(si).b.push(r)}function wV(r){si===null&&_f(),si.l===null&&XD(),lw(si).a.push(r)}function lw(r){var i=r.l;return i.u??={a:[],b:[],m:[]}}const EV=Object.freeze(Object.defineProperty({__proto__:null,afterUpdate:wV,beforeUpdate:xV,createEventDispatcher:vV,createRawSnippet:iV,flushSync:Jv,getAbortSignal:_V,getAllContexts:gO,getContext:hu,hasContext:yO,hydrate:DI,mount:sw,onDestroy:Bc,onMount:Ic,setContext:mu,settled:jO,tick:Cv,unmount:BI,untrack:is},Symbol.toStringTag,{value:"Module"}));class r0{constructor(i,s){this.status=i,typeof s=="string"?this.body={message:s}:s?this.body=s:this.body={message:`Error: ${i}`}}toString(){return JSON.stringify(this.body)}}class uw{constructor(i,s){this.status=i,this.location=s}}class cw extends Error{constructor(i,s,c){super(c),this.status=i,this.text=s}}new URL("sveltekit-internal://");function AV(r,i){return r==="/"||i==="ignore"?r:i==="never"?r.endsWith("/")?r.slice(0,-1):r:i==="always"&&!r.endsWith("/")?r+"/":r}function RV(r){return r.split("%25").map(decodeURI).join("%25")}function SV(r){for(const i in r)r[i]=decodeURIComponent(r[i]);return r}function Cx({href:r}){return r.split("#")[0]}function TV(r,i,s,c=!1){const d=new URL(r);Object.defineProperty(d,"searchParams",{value:new Proxy(d.searchParams,{get(e,a){if(a==="get"||a==="getAll"||a==="has")return w=>(s(w),e[a](w));i();const g=Reflect.get(e,a);return typeof g=="function"?g.bind(e):g}}),enumerable:!0,configurable:!0});const m=["href","pathname","search","toString","toJSON"];c&&m.push("hash");for(const e of m)Object.defineProperty(d,e,{get(){return i(),r[e]},enumerable:!0,configurable:!0});return d}function CV(...r){let i=5381;for(const s of r)if(typeof s=="string"){let c=s.length;for(;c;)i=i*33^s.charCodeAt(--c)}else if(ArrayBuffer.isView(s)){const c=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);let d=c.length;for(;d;)i=i*33^c[--d]}else throw new TypeError("value must be a string or TypedArray");return(i>>>0).toString(36)}new TextEncoder;const kV=new TextDecoder;function PV(r){const i=atob(r),s=new Uint8Array(i.length);for(let c=0;c<i.length;c++)s[c]=i.charCodeAt(c);return s}const LV=window.fetch;window.fetch=(r,i)=>((r instanceof Request?r.method:i?.method||"GET")!=="GET"&&km.delete(dw(r)),LV(r,i));const km=new Map;function DV(r,i){const s=dw(r,i),c=document.querySelector(s);if(c?.textContent){c.remove();let{body:d,...m}=JSON.parse(c.textContent);const e=c.getAttribute("data-ttl");return e&&km.set(s,{body:d,init:m,ttl:1e3*Number(e)}),c.getAttribute("data-b64")!==null&&(d=PV(d)),Promise.resolve(new Response(d,m))}return window.fetch(r,i)}function IV(r,i,s){if(km.size>0){const c=dw(r,s),d=km.get(c);if(d){if(performance.now()<d.ttl&&["default","force-cache","only-if-cached",void 0].includes(s?.cache))return new Response(d.body,d.init);km.delete(c)}}return window.fetch(i,s)}function dw(r,i){let c=`script[data-sveltekit-fetched][data-url=${JSON.stringify(r instanceof Request?r.url:r)}]`;if(i?.headers||i?.body){const d=[];i.headers&&d.push([...new Headers(i.headers)].join(",")),i.body&&(typeof i.body=="string"||ArrayBuffer.isView(i.body))&&d.push(i.body),c+=`[data-hash="${CV(...d)}"]`}return c}const BV=/^(\[)?(\.\.\.)?(\w+)(?:=(\w+))?(\])?$/;function MV(r){const i=[];return{pattern:r==="/"?/^\/$/:new RegExp(`^${OV(r).map(c=>{const d=/^\[\.\.\.(\w+)(?:=(\w+))?\]$/.exec(c);if(d)return i.push({name:d[1],matcher:d[2],optional:!1,rest:!0,chained:!0}),"(?:/([^]*))?";const m=/^\[\[(\w+)(?:=(\w+))?\]\]$/.exec(c);if(m)return i.push({name:m[1],matcher:m[2],optional:!0,rest:!1,chained:!0}),"(?:/([^/]+))?";if(!c)return;const e=c.split(/\[(.+?)\](?!\])/);return"/"+e.map((g,w)=>{if(w%2){if(g.startsWith("x+"))return kx(String.fromCharCode(parseInt(g.slice(2),16)));if(g.startsWith("u+"))return kx(String.fromCharCode(...g.slice(2).split("-").map(F=>parseInt(F,16))));const R=BV.exec(g),[,S,D,k,B]=R;return i.push({name:k,matcher:B,optional:!!S,rest:!!D,chained:D?w===1&&e[0]==="":!1}),D?"([^]*?)":S?"([^/]*)?":"([^/]+?)"}return kx(g)}).join("")}).join("")}/?$`),params:i}}function zV(r){return r!==""&&!/^\([^)]+\)$/.test(r)}function OV(r){return r.slice(1).split("/").filter(zV)}function VV(r,i,s){const c={},d=r.slice(1),m=d.filter(a=>a!==void 0);let e=0;for(let a=0;a<i.length;a+=1){const g=i[a];let w=d[a-e];if(g.chained&&g.rest&&e&&(w=d.slice(a-e,a+1).filter(R=>R).join("/"),e=0),w===void 0){g.rest&&(c[g.name]="");continue}if(!g.matcher||s[g.matcher](w)){c[g.name]=w;const R=i[a+1],S=d[a+1];R&&!R.rest&&R.optional&&S&&g.chained&&(e=0),!R&&!S&&Object.keys(c).length===m.length&&(e=0);continue}if(g.optional&&g.chained){e++;continue}return}if(!e)return c}function kx(r){return r.normalize().replace(/[[\]]/g,"\\$&").replace(/%/g,"%25").replace(/\//g,"%2[Ff]").replace(/\?/g,"%3[Ff]").replace(/#/g,"%23").replace(/[.*+?^${}()|\\]/g,"\\$&")}function UV({nodes:r,server_loads:i,dictionary:s,matchers:c}){const d=new Set(i);return Object.entries(s).map(([a,[g,w,R]])=>{const{pattern:S,params:D}=MV(a),k={id:a,exec:B=>{const F=S.exec(B);if(F)return VV(F,D,c)},errors:[1,...R||[]].map(B=>r[B]),layouts:[0,...w||[]].map(e),leaf:m(g)};return k.errors.length=k.layouts.length=Math.max(k.errors.length,k.layouts.length),k});function m(a){const g=a<0;return g&&(a=~a),[g,r[a]]}function e(a){return a===void 0?a:[d.has(a),r[a]]}}function $I(r,i=JSON.parse){try{return i(sessionStorage[r])}catch{}}function MA(r,i,s=JSON.stringify){const c=s(i);try{sessionStorage[r]=c}catch{}}const Eo=globalThis.__sveltekit_q3h5y4?.base??"",jV=globalThis.__sveltekit_q3h5y4?.assets??Eo??"",NV="1760485375375",ZI="sveltekit:snapshot",HI="sveltekit:scroll",XI="sveltekit:states",FV="sveltekit:pageurl",lf="sveltekit:history",jm="sveltekit:navigation",Ac={tap:1,hover:2,viewport:3,eager:4,off:-1,false:-1},i0=location.origin;function WI(r){if(r instanceof URL)return r;let i=document.baseURI;if(!i){const s=document.getElementsByTagName("base");i=s.length?s[0].href:document.URL}return new URL(r,i)}function n0(){return{x:pageXOffset,y:pageYOffset}}function Wd(r,i){return r.getAttribute(`data-sveltekit-${i}`)}const zA={...Ac,"":Ac.hover};function YI(r){let i=r.assignedSlot??r.parentNode;return i?.nodeType===11&&(i=i.host),i}function JI(r,i){for(;r&&r!==i;){if(r.nodeName.toUpperCase()==="A"&&r.hasAttribute("href"))return r;r=YI(r)}}function S1(r,i,s){let c;try{if(c=new URL(r instanceof SVGAElement?r.href.baseVal:r.href,document.baseURI),s&&c.hash.match(/^#[^/]/)){const a=location.hash.split("#")[1]||"/";c.hash=`#${a}${c.hash}`}}catch{}const d=r instanceof SVGAElement?r.target.baseVal:r.target,m=!c||!!d||s0(c,i,s)||(r.getAttribute("rel")||"").split(/\s+/).includes("external"),e=c?.origin===i0&&r.hasAttribute("download");return{url:c,external:m,target:d,download:e}}function Pv(r){let i=null,s=null,c=null,d=null,m=null,e=null,a=r;for(;a&&a!==document.documentElement;)c===null&&(c=Wd(a,"preload-code")),d===null&&(d=Wd(a,"preload-data")),i===null&&(i=Wd(a,"keepfocus")),s===null&&(s=Wd(a,"noscroll")),m===null&&(m=Wd(a,"reload")),e===null&&(e=Wd(a,"replacestate")),a=YI(a);function g(w){switch(w){case"":case"true":return!0;case"off":case"false":return!1;default:return}}return{preload_code:zA[c??"off"],preload_data:zA[d??"off"],keepfocus:g(i),noscroll:g(s),reload:g(m),replace_state:g(e)}}function OA(r){const i=aw(r);let s=!0;function c(){s=!0,i.update(e=>e)}function d(e){s=!1,i.set(e)}function m(e){let a;return i.subscribe(g=>{(a===void 0||s&&g!==a)&&e(a=g)})}return{notify:c,set:d,subscribe:m}}const QI={v:()=>{}};function qV(){const{set:r,subscribe:i}=aw(!1);let s;async function c(){clearTimeout(s);try{const d=await fetch(`${jV}/_app/version.json`,{headers:{pragma:"no-cache","cache-control":"no-cache"}});if(!d.ok)return!1;const e=(await d.json()).version!==NV;return e&&(r(!0),QI.v(),clearTimeout(s)),e}catch{return!1}}return{subscribe:i,check:c}}function s0(r,i,s){return r.origin!==i0||!r.pathname.startsWith(i)?!0:s?!(r.pathname===i+"/"||r.pathname===i+"/index.html"||r.protocol==="file:"&&r.pathname.replace(/\/[^/]+\.html?$/,"")===i):!1}function KV(r){const i=$V(r),s=new ArrayBuffer(i.length),c=new DataView(s);for(let d=0;d<s.byteLength;d++)c.setUint8(d,i.charCodeAt(d));return s}const GV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function $V(r){r.length%4===0&&(r=r.replace(/==?$/,""));let i="",s=0,c=0;for(let d=0;d<r.length;d++)s<<=6,s|=GV.indexOf(r[d]),c+=6,c===24&&(i+=String.fromCharCode((s&16711680)>>16),i+=String.fromCharCode((s&65280)>>8),i+=String.fromCharCode(s&255),s=c=0);return c===12?(s>>=4,i+=String.fromCharCode(s)):c===18&&(s>>=2,i+=String.fromCharCode((s&65280)>>8),i+=String.fromCharCode(s&255)),i}const ZV=-1,HV=-2,XV=-3,WV=-4,YV=-5,JV=-6;function QV(r,i){if(typeof r=="number")return d(r,!0);if(!Array.isArray(r)||r.length===0)throw new Error("Invalid input");const s=r,c=Array(s.length);function d(m,e=!1){if(m===ZV)return;if(m===XV)return NaN;if(m===WV)return 1/0;if(m===YV)return-1/0;if(m===JV)return-0;if(e||typeof m!="number")throw new Error("Invalid input");if(m in c)return c[m];const a=s[m];if(!a||typeof a!="object")c[m]=a;else if(Array.isArray(a))if(typeof a[0]=="string"){const g=a[0],w=i?.[g];if(w)return c[m]=w(d(a[1]));switch(g){case"Date":c[m]=new Date(a[1]);break;case"Set":const R=new Set;c[m]=R;for(let k=1;k<a.length;k+=1)R.add(d(a[k]));break;case"Map":const S=new Map;c[m]=S;for(let k=1;k<a.length;k+=2)S.set(d(a[k]),d(a[k+1]));break;case"RegExp":c[m]=new RegExp(a[1],a[2]);break;case"Object":c[m]=Object(a[1]);break;case"BigInt":c[m]=BigInt(a[1]);break;case"null":const D=Object.create(null);c[m]=D;for(let k=1;k<a.length;k+=2)D[a[k]]=d(a[k+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const k=globalThis[g],B=new k(d(a[1]));c[m]=a[2]!==void 0?B.subarray(a[2],a[3]):B;break}case"ArrayBuffer":{const k=a[1],B=KV(k);c[m]=B;break}case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":{const k=g.slice(9);c[m]=Temporal[k].from(a[1]);break}case"URL":{const k=new URL(a[1]);c[m]=k;break}case"URLSearchParams":{const k=new URLSearchParams(a[1]);c[m]=k;break}default:throw new Error(`Unknown type ${g}`)}}else{const g=new Array(a.length);c[m]=g;for(let w=0;w<a.length;w+=1){const R=a[w];R!==HV&&(g[w]=d(R))}}else{const g={};c[m]=g;for(const w in a){if(w==="__proto__")throw new Error("Cannot parse an object with a `__proto__` property");const R=a[w];g[w]=d(R)}}return c[m]}return d(0)}const eB=new Set(["load","prerender","csr","ssr","trailingSlash","config"]);[...eB];const eU=new Set([...eB]);[...eU];function tU(r){return r.filter(i=>i!=null)}const rU="x-sveltekit-invalidated",iU="x-sveltekit-trailing-slash";function Lv(r){return r instanceof r0||r instanceof cw?r.status:500}function nU(r){return r instanceof cw?r.text:"Internal Error"}let ts,Nm,Px;const sU=Ic.toString().includes("$$")||/function \w+\(\) \{\}/.test(Ic.toString());sU?(ts={data:{},form:null,error:null,params:{},route:{id:null},state:{},status:-1,url:new URL("https://example.com")},Nm={current:null},Px={current:!1}):(ts=new class{#t=Ar({});get data(){return Pe(this.#t)}set data(i){Xt(this.#t,i)}#e=Ar(null);get form(){return Pe(this.#e)}set form(i){Xt(this.#e,i)}#r=Ar(null);get error(){return Pe(this.#r)}set error(i){Xt(this.#r,i)}#i=Ar({});get params(){return Pe(this.#i)}set params(i){Xt(this.#i,i)}#a=Ar({id:null});get route(){return Pe(this.#a)}set route(i){Xt(this.#a,i)}#o=Ar({});get state(){return Pe(this.#o)}set state(i){Xt(this.#o,i)}#s=Ar(-1);get status(){return Pe(this.#s)}set status(i){Xt(this.#s,i)}#n=Ar(new URL("https://example.com"));get url(){return Pe(this.#n)}set url(i){Xt(this.#n,i)}},Nm=new class{#t=Ar(null);get current(){return Pe(this.#t)}set current(i){Xt(this.#t,i)}},Px=new class{#t=Ar(!1);get current(){return Pe(this.#t)}set current(i){Xt(this.#t,i)}},QI.v=()=>Px.current=!0);function oU(r){Object.assign(ts,r)}const aU="/__data.json",lU=".html__data.json";function uU(r){return r.endsWith(".html")?r.replace(/\.html$/,lU):r.replace(/\/$/,"")+aU}const VA={spanContext(){return cU},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this},addLink(){return this},addLinks(){return this}},cU={traceId:"",spanId:"",traceFlags:0},{tick:dU}=EV,pU=new Set(["icon","shortcut icon","apple-touch-icon"]),Mc=$I(HI)??{},Fm=$I(ZI)??{},ul={url:OA({}),page:OA({}),navigating:aw(null),updated:qV()};function pw(r){Mc[r]=n0()}function fU(r,i){let s=r+1;for(;Mc[s];)delete Mc[s],s+=1;for(s=i+1;Fm[s];)delete Fm[s],s+=1}function mf(r,i=!1){return i?location.replace(r.href):location.href=r.href,new Promise(()=>{})}async function tB(){if("serviceWorker"in navigator){const r=await navigator.serviceWorker.getRegistration(Eo||"/");r&&await r.update()}}function UA(){}let fw,T1,Dv,rl,C1,en;const Iv=[],Bv=[];let nl=null;const hg=new Map,rB=new Set,hU=new Set,Pm=new Set;let Li={branch:[],error:null,url:null},hw=!1,Mv=!1,jA=!0,qm=!1,Ih=!1,iB=!1,mw=!1,nB,Qn,xo,Rc;const Lm=new Set,NA=new Map;async function mU(r,i,s){globalThis.__sveltekit_q3h5y4?.data&&globalThis.__sveltekit_q3h5y4.data,document.URL!==location.href&&(location.href=location.href),en=r,await r.hooks.init?.(),fw=UV(r),rl=document.documentElement,C1=i,T1=r.nodes[0],Dv=r.nodes[1],T1(),Dv(),Qn=history.state?.[lf],xo=history.state?.[jm],Qn||(Qn=xo=Date.now(),history.replaceState({...history.state,[lf]:Qn,[jm]:xo},""));const c=Mc[Qn];function d(){c&&(history.scrollRestoration="manual",scrollTo(c.x,c.y))}s?(d(),await SU(C1,s)):(await uf({type:"enter",url:WI(en.hash?CU(new URL(location.href)):location.href),replace_state:!0}),d()),RU()}function yU(){Iv.length=0,mw=!1}function sB(r){Bv.some(i=>i?.snapshot)&&(Fm[r]=Bv.map(i=>i?.snapshot?.capture()))}function oB(r){Fm[r]?.forEach((i,s)=>{Bv[s]?.snapshot?.restore(i)})}function FA(){pw(Qn),MA(HI,Mc),sB(xo),MA(ZI,Fm)}async function gU(r,i,s,c){let d;i.invalidateAll&&(nl=null),await uf({type:"goto",url:WI(r),keepfocus:i.keepFocus,noscroll:i.noScroll,replace_state:i.replaceState,state:i.state,redirect_count:s,nav_token:c,accept:()=>{i.invalidateAll&&(mw=!0,d=[...NA.keys()]),i.invalidate&&i.invalidate.forEach(AU)}}),i.invalidateAll&&Cv().then(Cv).then(()=>{NA.forEach(({resource:m},e)=>{d?.includes(e)&&m.refresh?.()})})}async function _U(r){if(r.id!==nl?.id){const i={};Lm.add(i),nl={id:r.id,token:i,promise:uB({...r,preload:i}).then(s=>(Lm.delete(i),s.type==="loaded"&&s.state.error&&(nl=null),s))}}return nl.promise}async function Lx(r){const i=(await a0(r,!1))?.route;i&&await Promise.all([...i.layouts,i.leaf].map(s=>s?.[1]()))}function aB(r,i,s){Li=r.state;const c=document.querySelector("style[data-sveltekit]");if(c&&c.remove(),Object.assign(ts,r.props.page),nB=new en.root({target:i,props:{...r.props,stores:ul,components:Bv},hydrate:s,sync:!1}),oB(xo),s){const d={from:null,to:{params:Li.params,route:{id:Li.route?.id??null},url:new URL(location.href)},willUnload:!1,type:"enter",complete:Promise.resolve()};Pm.forEach(m=>m(d))}Mv=!0}function zv({url:r,params:i,branch:s,status:c,error:d,route:m,form:e}){let a="never";if(Eo&&(r.pathname===Eo||r.pathname===Eo+"/"))a="always";else for(const k of s)k?.slash!==void 0&&(a=k.slash);r.pathname=AV(r.pathname,a),r.search=r.search;const g={type:"loaded",state:{url:r,params:i,branch:s,error:d,route:m},props:{constructors:tU(s).map(k=>k.node.component),page:bw(ts)}};e!==void 0&&(g.props.form=e);let w={},R=!ts,S=0;for(let k=0;k<Math.max(s.length,Li.branch.length);k+=1){const B=s[k],F=Li.branch[k];B?.data!==F?.data&&(R=!0),B&&(w={...w,...B.data},R&&(g.props[`data_${S}`]=w),S+=1)}return(!Li.url||r.href!==Li.url.href||Li.error!==d||e!==void 0&&e!==ts.form||R)&&(g.props.page={error:d,params:i,route:{id:m?.id??null},state:{},status:c,url:new URL(r),form:e??null,data:R?w:ts.data}),g}async function yw({loader:r,parent:i,url:s,params:c,route:d,server_data_node:m}){let e=null,a=!0;const g={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},w=await r();if(w.universal?.load){let R=function(...D){for(const k of D){const{href:B}=new URL(k,s);g.dependencies.add(B)}};const S={tracing:{enabled:!1,root:VA,current:VA},route:new Proxy(d,{get:(D,k)=>(a&&(g.route=!0),D[k])}),params:new Proxy(c,{get:(D,k)=>(a&&g.params.add(k),D[k])}),data:m?.data??null,url:TV(s,()=>{a&&(g.url=!0)},D=>{a&&g.search_params.add(D)},en.hash),async fetch(D,k){D instanceof Request&&(k={body:D.method==="GET"||D.method==="HEAD"?void 0:await D.blob(),cache:D.cache,credentials:D.credentials,headers:[...D.headers].length>0?D?.headers:void 0,integrity:D.integrity,keepalive:D.keepalive,method:D.method,mode:D.mode,redirect:D.redirect,referrer:D.referrer,referrerPolicy:D.referrerPolicy,signal:D.signal,...k});const{resolved:B,promise:F}=lB(D,k,s);return a&&R(B.href),F},setHeaders:()=>{},depends:R,parent(){return a&&(g.parent=!0),i()},untrack(D){a=!1;try{return D()}finally{a=!0}}};e=await w.universal.load.call(null,S)??null}return{node:w,loader:r,server:m,universal:w.universal?.load?{type:"data",data:e,uses:g}:null,data:e??m?.data??null,slash:w.universal?.trailingSlash??m?.slash}}function lB(r,i,s){let c=r instanceof Request?r.url:r;const d=new URL(c,s);d.origin===s.origin&&(c=d.href.slice(s.origin.length));const m=Mv?IV(c,d.href,i):DV(c,i);return{resolved:d,promise:m}}function qA(r,i,s,c,d,m){if(mw)return!0;if(!d)return!1;if(d.parent&&r||d.route&&i||d.url&&s)return!0;for(const e of d.search_params)if(c.has(e))return!0;for(const e of d.params)if(m[e]!==Li.params[e])return!0;for(const e of d.dependencies)if(Iv.some(a=>a(new URL(e))))return!0;return!1}function gw(r,i){return r?.type==="data"?r:r?.type==="skip"?i??null:null}function bU(r,i){if(!r)return new Set(i.searchParams.keys());const s=new Set([...r.searchParams.keys(),...i.searchParams.keys()]);for(const c of s){const d=r.searchParams.getAll(c),m=i.searchParams.getAll(c);d.every(e=>m.includes(e))&&m.every(e=>d.includes(e))&&s.delete(c)}return s}function KA({error:r,url:i,route:s,params:c}){return{type:"loaded",state:{error:r,url:i,route:s,params:c,branch:[]},props:{page:bw(ts),constructors:[]}}}async function uB({id:r,invalidating:i,url:s,params:c,route:d,preload:m}){if(nl?.id===r)return Lm.delete(nl.token),nl.promise;const{errors:e,layouts:a,leaf:g}=d,w=[...a,g];e.forEach(Q=>Q?.().catch(()=>{})),w.forEach(Q=>Q?.[1]().catch(()=>{}));let R=null;const S=Li.url?r!==Ov(Li.url):!1,D=Li.route?d.id!==Li.route.id:!1,k=bU(Li.url,s);let B=!1;const F=w.map((Q,Te)=>{const pe=Li.branch[Te],_e=!!Q?.[0]&&(pe?.loader!==Q[1]||qA(B,D,S,k,pe.server?.uses,c));return _e&&(B=!0),_e});if(F.some(Boolean)){try{R=await pB(s,F)}catch(Q){const Te=await cf(Q,{url:s,params:c,route:{id:r}});return Lm.has(m)?KA({error:Te,url:s,params:c,route:d}):o0({status:Lv(Q),error:Te,url:s,route:d})}if(R.type==="redirect")return R}const K=R?.nodes;let U=!1;const ee=w.map(async(Q,Te)=>{if(!Q)return;const pe=Li.branch[Te],_e=K?.[Te];if((!_e||_e.type==="skip")&&Q[1]===pe?.loader&&!qA(U,D,S,k,pe.universal?.uses,c))return pe;if(U=!0,_e?.type==="error")throw _e;return yw({loader:Q[1],url:s,params:c,route:d,parent:async()=>{const dt={};for(let He=0;He<Te;He+=1)Object.assign(dt,(await ee[He])?.data);return dt},server_data_node:gw(_e===void 0&&Q[0]?{type:"skip"}:_e??null,Q[0]?pe?.server:void 0)})});for(const Q of ee)Q.catch(()=>{});const le=[];for(let Q=0;Q<w.length;Q+=1)if(w[Q])try{le.push(await ee[Q])}catch(Te){if(Te instanceof uw)return{type:"redirect",location:Te.location};if(Lm.has(m))return KA({error:await cf(Te,{params:c,url:s,route:{id:d.id}}),url:s,params:c,route:d});let pe=Lv(Te),_e;if(K?.includes(Te))pe=Te.status??pe,_e=Te.error;else if(Te instanceof r0)_e=Te.body;else{if(await ul.updated.check())return await tB(),await mf(s);_e=await cf(Te,{params:c,url:s,route:{id:d.id}})}const Xe=await vU(Q,le,e);return Xe?zv({url:s,params:c,branch:le.slice(0,Xe.idx).concat(Xe.node),status:pe,error:_e,route:d}):await dB(s,{id:d.id},_e,pe)}else le.push(void 0);return zv({url:s,params:c,branch:le,status:200,error:null,route:d,form:i?void 0:null})}async function vU(r,i,s){for(;r--;)if(s[r]){let c=r;for(;!i[c];)c-=1;try{return{idx:c+1,node:{node:await s[r](),loader:s[r],data:{},server:null,universal:null}}}catch{continue}}}async function o0({status:r,error:i,url:s,route:c}){const d={};let m=null;if(en.server_loads[0]===0)try{const a=await pB(s,[!0]);if(a.type!=="data"||a.nodes[0]&&a.nodes[0].type!=="data")throw 0;m=a.nodes[0]??null}catch{(s.origin!==i0||s.pathname!==location.pathname||hw)&&await mf(s)}try{const a=await yw({loader:T1,url:s,params:d,route:c,parent:()=>Promise.resolve({}),server_data_node:gw(m)}),g={node:await Dv(),loader:Dv,universal:null,server:null,data:null};return zv({url:s,params:d,branch:[a,g],status:r,error:i,route:null})}catch(a){if(a instanceof uw)return gU(new URL(a.location,location.href),{},0);throw a}}async function xU(r){const i=r.href;if(hg.has(i))return hg.get(i);let s;try{const c=(async()=>{let d=await en.hooks.reroute({url:new URL(r),fetch:async(m,e)=>lB(m,e,r).promise})??r;if(typeof d=="string"){const m=new URL(r);en.hash?m.hash=d:m.pathname=d,d=m}return d})();hg.set(i,c),s=await c}catch{hg.delete(i);return}return s}async function a0(r,i){if(r&&!s0(r,Eo,en.hash)){const s=await xU(r);if(!s)return;const c=wU(s);for(const d of fw){const m=d.exec(c);if(m)return{id:Ov(r),invalidating:i,route:d,params:SV(m),url:r}}}}function wU(r){return RV(en.hash?r.hash.replace(/^#/,"").replace(/[?#].+/,""):r.pathname.slice(Eo.length))||"/"}function Ov(r){return(en.hash?r.hash.replace(/^#/,""):r.pathname)+r.search}function cB({url:r,type:i,intent:s,delta:c,event:d}){let m=!1;const e=_w(Li,s,r,i);c!==void 0&&(e.navigation.delta=c),d!==void 0&&(e.navigation.event=d);const a={...e.navigation,cancel:()=>{m=!0,e.reject(new Error("navigation cancelled"))}};return qm||rB.forEach(g=>g(a)),m?null:e}async function uf({type:r,url:i,popped:s,keepfocus:c,noscroll:d,replace_state:m,state:e={},redirect_count:a=0,nav_token:g={},accept:w=UA,block:R=UA,event:S}){const D=Rc;Rc=g;const k=await a0(i,!1),B=r==="enter"?_w(Li,k,i,r):cB({url:i,type:r,delta:s?.delta,intent:k,event:S});if(!B){R(),Rc===g&&(Rc=D);return}const F=Qn,K=xo;w(),qm=!0,Mv&&B.navigation.type!=="enter"&&ul.navigating.set(Nm.current=B.navigation);let U=k&&await uB(k);if(!U){if(s0(i,Eo,en.hash))return await mf(i,m);U=await dB(i,{id:null},await cf(new cw(404,"Not Found",`Not found: ${i.pathname}`),{url:i,params:{},route:{id:null}}),404,m)}if(i=k?.url||i,Rc!==g)return B.reject(new Error("navigation aborted")),!1;if(U.type==="redirect"){if(a<20){await uf({type:r,url:new URL(U.location,i),popped:s,keepfocus:c,noscroll:d,replace_state:m,state:e,redirect_count:a+1,nav_token:g}),B.fulfil(void 0);return}U=await o0({status:500,error:await cf(new Error("Redirect loop"),{url:i,params:{},route:{id:null}}),url:i,route:{id:null}})}else U.props.page.status>=400&&await ul.updated.check()&&(await tB(),await mf(i,m));if(yU(),pw(F),sB(K),U.props.page.url.pathname!==i.pathname&&(i.pathname=U.props.page.url.pathname),e=s?s.state:e,!s){const Te=m?0:1,pe={[lf]:Qn+=Te,[jm]:xo+=Te,[XI]:e};(m?history.replaceState:history.pushState).call(history,pe,"",i),m||fU(Qn,xo)}if(nl=null,U.props.page.state=e,Mv){const Te=(await Promise.all(Array.from(hU,pe=>pe(B.navigation)))).filter(pe=>typeof pe=="function");if(Te.length>0){let pe=function(){Te.forEach(_e=>{Pm.delete(_e)})};Te.push(pe),Te.forEach(_e=>{Pm.add(_e)})}Li=U.state,U.props.page&&(U.props.page.url=i),nB.$set(U.props),oU(U.props.page),iB=!0}else aB(U,C1,!1);const{activeElement:ee}=document;await dU();let le=s?s.scroll:d?n0():null;if(jA){const Te=i.hash&&document.getElementById(hB(i));if(le)scrollTo(le.x,le.y);else if(Te){Te.scrollIntoView();const{top:pe,left:_e}=Te.getBoundingClientRect();le={x:pageXOffset+_e,y:pageYOffset+pe}}else scrollTo(0,0)}const Q=document.activeElement!==ee&&document.activeElement!==document.body;!c&&!Q&&TU(i,le),jA=!0,U.props.page&&Object.assign(ts,U.props.page),qm=!1,r==="popstate"&&oB(xo),B.fulfil(void 0),Pm.forEach(Te=>Te(B.navigation)),ul.navigating.set(Nm.current=null)}async function dB(r,i,s,c,d){return r.origin===i0&&r.pathname===location.pathname&&!hw?await o0({status:c,error:s,url:r,route:i}):await mf(r,d)}function EU(){let r,i,s;rl.addEventListener("mousemove",a=>{const g=a.target;clearTimeout(r),r=setTimeout(()=>{m(g,Ac.hover)},20)});function c(a){a.defaultPrevented||m(a.composedPath()[0],Ac.tap)}rl.addEventListener("mousedown",c),rl.addEventListener("touchstart",c,{passive:!0});const d=new IntersectionObserver(a=>{for(const g of a)g.isIntersecting&&(Lx(new URL(g.target.href)),d.unobserve(g.target))},{threshold:0});async function m(a,g){const w=JI(a,rl),R=w===i&&g>=s;if(!w||R)return;const{url:S,external:D,download:k}=S1(w,Eo,en.hash);if(D||k)return;const B=Pv(w),F=S&&Ov(Li.url)===Ov(S);if(!(B.reload||F))if(g<=B.preload_data){i=w,s=Ac.tap;const K=await a0(S,!1);if(!K)return;_U(K)}else g<=B.preload_code&&(i=w,s=g,Lx(S))}function e(){d.disconnect();for(const a of rl.querySelectorAll("a")){const{url:g,external:w,download:R}=S1(a,Eo,en.hash);if(w||R)continue;const S=Pv(a);S.reload||(S.preload_code===Ac.viewport&&d.observe(a),S.preload_code===Ac.eager&&Lx(g))}}Pm.add(e),e()}function cf(r,i){if(r instanceof r0)return r.body;const s=Lv(r),c=nU(r);return en.hooks.handleError({error:r,event:i,status:s,message:c})??{message:c}}function AU(r){if(typeof r=="function")Iv.push(r);else{const{href:i}=new URL(r,location.href);Iv.push(s=>s.href===i)}}function RU(){history.scrollRestoration="manual",addEventListener("beforeunload",i=>{let s=!1;if(FA(),!qm){const c=_w(Li,void 0,null,"leave"),d={...c.navigation,cancel:()=>{s=!0,c.reject(new Error("navigation cancelled"))}};rB.forEach(m=>m(d))}s?(i.preventDefault(),i.returnValue=""):history.scrollRestoration="auto"}),addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&FA()}),navigator.connection?.saveData||EU(),rl.addEventListener("click",async i=>{if(i.button||i.which!==1||i.metaKey||i.ctrlKey||i.shiftKey||i.altKey||i.defaultPrevented)return;const s=JI(i.composedPath()[0],rl);if(!s)return;const{url:c,external:d,target:m,download:e}=S1(s,Eo,en.hash);if(!c)return;if(m==="_parent"||m==="_top"){if(window.parent!==window)return}else if(m&&m!=="_self")return;const a=Pv(s);if(!(s instanceof SVGAElement)&&c.protocol!==location.protocol&&!(c.protocol==="https:"||c.protocol==="http:")||e)return;const[w,R]=(en.hash?c.hash.replace(/^#/,""):c.href).split("#"),S=w===Cx(location);if(d||a.reload&&(!S||!R)){cB({url:c,type:"link",event:i})?qm=!0:i.preventDefault();return}if(R!==void 0&&S){const[,D]=Li.url.href.split("#");if(D===R){if(i.preventDefault(),R===""||R==="top"&&s.ownerDocument.getElementById("top")===null)scrollTo({top:0});else{const k=s.ownerDocument.getElementById(decodeURIComponent(R));k&&(k.scrollIntoView(),k.focus())}return}if(Ih=!0,pw(Qn),r(c),!a.replace_state)return;Ih=!1}i.preventDefault(),await new Promise(D=>{requestAnimationFrame(()=>{setTimeout(D,0)}),setTimeout(D,100)}),await uf({type:"link",url:c,keepfocus:a.keepfocus,noscroll:a.noscroll,replace_state:a.replace_state??c.href===location.href,event:i})}),rl.addEventListener("submit",i=>{if(i.defaultPrevented)return;const s=HTMLFormElement.prototype.cloneNode.call(i.target),c=i.submitter;if((c?.formTarget||s.target)==="_blank"||(c?.formMethod||s.method)!=="get")return;const e=new URL(c?.hasAttribute("formaction")&&c?.formAction||s.action);if(s0(e,Eo,!1))return;const a=i.target,g=Pv(a);if(g.reload)return;i.preventDefault(),i.stopPropagation();const w=new FormData(a,c);e.search=new URLSearchParams(w).toString(),uf({type:"form",url:e,keepfocus:g.keepfocus,noscroll:g.noscroll,replace_state:g.replace_state??e.href===location.href,event:i})}),addEventListener("popstate",async i=>{if(!k1){if(i.state?.[lf]){const s=i.state[lf];if(Rc={},s===Qn)return;const c=Mc[s],d=i.state[XI]??{},m=new URL(i.state[FV]??location.href),e=i.state[jm],a=Li.url?Cx(location)===Cx(Li.url):!1;if(e===xo&&(iB||a)){d!==ts.state&&(ts.state=d),r(m),Mc[Qn]=n0(),c&&scrollTo(c.x,c.y),Qn=s;return}const w=s-Qn;await uf({type:"popstate",url:m,popped:{state:d,scroll:c,delta:w},accept:()=>{Qn=s,xo=e},block:()=>{history.go(-w)},nav_token:Rc,event:i})}else if(!Ih){const s=new URL(location.href);r(s),en.hash&&location.reload()}}}),addEventListener("hashchange",()=>{Ih&&(Ih=!1,history.replaceState({...history.state,[lf]:++Qn,[jm]:xo},"",location.href))});for(const i of document.querySelectorAll("link"))pU.has(i.rel)&&(i.href=i.href);addEventListener("pageshow",i=>{i.persisted&&ul.navigating.set(Nm.current=null)});function r(i){Li.url=ts.url=i,ul.page.set(bw(ts)),ul.page.notify()}}async function SU(r,{status:i=200,error:s,node_ids:c,params:d,route:m,server_route:e,data:a,form:g}){hw=!0;const w=new URL(location.href);let R;({params:d={},route:m={id:null}}=await a0(w,!1)||{}),R=fw.find(({id:k})=>k===m.id);let S,D=!0;try{const k=c.map(async(F,K)=>{const U=a[K];return U?.uses&&(U.uses=fB(U.uses)),yw({loader:en.nodes[F],url:w,params:d,route:m,parent:async()=>{const ee={};for(let le=0;le<K;le+=1)Object.assign(ee,(await k[le]).data);return ee},server_data_node:gw(U)})}),B=await Promise.all(k);if(R){const F=R.layouts;for(let K=0;K<F.length;K++)F[K]||B.splice(K,0,void 0)}S=zv({url:w,params:d,branch:B,status:i,error:s,form:g,route:R??null})}catch(k){if(k instanceof uw){await mf(new URL(k.location,location.href));return}S=await o0({status:Lv(k),error:await cf(k,{url:w,params:d,route:m}),url:w,route:m}),r.textContent="",D=!1}S.props.page&&(S.props.page.state={}),aB(S,r,D)}async function pB(r,i){const s=new URL(r);s.pathname=uU(r.pathname),r.pathname.endsWith("/")&&s.searchParams.append(iU,"1"),s.searchParams.append(rU,i.map(m=>m?"1":"0").join(""));const c=window.fetch,d=await c(s.href,{});if(!d.ok){let m;throw d.headers.get("content-type")?.includes("application/json")?m=await d.json():d.status===404?m="Not Found":d.status===500&&(m="Internal Error"),new r0(d.status,m)}return new Promise(async m=>{const e=new Map,a=d.body.getReader();function g(R){return QV(R,{...en.decoders,Promise:S=>new Promise((D,k)=>{e.set(S,{fulfil:D,reject:k})})})}let w="";for(;;){const{done:R,value:S}=await a.read();if(R&&!w)break;for(w+=!S&&w?`
`:kV.decode(S,{stream:!0});;){const D=w.indexOf(`
`);if(D===-1)break;const k=JSON.parse(w.slice(0,D));if(w=w.slice(D+1),k.type==="redirect")return m(k);if(k.type==="data")k.nodes?.forEach(B=>{B?.type==="data"&&(B.uses=fB(B.uses),B.data=g(B.data))}),m(k);else if(k.type==="chunk"){const{id:B,data:F,error:K}=k,U=e.get(B);e.delete(B),K?U.reject(g(K)):U.fulfil(g(F))}}}})}function fB(r){return{dependencies:new Set(r?.dependencies??[]),params:new Set(r?.params??[]),parent:!!r?.parent,route:!!r?.route,url:!!r?.url,search_params:new Set(r?.search_params??[])}}let k1=!1;function TU(r,i=null){const s=document.querySelector("[autofocus]");if(s)s.focus();else{const c=hB(r);if(c&&document.getElementById(c)){const{x:m,y:e}=i??n0();setTimeout(()=>{const a=history.state;k1=!0,location.replace(`#${c}`),en.hash&&location.replace(r.hash),history.replaceState(a,"",r.hash),scrollTo(m,e),k1=!1})}else{const m=document.body,e=m.getAttribute("tabindex");m.tabIndex=-1,m.focus({preventScroll:!0,focusVisible:!1}),e!==null?m.setAttribute("tabindex",e):m.removeAttribute("tabindex")}const d=getSelection();if(d&&d.type!=="None"){const m=[];for(let e=0;e<d.rangeCount;e+=1)m.push(d.getRangeAt(e));setTimeout(()=>{if(d.rangeCount===m.length){for(let e=0;e<d.rangeCount;e+=1){const a=m[e],g=d.getRangeAt(e);if(a.commonAncestorContainer!==g.commonAncestorContainer||a.startContainer!==g.startContainer||a.endContainer!==g.endContainer||a.startOffset!==g.startOffset||a.endOffset!==g.endOffset)return}d.removeAllRanges()}})}}}function _w(r,i,s,c){let d,m;const e=new Promise((g,w)=>{d=g,m=w});return e.catch(()=>{}),{navigation:{from:{params:r.params,route:{id:r.route?.id??null},url:r.url},to:s&&{params:i?.params??null,route:{id:i?.route?.id??null},url:s},willUnload:!i,type:c,complete:e},fulfil:d,reject:m}}function bw(r){return{data:r.data,error:r.error,form:r.form,params:r.params,route:r.route,state:r.state,status:r.status,url:r.url}}function CU(r){const i=new URL(r);return i.hash=decodeURIComponent(r.hash),i}function hB(r){let i;if(en.hash){const[,,s]=r.hash.split("#",3);i=s??""}else i=r.hash.slice(1);return decodeURIComponent(i)}const kU="modulepreload",PU=function(r,i){return new URL(r,i).href},GA={},Dx=function(i,s,c){let d=Promise.resolve();if(s&&s.length>0){let w=function(R){return Promise.all(R.map(S=>Promise.resolve(S).then(D=>({status:"fulfilled",value:D}),D=>({status:"rejected",reason:D}))))};const e=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),g=a?.nonce||a?.getAttribute("nonce");d=w(s.map(R=>{if(R=PU(R,c),R in GA)return;GA[R]=!0;const S=R.endsWith(".css"),D=S?'[rel="stylesheet"]':"";if(c)for(let B=e.length-1;B>=0;B--){const F=e[B];if(F.href===R&&(!S||F.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${R}"]${D}`))return;const k=document.createElement("link");if(k.rel=S?"stylesheet":kU,S||(k.as="script"),k.crossOrigin="",k.href=R,g&&k.setAttribute("nonce",g),document.head.appendChild(k),S)return new Promise((B,F)=>{k.addEventListener("load",B),k.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${R}`)))})}))}function m(e){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=e,window.dispatchEvent(a),!a.defaultPrevented)throw e}return d.then(e=>{for(const a of e||[])a.status==="rejected"&&m(a.reason);return i().catch(m)})},LU={},DU="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(DU);var IU=Bn('<div id="svelte-announcer" aria-live="assertive" aria-atomic="true" style="position: absolute; left: 0; top: 0; clip: rect(0 0 0 0); clip-path: inset(50%); overflow: hidden; white-space: nowrap; width: 1px; height: 1px"><!></div>'),BU=Bn("<!> <!>",1);function MU(r,i){mn(i,!0);let s=St(i,"components",23,()=>[]),c=St(i,"data_0",3,null),d=St(i,"data_1",3,null);tw(()=>i.stores.page.set(i.page)),xi(()=>{i.stores,i.page,i.constructors,s(),i.form,c(),d(),i.stores.page.notify()});let m=Ar(!1),e=Ar(!1),a=Ar(null);Ic(()=>{const F=i.stores.page.subscribe(()=>{Pe(m)&&(Xt(e,!0),Cv().then(()=>{Xt(a,document.title||"untitled page",!0)}))});return Xt(m,!0),F});const g=Hr(()=>i.constructors[1]);var w=BU(),R=Fr(w);{var S=F=>{const K=Hr(()=>i.constructors[0]);var U=ai(),ee=Fr(U);Tm(ee,()=>Pe(K),(le,Q)=>{Cm(Q(le,{get data(){return c()},get form(){return i.form},get params(){return i.page.params},children:(Te,pe)=>{var _e=ai(),Xe=Fr(_e);Tm(Xe,()=>Pe(g),(dt,He)=>{Cm(He(dt,{get data(){return d()},get form(){return i.form},get params(){return i.page.params}}),et=>s()[1]=et,()=>s()?.[1])}),fr(Te,_e)},$$slots:{default:!0}}),Te=>s()[0]=Te,()=>s()?.[0])}),fr(F,U)},D=F=>{const K=Hr(()=>i.constructors[0]);var U=ai(),ee=Fr(U);Tm(ee,()=>Pe(K),(le,Q)=>{Cm(Q(le,{get data(){return c()},get form(){return i.form},get params(){return i.page.params}}),Te=>s()[0]=Te,()=>s()?.[0])}),fr(F,U)};Qi(R,F=>{i.constructors[1]?F(S):F(D,!1)})}var k=Ji(R,2);{var B=F=>{var K=IU(),U=ei(K);{var ee=le=>{var Q=LI();no(()=>Ea(Q,Pe(a))),fr(le,Q)};Qi(U,le=>{Pe(e)&&le(ee)})}Zr(K),fr(F,K)};Qi(k,F=>{Pe(m)&&F(B)})}fr(r,w),yn()}const zU=yV(MU),OU=[()=>Dx(()=>Promise.resolve().then(()=>KU),void 0,import.meta.url),()=>Dx(()=>Promise.resolve().then(()=>HU),void 0,import.meta.url),()=>Dx(()=>Promise.resolve().then(()=>S$),void 0,import.meta.url)],VU=[],UU={"/":[2]},mB={handleError:(({error:r})=>{console.error(r)}),reroute:(()=>{}),transport:{}},yB=Object.fromEntries(Object.entries(mB.transport).map(([r,i])=>[r,i.decode])),jU=!1,NU=(r,i)=>yB[r](i),FU=Object.freeze(Object.defineProperty({__proto__:null,decode:NU,decoders:yB,dictionary:UU,hash:jU,hooks:mB,matchers:LU,nodes:OU,root:zU,server_loads:VU},Symbol.toStringTag,{value:"Module"}));function L$(r,i){mU(FU,r,i)}function qU(r,i){mn(i,!0);var m={csr:!0,ssr:!1,prerender:!0},e=ai(),a=Fr(e);return hf(a,()=>i.children??xa),fr(r,e),yn(m)}const KU=Object.freeze(Object.defineProperty({__proto__:null,component:qU},Symbol.toStringTag,{value:"Module"}));mO();const GU={get error(){return ts.error},get status(){return ts.status}};ul.updated.check;const $A=GU;var $U=Bn("<h1> </h1> <p> </p>",1);function ZU(r,i){mn(i,!1),xf();var s=$U(),c=Fr(s),d=ei(c,!0);Zr(c);var m=Ji(c,2),e=ei(m,!0);Zr(m),no(()=>{Ea(d,$A.status),Ea(e,$A.error?.message)}),fr(r,s),yn()}const HU=Object.freeze(Object.defineProperty({__proto__:null,component:ZU},Symbol.toStringTag,{value:"Module"}));var XU=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],WU=["difference","intersection","symmetricDifference","union"],ZA=!1;class Vv extends Set{#t=new Map;#e=Ar(0);#r=Ar(0);#i=ll||-1;constructor(i){if(super(),i){for(var s of i)super.add(s);this.#r.v=super.size}ZA||this.#o()}#a(i){return ll===this.#i?Ar(i):$o(i)}#o(){ZA=!0;var i=Vv.prototype,s=Set.prototype;for(const c of XU)i[c]=function(...d){return Pe(this.#e),s[c].apply(this,d)};for(const c of WU)i[c]=function(...d){Pe(this.#e);var m=s[c].apply(this,d);return new Vv(m)}}has(i){var s=super.has(i),c=this.#t,d=c.get(i);if(d===void 0){if(!s)return Pe(this.#e),!1;d=this.#a(!0),c.set(i,d)}return Pe(d),s}add(i){return super.has(i)||(super.add(i),Xt(this.#r,super.size),cu(this.#e)),this}delete(i){var s=super.delete(i),c=this.#t,d=c.get(i);return d!==void 0&&(c.delete(i),Xt(d,!1)),s&&(Xt(this.#r,super.size),cu(this.#e)),s}clear(){if(super.size!==0){super.clear();var i=this.#t;for(var s of i.values())Xt(s,!1);i.clear(),Xt(this.#r,0),cu(this.#e)}}keys(){return this.values()}values(){return Pe(this.#e),super.values()}entries(){return Pe(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return Pe(this.#r)}}class Uv{#t=Ar();get value(){return Pe(this.#t)}set value(i){Xt(this.#t,i,!0)}constructor(i){this.value=i}}class YU{#t=Ar();get map(){return Pe(this.#t)}set map(i){Xt(this.#t,i,!0)}#e=Ar(!1);get loaded(){return Pe(this.#e)}set loaded(i){Xt(this.#e,i,!0)}loadedImages=new Vv;#r=Ar(0);get minzoom(){return Pe(this.#r)}set minzoom(i){Xt(this.#r,i,!0)}#i=Ar(24);get maxzoom(){return Pe(this.#i)}set maxzoom(i){Xt(this.#i,i,!0)}layerInfo=new Map;eventTracker=new WeakMap;_eventTopMost(i){let s=this.eventTracker.get(i.originalEvent);if(s!==void 0)return s;let d=i.target.queryRenderedFeatures(i.point).find(m=>this.layerInfo.get(m.layer.id)?.interactive)?.layer.id;return this.eventTracker.set(i.originalEvent,d),d}eventTopMost;markerClickManager=new lj;constructor(){this.eventTopMost=this._eventTopMost.bind(this)}}function JU(){return hu(nj)}function QU(r){mu(bB,r)}function ej(){return hu(bB)}function tj(){return hu(vB)}function gB(r){mu(vB,r)}function rj(r){mu(xB,r)}function ij(){return hu(xB)}const _B=Symbol.for("svelte-maplibre"),bB=Symbol.for("svelte-maplibre.popup-target"),nj=Symbol.for("svelte-maplibre.layer"),vB=Symbol.for("svelte-maplibre.layer-event"),xB=Symbol.for("svelte-maplibre.lng-lat");function wf(){return hu(_B)}function sj(){return mu(_B,new YU)}function oj(){const r=new Uv(void 0),i=new Uv(void 0);return QU(r),gB(i),{marker:r,layerEvent:i}}function aj(r){return"layerType"in r&&r.layerType==="deckgl"}class lj{_handlers=new Set;add(i){this._handlers.add(i)}remove(i){this._handlers.delete(i)}handleClick(i){for(const s of this._handlers)s(i)}}function wB(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function EB(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var i=r.default;if(typeof i=="function"){var s=function c(){var d=!1;try{d=this instanceof c}catch{}return d?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};s.prototype=i.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(r).forEach(function(c){var d=Object.getOwnPropertyDescriptor(r,c);Object.defineProperty(s,c,d.get?d:{enumerable:!0,get:function(){return r[c]}})}),s}var xv={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.9.0/LICENSE.txt
 */var uj=xv.exports,HA;function cj(){return HA||(HA=1,(function(r,i){(function(s,c){r.exports=c()})(uj,(function(){var s={},c={};function d(e,a,g){if(c[e]=g,e==="index"){var w="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",R={};return c.shared(R),c.index(s,R),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([w],{type:"text/javascript"}))),s}}d("shared",["exports"],(function(e){function a(l,n,o,p){return new(o||(o=Promise))((function(h,b){function x(I){try{T(p.next(I))}catch(z){b(z)}}function A(I){try{T(p.throw(I))}catch(z){b(z)}}function T(I){var z;I.done?h(I.value):(z=I.value,z instanceof o?z:new o((function(q){q(z)}))).then(x,A)}T((p=p.apply(l,n||[])).next())}))}function g(l,n){this.x=l,this.y=n}function w(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var R,S;typeof SuppressedError=="function"&&SuppressedError,g.prototype={clone(){return new g(this.x,this.y)},add(l){return this.clone()._add(l)},sub(l){return this.clone()._sub(l)},multByPoint(l){return this.clone()._multByPoint(l)},divByPoint(l){return this.clone()._divByPoint(l)},mult(l){return this.clone()._mult(l)},div(l){return this.clone()._div(l)},rotate(l){return this.clone()._rotate(l)},rotateAround(l,n){return this.clone()._rotateAround(l,n)},matMult(l){return this.clone()._matMult(l)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(l){return this.x===l.x&&this.y===l.y},dist(l){return Math.sqrt(this.distSqr(l))},distSqr(l){const n=l.x-this.x,o=l.y-this.y;return n*n+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith(l){return this.angleWithSep(l.x,l.y)},angleWithSep(l,n){return Math.atan2(this.x*n-this.y*l,this.x*l+this.y*n)},_matMult(l){const n=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=n,this},_add(l){return this.x+=l.x,this.y+=l.y,this},_sub(l){return this.x-=l.x,this.y-=l.y,this},_mult(l){return this.x*=l,this.y*=l,this},_div(l){return this.x/=l,this.y/=l,this},_multByPoint(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint(l){return this.x/=l.x,this.y/=l.y,this},_unit(){return this._div(this.mag()),this},_perp(){const l=this.y;return this.y=this.x,this.x=-l,this},_rotate(l){const n=Math.cos(l),o=Math.sin(l),p=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=p,this},_rotateAround(l,n){const o=Math.cos(l),p=Math.sin(l),h=n.y+p*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-p*(this.y-n.y),this.y=h,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:g},g.convert=function(l){if(l instanceof g)return l;if(Array.isArray(l))return new g(+l[0],+l[1]);if(l.x!==void 0&&l.y!==void 0)return new g(+l.x,+l.y);throw new Error("Expected [x, y] or {x, y} point format")};var D=(function(){if(S)return R;function l(n,o,p,h){this.cx=3*n,this.bx=3*(p-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(h-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=o,this.p2x=p,this.p2y=h}return S=1,R=l,l.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,o){if(o===void 0&&(o=1e-6),n<0)return 0;if(n>1)return 1;for(var p=n,h=0;h<8;h++){var b=this.sampleCurveX(p)-n;if(Math.abs(b)<o)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=b/x}var A=0,T=1;for(p=n,h=0;h<20&&(b=this.sampleCurveX(p),!(Math.abs(b-n)<o));h++)n>b?A=p:T=p,p=.5*(T-A)+A;return p},solve:function(n,o){return this.sampleCurveY(this.solveCurveX(n,o))}},R})(),k=w(D);let B,F;function K(){return B==null&&(B=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),B}function U(){if(F==null&&(F=!1,K())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let p=0;p<25;p++){const h=4*p;n.fillStyle=`rgb(${h},${h+1},${h+2})`,n.fillRect(p%5,Math.floor(p/5),1,1)}const o=n.getImageData(0,0,5,5).data;for(let p=0;p<100;p++)if(p%4!=3&&o[p]!==p){F=!0;break}}}return F||!1}var ee=1e-6,le=typeof Float32Array<"u"?Float32Array:Array;function Q(){var l=new le(9);return le!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function Te(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function pe(){var l=new le(3);return le!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function _e(l){var n=l[0],o=l[1],p=l[2];return Math.sqrt(n*n+o*o+p*p)}function Xe(l,n,o){var p=new le(3);return p[0]=l,p[1]=n,p[2]=o,p}function dt(l,n,o){return l[0]=n[0]+o[0],l[1]=n[1]+o[1],l[2]=n[2]+o[2],l}function He(l,n,o){return l[0]=n[0]*o,l[1]=n[1]*o,l[2]=n[2]*o,l}function et(l,n,o){var p=n[0],h=n[1],b=n[2],x=o[0],A=o[1],T=o[2];return l[0]=h*T-b*A,l[1]=b*x-p*T,l[2]=p*A-h*x,l}var rt,te=_e;function Be(l,n,o){var p=n[0],h=n[1],b=n[2],x=n[3];return l[0]=o[0]*p+o[4]*h+o[8]*b+o[12]*x,l[1]=o[1]*p+o[5]*h+o[9]*b+o[13]*x,l[2]=o[2]*p+o[6]*h+o[10]*b+o[14]*x,l[3]=o[3]*p+o[7]*h+o[11]*b+o[15]*x,l}function fe(){var l=new le(4);return le!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function ye(l,n,o,p){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",b=Math.PI/360;n*=b,p*=b,o*=b;var x=Math.sin(n),A=Math.cos(n),T=Math.sin(o),I=Math.cos(o),z=Math.sin(p),q=Math.cos(p);switch(h){case"xyz":l[0]=x*I*q+A*T*z,l[1]=A*T*q-x*I*z,l[2]=A*I*z+x*T*q,l[3]=A*I*q-x*T*z;break;case"xzy":l[0]=x*I*q-A*T*z,l[1]=A*T*q-x*I*z,l[2]=A*I*z+x*T*q,l[3]=A*I*q+x*T*z;break;case"yxz":l[0]=x*I*q+A*T*z,l[1]=A*T*q-x*I*z,l[2]=A*I*z-x*T*q,l[3]=A*I*q+x*T*z;break;case"yzx":l[0]=x*I*q+A*T*z,l[1]=A*T*q+x*I*z,l[2]=A*I*z-x*T*q,l[3]=A*I*q-x*T*z;break;case"zxy":l[0]=x*I*q-A*T*z,l[1]=A*T*q+x*I*z,l[2]=A*I*z+x*T*q,l[3]=A*I*q-x*T*z;break;case"zyx":l[0]=x*I*q-A*T*z,l[1]=A*T*q+x*I*z,l[2]=A*I*z-x*T*q,l[3]=A*I*q+x*T*z;break;default:throw new Error("Unknown angle order "+h)}return l}function nt(){var l=new le(2);return le!=Float32Array&&(l[0]=0,l[1]=0),l}function gt(l,n){var o=new le(2);return o[0]=l,o[1]=n,o}pe(),rt=new le(4),le!=Float32Array&&(rt[0]=0,rt[1]=0,rt[2]=0,rt[3]=0),pe(),Xe(1,0,0),Xe(0,1,0),fe(),fe(),Q(),nt();const lt=8192;function be(l,n,o){return n*(lt/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}function Ft(l,n){return(l%n+n)%n}function Ut(l,n,o){return l*(1-o)+n*o}function Le(l){if(l<=0)return 0;if(l>=1)return 1;const n=l*l,o=n*l;return 4*(l<.5?o:3*(l-n)+o-.75)}function ur(l,n,o,p){const h=new k(l,n,o,p);return b=>h.solve(b)}const Tt=ur(.25,.1,.25,1);function tr(l,n,o){return Math.min(o,Math.max(n,l))}function qr(l,n,o){const p=o-n,h=((l-n)%p+p)%p+n;return h===n?o:h}function lr(l,...n){for(const o of n)for(const p in o)l[p]=o[p];return l}let kr=1;function Sr(l,n,o){const p={};for(const h in l)p[h]=n.call(this,l[h],h,l);return p}function $r(l,n,o){const p={};for(const h in l)n.call(this,l[h],h,l)&&(p[h]=l[h]);return p}function sr(l){return Array.isArray(l)?l.map(sr):typeof l=="object"&&l?Sr(l,sr):l}const br={};function nr(l){br[l]||(typeof console<"u"&&console.warn(l),br[l]=!0)}function Xr(l,n,o){return(o.y-l.y)*(n.x-l.x)>(n.y-l.y)*(o.x-l.x)}function Vt(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let Pr=null;function Ct(l){if(Pr==null){const n=l.navigator?l.navigator.userAgent:null;Pr=!!l.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Pr}function er(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const or="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Lr(l,n,o,p,h){return a(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(l,{timestamp:0});try{const x=b?.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const A=x.startsWith("BGR"),T=new Uint8ClampedArray(p*h*4);if(yield b.copyTo(T,(function(I,z,q,Z,H){const Y=4*Math.max(-z,0),ne=(Math.max(0,q)-q)*Z*4+Y,ae=4*Z,ge=Math.max(0,z),qe=Math.max(0,q);return{rect:{x:ge,y:qe,width:Math.min(I.width,z+Z)-ge,height:Math.min(I.height,q+H)-qe},layout:[{offset:ne,stride:ae}]}})(l,n,o,p,h)),A)for(let I=0;I<T.length;I+=4){const z=T[I];T[I]=T[I+2],T[I+2]=z}return T}finally{b.close()}}))}let Jr,bt;function gi(l,n,o,p){return l.addEventListener(n,o,p),{unsubscribe:()=>{l.removeEventListener(n,o,p)}}}function Oi(l){return l*Math.PI/180}function Oe(l){return l/Math.PI*180}const vt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Nt={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},we="AbortError";function W(){return new Error(we)}const J={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function se(l){return J.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const ve="global-dispatcher";class Se extends Error{constructor(n,o,p,h){super(`AJAXError: ${o} (${n}): ${p}`),this.status=n,this.statusText=o,this.url=p,this.body=h}}const je=()=>Vt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ge=function(l,n){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const p=se(l.url);if(p)return p(l,n);if(Vt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,targetMapId:ve},n)}if(!(/^file:/.test(o=l.url)||/^file:/.test(je())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(p,h){return a(this,void 0,void 0,(function*(){const b=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:je(),signal:h.signal});let x,A;p.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{x=yield fetch(b)}catch(I){throw new Se(0,I.message,p.url,new Blob)}if(!x.ok){const I=yield x.blob();throw new Se(x.status,x.statusText,p.url,I)}A=p.type==="arrayBuffer"||p.type==="image"?x.arrayBuffer():p.type==="json"?x.json():x.text();const T=yield A;if(h.signal.aborted)throw W();return{data:T,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}}))})(l,n);if(Vt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,mustQueue:!0,targetMapId:ve},n)}var o;return(function(p,h){return new Promise(((b,x)=>{var A;const T=new XMLHttpRequest;T.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(T.responseType="arraybuffer");for(const I in p.headers)T.setRequestHeader(I,p.headers[I]);p.type==="json"&&(T.responseType="text",!((A=p.headers)===null||A===void 0)&&A.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=p.credentials==="include",T.onerror=()=>{x(new Error(T.statusText))},T.onload=()=>{if(!h.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let I=T.response;if(p.type==="json")try{I=JSON.parse(T.response)}catch(z){return void x(z)}b({data:I,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const I=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});x(new Se(T.status,T.statusText,p.url,I))}},h.signal.addEventListener("abort",(()=>{T.abort(),x(W())})),T.send(p.body)}))})(l,n)};function Ne(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const n=new URL(l),o=window.location;return n.protocol===o.protocol&&n.host===o.host}function Qe(l,n,o){o[l]&&o[l].indexOf(n)!==-1||(o[l]=o[l]||[],o[l].push(n))}function mt(l,n,o){if(o&&o[l]){const p=o[l].indexOf(n);p!==-1&&o[l].splice(p,1)}}class Ze{constructor(n,o={}){lr(this,o),this.type=n}}class Mt extends Ze{constructor(n,o={}){super("error",lr({error:n},o))}}class qt{on(n,o){return this._listeners=this._listeners||{},Qe(n,o,this._listeners),{unsubscribe:()=>{this.off(n,o)}}}off(n,o){return mt(n,o,this._listeners),mt(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Qe(n,o,this._oneTimeListeners),this):new Promise((p=>this.once(n,p)))}fire(n,o){typeof n=="string"&&(n=new Ze(n,o||{}));const p=n.type;if(this.listens(p)){n.target=this;const h=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const A of h)A.call(this,n);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const A of b)mt(p,A,this._oneTimeListeners),A.call(this,n);const x=this._eventedParent;x&&(lr(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof Mt&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var Ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const yr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Dr(l,n){const o={};for(const p in l)p!=="ref"&&(o[p]=l[p]);return yr.forEach((p=>{p in n&&(o[p]=n[p])})),o}function Ot(l,n){if(Array.isArray(l)){if(!Array.isArray(n)||l.length!==n.length)return!1;for(let o=0;o<l.length;o++)if(!Ot(l[o],n[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&n!==null){if(typeof n!="object"||Object.keys(l).length!==Object.keys(n).length)return!1;for(const o in l)if(!Ot(l[o],n[o]))return!1;return!0}return l===n}function gr(l,n){l.push(n)}function pi(l,n,o){gr(o,{command:"addSource",args:[l,n[l]]})}function fi(l,n,o){gr(n,{command:"removeSource",args:[l]}),o[l]=!0}function ti(l,n,o,p){fi(l,o,p),pi(l,n,o)}function _i(l,n,o){let p;for(p in l[o])if(Object.prototype.hasOwnProperty.call(l[o],p)&&p!=="data"&&!Ot(l[o][p],n[o][p]))return!1;for(p in n[o])if(Object.prototype.hasOwnProperty.call(n[o],p)&&p!=="data"&&!Ot(l[o][p],n[o][p]))return!1;return!0}function Kr(l,n,o,p,h,b){l=l||{},n=n||{};for(const x in l)Object.prototype.hasOwnProperty.call(l,x)&&(Ot(l[x],n[x])||o.push({command:b,args:[p,x,n[x],h]}));for(const x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(l,x)&&(Ot(l[x],n[x])||o.push({command:b,args:[p,x,n[x],h]}))}function oi(l){return l.id}function Mr(l,n){return l[n.id]=n,l}class pt{constructor(n,o,p,h){this.message=(n?`${n}: `:"")+p,h&&(this.identifier=h),o!=null&&o.__line__&&(this.line=o.__line__)}}function Vi(l,...n){for(const o of n)for(const p in o)l[p]=o[p];return l}class Di extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class Ii{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[p,h]of o)this.bindings[p]=h}concat(n){return new Ii(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const at={kind:"null"},At={kind:"number"},_r={kind:"string"},cr={kind:"boolean"},Gi={kind:"color"},gn={kind:"projectionDefinition"},tn={kind:"object"},dr={kind:"value"},ns={kind:"collator"},ss={kind:"formatted"},Kn={kind:"padding"},vs={kind:"colorArray"},rn={kind:"numberArray"},Gn={kind:"resolvedImage"},hi={kind:"variableAnchorOffsetCollection"};function Ui(l,n){return{kind:"array",itemType:l,N:n}}function Qr(l){if(l.kind==="array"){const n=Qr(l.itemType);return typeof l.N=="number"?`array<${n}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${n}>`}return l.kind}const xs=[at,At,_r,cr,Gi,gn,ss,tn,Ui(dr),Kn,rn,vs,Gn,hi];function $n(l,n){if(n.kind==="error")return null;if(l.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!$n(l.itemType,n.itemType))&&(typeof l.N!="number"||l.N===n.N))return null}else{if(l.kind===n.kind)return null;if(l.kind==="value"){for(const o of xs)if(!$n(o,n))return null}}return`Expected ${Qr(l)} but found ${Qr(n)} instead.`}function oo(l,n){return n.some((o=>o.kind===l.kind))}function ke(l,n){return n.some((o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l))}function j(l,n){return l.kind==="array"&&n.kind==="array"?l.itemType.kind===n.itemType.kind&&typeof l.N=="number":l.kind===n.kind}const re=.96422,oe=.82521,De=4/29,Me=6/29,Et=3*Me*Me,ht=Me*Me*Me,$t=Math.PI/180,Yt=180/Math.PI;function wr(l){return(l%=360)<0&&(l+=360),l}function ji([l,n,o,p]){let h,b;const x=Bt((.2225045*(l=Mn(l))+.7168786*(n=Mn(n))+.0606169*(o=Mn(o)))/1);l===n&&n===o?h=b=x:(h=Bt((.4360747*l+.3850649*n+.1430804*o)/re),b=Bt((.0139322*l+.0971045*n+.7141733*o)/oe));const A=116*x-16;return[A<0?0:A,500*(h-x),200*(x-b),p]}function Mn(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Bt(l){return l>ht?Math.pow(l,1/3):l/Et+De}function L([l,n,o,p]){let h=(l+16)/116,b=isNaN(n)?h:h+n/500,x=isNaN(o)?h:h-o/200;return h=1*Ve(h),b=re*Ve(b),x=oe*Ve(x),[M(3.1338561*b-1.6168667*h-.4906146*x),M(-.9787684*b+1.9161415*h+.033454*x),M(.0719453*b-.2289914*h+1.4052427*x),p]}function M(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function Ve(l){return l>Me?l*l*l:Et*(l-De)}const ut=Object.hasOwn||function(l,n){return Object.prototype.hasOwnProperty.call(l,n)};function vr(l,n){return ut(l,n)?l[n]:void 0}function Ho(l){return parseInt(l.padEnd(2,l),16)/255}function bu(l,n){return _n(n?l/100:l,0,1)}function _n(l,n,o){return Math.min(Math.max(n,l),o)}function Ir(l){return!l.some(Number.isNaN)}const Xo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function bn(l,n,o){return l+o*(n-l)}function ao(l,n,o){return l.map(((p,h)=>bn(p,n[h],o)))}class Tr{constructor(n,o,p,h=1,b=!0){this.r=n,this.g=o,this.b=p,this.a=h,b||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[n,o,p,h]))}static parse(n){if(n instanceof Tr)return n;if(typeof n!="string")return;const o=(function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=vr(Xo,p);if(h){const[x,A,T]=h;return[x/255,A/255,T/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const x=p.length<6?1:2;let A=1;return[Ho(p.slice(A,A+=x)),Ho(p.slice(A,A+=x)),Ho(p.slice(A,A+=x)),Ho(p.slice(A,A+x)||"ff")]}if(p.startsWith("rgb")){const x=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[A,T,I,z,q,Z,H,Y,ne,ae,ge,qe]=x,Ce=[z||" ",H||" ",ae].join("");if(Ce==="  "||Ce==="  /"||Ce===",,"||Ce===",,,"){const ze=[I,Z,ne].join(""),Je=ze==="%%%"?100:ze===""?255:0;if(Je){const ot=[_n(+T/Je,0,1),_n(+q/Je,0,1),_n(+Y/Je,0,1),ge?bu(+ge,qe):1];if(Ir(ot))return ot}}return}}const b=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[x,A,T,I,z,q,Z,H,Y]=b,ne=[T||" ",z||" ",Z].join("");if(ne==="  "||ne==="  /"||ne===",,"||ne===",,,"){const ae=[+A,_n(+I,0,100),_n(+q,0,100),H?bu(+H,Y):1];if(Ir(ae))return(function([ge,qe,Ce,ze]){function Je(ot){const yt=(ot+ge/30)%12,Dt=qe*Math.min(Ce,1-Ce);return Ce-Dt*Math.max(-1,Math.min(yt-3,9-yt,1))}return ge=wr(ge),qe/=100,Ce/=100,[Je(0),Je(8),Je(4),ze]})(ae)}}})(n);return o?new Tr(...o,!1):void 0}get rgb(){const{r:n,g:o,b:p,a:h}=this,b=h||1/0;return this.overwriteGetter("rgb",[n/b,o/b,p/b,h])}get hcl(){return this.overwriteGetter("hcl",(function(n){const[o,p,h,b]=ji(n),x=Math.sqrt(p*p+h*h);return[Math.round(1e4*x)?wr(Math.atan2(h,p)*Yt):NaN,x,o,b]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ji(this.rgb))}overwriteGetter(n,o){return Object.defineProperty(this,n,{value:o}),o}toString(){const[n,o,p,h]=this.rgb;return`rgba(${[n,o,p].map((b=>Math.round(255*b))).join(",")},${h})`}static interpolate(n,o,p,h="rgb"){switch(h){case"rgb":{const[b,x,A,T]=ao(n.rgb,o.rgb,p);return new Tr(b,x,A,T,!1)}case"hcl":{const[b,x,A,T]=n.hcl,[I,z,q,Z]=o.hcl;let H,Y;if(isNaN(b)||isNaN(I))isNaN(b)?isNaN(I)?H=NaN:(H=I,A!==1&&A!==0||(Y=z)):(H=b,q!==1&&q!==0||(Y=x));else{let Ce=I-b;I>b&&Ce>180?Ce-=360:I<b&&b-I>180&&(Ce+=360),H=b+p*Ce}const[ne,ae,ge,qe]=(function([Ce,ze,Je,ot]){return Ce=isNaN(Ce)?0:Ce*$t,L([Je,Math.cos(Ce)*ze,Math.sin(Ce)*ze,ot])})([H,Y??bn(x,z,p),bn(A,q,p),bn(T,Z,p)]);return new Tr(ne,ae,ge,qe,!1)}case"lab":{const[b,x,A,T]=L(ao(n.lab,o.lab,p));return new Tr(b,x,A,T,!1)}}}}Tr.black=new Tr(0,0,0,1),Tr.white=new Tr(1,1,1,1),Tr.transparent=new Tr(0,0,0,0),Tr.red=new Tr(1,0,0,1);class Ca{constructor(n,o,p){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const $e=["bottom","center","top"];class hl{constructor(n,o,p,h,b,x){this.text=n,this.image=o,this.scale=p,this.fontStack=h,this.textColor=b,this.verticalAlign=x}}class Zn{constructor(n){this.sections=n}static fromString(n){return new Zn([new hl(n,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((n=>n.text.length!==0||n.image&&n.image.name.length!==0))}static factory(n){return n instanceof Zn?n:Zn.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map((n=>n.text)).join("")}}class vn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof vn)return n;if(typeof n=="number")return new vn([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const o of n)if(typeof o!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new vn(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,o,p){return new vn(ao(n.values,o.values,p))}}class nn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof nn)return n;if(typeof n=="number")return new nn([n]);if(Array.isArray(n)){for(const o of n)if(typeof o!="number")return;return new nn(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,o,p){return new nn(ao(n.values,o.values,p))}}class xn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof xn)return n;if(typeof n=="string"){const p=Tr.parse(n);return p?new xn([p]):void 0}if(!Array.isArray(n))return;const o=[];for(const p of n){if(typeof p!="string")return;const h=Tr.parse(p);if(!h)return;o.push(h)}return new xn(o)}toString(){return JSON.stringify(this.values)}static interpolate(n,o,p,h="rgb"){const b=[];if(n.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${n.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let x=0;x<n.values.length;x++)b.push(Tr.interpolate(n.values[x],o.values[x],p,h));return new xn(b)}}class bi extends Error{constructor(n){super(n),this.name="RuntimeError"}toJSON(){return this.message}}const ml=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class zn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof zn)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let o=0;o<n.length;o+=2){const p=n[o],h=n[o+1];if(typeof p!="string"||!ml.has(p)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new zn(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,o,p){const h=n.values,b=o.values;if(h.length!==b.length)throw new bi(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${o.toString()}`);const x=[];for(let A=0;A<h.length;A+=2){if(h[A]!==b[A])throw new bi(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${h[A]}, to[${A}]: ${b[A]}`);x.push(h[A]);const[T,I]=h[A+1],[z,q]=b[A+1];x.push([bn(T,z,p),bn(I,q,p)])}return new zn(x)}}class os{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new os({name:n,available:!1}):null}}class Hn{constructor(n,o,p){this.from=n,this.to=o,this.transition=p}static interpolate(n,o,p){return new Hn(n,o,p)}static parse(n){return n instanceof Hn?n:Array.isArray(n)&&n.length===3&&typeof n[0]=="string"&&typeof n[1]=="string"&&typeof n[2]=="number"?new Hn(n[0],n[1],n[2]):typeof n=="object"&&typeof n.from=="string"&&typeof n.to=="string"&&typeof n.transition=="number"?new Hn(n.from,n.to,n.transition):typeof n=="string"?new Hn(n,n,1):void 0}}function vu(l,n,o,p){return typeof l=="number"&&l>=0&&l<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[l,n,o,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[l,n,o,p]:[l,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function li(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Hn||l instanceof Tr||l instanceof Ca||l instanceof Zn||l instanceof vn||l instanceof nn||l instanceof xn||l instanceof zn||l instanceof os)return!0;if(Array.isArray(l)){for(const n of l)if(!li(n))return!1;return!0}if(typeof l=="object"){for(const n in l)if(!li(l[n]))return!1;return!0}return!1}function Ci(l){if(l===null)return at;if(typeof l=="string")return _r;if(typeof l=="boolean")return cr;if(typeof l=="number")return At;if(l instanceof Tr)return Gi;if(l instanceof Hn)return gn;if(l instanceof Ca)return ns;if(l instanceof Zn)return ss;if(l instanceof vn)return Kn;if(l instanceof nn)return rn;if(l instanceof xn)return vs;if(l instanceof zn)return hi;if(l instanceof os)return Gn;if(Array.isArray(l)){const n=l.length;let o;for(const p of l){const h=Ci(p);if(o){if(o===h)continue;o=dr;break}o=h}return Ui(o||dr,n)}return tn}function Vr(l){const n=typeof l;return l===null?"":n==="string"||n==="number"||n==="boolean"?String(l):l instanceof Tr||l instanceof Hn||l instanceof Zn||l instanceof vn||l instanceof nn||l instanceof xn||l instanceof zn||l instanceof os?l.toString():JSON.stringify(l)}class hr{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!li(n[1]))return o.error("invalid value");const p=n[1];let h=Ci(p);const b=o.expectedType;return h.kind!=="array"||h.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(h=b),new hr(h,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const yl={string:_r,number:At,boolean:cr,object:tn};class Er{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let p,h=1;const b=n[0];if(b==="array"){let A,T;if(n.length>2){const I=n[1];if(typeof I!="string"||!(I in yl)||I==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);A=yl[I],h++}else A=dr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=n[2],h++}p=Ui(A,T)}else{if(!yl[b])throw new Error(`Types doesn't contain name = ${b}`);p=yl[b]}const x=[];for(;h<n.length;h++){const A=o.parse(n[h],h,dr);if(!A)return null;x.push(A)}return new Er(p,x)}evaluate(n){for(let o=0;o<this.args.length;o++){const p=this.args[o].evaluate(n);if(!$n(this.type,Ci(p)))return p;if(o===this.args.length-1)throw new bi(`Expected value to be of type ${Qr(this.type)}, but found ${Qr(Ci(p))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Kc={"to-boolean":cr,"to-color":Gi,"to-number":At,"to-string":_r};class Cn{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const p=n[0];if(!Kc[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&n.length!==2)return o.error("Expected one argument.");const h=Kc[p],b=[];for(let x=1;x<n.length;x++){const A=o.parse(n[x],x,dr);if(!A)return null;b.push(A)}return new Cn(h,b)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let o,p;for(const h of this.args){if(o=h.evaluate(n),p=null,o instanceof Tr)return o;if(typeof o=="string"){const b=n.parseColor(o);if(b)return b}else if(Array.isArray(o)&&(p=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:vu(o[0],o[1],o[2],o[3]),!p))return new Tr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new bi(p||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const p of this.args){o=p.evaluate(n);const h=vn.parse(o);if(h)return h}throw new bi(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const p of this.args){o=p.evaluate(n);const h=nn.parse(o);if(h)return h}throw new bi(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const p of this.args){o=p.evaluate(n);const h=xn.parse(o);if(h)return h}throw new bi(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const p of this.args){o=p.evaluate(n);const h=zn.parse(o);if(h)return h}throw new bi(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const p of this.args){if(o=p.evaluate(n),o===null)return 0;const h=Number(o);if(!isNaN(h))return h}throw new bi(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Zn.fromString(Vr(this.args[0].evaluate(n)));case"resolvedImage":return os.fromString(Vr(this.args[0].evaluate(n)));case"projectionDefinition":return this.args[0].evaluate(n);default:return Vr(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}const Sf=["Unknown","Point","LineString","Polygon"];class xu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Sf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let o=this._parseColorCache.get(n);return o||(o=Tr.parse(n),this._parseColorCache.set(n,o)),o}}class wu{constructor(n,o,p=[],h,b=new Ii,x=[]){this.registry=n,this.path=p,this.key=p.map((A=>`[${A}]`)).join(""),this.scope=b,this.errors=x,this.expectedType=h,this._isConstant=o}parse(n,o,p,h,b={}){return o?this.concat(o,p,h)._parse(n,b):this._parse(n,b)}_parse(n,o){function p(h,b,x){return x==="assert"?new Er(b,[h]):x==="coerce"?new Cn(b,[h]):h}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=n[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[h];if(b){let x=b.parse(n,this);if(!x)return null;if(this.expectedType){const A=this.expectedType,T=x.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||T.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(T.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(T.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(T.kind)||A.kind==="colorArray"&&["value","string","array"].includes(T.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(T.kind))x=p(x,A,o.typeAnnotation||"coerce");else if(this.checkSubtype(A,T))return null}else x=p(x,A,o.typeAnnotation||"assert")}if(!(x instanceof hr)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const A=new xu;try{x=new hr(x.type,x.evaluate(A))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,p){const h=typeof n=="number"?this.path.concat(n):this.path,b=p?this.scope.concat(p):this.scope;return new wu(this.registry,this._isConstant,h,o||null,b,this.errors)}error(n,...o){const p=`${this.key}${o.map((h=>`[${h}]`)).join("")}`;this.errors.push(new Di(p,n))}checkSubtype(n,o){const p=$n(n,o);return p&&this.error(p),p}}class gl{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const p=[];for(let b=1;b<n.length-1;b+=2){const x=n[b];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,b);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",b);const A=o.parse(n[b+1],b+1);if(!A)return null;p.push([x,A])}const h=o.parse(n[n.length-1],n.length-1,o.expectedType,p);return h?new gl(p,h):null}outputDefined(){return this.result.outputDefined()}}class Eu{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const p=n[1];return o.scope.has(p)?new Eu(p,o.scope.get(p)):o.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Tf{constructor(n,o,p){this.type=n,this.index=o,this.input=p}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const p=o.parse(n[1],1,At),h=o.parse(n[2],2,Ui(o.expectedType||dr));return p&&h?new Tf(h.type.itemType,p,h):null}evaluate(n){const o=this.index.evaluate(n),p=this.input.evaluate(n);if(o<0)throw new bi(`Array index out of bounds: ${o} < 0.`);if(o>=p.length)throw new bi(`Array index out of bounds: ${o} > ${p.length-1}.`);if(o!==Math.floor(o))throw new bi(`Array index must be an integer, but found ${o} instead.`);return p[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Gc{constructor(n,o){this.type=cr,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const p=o.parse(n[1],1,dr),h=o.parse(n[2],2,dr);return p&&h?oo(p.type,[cr,_r,At,at,dr])?new Gc(p,h):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(p.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),p=this.haystack.evaluate(n);if(!p)return!1;if(!ke(o,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(Ci(o))} instead.`);if(!ke(p,["string","array"]))throw new bi(`Expected second argument to be of type array or string, but found ${Qr(Ci(p))} instead.`);return p.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Au{constructor(n,o,p){this.type=At,this.needle=n,this.haystack=o,this.fromIndex=p}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${n.length-1} instead.`);const p=o.parse(n[1],1,dr),h=o.parse(n[2],2,dr);if(!p||!h)return null;if(!oo(p.type,[cr,_r,At,at,dr]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(p.type)} instead`);if(n.length===4){const b=o.parse(n[3],3,At);return b?new Au(p,h,b):null}return new Au(p,h)}evaluate(n){const o=this.needle.evaluate(n),p=this.haystack.evaluate(n);if(!ke(o,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${Qr(Ci(o))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(n)),ke(p,["string"])){const b=p.indexOf(o,h);return b===-1?-1:[...p.slice(0,b)].length}if(ke(p,["array"]))return p.indexOf(o,h);throw new bi(`Expected second argument to be of type array or string, but found ${Qr(Ci(p))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class lo{constructor(n,o,p,h,b,x){this.inputType=n,this.type=o,this.input=p,this.cases=h,this.outputs=b,this.otherwise=x}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let p,h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const b={},x=[];for(let I=2;I<n.length-1;I+=2){let z=n[I];const q=n[I+1];Array.isArray(z)||(z=[z]);const Z=o.concat(I);if(z.length===0)return Z.error("Expected at least one branch label.");for(const Y of z){if(typeof Y!="number"&&typeof Y!="string")return Z.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return Z.error("Numeric branch labels must be integer values.");if(p){if(Z.checkSubtype(p,Ci(Y)))return null}else p=Ci(Y);if(b[String(Y)]!==void 0)return Z.error("Branch labels must be unique.");b[String(Y)]=x.length}const H=o.parse(q,I,h);if(!H)return null;h=h||H.type,x.push(H)}const A=o.parse(n[1],1,dr);if(!A)return null;const T=o.parse(n[n.length-1],n.length-1,h);return T?A.type.kind!=="value"&&o.concat(1).checkSubtype(p,A.type)?null:new lo(p,h,A,b,x,T):null}evaluate(n){const o=this.input.evaluate(n);return(Ci(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))&&this.otherwise.outputDefined()}}class sn{constructor(n,o,p){this.type=n,this.branches=o,this.otherwise=p}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const h=[];for(let x=1;x<n.length-1;x+=2){const A=o.parse(n[x],x,cr);if(!A)return null;const T=o.parse(n[x+1],x+1,p);if(!T)return null;h.push([A,T]),p=p||T.type}const b=o.parse(n[n.length-1],n.length-1,p);if(!b)return null;if(!p)throw new Error("Can't infer output type");return new sn(p,h,b)}evaluate(n){for(const[o,p]of this.branches)if(o.evaluate(n))return p.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,p]of this.branches)n(o),n(p);n(this.otherwise)}outputDefined(){return this.branches.every((([n,o])=>o.outputDefined()))&&this.otherwise.outputDefined()}}class ka{constructor(n,o,p,h){this.type=n,this.input=o,this.beginIndex=p,this.endIndex=h}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${n.length-1} instead.`);const p=o.parse(n[1],1,dr),h=o.parse(n[2],2,At);if(!p||!h)return null;if(!oo(p.type,[Ui(dr),_r,dr]))return o.error(`Expected first argument to be of type array or string, but found ${Qr(p.type)} instead`);if(n.length===4){const b=o.parse(n[3],3,At);return b?new ka(p.type,p,h,b):null}return new ka(p.type,p,h)}evaluate(n){const o=this.input.evaluate(n),p=this.beginIndex.evaluate(n);let h;if(this.endIndex&&(h=this.endIndex.evaluate(n)),ke(o,["string"]))return[...o].slice(p,h).join("");if(ke(o,["array"]))return o.slice(p,h);throw new bi(`Expected first argument to be of type array or string, but found ${Qr(Ci(o))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Ru(l,n){const o=l.length-1;let p,h,b=0,x=o,A=0;for(;b<=x;)if(A=Math.floor((b+x)/2),p=l[A],h=l[A+1],p<=n){if(A===o||n<h)return A;b=A+1}else{if(!(p>n))throw new bi("Input is not a number.");x=A-1}return 0}class Wo{constructor(n,o,p){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[h,b]of p)this.labels.push(h),this.outputs.push(b)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const p=o.parse(n[1],1,At);if(!p)return null;const h=[];let b=null;o.expectedType&&o.expectedType.kind!=="value"&&(b=o.expectedType);for(let x=1;x<n.length;x+=2){const A=x===1?-1/0:n[x],T=n[x+1],I=x,z=x+1;if(typeof A!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(h.length&&h[h.length-1][0]>=A)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const q=o.parse(T,z,b);if(!q)return null;b=b||q.type,h.push([A,q])}return new Wo(b,p,h)}evaluate(n){const o=this.labels,p=this.outputs;if(o.length===1)return p[0].evaluate(n);const h=this.input.evaluate(n);if(h<=o[0])return p[0].evaluate(n);const b=o.length;return h>=o[b-1]?p[b-1].evaluate(n):p[Ru(o,h)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function on(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var $c,Zc,iy=(function(){if(Zc)return $c;function l(n,o,p,h){this.cx=3*n,this.bx=3*(p-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(h-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=o,this.p2x=p,this.p2y=h}return Zc=1,$c=l,l.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,o){if(o===void 0&&(o=1e-6),n<0)return 0;if(n>1)return 1;for(var p=n,h=0;h<8;h++){var b=this.sampleCurveX(p)-n;if(Math.abs(b)<o)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=b/x}var A=0,T=1;for(p=n,h=0;h<20&&(b=this.sampleCurveX(p),!(Math.abs(b-n)<o));h++)n>b?A=p:T=p,p=.5*(T-A)+A;return p},solve:function(n,o){return this.sampleCurveY(this.solveCurveX(n,o))}},$c})(),g0=on(iy);class Hi{constructor(n,o,p,h,b){this.type=n,this.operator=o,this.interpolation=p,this.input=h,this.labels=[],this.outputs=[];for(const[x,A]of b)this.labels.push(x),this.outputs.push(A)}static interpolationFactor(n,o,p,h){let b=0;if(n.name==="exponential")b=_l(o,n.base,p,h);else if(n.name==="linear")b=_l(o,1,p,h);else if(n.name==="cubic-bezier"){const x=n.controlPoints;b=new g0(x[0],x[1],x[2],x[3]).solve(_l(o,1,p,h))}return b}static parse(n,o){let[p,h,b,...x]=n;if(!Array.isArray(h)||h.length===0)return o.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const I=h[1];if(typeof I!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:I}}else{if(h[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const I=h.slice(1);if(I.length!==4||I.some((z=>typeof z!="number"||z<0||z>1)))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:I}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(b=o.parse(b,2,At),!b)return null;const A=[];let T=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||o.expectedType==vs?o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType):T=Gi;for(let I=0;I<x.length;I+=2){const z=x[I],q=x[I+1],Z=I+3,H=I+4;if(typeof z!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(A.length&&A[A.length-1][0]>=z)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const Y=o.parse(q,H,T);if(!Y)return null;T=T||Y.type,A.push([z,Y])}return j(T,At)||j(T,gn)||j(T,Gi)||j(T,Kn)||j(T,rn)||j(T,vs)||j(T,hi)||j(T,Ui(At))?new Hi(T,p,h,b,A):o.error(`Type ${Qr(T)} is not interpolatable.`)}evaluate(n){const o=this.labels,p=this.outputs;if(o.length===1)return p[0].evaluate(n);const h=this.input.evaluate(n);if(h<=o[0])return p[0].evaluate(n);const b=o.length;if(h>=o[b-1])return p[b-1].evaluate(n);const x=Ru(o,h),A=Hi.interpolationFactor(this.interpolation,h,o[x],o[x+1]),T=p[x].evaluate(n),I=p[x+1].evaluate(n);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return bn(T,I,A);case"color":return Tr.interpolate(T,I,A);case"padding":return vn.interpolate(T,I,A);case"colorArray":return xn.interpolate(T,I,A);case"numberArray":return nn.interpolate(T,I,A);case"variableAnchorOffsetCollection":return zn.interpolate(T,I,A);case"array":return ao(T,I,A);case"projectionDefinition":return Hn.interpolate(T,I,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return Tr.interpolate(T,I,A,"hcl");case"colorArray":return xn.interpolate(T,I,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Tr.interpolate(T,I,A,"lab");case"colorArray":return xn.interpolate(T,I,A,"lab")}}}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}}function _l(l,n,o,p){const h=p-o,b=l-o;return h===0?0:n===1?b/h:(Math.pow(n,b)-1)/(Math.pow(n,h)-1)}const ws={color:Tr.interpolate,number:bn,padding:vn.interpolate,numberArray:nn.interpolate,colorArray:xn.interpolate,variableAnchorOffsetCollection:zn.interpolate,array:ao};class Hc{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let p=null;const h=o.expectedType;h&&h.kind!=="value"&&(p=h);const b=[];for(const A of n.slice(1)){const T=o.parse(A,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!T)return null;p=p||T.type,b.push(T)}if(!p)throw new Error("No output type");const x=h&&b.some((A=>$n(h,A.type)));return new Hc(x?dr:p,b)}evaluate(n){let o,p=null,h=0;for(const b of this.args)if(h++,p=b.evaluate(n),p&&p instanceof os&&!p.available&&(o||(o=p.name),p=null,h===this.args.length&&(p=o)),p!==null)break;return p}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}}function Cf(l,n){return l==="=="||l==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Su(l,n,o,p){return p.compare(n,o)===0}function So(l,n,o){const p=l!=="=="&&l!=="!=";return class AB{constructor(b,x,A){this.type=cr,this.lhs=b,this.rhs=x,this.collator=A,this.hasUntypedArgument=b.type.kind==="value"||x.type.kind==="value"}static parse(b,x){if(b.length!==3&&b.length!==4)return x.error("Expected two or three arguments.");const A=b[0];let T=x.parse(b[1],1,dr);if(!T)return null;if(!Cf(A,T.type))return x.concat(1).error(`"${A}" comparisons are not supported for type '${Qr(T.type)}'.`);let I=x.parse(b[2],2,dr);if(!I)return null;if(!Cf(A,I.type))return x.concat(2).error(`"${A}" comparisons are not supported for type '${Qr(I.type)}'.`);if(T.type.kind!==I.type.kind&&T.type.kind!=="value"&&I.type.kind!=="value")return x.error(`Cannot compare types '${Qr(T.type)}' and '${Qr(I.type)}'.`);p&&(T.type.kind==="value"&&I.type.kind!=="value"?T=new Er(I.type,[T]):T.type.kind!=="value"&&I.type.kind==="value"&&(I=new Er(T.type,[I])));let z=null;if(b.length===4){if(T.type.kind!=="string"&&I.type.kind!=="string"&&T.type.kind!=="value"&&I.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(z=x.parse(b[3],3,ns),!z)return null}return new AB(T,I,z)}evaluate(b){const x=this.lhs.evaluate(b),A=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const T=Ci(x),I=Ci(A);if(T.kind!==I.kind||T.kind!=="string"&&T.kind!=="number")throw new bi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${T.kind}, ${I.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const T=Ci(x),I=Ci(A);if(T.kind!=="string"||I.kind!=="string")return n(b,x,A)}return this.collator?o(b,x,A,this.collator.evaluate(b)):n(b,x,A)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Os=So("==",(function(l,n,o){return n===o}),Su),ny=So("!=",(function(l,n,o){return n!==o}),(function(l,n,o,p){return!Su(0,n,o,p)})),Xc=So("<",(function(l,n,o){return n<o}),(function(l,n,o,p){return p.compare(n,o)<0})),_0=So(">",(function(l,n,o){return n>o}),(function(l,n,o,p){return p.compare(n,o)>0})),kf=So("<=",(function(l,n,o){return n<=o}),(function(l,n,o,p){return p.compare(n,o)<=0})),b0=So(">=",(function(l,n,o){return n>=o}),(function(l,n,o,p){return p.compare(n,o)>=0}));class Wc{constructor(n,o,p){this.type=ns,this.locale=p,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const p=n[1];if(typeof p!="object"||Array.isArray(p))return o.error("Collator options argument must be an object.");const h=o.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,cr);if(!h)return null;const b=o.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,cr);if(!b)return null;let x=null;return p.locale&&(x=o.parse(p.locale,1,_r),!x)?null:new Wc(h,b,x)}evaluate(n){return new Ca(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Pf{constructor(n,o,p,h,b){this.type=_r,this.number=n,this.locale=o,this.currency=p,this.minFractionDigits=h,this.maxFractionDigits=b}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const p=o.parse(n[1],1,At);if(!p)return null;const h=n[2];if(typeof h!="object"||Array.isArray(h))return o.error("NumberFormat options argument must be an object.");let b=null;if(h.locale&&(b=o.parse(h.locale,1,_r),!b))return null;let x=null;if(h.currency&&(x=o.parse(h.currency,1,_r),!x))return null;let A=null;if(h["min-fraction-digits"]&&(A=o.parse(h["min-fraction-digits"],1,At),!A))return null;let T=null;return h["max-fraction-digits"]&&(T=o.parse(h["max-fraction-digits"],1,At),!T)?null:new Pf(p,b,x,A,T)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Yc{constructor(n){this.type=ss,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const p=n[1];if(!Array.isArray(p)&&typeof p=="object")return o.error("First argument must be an image or text section.");const h=[];let b=!1;for(let x=1;x<=n.length-1;++x){const A=n[x];if(b&&typeof A=="object"&&!Array.isArray(A)){b=!1;let T=null;if(A["font-scale"]&&(T=o.parse(A["font-scale"],1,At),!T))return null;let I=null;if(A["text-font"]&&(I=o.parse(A["text-font"],1,Ui(_r)),!I))return null;let z=null;if(A["text-color"]&&(z=o.parse(A["text-color"],1,Gi),!z))return null;let q=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!$e.includes(A["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(q=o.parse(A["vertical-align"],1,_r),!q)return null}const Z=h[h.length-1];Z.scale=T,Z.font=I,Z.textColor=z,Z.verticalAlign=q}else{const T=o.parse(n[x],1,dr);if(!T)return null;const I=T.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,h.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Yc(h)}evaluate(n){return new Zn(this.sections.map((o=>{const p=o.content.evaluate(n);return Ci(p)===Gn?new hl("",p,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(n):null):new hl(Vr(p),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null,o.verticalAlign?o.verticalAlign.evaluate(n):null)})))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor),o.verticalAlign&&n(o.verticalAlign)}outputDefined(){return!1}}class bl{constructor(n){this.type=Gn,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const p=o.parse(n[1],1,_r);return p?new bl(p):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),p=os.fromString(o);return p&&n.availableImages&&(p.available=n.availableImages.indexOf(o)>-1),p}eachChild(n){n(this.input)}outputDefined(){return!1}}class Lf{constructor(n){this.type=At,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const p=o.parse(n[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Qr(p.type)} instead.`):new Lf(p):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new bi(`Expected value to be of type string or array, but found ${Qr(Ci(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Vs=8192;function sy(l,n){const o=(180+l[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,h=Math.pow(2,n.z);return[Math.round(o*h*Vs),Math.round(p*h*Vs)]}function Df(l,n){const o=Math.pow(2,n.z);return[(h=(l[0]/Vs+n.x)/o,360*h-180),(p=(l[1]/Vs+n.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,h}function vl(l,n){l[0]=Math.min(l[0],n[0]),l[1]=Math.min(l[1],n[1]),l[2]=Math.max(l[2],n[0]),l[3]=Math.max(l[3],n[1])}function Tu(l,n){return!(l[0]<=n[0]||l[2]>=n[2]||l[1]<=n[1]||l[3]>=n[3])}function v0(l,n,o){const p=l[0]-n[0],h=l[1]-n[1],b=l[0]-o[0],x=l[1]-o[1];return p*x-b*h==0&&p*b<=0&&h*x<=0}function Jc(l,n,o,p){return(h=[p[0]-o[0],p[1]-o[1]])[0]*(b=[n[0]-l[0],n[1]-l[1]])[1]-h[1]*b[0]!=0&&!(!ly(l,n,o,p)||!ly(o,p,l,n));var h,b}function x0(l,n,o){for(const p of o)for(let h=0;h<p.length-1;++h)if(Jc(l,n,p[h],p[h+1]))return!0;return!1}function xl(l,n,o=!1){let p=!1;for(const A of n)for(let T=0;T<A.length-1;T++){if(v0(l,A[T],A[T+1]))return o;(b=A[T])[1]>(h=l)[1]!=(x=A[T+1])[1]>h[1]&&h[0]<(x[0]-b[0])*(h[1]-b[1])/(x[1]-b[1])+b[0]&&(p=!p)}var h,b,x;return p}function oy(l,n){for(const o of n)if(xl(l,o))return!0;return!1}function If(l,n){for(const o of l)if(!xl(o,n))return!1;for(let o=0;o<l.length-1;++o)if(x0(l[o],l[o+1],n))return!1;return!0}function ay(l,n){for(const o of n)if(If(l,o))return!0;return!1}function ly(l,n,o,p){const h=p[0]-o[0],b=p[1]-o[1],x=(l[0]-o[0])*b-h*(l[1]-o[1]),A=(n[0]-o[0])*b-h*(n[1]-o[1]);return x>0&&A<0||x<0&&A>0}function Bf(l,n,o){const p=[];for(let h=0;h<l.length;h++){const b=[];for(let x=0;x<l[h].length;x++){const A=sy(l[h][x],o);vl(n,A),b.push(A)}p.push(b)}return p}function uy(l,n,o){const p=[];for(let h=0;h<l.length;h++){const b=Bf(l[h],n,o);p.push(b)}return p}function cy(l,n,o,p){if(l[0]<o[0]||l[0]>o[2]){const h=.5*p;let b=l[0]-o[0]>h?-p:o[0]-l[0]>h?p:0;b===0&&(b=l[0]-o[2]>h?-p:o[2]-l[0]>h?p:0),l[0]+=b}vl(n,l)}function Cu(l,n,o,p){const h=Math.pow(2,p.z)*Vs,b=[p.x*Vs,p.y*Vs],x=[];for(const A of l)for(const T of A){const I=[T.x+b[0],T.y+b[1]];cy(I,n,o,h),x.push(I)}return x}function dy(l,n,o,p){const h=Math.pow(2,p.z)*Vs,b=[p.x*Vs,p.y*Vs],x=[];for(const T of l){const I=[];for(const z of T){const q=[z.x+b[0],z.y+b[1]];vl(n,q),I.push(q)}x.push(I)}if(n[2]-n[0]<=h/2){(A=n)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const T of x)for(const I of T)cy(I,n,o,h)}var A;return x}class Pa{constructor(n,o){this.type=cr,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(li(n[1])){const p=n[1];if(p.type==="FeatureCollection"){const h=[];for(const b of p.features){const{type:x,coordinates:A}=b.geometry;x==="Polygon"&&h.push(A),x==="MultiPolygon"&&h.push(...A)}if(h.length)return new Pa(p,{type:"MultiPolygon",coordinates:h})}else if(p.type==="Feature"){const h=p.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Pa(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Pa(p,p)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(o,p){const h=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(p.type==="Polygon"){const A=Bf(p.coordinates,b,x),T=Cu(o.geometry(),h,b,x);if(!Tu(h,b))return!1;for(const I of T)if(!xl(I,A))return!1}if(p.type==="MultiPolygon"){const A=uy(p.coordinates,b,x),T=Cu(o.geometry(),h,b,x);if(!Tu(h,b))return!1;for(const I of T)if(!oy(I,A))return!1}return!0})(n,this.geometries);if(n.geometryType()==="LineString")return(function(o,p){const h=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(p.type==="Polygon"){const A=Bf(p.coordinates,b,x),T=dy(o.geometry(),h,b,x);if(!Tu(h,b))return!1;for(const I of T)if(!If(I,A))return!1}if(p.type==="MultiPolygon"){const A=uy(p.coordinates,b,x),T=dy(o.geometry(),h,b,x);if(!Tu(h,b))return!1;for(const I of T)if(!ay(I,A))return!1}return!0})(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let py=class{constructor(l=[],n=(o,p)=>o<p?-1:o>p?1:0){if(this.data=l,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:n,compare:o}=this,p=n[l];for(;l>0;){const h=l-1>>1,b=n[h];if(o(p,b)>=0)break;n[l]=b,l=h}n[l]=p}_down(l){const{data:n,compare:o}=this,p=this.length>>1,h=n[l];for(;l<p;){let b=1+(l<<1);const x=b+1;if(x<this.length&&o(n[x],n[b])<0&&(b=x),o(n[b],h)>=0)break;n[l]=n[b],l=b}n[l]=h}};function fy(l,n,o=0,p=l.length-1,h=hy){for(;p>o;){if(p-o>600){const T=p-o+1,I=n-o+1,z=Math.log(T),q=.5*Math.exp(2*z/3),Z=.5*Math.sqrt(z*q*(T-q)/T)*(I-T/2<0?-1:1);fy(l,n,Math.max(o,Math.floor(n-I*q/T+Z)),Math.min(p,Math.floor(n+(T-I)*q/T+Z)),h)}const b=l[n];let x=o,A=p;for(La(l,o,n),h(l[p],b)>0&&La(l,o,p);x<A;){for(La(l,x,A),x++,A--;h(l[x],b)<0;)x++;for(;h(l[A],b)>0;)A--}h(l[o],b)===0?La(l,o,A):(A++,La(l,A,p)),A<=n&&(o=A+1),n<=A&&(p=A-1)}}function La(l,n,o){const p=l[n];l[n]=l[o],l[o]=p}function hy(l,n){return l<n?-1:l>n?1:0}function Qc(l,n){if(l.length<=1)return[l];const o=[];let p,h;for(const b of l){const x=my(b);x!==0&&(b.area=Math.abs(x),h===void 0&&(h=x<0),h===x<0?(p&&o.push(p),p=[b]):p.push(b))}if(p&&o.push(p),n>1)for(let b=0;b<o.length;b++)o[b].length<=n||(fy(o[b],n,1,o[b].length-1,w0),o[b]=o[b].slice(0,n));return o}function w0(l,n){return n.area-l.area}function my(l){let n=0;for(let o,p,h=0,b=l.length,x=b-1;h<b;x=h++)o=l[h],p=l[x],n+=(p.x-o.x)*(o.y+p.y);return n}const Mf=1/298.257223563,yy=Mf*(2-Mf),gy=Math.PI/180;class zf{constructor(n){const o=6378.137*gy*1e3,p=Math.cos(n*gy),h=1/(1-yy*(1-p*p)),b=Math.sqrt(h);this.kx=o*b*p,this.ky=o*b*h*(1-yy)}distance(n,o){const p=this.wrap(n[0]-o[0])*this.kx,h=(n[1]-o[1])*this.ky;return Math.sqrt(p*p+h*h)}pointOnLine(n,o){let p,h,b,x,A=1/0;for(let T=0;T<n.length-1;T++){let I=n[T][0],z=n[T][1],q=this.wrap(n[T+1][0]-I)*this.kx,Z=(n[T+1][1]-z)*this.ky,H=0;q===0&&Z===0||(H=(this.wrap(o[0]-I)*this.kx*q+(o[1]-z)*this.ky*Z)/(q*q+Z*Z),H>1?(I=n[T+1][0],z=n[T+1][1]):H>0&&(I+=q/this.kx*H,z+=Z/this.ky*H)),q=this.wrap(o[0]-I)*this.kx,Z=(o[1]-z)*this.ky;const Y=q*q+Z*Z;Y<A&&(A=Y,p=I,h=z,b=T,x=H)}return{point:[p,h],index:b,t:Math.max(0,Math.min(1,x))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Of(l,n){return n[0]-l[0]}function ed(l){return l[1]-l[0]+1}function To(l,n){return l[1]>=l[0]&&l[1]<n}function Vf(l,n){if(l[0]>l[1])return[null,null];const o=ed(l);if(n){if(o===2)return[l,null];const h=Math.floor(o/2);return[[l[0],l[0]+h],[l[0]+h,l[1]]]}if(o===1)return[l,null];const p=Math.floor(o/2)-1;return[[l[0],l[0]+p],[l[0]+p+1,l[1]]]}function Uf(l,n){if(!To(n,l.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let p=n[0];p<=n[1];++p)vl(o,l[p]);return o}function Wr(l){const n=[1/0,1/0,-1/0,-1/0];for(const o of l)for(const p of o)vl(n,p);return n}function _y(l){return l[0]!==-1/0&&l[1]!==-1/0&&l[2]!==1/0&&l[3]!==1/0}function jf(l,n,o){if(!_y(l)||!_y(n))return NaN;let p=0,h=0;return l[2]<n[0]&&(p=n[0]-l[2]),l[0]>n[2]&&(p=l[0]-n[2]),l[1]>n[3]&&(h=l[1]-n[3]),l[3]<n[1]&&(h=n[1]-l[3]),o.distance([0,0],[p,h])}function Da(l,n,o){const p=o.pointOnLine(n,l);return o.distance(l,p.point)}function Nf(l,n,o,p,h){const b=Math.min(Da(l,[o,p],h),Da(n,[o,p],h)),x=Math.min(Da(o,[l,n],h),Da(p,[l,n],h));return Math.min(b,x)}function E0(l,n,o,p,h){if(!To(n,l.length)||!To(p,o.length))return 1/0;let b=1/0;for(let x=n[0];x<n[1];++x){const A=l[x],T=l[x+1];for(let I=p[0];I<p[1];++I){const z=o[I],q=o[I+1];if(Jc(A,T,z,q))return 0;b=Math.min(b,Nf(A,T,z,q,h))}}return b}function A0(l,n,o,p,h){if(!To(n,l.length)||!To(p,o.length))return NaN;let b=1/0;for(let x=n[0];x<=n[1];++x)for(let A=p[0];A<=p[1];++A)if(b=Math.min(b,h.distance(l[x],o[A])),b===0)return b;return b}function R0(l,n,o){if(xl(l,n,!0))return 0;let p=1/0;for(const h of n){const b=h[0],x=h[h.length-1];if(b!==x&&(p=Math.min(p,Da(l,[x,b],o)),p===0))return p;const A=o.pointOnLine(h,l);if(p=Math.min(p,o.distance(l,A.point)),p===0)return p}return p}function S0(l,n,o,p){if(!To(n,l.length))return NaN;for(let b=n[0];b<=n[1];++b)if(xl(l[b],o,!0))return 0;let h=1/0;for(let b=n[0];b<n[1];++b){const x=l[b],A=l[b+1];for(const T of o)for(let I=0,z=T.length,q=z-1;I<z;q=I++){const Z=T[q],H=T[I];if(Jc(x,A,Z,H))return 0;h=Math.min(h,Nf(x,A,Z,H,p))}}return h}function by(l,n){for(const o of l)for(const p of o)if(xl(p,n,!0))return!0;return!1}function T0(l,n,o,p=1/0){const h=Wr(l),b=Wr(n);if(p!==1/0&&jf(h,b,o)>=p)return p;if(Tu(h,b)){if(by(l,n))return 0}else if(by(n,l))return 0;let x=1/0;for(const A of l)for(let T=0,I=A.length,z=I-1;T<I;z=T++){const q=A[z],Z=A[T];for(const H of n)for(let Y=0,ne=H.length,ae=ne-1;Y<ne;ae=Y++){const ge=H[ae],qe=H[Y];if(Jc(q,Z,ge,qe))return 0;x=Math.min(x,Nf(q,Z,ge,qe,o))}}return x}function vy(l,n,o,p,h,b){if(!b)return;const x=jf(Uf(p,b),h,o);x<n&&l.push([x,b,[0,0]])}function td(l,n,o,p,h,b,x){if(!b||!x)return;const A=jf(Uf(p,b),Uf(h,x),o);A<n&&l.push([A,b,x])}function rd(l,n,o,p,h=1/0){let b=Math.min(p.distance(l[0],o[0][0]),h);if(b===0)return b;const x=new py([[0,[0,l.length-1],[0,0]]],Of),A=Wr(o);for(;x.length>0;){const T=x.pop();if(T[0]>=b)continue;const I=T[1],z=n?50:100;if(ed(I)<=z){if(!To(I,l.length))return NaN;if(n){const q=S0(l,I,o,p);if(isNaN(q)||q===0)return q;b=Math.min(b,q)}else for(let q=I[0];q<=I[1];++q){const Z=R0(l[q],o,p);if(b=Math.min(b,Z),b===0)return 0}}else{const q=Vf(I,n);vy(x,b,p,l,A,q[0]),vy(x,b,p,l,A,q[1])}}return b}function id(l,n,o,p,h,b=1/0){let x=Math.min(b,h.distance(l[0],o[0]));if(x===0)return x;const A=new py([[0,[0,l.length-1],[0,o.length-1]]],Of);for(;A.length>0;){const T=A.pop();if(T[0]>=x)continue;const I=T[1],z=T[2],q=n?50:100,Z=p?50:100;if(ed(I)<=q&&ed(z)<=Z){if(!To(I,l.length)&&To(z,o.length))return NaN;let H;if(n&&p)H=E0(l,I,o,z,h),x=Math.min(x,H);else if(n&&!p){const Y=l.slice(I[0],I[1]+1);for(let ne=z[0];ne<=z[1];++ne)if(H=Da(o[ne],Y,h),x=Math.min(x,H),x===0)return x}else if(!n&&p){const Y=o.slice(z[0],z[1]+1);for(let ne=I[0];ne<=I[1];++ne)if(H=Da(l[ne],Y,h),x=Math.min(x,H),x===0)return x}else H=A0(l,I,o,z,h),x=Math.min(x,H)}else{const H=Vf(I,n),Y=Vf(z,p);td(A,x,h,l,o,H[0],Y[0]),td(A,x,h,l,o,H[0],Y[1]),td(A,x,h,l,o,H[1],Y[0]),td(A,x,h,l,o,H[1],Y[1])}}return x}function Ff(l){return l.type==="MultiPolygon"?l.coordinates.map((n=>({type:"Polygon",coordinates:n}))):l.type==="MultiLineString"?l.coordinates.map((n=>({type:"LineString",coordinates:n}))):l.type==="MultiPoint"?l.coordinates.map((n=>({type:"Point",coordinates:n}))):[l]}class Ia{constructor(n,o){this.type=At,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(li(n[1])){const p=n[1];if(p.type==="FeatureCollection")return new Ia(p,p.features.map((h=>Ff(h.geometry))).flat());if(p.type==="Feature")return new Ia(p,Ff(p.geometry));if("type"in p&&"coordinates"in p)return new Ia(p,Ff(p))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(o,p){const h=o.geometry(),b=h.flat().map((T=>Df([T.x,T.y],o.canonical)));if(h.length===0)return NaN;const x=new zf(b[0][1]);let A=1/0;for(const T of p){switch(T.type){case"Point":A=Math.min(A,id(b,!1,[T.coordinates],!1,x,A));break;case"LineString":A=Math.min(A,id(b,!1,T.coordinates,!0,x,A));break;case"Polygon":A=Math.min(A,rd(b,!1,T.coordinates,x,A))}if(A===0)return A}return A})(n,this.geometries);if(n.geometryType()==="LineString")return(function(o,p){const h=o.geometry(),b=h.flat().map((T=>Df([T.x,T.y],o.canonical)));if(h.length===0)return NaN;const x=new zf(b[0][1]);let A=1/0;for(const T of p){switch(T.type){case"Point":A=Math.min(A,id(b,!0,[T.coordinates],!1,x,A));break;case"LineString":A=Math.min(A,id(b,!0,T.coordinates,!0,x,A));break;case"Polygon":A=Math.min(A,rd(b,!0,T.coordinates,x,A))}if(A===0)return A}return A})(n,this.geometries);if(n.geometryType()==="Polygon")return(function(o,p){const h=o.geometry();if(h.length===0||h[0].length===0)return NaN;const b=Qc(h,0).map((T=>T.map((I=>I.map((z=>Df([z.x,z.y],o.canonical))))))),x=new zf(b[0][0][0][1]);let A=1/0;for(const T of p)for(const I of b){switch(T.type){case"Point":A=Math.min(A,rd([T.coordinates],!1,I,x,A));break;case"LineString":A=Math.min(A,rd(T.coordinates,!0,I,x,A));break;case"Polygon":A=Math.min(A,T0(I,T.coordinates,x,A))}if(A===0)return A}return A})(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class ku{constructor(n){this.type=dr,this.key=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const p=n[1];return p==null?o.error("Global state property must be defined."):typeof p!="string"?o.error(`Global state property must be string, but found ${typeof n[1]} instead.`):new ku(p)}evaluate(n){var o;const p=(o=n.globals)===null||o===void 0?void 0:o.globalState;return p&&Object.keys(p).length!==0?vr(p,this.key):null}eachChild(){}outputDefined(){return!1}}const wl={"==":Os,"!=":ny,">":_0,"<":Xc,">=":b0,"<=":kf,array:Er,at:Tf,boolean:Er,case:sn,coalesce:Hc,collator:Wc,format:Yc,image:bl,in:Gc,"index-of":Au,interpolate:Hi,"interpolate-hcl":Hi,"interpolate-lab":Hi,length:Lf,let:gl,literal:hr,match:lo,number:Er,"number-format":Pf,object:Er,slice:ka,step:Wo,string:Er,"to-boolean":Cn,"to-color":Cn,"to-number":Cn,"to-string":Cn,var:Eu,within:Pa,distance:Ia,"global-state":ku};class Es{constructor(n,o,p,h){this.name=n,this.type=o,this._evaluate=p,this.args=h}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,o){const p=n[0],h=Es.definitions[p];if(!h)return o.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(h)?h[0]:h.type,x=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,A=x.filter((([I])=>!Array.isArray(I)||I.length===n.length-1));let T=null;for(const[I,z]of A){T=new wu(o.registry,nd,o.path,null,o.scope);const q=[];let Z=!1;for(let H=1;H<n.length;H++){const Y=n[H],ne=Array.isArray(I)?I[H-1]:I.type,ae=T.parse(Y,1+q.length,ne);if(!ae){Z=!0;break}q.push(ae)}if(!Z)if(Array.isArray(I)&&I.length!==q.length)T.error(`Expected ${I.length} arguments, but found ${q.length} instead.`);else{for(let H=0;H<q.length;H++){const Y=Array.isArray(I)?I[H]:I.type,ne=q[H];T.concat(H+1).checkSubtype(Y,ne.type)}if(T.errors.length===0)return new Es(p,b,z,q)}}if(A.length===1)o.errors.push(...T.errors);else{const I=(A.length?A:x).map((([q])=>{return Z=q,Array.isArray(Z)?`(${Z.map(Qr).join(", ")})`:`(${Qr(Z.type)}...)`;var Z})).join(" | "),z=[];for(let q=1;q<n.length;q++){const Z=o.parse(n[q],1+z.length);if(!Z)return null;z.push(Qr(Z.type))}o.error(`Expected arguments of type ${I}, but found (${z.join(", ")}) instead.`)}return null}static register(n,o){Es.definitions=o;for(const p in o)n[p]=Es}}function xy(l,[n,o,p,h]){n=n.evaluate(l),o=o.evaluate(l),p=p.evaluate(l);const b=h?h.evaluate(l):1,x=vu(n,o,p,b);if(x)throw new bi(x);return new Tr(n/255,o/255,p/255,b,!1)}function wy(l,n){return l in n}function qf(l,n){const o=n[l];return o===void 0?null:o}function Ba(l){return{type:l}}function nd(l){if(l instanceof Eu)return nd(l.boundExpression);if(l instanceof Es&&l.name==="error"||l instanceof Wc||l instanceof Pa||l instanceof Ia||l instanceof ku)return!1;const n=l instanceof Cn||l instanceof Er;let o=!0;return l.eachChild((p=>{o=n?o&&nd(p):o&&p instanceof hr})),!!o&&sd(l)&&od(l,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function sd(l){if(l instanceof Es&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Pa||l instanceof Ia)return!1;let n=!0;return l.eachChild((o=>{n&&!sd(o)&&(n=!1)})),n}function Pu(l){if(l instanceof Es&&l.name==="feature-state")return!1;let n=!0;return l.eachChild((o=>{n&&!Pu(o)&&(n=!1)})),n}function od(l,n){if(l instanceof Es&&n.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild((p=>{o&&!od(p,n)&&(o=!1)})),o}function Ey(l){return{result:"success",value:l}}function El(l){return{result:"error",value:l}}function Al(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Ay(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Lu(l){return!!l.expression&&l.expression.interpolated}function zr(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function ad(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)&&Ci(l)===tn}function C0(l){return l}function Kf(l,n){const o=l.stops&&typeof l.stops[0][0]=="object",p=o||!(o||l.property!==void 0),h=l.type||(Lu(n)?"exponential":"interval"),b=(function(z){switch(z.type){case"color":return Tr.parse;case"padding":return vn.parse;case"numberArray":return nn.parse;case"colorArray":return xn.parse;default:return null}})(n);if(b&&((l=Vi({},l)).stops&&(l.stops=l.stops.map((z=>[z[0],b(z[1])]))),l.default=b(l.default?l.default:n.default)),l.colorSpace&&(x=l.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var x;const A=(function(z){switch(z){case"exponential":return Gf;case"interval":return ld;case"categorical":return k0;case"identity":return P0;default:throw new Error(`Unknown function type "${z}"`)}})(h);let T,I;if(h==="categorical"){T=Object.create(null);for(const z of l.stops)T[z[0]]=z[1];I=typeof l.stops[0][0]}if(o){const z={},q=[];for(let Y=0;Y<l.stops.length;Y++){const ne=l.stops[Y],ae=ne[0].zoom;z[ae]===void 0&&(z[ae]={zoom:ae,type:l.type,property:l.property,default:l.default,stops:[]},q.push(ae)),z[ae].stops.push([ne[0].value,ne[1]])}const Z=[];for(const Y of q)Z.push([z[Y].zoom,Kf(z[Y],n)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:Hi.interpolationFactor.bind(void 0,H),zoomStops:Z.map((Y=>Y[0])),evaluate:({zoom:Y},ne)=>Gf({stops:Z,base:l.base},n,Y).evaluate(Y,ne)}}if(p){const z=h==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:Hi.interpolationFactor.bind(void 0,z),zoomStops:l.stops.map((q=>q[0])),evaluate:({zoom:q})=>A(l,n,q,T,I)}}return{kind:"source",evaluate(z,q){const Z=q&&q.properties?q.properties[l.property]:void 0;return Z===void 0?Du(l.default,n.default):A(l,n,Z,T,I)}}}function Du(l,n,o){return l!==void 0?l:n!==void 0?n:o!==void 0?o:void 0}function k0(l,n,o,p,h){return Du(typeof o===h?p[o]:void 0,l.default,n.default)}function ld(l,n,o){if(zr(o)!=="number")return Du(l.default,n.default);const p=l.stops.length;if(p===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[p-1][0])return l.stops[p-1][1];const h=Ru(l.stops.map((b=>b[0])),o);return l.stops[h][1]}function Gf(l,n,o){const p=l.base!==void 0?l.base:1;if(zr(o)!=="number")return Du(l.default,n.default);const h=l.stops.length;if(h===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[h-1][0])return l.stops[h-1][1];const b=Ru(l.stops.map((z=>z[0])),o),x=(function(z,q,Z,H){const Y=H-Z,ne=z-Z;return Y===0?0:q===1?ne/Y:(Math.pow(q,ne)-1)/(Math.pow(q,Y)-1)})(o,p,l.stops[b][0],l.stops[b+1][0]),A=l.stops[b][1],T=l.stops[b+1][1],I=ws[n.type]||C0;return typeof A.evaluate=="function"?{evaluate(...z){const q=A.evaluate.apply(void 0,z),Z=T.evaluate.apply(void 0,z);if(q!==void 0&&Z!==void 0)return I(q,Z,x,l.colorSpace)}}:I(A,T,x,l.colorSpace)}function P0(l,n,o){switch(n.type){case"color":o=Tr.parse(o);break;case"formatted":o=Zn.fromString(o.toString());break;case"resolvedImage":o=os.fromString(o.toString());break;case"padding":o=vn.parse(o);break;case"colorArray":o=xn.parse(o);break;case"numberArray":o=nn.parse(o);break;default:zr(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0)}return Du(o,l.default,n.default)}Es.register(wl,{error:[{kind:"error"},[_r],(l,[n])=>{throw new bi(n.evaluate(l))}],typeof:[_r,[dr],(l,[n])=>Qr(Ci(n.evaluate(l)))],"to-rgba":[Ui(At,4),[Gi],(l,[n])=>{const[o,p,h,b]=n.evaluate(l).rgb;return[255*o,255*p,255*h,b]}],rgb:[Gi,[At,At,At],xy],rgba:[Gi,[At,At,At,At],xy],has:{type:cr,overloads:[[[_r],(l,[n])=>wy(n.evaluate(l),l.properties())],[[_r,tn],(l,[n,o])=>wy(n.evaluate(l),o.evaluate(l))]]},get:{type:dr,overloads:[[[_r],(l,[n])=>qf(n.evaluate(l),l.properties())],[[_r,tn],(l,[n,o])=>qf(n.evaluate(l),o.evaluate(l))]]},"feature-state":[dr,[_r],(l,[n])=>qf(n.evaluate(l),l.featureState||{})],properties:[tn,[],l=>l.properties()],"geometry-type":[_r,[],l=>l.geometryType()],id:[dr,[],l=>l.id()],zoom:[At,[],l=>l.globals.zoom],"heatmap-density":[At,[],l=>l.globals.heatmapDensity||0],elevation:[At,[],l=>l.globals.elevation||0],"line-progress":[At,[],l=>l.globals.lineProgress||0],accumulated:[dr,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[At,Ba(At),(l,n)=>{let o=0;for(const p of n)o+=p.evaluate(l);return o}],"*":[At,Ba(At),(l,n)=>{let o=1;for(const p of n)o*=p.evaluate(l);return o}],"-":{type:At,overloads:[[[At,At],(l,[n,o])=>n.evaluate(l)-o.evaluate(l)],[[At],(l,[n])=>-n.evaluate(l)]]},"/":[At,[At,At],(l,[n,o])=>n.evaluate(l)/o.evaluate(l)],"%":[At,[At,At],(l,[n,o])=>n.evaluate(l)%o.evaluate(l)],ln2:[At,[],()=>Math.LN2],pi:[At,[],()=>Math.PI],e:[At,[],()=>Math.E],"^":[At,[At,At],(l,[n,o])=>Math.pow(n.evaluate(l),o.evaluate(l))],sqrt:[At,[At],(l,[n])=>Math.sqrt(n.evaluate(l))],log10:[At,[At],(l,[n])=>Math.log(n.evaluate(l))/Math.LN10],ln:[At,[At],(l,[n])=>Math.log(n.evaluate(l))],log2:[At,[At],(l,[n])=>Math.log(n.evaluate(l))/Math.LN2],sin:[At,[At],(l,[n])=>Math.sin(n.evaluate(l))],cos:[At,[At],(l,[n])=>Math.cos(n.evaluate(l))],tan:[At,[At],(l,[n])=>Math.tan(n.evaluate(l))],asin:[At,[At],(l,[n])=>Math.asin(n.evaluate(l))],acos:[At,[At],(l,[n])=>Math.acos(n.evaluate(l))],atan:[At,[At],(l,[n])=>Math.atan(n.evaluate(l))],min:[At,Ba(At),(l,n)=>Math.min(...n.map((o=>o.evaluate(l))))],max:[At,Ba(At),(l,n)=>Math.max(...n.map((o=>o.evaluate(l))))],abs:[At,[At],(l,[n])=>Math.abs(n.evaluate(l))],round:[At,[At],(l,[n])=>{const o=n.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[At,[At],(l,[n])=>Math.floor(n.evaluate(l))],ceil:[At,[At],(l,[n])=>Math.ceil(n.evaluate(l))],"filter-==":[cr,[_r,dr],(l,[n,o])=>l.properties()[n.value]===o.value],"filter-id-==":[cr,[dr],(l,[n])=>l.id()===n.value],"filter-type-==":[cr,[_r],(l,[n])=>l.geometryType()===n.value],"filter-<":[cr,[_r,dr],(l,[n,o])=>{const p=l.properties()[n.value],h=o.value;return typeof p==typeof h&&p<h}],"filter-id-<":[cr,[dr],(l,[n])=>{const o=l.id(),p=n.value;return typeof o==typeof p&&o<p}],"filter->":[cr,[_r,dr],(l,[n,o])=>{const p=l.properties()[n.value],h=o.value;return typeof p==typeof h&&p>h}],"filter-id->":[cr,[dr],(l,[n])=>{const o=l.id(),p=n.value;return typeof o==typeof p&&o>p}],"filter-<=":[cr,[_r,dr],(l,[n,o])=>{const p=l.properties()[n.value],h=o.value;return typeof p==typeof h&&p<=h}],"filter-id-<=":[cr,[dr],(l,[n])=>{const o=l.id(),p=n.value;return typeof o==typeof p&&o<=p}],"filter->=":[cr,[_r,dr],(l,[n,o])=>{const p=l.properties()[n.value],h=o.value;return typeof p==typeof h&&p>=h}],"filter-id->=":[cr,[dr],(l,[n])=>{const o=l.id(),p=n.value;return typeof o==typeof p&&o>=p}],"filter-has":[cr,[dr],(l,[n])=>n.value in l.properties()],"filter-has-id":[cr,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[cr,[Ui(_r)],(l,[n])=>n.value.indexOf(l.geometryType())>=0],"filter-id-in":[cr,[Ui(dr)],(l,[n])=>n.value.indexOf(l.id())>=0],"filter-in-small":[cr,[_r,Ui(dr)],(l,[n,o])=>o.value.indexOf(l.properties()[n.value])>=0],"filter-in-large":[cr,[_r,Ui(dr)],(l,[n,o])=>(function(p,h,b,x){for(;b<=x;){const A=b+x>>1;if(h[A]===p)return!0;h[A]>p?x=A-1:b=A+1}return!1})(l.properties()[n.value],o.value,0,o.value.length-1)],all:{type:cr,overloads:[[[cr,cr],(l,[n,o])=>n.evaluate(l)&&o.evaluate(l)],[Ba(cr),(l,n)=>{for(const o of n)if(!o.evaluate(l))return!1;return!0}]]},any:{type:cr,overloads:[[[cr,cr],(l,[n,o])=>n.evaluate(l)||o.evaluate(l)],[Ba(cr),(l,n)=>{for(const o of n)if(o.evaluate(l))return!0;return!1}]]},"!":[cr,[cr],(l,[n])=>!n.evaluate(l)],"is-supported-script":[cr,[_r],(l,[n])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(n.evaluate(l))}],upcase:[_r,[_r],(l,[n])=>n.evaluate(l).toUpperCase()],downcase:[_r,[_r],(l,[n])=>n.evaluate(l).toLowerCase()],concat:[_r,Ba(dr),(l,n)=>n.map((o=>Vr(o.evaluate(l)))).join("")],"resolved-locale":[_r,[ns],(l,[n])=>n.evaluate(l).resolvedLocale()]});class $f{constructor(n,o,p){this.expression=n,this._warningHistory={},this._evaluator=new xu,this._defaultValue=o?(function(h){if(h.type==="color"&&ad(h.default))return new Tr(0,0,0,0);switch(h.type){case"color":return Tr.parse(h.default)||null;case"padding":return vn.parse(h.default)||null;case"numberArray":return nn.parse(h.default)||null;case"colorArray":return xn.parse(h.default)||null;case"variableAnchorOffsetCollection":return zn.parse(h.default)||null;case"projectionDefinition":return Hn.parse(h.default)||null;default:return h.default===void 0?null:h.default}})(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this._globalState=p}evaluateWithoutErrorHandling(n,o,p,h,b,x){return this._globalState&&(n=Ma(n,this._globalState)),this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=p,this._evaluator.canonical=h,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,o,p,h,b,x){this._globalState&&(n=Ma(n,this._globalState)),this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=p||null,this._evaluator.canonical=h,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new bi(`Expected value to be one of ${Object.keys(this._enumValues).map((T=>JSON.stringify(T))).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function ud(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in wl}function cd(l,n,o){const p=new wu(wl,nd,[],n?(function(b){const x={color:Gi,string:_r,number:At,enum:_r,boolean:cr,formatted:ss,padding:Kn,numberArray:rn,colorArray:vs,projectionDefinition:gn,resolvedImage:Gn,variableAnchorOffsetCollection:hi};return b.type==="array"?Ui(x[b.value]||dr,b.length):x[b.type]})(n):void 0),h=p.parse(l,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Ey(new $f(h,n,o)):El(p.errors)}class dd{constructor(n,o,p){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!Pu(o.expression),this.globalStateRefs=Iu(o.expression),this._globalState=p}evaluateWithoutErrorHandling(n,o,p,h,b,x){return this._globalState&&(n=Ma(n,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(n,o,p,h,b,x)}evaluate(n,o,p,h,b,x){return this._globalState&&(n=Ma(n,this._globalState)),this._styleExpression.evaluate(n,o,p,h,b,x)}}class pd{constructor(n,o,p,h,b){this.kind=n,this.zoomStops=p,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!Pu(o.expression),this.globalStateRefs=Iu(o.expression),this.interpolationType=h,this._globalState=b}evaluateWithoutErrorHandling(n,o,p,h,b,x){return this._globalState&&(n=Ma(n,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(n,o,p,h,b,x)}evaluate(n,o,p,h,b,x){return this._globalState&&(n=Ma(n,this._globalState)),this._styleExpression.evaluate(n,o,p,h,b,x)}interpolationFactor(n,o,p){return this.interpolationType?Hi.interpolationFactor(this.interpolationType,n,o,p):0}}function Zf(l,n,o){const p=cd(l,n,o);if(p.result==="error")return p;const h=p.value.expression,b=sd(h);if(!b&&!Al(n))return El([new Di("","data expressions not supported")]);const x=od(h,["zoom"]);if(!x&&!Ay(n))return El([new Di("","zoom expressions not supported")]);const A=hd(h);return A||x?A instanceof Di?El([A]):A instanceof Hi&&!Lu(n)?El([new Di("",'"interpolate" expressions cannot be used with this property')]):Ey(A?new pd(b?"camera":"composite",p.value,A.labels,A instanceof Hi?A.interpolation:void 0,o):new dd(b?"constant":"source",p.value,o)):El([new Di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fd{constructor(n,o){this._parameters=n,this._specification=o,Vi(this,Kf(this._parameters,this._specification))}static deserialize(n){return new fd(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function hd(l){let n=null;if(l instanceof gl)n=hd(l.result);else if(l instanceof Hc){for(const o of l.args)if(n=hd(o),n)break}else(l instanceof Wo||l instanceof Hi)&&l.input instanceof Es&&l.input.name==="zoom"&&(n=l);return n instanceof Di||l.eachChild((o=>{const p=hd(o);p instanceof Di?n=p:!n&&p?n=new Di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&p&&n!==p&&(n=new Di("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}function Iu(l,n=new Set){return l instanceof ku&&n.add(l.key),l.eachChild((o=>{Iu(o,n)})),n}function Ma(l,n){const{zoom:o,heatmapDensity:p,elevation:h,lineProgress:b,isSupportedScript:x,accumulated:A}=l??{};return{zoom:o,heatmapDensity:p,elevation:h,lineProgress:b,isSupportedScript:x,accumulated:A,globalState:n}}function md(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const n of l.slice(1))if(!md(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const L0={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Bu(l,n){if(l==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};md(l)||(l=Mu(l));const o=cd(l,L0,n);if(o.result==="error")throw new Error(o.value.map((p=>`${p.key}: ${p.message}`)).join(", "));return{filter:(p,h,b)=>o.value.evaluate(p,h,{},b),needGeometry:Ry(l),getGlobalStateRefs:()=>Iu(o.value.expression)}}function D0(l,n){return l<n?-1:l>n?1:0}function Ry(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let n=1;n<l.length;n++)if(Ry(l[n]))return!0;return!1}function Mu(l){if(!l)return!0;const n=l[0];return l.length<=1?n!=="any":n==="=="?yd(l[1],l[2],"=="):n==="!="?Rl(yd(l[1],l[2],"==")):n==="<"||n===">"||n==="<="||n===">="?yd(l[1],l[2],n):n==="any"?(o=l.slice(1),["any"].concat(o.map(Mu))):n==="all"?["all"].concat(l.slice(1).map(Mu)):n==="none"?["all"].concat(l.slice(1).map(Mu).map(Rl)):n==="in"?gd(l[1],l.slice(2)):n==="!in"?Rl(gd(l[1],l.slice(2))):n==="has"?_d(l[1]):n!=="!has"||Rl(_d(l[1]));var o}function yd(l,n,o){switch(l){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,l,n]}}function gd(l,n){if(n.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((o=>typeof o!=typeof n[0]))?["filter-in-large",l,["literal",n.sort(D0)]]:["filter-in-small",l,["literal",n]]}}function _d(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Rl(l){return["!",l]}function zu(l){const n=typeof l;if(n==="number"||n==="boolean"||n==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let h="[";for(const b of l)h+=`${zu(b)},`;return`${h}]`}const o=Object.keys(l).sort();let p="{";for(let h=0;h<o.length;h++)p+=`${JSON.stringify(o[h])}:${zu(l[o[h]])},`;return`${p}}`}function bd(l){let n="";for(const o of yr)n+=`/${zu(l[o])}`;return n}function Sy(l){const n=l.value;return n?[new pt(l.key,n,"constants have been deprecated as of v8")]:[]}function Bi(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function za(l){if(Array.isArray(l))return l.map(za);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const n={};for(const o in l)n[o]=za(l[o]);return n}return Bi(l)}function As(l){const n=l.key,o=l.value,p=l.valueSpec||{},h=l.objectElementValidators||{},b=l.style,x=l.styleSpec,A=l.validateSpec;let T=[];const I=zr(o);if(I!=="object")return[new pt(n,o,`object expected, ${I} found`)];for(const z in o){const q=z.split(".")[0],Z=vr(p,q)||p["*"];let H;if(vr(h,q))H=h[q];else if(vr(p,q))H=A;else if(h["*"])H=h["*"];else{if(!p["*"]){T.push(new pt(n,o[z],`unknown property "${z}"`));continue}H=A}T=T.concat(H({key:(n&&`${n}.`)+z,value:o[z],valueSpec:Z,style:b,styleSpec:x,object:o,objectKey:z,validateSpec:A},o))}for(const z in p)h[z]||p[z].required&&p[z].default===void 0&&o[z]===void 0&&T.push(new pt(n,o,`missing required property "${z}"`));return T}function Hf(l){const n=l.value,o=l.valueSpec,p=l.style,h=l.styleSpec,b=l.key,x=l.arrayElementValidator||l.validateSpec;if(zr(n)!=="array")return[new pt(b,n,`array expected, ${zr(n)} found`)];if(o.length&&n.length!==o.length)return[new pt(b,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new pt(b,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let A={type:o.value,values:o.values};h.$version<7&&(A.function=o.function),zr(o.value)==="object"&&(A=o.value);let T=[];for(let I=0;I<n.length;I++)T=T.concat(x({array:n,arrayIndex:I,value:n[I],valueSpec:A,validateSpec:l.validateSpec,style:p,styleSpec:h,key:`${b}[${I}]`}));return T}function vd(l){const n=l.key,o=l.value,p=l.valueSpec;let h=zr(o);return h==="number"&&o!=o&&(h="NaN"),h!=="number"?[new pt(n,o,`number expected, ${h} found`)]:"minimum"in p&&o<p.minimum?[new pt(n,o,`${o} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&o>p.maximum?[new pt(n,o,`${o} is greater than the maximum value ${p.maximum}`)]:[]}function Xf(l){const n=l.valueSpec,o=Bi(l.value.type);let p,h,b,x={};const A=o!=="categorical"&&l.value.property===void 0,T=!A,I=zr(l.value.stops)==="array"&&zr(l.value.stops[0])==="array"&&zr(l.value.stops[0][0])==="object",z=As({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(H){if(o==="identity")return[new pt(H.key,H.value,'identity function may not have a "stops" property')];let Y=[];const ne=H.value;return Y=Y.concat(Hf({key:H.key,value:ne,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:q})),zr(ne)==="array"&&ne.length===0&&Y.push(new pt(H.key,ne,"array must have at least one stop")),Y},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:n,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return o==="identity"&&A&&z.push(new pt(l.key,l.value,'missing required property "property"')),o==="identity"||l.value.stops||z.push(new pt(l.key,l.value,'missing required property "stops"')),o==="exponential"&&l.valueSpec.expression&&!Lu(l.valueSpec)&&z.push(new pt(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(T&&!Al(l.valueSpec)?z.push(new pt(l.key,l.value,"property functions not supported")):A&&!Ay(l.valueSpec)&&z.push(new pt(l.key,l.value,"zoom functions not supported"))),o!=="categorical"&&!I||l.value.property!==void 0||z.push(new pt(l.key,l.value,'"property" property is required')),z;function q(H){let Y=[];const ne=H.value,ae=H.key;if(zr(ne)!=="array")return[new pt(ae,ne,`array expected, ${zr(ne)} found`)];if(ne.length!==2)return[new pt(ae,ne,`array length 2 expected, length ${ne.length} found`)];if(I){if(zr(ne[0])!=="object")return[new pt(ae,ne,`object expected, ${zr(ne[0])} found`)];if(ne[0].zoom===void 0)return[new pt(ae,ne,"object stop key must have zoom")];if(ne[0].value===void 0)return[new pt(ae,ne,"object stop key must have value")];if(b&&b>Bi(ne[0].zoom))return[new pt(ae,ne[0].zoom,"stop zoom values must appear in ascending order")];Bi(ne[0].zoom)!==b&&(b=Bi(ne[0].zoom),h=void 0,x={}),Y=Y.concat(As({key:`${ae}[0]`,value:ne[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:vd,value:Z}}))}else Y=Y.concat(Z({key:`${ae}[0]`,value:ne[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},ne));return ud(za(ne[1]))?Y.concat([new pt(`${ae}[1]`,ne[1],"expressions are not allowed in function stops.")]):Y.concat(H.validateSpec({key:`${ae}[1]`,value:ne[1],valueSpec:n,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function Z(H,Y){const ne=zr(H.value),ae=Bi(H.value),ge=H.value!==null?H.value:Y;if(p){if(ne!==p)return[new pt(H.key,ge,`${ne} stop domain type must match previous stop domain type ${p}`)]}else p=ne;if(ne!=="number"&&ne!=="string"&&ne!=="boolean")return[new pt(H.key,ge,"stop domain value must be a number, string, or boolean")];if(ne!=="number"&&o!=="categorical"){let qe=`number expected, ${ne} found`;return Al(n)&&o===void 0&&(qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(H.key,ge,qe)]}return o!=="categorical"||ne!=="number"||isFinite(ae)&&Math.floor(ae)===ae?o!=="categorical"&&ne==="number"&&h!==void 0&&ae<h?[new pt(H.key,ge,"stop domain values must appear in ascending order")]:(h=ae,o==="categorical"&&ae in x?[new pt(H.key,ge,"stop domain values must be unique")]:(x[ae]=!0,[])):[new pt(H.key,ge,`integer expected, found ${ae}`)]}}function Oa(l){const n=(l.expressionContext==="property"?Zf:cd)(za(l.value),l.valueSpec);if(n.result==="error")return n.value.map((p=>new pt(`${l.key}${p.key}`,l.value,p.message)));const o=n.value.expression||n.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!o.outputDefined())return[new pt(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!Pu(o))return[new pt(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!Pu(o))return[new pt(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!od(o,["zoom","feature-state"]))return[new pt(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!sd(o))return[new pt(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Sl(l){const n=l.key,o=l.value,p=zr(o);return p!=="string"?[new pt(n,o,`color expected, ${p} found`)]:Tr.parse(String(o))?[]:[new pt(n,o,`color expected, "${o}" found`)]}function Ou(l){const n=l.key,o=l.value,p=l.valueSpec,h=[];return Array.isArray(p.values)?p.values.indexOf(Bi(o))===-1&&h.push(new pt(n,o,`expected one of [${p.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(p.values).indexOf(Bi(o))===-1&&h.push(new pt(n,o,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(o)} found`)),h}function xd(l){return md(za(l.value))?Oa(Vi({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Wf(l)}function Wf(l){const n=l.value,o=l.key;if(zr(n)!=="array")return[new pt(o,n,`array expected, ${zr(n)} found`)];const p=l.styleSpec;let h,b=[];if(n.length<1)return[new pt(o,n,"filter array must have at least 1 element")];switch(b=b.concat(Ou({key:`${o}[0]`,value:n[0],valueSpec:p.filter_operator,style:l.style,styleSpec:l.styleSpec})),Bi(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&Bi(n[1])==="$type"&&b.push(new pt(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&b.push(new pt(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(h=zr(n[1]),h!=="string"&&b.push(new pt(`${o}[1]`,n[1],`string expected, ${h} found`)));for(let x=2;x<n.length;x++)h=zr(n[x]),Bi(n[1])==="$type"?b=b.concat(Ou({key:`${o}[${x}]`,value:n[x],valueSpec:p.geometry_type,style:l.style,styleSpec:l.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&b.push(new pt(`${o}[${x}]`,n[x],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)b=b.concat(Wf({key:`${o}[${x}]`,value:n[x],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":h=zr(n[1]),n.length!==2?b.push(new pt(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):h!=="string"&&b.push(new pt(`${o}[1]`,n[1],`string expected, ${h} found`))}return b}function Ty(l,n){const o=l.key,p=l.validateSpec,h=l.style,b=l.styleSpec,x=l.value,A=l.objectKey,T=b[`${n}_${l.layerType}`];if(!T)return[];const I=A.match(/^(.*)-transition$/);if(n==="paint"&&I&&T[I[1]]&&T[I[1]].transition)return p({key:o,value:x,valueSpec:b.transition,style:h,styleSpec:b});const z=l.valueSpec||T[A];if(!z)return[new pt(o,x,`unknown property "${A}"`)];let q;if(zr(x)==="string"&&Al(z)&&!z.tokens&&(q=/^{([^}]+)}$/.exec(x)))return[new pt(o,x,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(q[1])} }\`.`)];const Z=[];return l.layerType==="symbol"&&(A==="text-field"&&h&&!h.glyphs&&Z.push(new pt(o,x,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&ad(za(x))&&Bi(x.type)==="identity"&&Z.push(new pt(o,x,'"text-font" does not support identity functions'))),Z.concat(p({key:l.key,value:x,valueSpec:z,style:h,styleSpec:b,expressionContext:"property",propertyType:n,propertyKey:A}))}function Yf(l){return Ty(l,"paint")}function Jf(l){return Ty(l,"layout")}function Tl(l){let n=[];const o=l.value,p=l.key,h=l.style,b=l.styleSpec;if(zr(o)!=="object")return[new pt(p,o,`object expected, ${zr(o)} found`)];o.type||o.ref||n.push(new pt(p,o,'either "type" or "ref" is required'));let x=Bi(o.type);const A=Bi(o.ref);if(o.id){const T=Bi(o.id);for(let I=0;I<l.arrayIndex;I++){const z=h.layers[I];Bi(z.id)===T&&n.push(new pt(p,o.id,`duplicate layer id "${o.id}", previously used at line ${z.id.__line__}`))}}if("ref"in o){let T;["type","source","source-layer","filter","layout"].forEach((I=>{I in o&&n.push(new pt(p,o[I],`"${I}" is prohibited for ref layers`))})),h.layers.forEach((I=>{Bi(I.id)===A&&(T=I)})),T?T.ref?n.push(new pt(p,o.ref,"ref cannot reference another ref layer")):x=Bi(T.type):n.push(new pt(p,o.ref,`ref layer "${A}" not found`))}else if(x!=="background")if(o.source){const T=h.sources&&h.sources[o.source],I=T&&Bi(T.type);T?I==="vector"&&x==="raster"?n.push(new pt(p,o.source,`layer "${o.id}" requires a raster source`)):I!=="raster-dem"&&x==="hillshade"||I!=="raster-dem"&&x==="color-relief"?n.push(new pt(p,o.source,`layer "${o.id}" requires a raster-dem source`)):I==="raster"&&x!=="raster"?n.push(new pt(p,o.source,`layer "${o.id}" requires a vector source`)):I!=="vector"||o["source-layer"]?I==="raster-dem"&&x!=="hillshade"&&x!=="color-relief"?n.push(new pt(p,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||I==="geojson"&&T.lineMetrics||n.push(new pt(p,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new pt(p,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new pt(p,o.source,`source "${o.source}" not found`))}else n.push(new pt(p,o,'missing required property "source"'));return n=n.concat(As({key:p,value:o,valueSpec:b.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${p}.type`,value:o.type,valueSpec:b.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:o,objectKey:"type"}),filter:xd,layout:T=>As({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":I=>Jf(Vi({layerType:x},I))}}),paint:T=>As({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":I=>Yf(Vi({layerType:x},I))}})}})),n}function Va(l){const n=l.value,o=l.key,p=zr(n);return p!=="string"?[new pt(o,n,`string expected, ${p} found`)]:[]}const Cy={promoteId:function({key:l,value:n}){if(zr(n)==="string")return Va({key:l,value:n});{const o=[];for(const p in n)o.push(...Va({key:`${l}.${p}`,value:n[p]}));return o}}};function ky(l){const n=l.value,o=l.key,p=l.styleSpec,h=l.style,b=l.validateSpec;if(!n.type)return[new pt(o,n,'"type" is required')];const x=Bi(n.type);let A;switch(x){case"vector":case"raster":return A=As({key:o,value:n,valueSpec:p[`source_${x.replace("-","_")}`],style:l.style,styleSpec:p,objectElementValidators:Cy,validateSpec:b}),A;case"raster-dem":return A=(function(T){var I;const z=(I=T.sourceName)!==null&&I!==void 0?I:"",q=T.value,Z=T.styleSpec,H=Z.source_raster_dem,Y=T.style;let ne=[];const ae=zr(q);if(q===void 0)return ne;if(ae!=="object")return ne.push(new pt("source_raster_dem",q,`object expected, ${ae} found`)),ne;const ge=Bi(q.encoding)==="custom",qe=["redFactor","greenFactor","blueFactor","baseShift"],Ce=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const ze in q)!ge&&qe.includes(ze)?ne.push(new pt(ze,q[ze],`In "${z}": "${ze}" is only valid when "encoding" is set to "custom". ${Ce} encoding found`)):H[ze]?ne=ne.concat(T.validateSpec({key:ze,value:q[ze],valueSpec:H[ze],validateSpec:T.validateSpec,style:Y,styleSpec:Z})):ne.push(new pt(ze,q[ze],`unknown property "${ze}"`));return ne})({sourceName:o,value:n,style:l.style,styleSpec:p,validateSpec:b}),A;case"geojson":if(A=As({key:o,value:n,valueSpec:p.source_geojson,style:h,styleSpec:p,validateSpec:b,objectElementValidators:Cy}),n.cluster)for(const T in n.clusterProperties){const[I,z]=n.clusterProperties[T],q=typeof I=="string"?[I,["accumulated"],["get",T]]:I;A.push(...Oa({key:`${o}.${T}.map`,value:z,expressionContext:"cluster-map"})),A.push(...Oa({key:`${o}.${T}.reduce`,value:q,expressionContext:"cluster-reduce"}))}return A;case"video":return As({key:o,value:n,valueSpec:p.source_video,style:h,validateSpec:b,styleSpec:p});case"image":return As({key:o,value:n,valueSpec:p.source_image,style:h,validateSpec:b,styleSpec:p});case"canvas":return[new pt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ou({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Py(l){const n=l.value,o=l.styleSpec,p=o.light,h=l.style;let b=[];const x=zr(n);if(n===void 0)return b;if(x!=="object")return b=b.concat([new pt("light",n,`object expected, ${x} found`)]),b;for(const A in n){const T=A.match(/^(.*)-transition$/);b=b.concat(T&&p[T[1]]&&p[T[1]].transition?l.validateSpec({key:A,value:n[A],valueSpec:o.transition,validateSpec:l.validateSpec,style:h,styleSpec:o}):p[A]?l.validateSpec({key:A,value:n[A],valueSpec:p[A],validateSpec:l.validateSpec,style:h,styleSpec:o}):[new pt(A,n[A],`unknown property "${A}"`)])}return b}function Ly(l){const n=l.value,o=l.styleSpec,p=o.sky,h=l.style,b=zr(n);if(n===void 0)return[];if(b!=="object")return[new pt("sky",n,`object expected, ${b} found`)];let x=[];for(const A in n)x=x.concat(p[A]?l.validateSpec({key:A,value:n[A],valueSpec:p[A],style:h,styleSpec:o}):[new pt(A,n[A],`unknown property "${A}"`)]);return x}function Dy(l){const n=l.value,o=l.styleSpec,p=o.terrain,h=l.style;let b=[];const x=zr(n);if(n===void 0)return b;if(x!=="object")return b=b.concat([new pt("terrain",n,`object expected, ${x} found`)]),b;for(const A in n)b=b.concat(p[A]?l.validateSpec({key:A,value:n[A],valueSpec:p[A],validateSpec:l.validateSpec,style:h,styleSpec:o}):[new pt(A,n[A],`unknown property "${A}"`)]);return b}function Cl(l){let n=[];const o=l.value,p=l.key;if(Array.isArray(o)){const h=[],b=[];for(const x in o)o[x].id&&h.includes(o[x].id)&&n.push(new pt(p,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),h.push(o[x].id),o[x].url&&b.includes(o[x].url)&&n.push(new pt(p,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),b.push(o[x].url),n=n.concat(As({key:`${p}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return n}return Va({key:p,value:o})}function kl(l){return n=l.value,n&&n.constructor===Object?[]:[new pt(l.key,l.value,`object expected, ${zr(l.value)} found`)];var n}const Xn={"*":()=>[],array:Hf,boolean:function(l){const n=l.value,o=l.key,p=zr(n);return p!=="boolean"?[new pt(o,n,`boolean expected, ${p} found`)]:[]},number:vd,color:Sl,constants:Sy,enum:Ou,filter:xd,function:Xf,layer:Tl,object:As,source:ky,light:Py,sky:Ly,terrain:Dy,projection:function(l){const n=l.value,o=l.styleSpec,p=o.projection,h=l.style,b=zr(n);if(n===void 0)return[];if(b!=="object")return[new pt("projection",n,`object expected, ${b} found`)];let x=[];for(const A in n)x=x.concat(p[A]?l.validateSpec({key:A,value:n[A],valueSpec:p[A],style:h,styleSpec:o}):[new pt(A,n[A],`unknown property "${A}"`)]);return x},projectionDefinition:function(l){const n=l.key;let o=l.value;o=o instanceof String?o.valueOf():o;const p=zr(o);return p!=="array"||(function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"})(o)||(function(h){return!!["interpolate","step","literal"].includes(h[0])})(o)?["array","string"].includes(p)?[]:[new pt(n,o,`projection expected, invalid type "${p}" found`)]:[new pt(n,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:Va,formatted:function(l){return Va(l).length===0?[]:Oa(l)},resolvedImage:function(l){return Va(l).length===0?[]:Oa(l)},padding:function(l){const n=l.key,o=l.value;if(zr(o)==="array"){if(o.length<1||o.length>4)return[new pt(n,o,`padding requires 1 to 4 values; ${o.length} values found`)];const p={type:"number"};let h=[];for(let b=0;b<o.length;b++)h=h.concat(l.validateSpec({key:`${n}[${b}]`,value:o[b],validateSpec:l.validateSpec,valueSpec:p}));return h}return vd({key:n,value:o,valueSpec:{}})},numberArray:function(l){const n=l.key,o=l.value;if(zr(o)==="array"){const p={type:"number"};if(o.length<1)return[new pt(n,o,"array length at least 1 expected, length 0 found")];let h=[];for(let b=0;b<o.length;b++)h=h.concat(l.validateSpec({key:`${n}[${b}]`,value:o[b],validateSpec:l.validateSpec,valueSpec:p}));return h}return vd({key:n,value:o,valueSpec:{}})},colorArray:function(l){const n=l.key,o=l.value;if(zr(o)==="array"){if(o.length<1)return[new pt(n,o,"array length at least 1 expected, length 0 found")];let p=[];for(let h=0;h<o.length;h++)p=p.concat(Sl({key:`${n}[${h}]`,value:o[h]}));return p}return Sl({key:n,value:o})},variableAnchorOffsetCollection:function(l){const n=l.key,o=l.value,p=zr(o),h=l.styleSpec;if(p!=="array"||o.length<1||o.length%2!=0)return[new pt(n,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let x=0;x<o.length;x+=2)b=b.concat(Ou({key:`${n}[${x}]`,value:o[x],valueSpec:h.layout_symbol["text-anchor"]})),b=b.concat(Hf({key:`${n}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:h}));return b},sprite:Cl,state:kl};function Yo(l){const n=l.value,o=l.valueSpec,p=l.styleSpec;return l.validateSpec=Yo,o.expression&&ad(Bi(n))?Xf(l):o.expression&&ud(za(n))?Oa(l):o.type&&Xn[o.type]?Xn[o.type](l):As(Vi({},l,{valueSpec:o.type?p[o.type]:o}))}function Qf(l){const n=l.value,o=l.key,p=Va(l);return p.length||(n.indexOf("{fontstack}")===-1&&p.push(new pt(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&p.push(new pt(o,n,'"glyphs" url must include a "{range}" token'))),p}function Rs(l,n=Ke){let o=[];return o=o.concat(Yo({key:"",value:l,valueSpec:n.$root,styleSpec:n,style:l,validateSpec:Yo,objectElementValidators:{glyphs:Qf,"*":()=>[]}})),l.constants&&(o=o.concat(Sy({key:"constants",value:l.constants}))),Pl(o)}function Us(l){return function(n){return l(Object.assign({},n,{validateSpec:Yo}))}}function Pl(l){return[].concat(l).sort(((n,o)=>n.line-o.line))}function Ss(l){return function(...n){return Pl(l.apply(this,n))}}Rs.source=Ss(Us(ky)),Rs.sprite=Ss(Us(Cl)),Rs.glyphs=Ss(Us(Qf)),Rs.light=Ss(Us(Py)),Rs.sky=Ss(Us(Ly)),Rs.terrain=Ss(Us(Dy)),Rs.state=Ss(Us(kl)),Rs.layer=Ss(Us(Tl)),Rs.filter=Ss(Us(xd)),Rs.paintProperty=Ss(Us(Yf)),Rs.layoutProperty=Ss(Us(Jf));const Jo=Rs,I0=Jo.light,eh=Jo.sky,B0=Jo.paintProperty,Vu=Jo.layoutProperty;function Iy(l,n){let o=!1;if(n&&n.length)for(const p of n)l.fire(new Mt(new Error(p.message))),o=!0;return o}class Uu{constructor(n,o,p){const h=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(o=x[1])+2*(p=x[2]);for(let T=0;T<this.d*this.d;T++){const I=x[3+T],z=x[3+T+1];h.push(I===z?null:x.subarray(I,z))}const A=x[3+h.length+1];this.keys=x.subarray(x[3+h.length],A),this.bboxes=x.subarray(A),this.insert=this._insertReadonly}else{this.d=o+2*p;for(let x=0;x<this.d*this.d;x++)h.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=p,this.scale=o/n,this.uid=0;const b=p/o*n;this.min=-b,this.max=n+b}insert(n,o,p,h,b){this._forEachCell(o,p,h,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,o,p,h,b,x){this.cells[b].push(x)}query(n,o,p,h,b){const x=this.min,A=this.max;if(n<=x&&o<=x&&A<=p&&A<=h&&!b)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(n,o,p,h,this._queryCell,T,{},b),T}}_queryCell(n,o,p,h,b,x,A,T){const I=this.cells[b];if(I!==null){const z=this.keys,q=this.bboxes;for(let Z=0;Z<I.length;Z++){const H=I[Z];if(A[H]===void 0){const Y=4*H;(T?T(q[Y+0],q[Y+1],q[Y+2],q[Y+3]):n<=q[Y+2]&&o<=q[Y+3]&&p>=q[Y+0]&&h>=q[Y+1])?(A[H]=!0,x.push(z[H])):A[H]=!1}}}}_forEachCell(n,o,p,h,b,x,A,T){const I=this._convertToCellCoord(n),z=this._convertToCellCoord(o),q=this._convertToCellCoord(p),Z=this._convertToCellCoord(h);for(let H=I;H<=q;H++)for(let Y=z;Y<=Z;Y++){const ne=this.d*Y+H;if((!T||T(this._convertFromCellCoord(H),this._convertFromCellCoord(Y),this._convertFromCellCoord(H+1),this._convertFromCellCoord(Y+1)))&&b.call(this,n,o,p,h,ne,x,A,T))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,o=3+this.cells.length+1+1;let p=0;for(let x=0;x<this.cells.length;x++)p+=this.cells[x].length;const h=new Int32Array(o+p+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let b=o;for(let x=0;x<n.length;x++){const A=n[x];h[3+x]=b,h.set(A,b),b+=A.length}return h[3+n.length]=b,h.set(this.keys,b),b+=this.keys.length,h[3+n.length+1]=b,h.set(this.bboxes,b),b+=this.bboxes.length,h.buffer}static serialize(n,o){const p=n.toArrayBuffer();return o&&o.push(p),{buffer:p}}static deserialize(n){return new Uu(n.buffer)}}const Co={};function It(l,n,o={}){if(Co[l])throw new Error(`${l} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:l,writeable:!1}),Co[l]={klass:n,omit:o.omit||[],shallow:o.shallow||[]}}It("Object",Object),It("Set",Set),It("TransferableGridIndex",Uu),It("Color",Tr),It("Error",Error),It("AJAXError",Se),It("ResolvedImage",os),It("StylePropertyFunction",fd),It("StyleExpression",$f,{omit:["_evaluator"]}),It("ZoomDependentExpression",pd),It("ZoomConstantExpression",dd),It("CompoundExpression",Es,{omit:["_evaluate"]});for(const l in wl)wl[l]._classRegistryKey||It(`Expression_${l}`,wl[l]);function By(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function th(l){return l.$name||l.constructor._classRegistryKey}function ju(l){return!(function(n){if(n===null||typeof n!="object")return!1;const o=th(n);return!(!o||o==="Object")})(l)&&(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||By(l)||er(l)||ArrayBuffer.isView(l)||l instanceof ImageData)}function Nu(l,n){if(ju(l))return(By(l)||er(l))&&n&&n.push(l),ArrayBuffer.isView(l)&&n&&n.push(l.buffer),l instanceof ImageData&&n&&n.push(l.data.buffer),l;if(Array.isArray(l)){const b=[];for(const x of l)b.push(Nu(x,n));return b}if(typeof l!="object")throw new Error("can't serialize object of type "+typeof l);const o=th(l);if(!o)throw new Error(`can't serialize object of unregistered class ${l.constructor.name}`);if(!Co[o])throw new Error(`${o} is not registered.`);const{klass:p}=Co[o],h=p.serialize?p.serialize(l,n):{};if(p.serialize){if(n&&h===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in l){if(!l.hasOwnProperty(b)||Co[o].omit.indexOf(b)>=0)continue;const x=l[b];h[b]=Co[o].shallow.indexOf(b)>=0?x:Nu(x,n)}l instanceof Error&&(h.message=l.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(h.$name=o),h}function Ua(l){if(ju(l))return l;if(Array.isArray(l))return l.map(Ua);if(typeof l!="object")throw new Error("can't deserialize object of type "+typeof l);const n=th(l)||"Object";if(!Co[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:o}=Co[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(l);const p=Object.create(o.prototype);for(const h of Object.keys(l)){if(h==="$name")continue;const b=l[h];p[h]=Co[n].shallow.indexOf(h)>=0?b:Ua(b)}return p}class Ll{constructor(){this.first=!0}update(n,o){const p=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=o),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=p,!0))}}const Or={"Latin-1 Supplement":l=>l>=128&&l<=255,"Hangul Jamo":l=>l>=4352&&l<=4607,Khmer:l=>l>=6016&&l<=6143,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Kanbun:l=>l>=12688&&l<=12703,"CJK Strokes":l=>l>=12736&&l<=12783,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Hangul Syllables":l=>l>=44032&&l<=55215,"Private Use Area":l=>l>=57344&&l<=63743,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function wd(l){for(const n of l)if(Ad(n.charCodeAt(0)))return!0;return!1}function My(l){for(const n of l)if(!zy(n.charCodeAt(0)))return!1;return!0}function Ed(l){const n=l.map((o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}})).filter((o=>o));return new RegExp(n.join("|"),"u")}const rh=Ed(["Arab","Dupl","Mong","Ougr","Syrc"]);function zy(l){return!rh.test(String.fromCodePoint(l))}const Oy=Ed(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ad(l){return!(l!==746&&l!==747&&(l<4352||!(Or["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Or["CJK Compatibility"](l)||Or["CJK Strokes"](l)||!(!Or["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Or["Enclosed CJK Letters and Months"](l)||Or["Ideographic Description Characters"](l)||Or.Kanbun(l)||Or.Katakana(l)&&l!==12540||!(!Or["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Or["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Or["Vertical Forms"](l)||Or["Yijing Hexagram Symbols"](l)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(l))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(l))||Oy.test(String.fromCodePoint(l)))))}function Vy(l){return!(Ad(l)||(function(n){return!!(Or["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Or["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Or["Letterlike Symbols"](n)||Or["Number Forms"](n)||Or["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Or["Control Pictures"](n)&&n!==9251||Or["Optical Character Recognition"](n)||Or["Enclosed Alphanumerics"](n)||Or["Geometric Shapes"](n)||Or["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Or["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Or["CJK Symbols and Punctuation"](n)||Or.Katakana(n)||Or["Private Use Area"](n)||Or["CJK Compatibility Forms"](n)||Or["Small Form Variants"](n)||Or["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)})(l))}const Uy=Ed(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function jy(l){return Uy.test(String.fromCodePoint(l))}function Ny(l,n){return!(!n&&jy(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Or.Khmer(l))}function Fy(l){for(const n of l)if(jy(n.charCodeAt(0)))return!0;return!1}const Qo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){if(Qo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(l,n){return a(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(l.pluginStatus!=="loading")return this.setState(l),l;const o=l.pluginURL,p=new Promise((b=>{this.loadScriptResolve=b}));n(o);const h=new Promise((b=>setTimeout((()=>b()),this.TIMEOUT)));if(yield Promise.race([p,h]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:o};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)}))}};class mi{constructor(n,o){this.isSupportedScript=qy,this.zoom=n,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new Ll,this.transition=o.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ll,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,o=n-Math.floor(n),p=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*o}}}function qy(l){return(function(n,o){for(const p of n)if(!Ny(p.charCodeAt(0),o))return!1;return!0})(l,Qo.getRTLTextPluginStatus()==="loaded")}class Fu{constructor(n,o,p){this.property=n,this.value=o,this.expression=(function(h,b,x){if(ad(h))return new fd(h,b);if(ud(h)){const A=Zf(h,b,x);if(A.result==="error")throw new Error(A.value.map((T=>`${T.key}: ${T.message}`)).join(", "));return A.value}{let A=h;return b.type==="color"&&typeof h=="string"?A=Tr.parse(h):b.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?b.type!=="numberArray"||typeof h!="number"&&!Array.isArray(h)?b.type!=="colorArray"||typeof h!="string"&&!Array.isArray(h)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(h)?A=zn.parse(h):b.type==="projectionDefinition"&&typeof h=="string"&&(A=Hn.parse(h)):A=xn.parse(h):A=nn.parse(h):A=vn.parse(h),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>A}}})(o===void 0?n.specification.default:o,n.specification,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(n,o,p){return this.property.possiblyEvaluate(this,n,o,p)}}class Rd{constructor(n,o){this.property=n,this.value=new Fu(n,void 0,o)}transitioned(n,o){return new qu(this.property,this.value,o,lr({},n.transition,this.transition),n.now)}untransitioned(){return new qu(this.property,this.value,null,{},0)}}class ih{constructor(n,o){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._globalState=o}getValue(n){return sr(this._values[n].value.value)}setValue(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Rd(this._values[n].property,this._globalState)),this._values[n].value=new Fu(this._values[n].property,o===null?void 0:sr(o),this._globalState)}getTransition(n){return sr(this._values[n].transition)}setTransition(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Rd(this._values[n].property,this._globalState)),this._values[n].transition=sr(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const p=this.getValue(o);p!==void 0&&(n[o]=p);const h=this.getTransition(o);h!==void 0&&(n[`${o}-transition`]=h)}return n}transitioned(n,o){const p=new Ky(this._properties);for(const h of Object.keys(this._values))p._values[h]=this._values[h].transitioned(n,o._values[h]);return p}untransitioned(){const n=new Ky(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class qu{constructor(n,o,p,h,b){this.property=n,this.value=o,this.begin=b+h.delay||0,this.end=this.begin+h.duration||0,n.specification.transition&&(h.delay||h.duration)&&(this.prior=p)}possiblyEvaluate(n,o,p){const h=n.now||0,b=this.value.possiblyEvaluate(n,o,p),x=this.prior;if(x){if(h>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(h<this.begin)return x.possiblyEvaluate(n,o,p);{const A=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,o,p),b,Le(A))}}return b}}class Ky{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,p){const h=new Sd(this._properties);for(const b of Object.keys(this._values))h._values[b]=this._values[b].possiblyEvaluate(n,o,p);return h}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class nh{constructor(n,o){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._globalState=o}hasValue(n){return this._values[n].value!==void 0}getValue(n){return sr(this._values[n].value)}setValue(n,o){this._values[n]=new Fu(this._values[n].property,o===null?void 0:sr(o),this._globalState)}serialize(){const n={};for(const o of Object.keys(this._values)){const p=this.getValue(o);p!==void 0&&(n[o]=p)}return n}possiblyEvaluate(n,o,p){const h=new Sd(this._properties);for(const b of Object.keys(this._values))h._values[b]=this._values[b].possiblyEvaluate(n,o,p);return h}}class uo{constructor(n,o,p){this.property=n,this.value=o,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,p,h){return this.property.evaluate(this.value,this.parameters,n,o,p,h)}}class Sd{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Kt{constructor(n){this.specification=n}possiblyEvaluate(n,o){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(o)}interpolate(n,o,p){const h=ws[this.specification.type];return h?h(n,o,p):n}}class rr{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,p,h){return new uo(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},p,h)}:n.expression,o)}interpolate(n,o,p){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new uo(this,{kind:"constant",value:void 0},n.parameters);const h=ws[this.specification.type];if(h){const b=h(n.value.value,o.value.value,p);return new uo(this,{kind:"constant",value:b},n.parameters)}return n}evaluate(n,o,p,h,b,x){return n.kind==="constant"?n.value:n.evaluate(o,p,h,b,x)}}class Dl extends rr{possiblyEvaluate(n,o,p,h){if(n.value===void 0)return new uo(this,{kind:"constant",value:void 0},o);if(n.expression.kind==="constant"){const b=n.expression.evaluate(o,null,{},p,h),x=n.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,A=this._calculate(x,x,x,o);return new uo(this,{kind:"constant",value:A},o)}if(n.expression.kind==="camera"){const b=this._calculate(n.expression.evaluate({zoom:o.zoom-1}),n.expression.evaluate({zoom:o.zoom}),n.expression.evaluate({zoom:o.zoom+1}),o);return new uo(this,{kind:"constant",value:b},o)}return new uo(this,n.expression,o)}evaluate(n,o,p,h,b,x){if(n.kind==="source"){const A=n.evaluate(o,p,h,b,x);return this._calculate(A,A,A,o)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(o.zoom)-1},p,h),n.evaluate({zoom:Math.floor(o.zoom)},p,h),n.evaluate({zoom:Math.floor(o.zoom)+1},p,h),o):n.value}_calculate(n,o,p,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:p,to:o}}interpolate(n){return n}}class Gy{constructor(n){this.specification=n}possiblyEvaluate(n,o,p,h){if(n.value!==void 0){if(n.expression.kind==="constant"){const b=n.expression.evaluate(o,null,{},p,h);return this._calculate(b,b,b,o)}return this._calculate(n.expression.evaluate(new mi(Math.floor(o.zoom-1),o)),n.expression.evaluate(new mi(Math.floor(o.zoom),o)),n.expression.evaluate(new mi(Math.floor(o.zoom+1),o)),o)}}_calculate(n,o,p,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:p,to:o}}interpolate(n){return n}}class Td{constructor(n){this.specification=n}possiblyEvaluate(n,o,p,h){return!!n.expression.evaluate(o,null,{},p,h)}interpolate(){return!1}}class On{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in n){const p=n[o];p.specification.overridable&&this.overridableProperties.push(o);const h=this.defaultPropertyValues[o]=new Fu(p,void 0,void 0),b=this.defaultTransitionablePropertyValues[o]=new Rd(p,void 0);this.defaultTransitioningPropertyValues[o]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=h.possiblyEvaluate({})}}}It("DataDrivenProperty",rr),It("DataConstantProperty",Kt),It("CrossFadedDataDrivenProperty",Dl),It("CrossFadedProperty",Gy),It("ColorRampProperty",Td);const $y="-transition";class js extends qt{constructor(n,o,p){if(super(),this.id=n.id,this.type=n.type,this._globalState=p,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter,this._featureFilter=Bu(n.filter,p)),o.layout&&(this._unevaluatedLayout=new nh(o.layout,p)),o.paint)){this._transitionablePaint=new ih(o.paint,p);for(const h in n.paint)this.setPaintProperty(h,n.paint[h],{validate:!1});for(const h in n.layout)this.setLayoutProperty(h,n.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Sd(o.paint)}}setFilter(n){this.filter=n,this._featureFilter=Bu(n,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}getLayoutAffectingGlobalStateRefs(){const n=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[o];for(const h of p.getGlobalStateRefs())n.add(h)}for(const o of this._featureFilter.getGlobalStateRefs())n.add(o);return n}getPaintAffectingGlobalStateRefs(){var n;const o=new globalThis.Map;if(this._transitionablePaint)for(const p in this._transitionablePaint._values){const h=this._transitionablePaint._values[p].value;for(const b of h.getGlobalStateRefs()){const x=(n=o.get(b))!==null&&n!==void 0?n:[];x.push({name:p,value:h.value}),o.set(b,x)}}return o}setLayoutProperty(n,o,p={}){o!=null&&this._validate(Vu,`layers.${this.id}.layout.${n}`,n,o,p)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return n.endsWith($y)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,p={}){if(o!=null&&this._validate(B0,`layers.${this.id}.paint.${n}`,n,o,p))return!1;if(n.endsWith($y))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const h=this._transitionablePaint._values[n],b=h.property.specification["property-type"]==="cross-faded-data-driven",x=h.value.isDataDriven(),A=h.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const T=this._transitionablePaint._values[n].value;return T.isDataDriven()||x||b||this._handleOverridablePaintPropertyUpdate(n,A,T)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,o,p){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),$r(n,((o,p)=>!(o===void 0||p==="layout"&&!Object.keys(o).length||p==="paint"&&!Object.keys(o).length)))}_validate(n,o,p,h,b={}){return(!b||b.validate!==!1)&&Iy(this,n.call(Jo,{key:o,layerType:this.type,objectKey:p,value:h,styleSpec:Ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof uo&&Al(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}let ja;var M0={get paint(){return ja=ja||new On({"raster-opacity":new Kt(Ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kt(Ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kt(Ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kt(Ke.paint_raster["raster-brightness-max"]),"raster-saturation":new Kt(Ke.paint_raster["raster-saturation"]),"raster-contrast":new Kt(Ke.paint_raster["raster-contrast"]),"raster-resampling":new Kt(Ke.paint_raster["raster-resampling"]),"raster-fade-duration":new Kt(Ke.paint_raster["raster-fade-duration"])})}};class z0 extends js{constructor(n,o){super(n,M0,o)}}const O0={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Il{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ai{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Mi(l,n=1){let o=0,p=0;return{members:l.map((h=>{const b=O0[h.type].BYTES_PER_ELEMENT,x=o=ea(o,Math.max(n,b)),A=h.components||1;return p=Math.max(p,b),o+=b*A,{name:h.name,type:h.type,components:A,offset:x}})),size:ea(o,Math.max(p,n)),alignment:n}}function ea(l,n){return Math.ceil(l/n)*n}class Bl extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const p=this.length;return this.resize(p+1),this.emplace(p,n,o)}emplace(n,o,p){const h=2*n;return this.int16[h+0]=o,this.int16[h+1]=p,n}}Bl.prototype.bytesPerElement=4,It("StructArrayLayout2i4",Bl);class Ml extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p){const h=this.length;return this.resize(h+1),this.emplace(h,n,o,p)}emplace(n,o,p,h){const b=3*n;return this.int16[b+0]=o,this.int16[b+1]=p,this.int16[b+2]=h,n}}Ml.prototype.bytesPerElement=6,It("StructArrayLayout3i6",Ml);class Cd extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p,h){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,p,h)}emplace(n,o,p,h,b){const x=4*n;return this.int16[x+0]=o,this.int16[x+1]=p,this.int16[x+2]=h,this.int16[x+3]=b,n}}Cd.prototype.bytesPerElement=8,It("StructArrayLayout4i8",Cd);class Ku extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,n,o,p,h,b,x)}emplace(n,o,p,h,b,x,A){const T=6*n;return this.int16[T+0]=o,this.int16[T+1]=p,this.int16[T+2]=h,this.int16[T+3]=b,this.int16[T+4]=x,this.int16[T+5]=A,n}}Ku.prototype.bytesPerElement=12,It("StructArrayLayout2i4i12",Ku);class sh extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,n,o,p,h,b,x)}emplace(n,o,p,h,b,x,A){const T=4*n,I=8*n;return this.int16[T+0]=o,this.int16[T+1]=p,this.uint8[I+4]=h,this.uint8[I+5]=b,this.uint8[I+6]=x,this.uint8[I+7]=A,n}}sh.prototype.bytesPerElement=8,It("StructArrayLayout2i4ub8",sh);class ta extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const p=this.length;return this.resize(p+1),this.emplace(p,n,o)}emplace(n,o,p){const h=2*n;return this.float32[h+0]=o,this.float32[h+1]=p,n}}ta.prototype.bytesPerElement=8,It("StructArrayLayout2f8",ta);class Na extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x,A,T,I,z){const q=this.length;return this.resize(q+1),this.emplace(q,n,o,p,h,b,x,A,T,I,z)}emplace(n,o,p,h,b,x,A,T,I,z,q){const Z=10*n;return this.uint16[Z+0]=o,this.uint16[Z+1]=p,this.uint16[Z+2]=h,this.uint16[Z+3]=b,this.uint16[Z+4]=x,this.uint16[Z+5]=A,this.uint16[Z+6]=T,this.uint16[Z+7]=I,this.uint16[Z+8]=z,this.uint16[Z+9]=q,n}}Na.prototype.bytesPerElement=20,It("StructArrayLayout10ui20",Na);class oh extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x,A,T){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,p,h,b,x,A,T)}emplace(n,o,p,h,b,x,A,T,I){const z=8*n;return this.uint16[z+0]=o,this.uint16[z+1]=p,this.uint16[z+2]=h,this.uint16[z+3]=b,this.uint16[z+4]=x,this.uint16[z+5]=A,this.uint16[z+6]=T,this.uint16[z+7]=I,n}}oh.prototype.bytesPerElement=16,It("StructArrayLayout8ui16",oh);class kd extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x,A,T,I,z,q,Z){const H=this.length;return this.resize(H+1),this.emplace(H,n,o,p,h,b,x,A,T,I,z,q,Z)}emplace(n,o,p,h,b,x,A,T,I,z,q,Z,H){const Y=12*n;return this.int16[Y+0]=o,this.int16[Y+1]=p,this.int16[Y+2]=h,this.int16[Y+3]=b,this.uint16[Y+4]=x,this.uint16[Y+5]=A,this.uint16[Y+6]=T,this.uint16[Y+7]=I,this.int16[Y+8]=z,this.int16[Y+9]=q,this.int16[Y+10]=Z,this.int16[Y+11]=H,n}}kd.prototype.bytesPerElement=24,It("StructArrayLayout4i4ui4i24",kd);class Fa extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,p){const h=this.length;return this.resize(h+1),this.emplace(h,n,o,p)}emplace(n,o,p,h){const b=3*n;return this.float32[b+0]=o,this.float32[b+1]=p,this.float32[b+2]=h,n}}Fa.prototype.bytesPerElement=12,It("StructArrayLayout3f12",Fa);class ah extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}ah.prototype.bytesPerElement=4,It("StructArrayLayout1ul4",ah);class lh extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x,A,T,I){const z=this.length;return this.resize(z+1),this.emplace(z,n,o,p,h,b,x,A,T,I)}emplace(n,o,p,h,b,x,A,T,I,z){const q=10*n,Z=5*n;return this.int16[q+0]=o,this.int16[q+1]=p,this.int16[q+2]=h,this.int16[q+3]=b,this.int16[q+4]=x,this.int16[q+5]=A,this.uint32[Z+3]=T,this.uint16[q+8]=I,this.uint16[q+9]=z,n}}lh.prototype.bytesPerElement=20,It("StructArrayLayout6i1ul2ui20",lh);class Pd extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,n,o,p,h,b,x)}emplace(n,o,p,h,b,x,A){const T=6*n;return this.int16[T+0]=o,this.int16[T+1]=p,this.int16[T+2]=h,this.int16[T+3]=b,this.int16[T+4]=x,this.int16[T+5]=A,n}}Pd.prototype.bytesPerElement=12,It("StructArrayLayout2i2i2i12",Pd);class uh extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b){const x=this.length;return this.resize(x+1),this.emplace(x,n,o,p,h,b)}emplace(n,o,p,h,b,x){const A=4*n,T=8*n;return this.float32[A+0]=o,this.float32[A+1]=p,this.float32[A+2]=h,this.int16[T+6]=b,this.int16[T+7]=x,n}}uh.prototype.bytesPerElement=16,It("StructArrayLayout2f1f2i16",uh);class _ extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,n,o,p,h,b,x)}emplace(n,o,p,h,b,x,A){const T=16*n,I=4*n,z=8*n;return this.uint8[T+0]=o,this.uint8[T+1]=p,this.float32[I+1]=h,this.float32[I+2]=b,this.int16[z+6]=x,this.int16[z+7]=A,n}}_.prototype.bytesPerElement=16,It("StructArrayLayout2ub2f2i16",_);class t extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,p){const h=this.length;return this.resize(h+1),this.emplace(h,n,o,p)}emplace(n,o,p,h){const b=3*n;return this.uint16[b+0]=o,this.uint16[b+1]=p,this.uint16[b+2]=h,n}}t.prototype.bytesPerElement=6,It("StructArrayLayout3ui6",t);class u extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge){const qe=this.length;return this.resize(qe+1),this.emplace(qe,n,o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge)}emplace(n,o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge,qe){const Ce=24*n,ze=12*n,Je=48*n;return this.int16[Ce+0]=o,this.int16[Ce+1]=p,this.uint16[Ce+2]=h,this.uint16[Ce+3]=b,this.uint32[ze+2]=x,this.uint32[ze+3]=A,this.uint32[ze+4]=T,this.uint16[Ce+10]=I,this.uint16[Ce+11]=z,this.uint16[Ce+12]=q,this.float32[ze+7]=Z,this.float32[ze+8]=H,this.uint8[Je+36]=Y,this.uint8[Je+37]=ne,this.uint8[Je+38]=ae,this.uint32[ze+10]=ge,this.int16[Ce+22]=qe,n}}u.prototype.bytesPerElement=48,It("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",u);class f extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge,qe,Ce,ze,Je,ot,yt,Dt,Rt,Pt,Zt,kt){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,n,o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge,qe,Ce,ze,Je,ot,yt,Dt,Rt,Pt,Zt,kt)}emplace(n,o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge,qe,Ce,ze,Je,ot,yt,Dt,Rt,Pt,Zt,kt,Lt){const ct=32*n,ar=16*n;return this.int16[ct+0]=o,this.int16[ct+1]=p,this.int16[ct+2]=h,this.int16[ct+3]=b,this.int16[ct+4]=x,this.int16[ct+5]=A,this.int16[ct+6]=T,this.int16[ct+7]=I,this.uint16[ct+8]=z,this.uint16[ct+9]=q,this.uint16[ct+10]=Z,this.uint16[ct+11]=H,this.uint16[ct+12]=Y,this.uint16[ct+13]=ne,this.uint16[ct+14]=ae,this.uint16[ct+15]=ge,this.uint16[ct+16]=qe,this.uint16[ct+17]=Ce,this.uint16[ct+18]=ze,this.uint16[ct+19]=Je,this.uint16[ct+20]=ot,this.uint16[ct+21]=yt,this.uint16[ct+22]=Dt,this.uint32[ar+12]=Rt,this.float32[ar+13]=Pt,this.float32[ar+14]=Zt,this.uint16[ct+30]=kt,this.uint16[ct+31]=Lt,n}}f.prototype.bytesPerElement=64,It("StructArrayLayout8i15ui1ul2f2ui64",f);class y extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}y.prototype.bytesPerElement=4,It("StructArrayLayout1f4",y);class v extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,p){const h=this.length;return this.resize(h+1),this.emplace(h,n,o,p)}emplace(n,o,p,h){const b=3*n;return this.uint16[6*n+0]=o,this.float32[b+1]=p,this.float32[b+2]=h,n}}v.prototype.bytesPerElement=12,It("StructArrayLayout1ui2f12",v);class E extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,p){const h=this.length;return this.resize(h+1),this.emplace(h,n,o,p)}emplace(n,o,p,h){const b=4*n;return this.uint32[2*n+0]=o,this.uint16[b+2]=p,this.uint16[b+3]=h,n}}E.prototype.bytesPerElement=8,It("StructArrayLayout1ul2ui8",E);class C extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const p=this.length;return this.resize(p+1),this.emplace(p,n,o)}emplace(n,o,p){const h=2*n;return this.uint16[h+0]=o,this.uint16[h+1]=p,n}}C.prototype.bytesPerElement=4,It("StructArrayLayout2ui4",C);class P extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}P.prototype.bytesPerElement=2,It("StructArrayLayout1ui2",P);class V extends Ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,p,h){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,p,h)}emplace(n,o,p,h,b){const x=4*n;return this.float32[x+0]=o,this.float32[x+1]=p,this.float32[x+2]=h,this.float32[x+3]=b,n}}V.prototype.bytesPerElement=16,It("StructArrayLayout4f16",V);class N extends Il{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new g(this.anchorPointX,this.anchorPointY)}}N.prototype.size=20;class $ extends lh{get(n){return new N(this,n)}}It("CollisionBoxArray",$);class G extends Il{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}G.prototype.size=48;class X extends u{get(n){return new G(this,n)}}It("PlacedSymbolArray",X);class ie extends Il{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ie.prototype.size=64;class ue extends f{get(n){return new ie(this,n)}}It("SymbolInstanceArray",ue);class ce extends y{getoffsetX(n){return this.float32[1*n+0]}}It("GlyphOffsetArray",ce);class de extends Ml{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}It("SymbolLineVertexArray",de);class xe extends Il{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}xe.prototype.size=12;class Ae extends v{get(n){return new xe(this,n)}}It("TextAnchorOffsetArray",Ae);class Ee extends Il{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ee.prototype.size=8;class Ie extends E{get(n){return new Ee(this,n)}}It("FeatureIndexArray",Ie);class Ue extends Bl{}class Re extends Bl{}class Fe extends Bl{}class st extends Ku{}class Ye extends sh{}class tt extends ta{}class it extends Na{}class xt extends oh{}class wt extends kd{}class ft extends Fa{}class jt extends ah{}class mr extends Pd{}class ri extends _{}class ii extends t{}class ui extends C{}const Ri=Mi([{name:"a_pos",components:2,type:"Int16"}],4),{members:yi}=Ri;class Nr{constructor(n=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=n}prepareSegment(n,o,p,h){const b=this.segments[this.segments.length-1];return n>Nr.MAX_VERTEX_ARRAY_LENGTH&&nr(`Max vertices per segment is ${Nr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Nr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+n>Nr.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==h?this.createNewSegment(o,p,h):b}createNewSegment(n,o,p){const h={vertexOffset:n.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(h.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(n,o,p){return this.prepareSegment(0,n,o,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,p,h){return new Nr([{vertexOffset:n,primitiveOffset:o,vertexLength:p,primitiveLength:h,vaos:{},sortKey:0}])}}function wi(l,n){return 256*(l=tr(Math.floor(l),0,255))+tr(Math.floor(n),0,255)}Nr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,It("SegmentVector",Nr);const wn=Mi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ni=Mi([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Fi,Vn,ra,Ns={exports:{}},ia={exports:{}},qa={exports:{}},Ld=(function(){if(ra)return Ns.exports;ra=1;var l=(Fi||(Fi=1,ia.exports=function(o,p){var h,b,x,A,T,I,z,q;for(b=o.length-(h=3&o.length),x=p,T=3432918353,I=461845907,q=0;q<b;)z=255&o.charCodeAt(q)|(255&o.charCodeAt(++q))<<8|(255&o.charCodeAt(++q))<<16|(255&o.charCodeAt(++q))<<24,++q,x=27492+(65535&(A=5*(65535&(x=(x^=z=(65535&(z=(z=(65535&z)*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*I+(((z>>>16)*I&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(z=0,h){case 3:z^=(255&o.charCodeAt(q+2))<<16;case 2:z^=(255&o.charCodeAt(q+1))<<8;case 1:x^=z=(65535&(z=(z=(65535&(z^=255&o.charCodeAt(q)))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*I+(((z>>>16)*I&65535)<<16)&4294967295}return x^=o.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),ia.exports),n=(Vn||(Vn=1,qa.exports=function(o,p){for(var h,b=o.length,x=p^b,A=0;b>=4;)h=1540483477*(65535&(h=255&o.charCodeAt(A)|(255&o.charCodeAt(++A))<<8|(255&o.charCodeAt(++A))<<16|(255&o.charCodeAt(++A))<<24))+((1540483477*(h>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),b-=4,++A;switch(b){case 3:x^=(255&o.charCodeAt(A+2))<<16;case 2:x^=(255&o.charCodeAt(A+1))<<8;case 1:x=1540483477*(65535&(x^=255&o.charCodeAt(A)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),qa.exports);return Ns.exports=l,Ns.exports.murmur3=l,Ns.exports.murmur2=n,Ns.exports})(),zl=w(Ld);class ko{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,p,h){this.ids.push(as(n)),this.positions.push(o,p,h)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=as(n);let p=0,h=this.ids.length-1;for(;p<h;){const x=p+h>>1;this.ids[x]>=o?h=x:p=x+1}const b=[];for(;this.ids[p]===o;)b.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return b}static serialize(n,o){const p=new Float64Array(n.ids),h=new Uint32Array(n.positions);return co(p,h,0,p.length-1),o&&o.push(p.buffer,h.buffer),{ids:p,positions:h}}static deserialize(n){const o=new ko;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function as(l){const n=+l;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:zl(String(l))}function co(l,n,o,p){for(;o<p;){const h=l[o+p>>1];let b=o-1,x=p+1;for(;;){do b++;while(l[b]<h);do x--;while(l[x]>h);if(b>=x)break;po(l,b,x),po(n,3*b,3*x),po(n,3*b+1,3*x+1),po(n,3*b+2,3*x+2)}x-o<p-x?(co(l,n,o,x),o=x+1):(co(l,n,x+1,p),p=x)}}function po(l,n,o){const p=l[n];l[n]=l[o],l[o]=p}It("FeaturePositionMap",ko);class ls{constructor(n,o){this.gl=n.gl,this.location=o}}class zi extends ls{constructor(n,o){super(n,o),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Xi extends ls{constructor(n,o){super(n,o),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class us extends ls{constructor(n,o){super(n,o),this.current=Tr.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const an=new Float32Array(16);function ch(l){return[wi(255*l.r,255*l.g),wi(255*l.b,255*l.a)]}class Gu{constructor(n,o,p){this.value=n,this.uniformNames=o.map((h=>`u_${h}`)),this.type=p}setUniform(n,o,p){n.set(p.constantOr(this.value))}getBinding(n,o,p){return this.type==="color"?new us(n,o):new zi(n,o)}}class Ka{constructor(n,o){this.uniformNames=o.map((p=>`u_${p}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=n.tlbr}setConstantDashPositions(n,o){this.dashTo=[0,n.y,n.height,n.width],this.dashFrom=[0,o.y,o.height,o.width]}setUniform(n,o,p,h){let b=null;h==="u_pattern_to"?b=this.patternTo:h==="u_pattern_from"?b=this.patternFrom:h==="u_dasharray_to"?b=this.dashTo:h==="u_dasharray_from"?b=this.dashFrom:h==="u_pixel_ratio_to"?b=this.pixelRatioTo:h==="u_pixel_ratio_from"&&(b=this.pixelRatioFrom),b!==null&&n.set(b)}getBinding(n,o,p){return p.substr(0,9)==="u_pattern"||p.substr(0,12)==="u_dasharray_"?new Xi(n,o):new zi(n,o)}}class Po{constructor(n,o,p,h){this.expression=n,this.type=p,this.maxValue=0,this.paintVertexAttributes=o.map((b=>({name:`a_${b}`,type:"Float32",components:p==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(n,o,p){const h=this.paintVertexArray.length,b=this.expression.evaluate(new mi(0,p),o,{},p.canonical,[],p.formattedSection);this.paintVertexArray.resize(n),this._setPaintValue(h,n,b)}updatePaintArray(n,o,p,h,b){const x=this.expression.evaluate(new mi(0,b),p,h);this._setPaintValue(n,o,x)}_setPaintValue(n,o,p){if(this.type==="color"){const h=ch(p);for(let b=n;b<o;b++)this.paintVertexArray.emplace(b,h[0],h[1])}else{for(let h=n;h<o;h++)this.paintVertexArray.emplace(h,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fs{constructor(n,o,p,h,b,x){this.expression=n,this.uniformNames=o.map((A=>`u_${A}_t`)),this.type=p,this.useIntegerZoom=h,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=o.map((A=>({name:`a_${A}`,type:"Float32",components:p==="color"?4:2,offset:0}))),this.paintVertexArray=new x}populatePaintArray(n,o,p){const h=this.expression.evaluate(new mi(this.zoom,p),o,{},p.canonical,[],p.formattedSection),b=this.expression.evaluate(new mi(this.zoom+1,p),o,{},p.canonical,[],p.formattedSection),x=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(x,n,h,b)}updatePaintArray(n,o,p,h,b){const x=this.expression.evaluate(new mi(this.zoom,b),p,h),A=this.expression.evaluate(new mi(this.zoom+1,b),p,h);this._setPaintValue(n,o,x,A)}_setPaintValue(n,o,p,h){if(this.type==="color"){const b=ch(p),x=ch(h);for(let A=n;A<o;A++)this.paintVertexArray.emplace(A,b[0],b[1],x[0],x[1])}else{for(let b=n;b<o;b++)this.paintVertexArray.emplace(b,p,h);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o){const p=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,h=tr(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);n.set(h)}getBinding(n,o,p){return new zi(n,o)}}class na{constructor(n,o,p,h,b,x){this.expression=n,this.type=o,this.useIntegerZoom=p,this.zoom=h,this.layerId=x,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(n,o,p){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(h,n,this.getPositionIds(o),p)}updatePaintArray(n,o,p,h,b){this._setPaintValues(n,o,this.getPositionIds(p),b)}_setPaintValues(n,o,p,h){const b=this.getPositions(h);if(!b||!p)return;const x=b[p.min],A=b[p.mid],T=b[p.max];if(x&&A&&T)for(let I=n;I<o;I++)this.emplace(this.zoomInPaintVertexArray,I,A,x),this.emplace(this.zoomOutPaintVertexArray,I,A,T)}upload(n){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const o=this.getVertexAttributes();this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,o,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,o,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class sa extends na{getPositions(n){return n.imagePositions}getPositionIds(n){return n.patterns&&n.patterns[this.layerId]}getVertexAttributes(){return wn.members}emplace(n,o,p,h){n.emplace(o,p.tlbr[0],p.tlbr[1],p.tlbr[2],p.tlbr[3],h.tlbr[0],h.tlbr[1],h.tlbr[2],h.tlbr[3],p.pixelRatio,h.pixelRatio)}}class dh extends na{getPositions(n){return n.dashPositions}getPositionIds(n){return n.dashes&&n.dashes[this.layerId]}getVertexAttributes(){return Ni.members}emplace(n,o,p,h){n.emplace(o,0,p.y,p.height,p.width,0,h.y,h.height,h.width)}}class ph{constructor(n,o,p){this.binders={},this._buffers=[];const h=[];for(const b in n.paint._values){if(!p(b))continue;const x=n.paint.get(b);if(!(x instanceof uo&&Al(x.property.specification)))continue;const A=fh(b,n.type),T=x.value,I=x.property.specification.type,z=x.property.useIntegerZoom,q=x.property.specification["property-type"],Z=q==="cross-faded"||q==="cross-faded-data-driven";if(T.kind==="constant")this.binders[b]=Z?new Ka(T.value,A):new Gu(T.value,A,I),h.push(`/u_${b}`);else if(T.kind==="source"||Z){const H=hh(b,I,"source");this.binders[b]=Z?b==="line-dasharray"?new dh(T,I,z,o,H,n.id):new sa(T,I,z,o,H,n.id):new Po(T,A,I,H),h.push(`/a_${b}`)}else{const H=hh(b,I,"composite");this.binders[b]=new Fs(T,A,I,z,o,H),h.push(`/z_${b}`)}}this.cacheKey=h.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof Po||o instanceof Fs?o.maxValue:0}populatePaintArrays(n,o,p){for(const h in this.binders){const b=this.binders[h];(b instanceof Po||b instanceof Fs||b instanceof na)&&b.populatePaintArray(n,o,p)}}setConstantPatternPositions(n,o){for(const p in this.binders){const h=this.binders[p];h instanceof Ka&&h.setConstantPatternPositions(n,o)}}setConstantDashPositions(n,o){for(const p in this.binders){const h=this.binders[p];h instanceof Ka&&h.setConstantDashPositions(n,o)}}updatePaintArrays(n,o,p,h,b){let x=!1;for(const A in n){const T=o.getPositions(A);for(const I of T){const z=p.feature(I.index);for(const q in this.binders){const Z=this.binders[q];if((Z instanceof Po||Z instanceof Fs||Z instanceof na)&&Z.expression.isStateDependent===!0){const H=h.paint.get(q);Z.expression=H.value,Z.updatePaintArray(I.start,I.end,z,n[A],b),x=!0}}}}return x}defines(){const n=[];for(const o in this.binders){const p=this.binders[o];(p instanceof Gu||p instanceof Ka)&&n.push(...p.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const p=this.binders[o];if(p instanceof Po||p instanceof Fs)for(let h=0;h<p.paintVertexAttributes.length;h++)n.push(p.paintVertexAttributes[h].name);else if(p instanceof na){const h=p.getVertexAttributes();for(const b of h)n.push(b.name)}}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const p=this.binders[o];if(p instanceof Gu||p instanceof Ka||p instanceof Fs)for(const h of p.uniformNames)n.push(h)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,o){const p=[];for(const h in this.binders){const b=this.binders[h];if(b instanceof Gu||b instanceof Ka||b instanceof Fs){for(const x of b.uniformNames)if(o[x]){const A=b.getBinding(n,o[x],x);p.push({name:x,property:h,binding:A})}}}return p}setUniforms(n,o,p,h){for(const{name:b,property:x,binding:A}of o)this.binders[x].setUniform(A,h,p.get(x),b)}updatePaintBuffers(n){this._buffers=[];for(const o in this.binders){const p=this.binders[o];if(n&&p instanceof na){const h=n.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(p instanceof Po||p instanceof Fs)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(n){for(const o in this.binders){const p=this.binders[o];(p instanceof Po||p instanceof Fs||p instanceof na)&&p.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof Po||o instanceof Fs||o instanceof na)&&o.destroy()}}}class oa{constructor(n,o,p=()=>!0){this.programConfigurations={};for(const h of n)this.programConfigurations[h.id]=new ph(h,o,p);this.needsUpload=!1,this._featureMap=new ko,this._bufferOffset=0}populatePaintArrays(n,o,p,h){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(n,o,h);o.id!==void 0&&this._featureMap.add(o.id,p,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,p,h){for(const b of p)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(n,this._featureMap,o,b,h)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function fh(l,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${n}-`,"").replace(/-/g,"_")]}function hh(l,n,o){const p={color:{source:ta,composite:V},number:{source:y,composite:ta}},h=(function(b){return{"line-pattern":{source:it,composite:it},"fill-pattern":{source:it,composite:it},"fill-extrusion-pattern":{source:it,composite:it},"line-dasharray":{source:xt,composite:xt}}[b]})(l);return h&&h[o]||p[n][o]}It("ConstantBinder",Gu),It("CrossFadedConstantBinder",Ka),It("SourceExpressionBinder",Po),It("CrossFadedPatternBinder",sa),It("CrossFadedDasharrayBinder",dh),It("CompositeExpressionBinder",Fs),It("ProgramConfiguration",ph,{omit:["_buffers"]}),It("ProgramConfigurationSet",oa);const $u=Math.pow(2,14)-1,Uw=-$u-1;function Zu(l){const n=lt/l.extent,o=l.loadGeometry();for(let p=0;p<o.length;p++){const h=o[p];for(let b=0;b<h.length;b++){const x=h[b],A=Math.round(x.x*n),T=Math.round(x.y*n);x.x=tr(A,Uw,$u),x.y=tr(T,Uw,$u),(A<x.x||A>x.x+1||T<x.y||T>x.y+1)&&nr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Hu(l,n){return{type:l.type,id:l.id,properties:l.properties,geometry:n?Zu(l):[]}}const jw=-32768;function jM(l,n,o,p,h){l.emplaceBack(jw+8*n+p,jw+8*o+h)}class V0{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=n.index,this.hasDependencies=!1,this.layoutVertexArray=new Re,this.indexArray=new ii,this.segments=new Nr,this.programConfigurations=new oa(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(n,o,p){const h=this.layers[0],b=[];let x=null,A=!1,T=h.type==="heatmap";if(h.type==="circle"){const z=h;x=z.layout.get("circle-sort-key"),A=!x.isConstant(),T=T||z.paint.get("circle-pitch-alignment")==="map"}const I=T?o.subdivisionGranularity.circle:1;for(const{feature:z,id:q,index:Z,sourceLayerIndex:H}of n){const Y=this.layers[0]._featureFilter.needGeometry,ne=Hu(z,Y);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),ne,p))continue;const ae=A?x.evaluate(ne,{},p):void 0,ge={id:q,properties:z.properties,type:z.type,sourceLayerIndex:H,index:Z,geometry:Y?ne.geometry:Zu(z),patterns:{},sortKey:ae};b.push(ge)}A&&b.sort(((z,q)=>z.sortKey-q.sortKey));for(const z of b){const{geometry:q,index:Z,sourceLayerIndex:H}=z,Y=n[Z].feature;this.addFeature(z,q,Z,p,I),o.featureIndex.insert(Y,q,Z,H,this.index)}}update(n,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:p})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,yi),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,p,h,b=1){let x;switch(b){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const A=x.length;for(const T of o)for(const I of T){const z=I.x,q=I.y;if(z<0||z>=lt||q<0||q>=lt)continue;const Z=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,n.sortKey),H=Z.vertexLength;for(let Y=0;Y<A;Y++)for(let ne=0;ne<A;ne++)jM(this.layoutVertexArray,z,q,x[ne],x[Y]);for(let Y=0;Y<A-1;Y++)for(let ne=0;ne<A-1;ne++){const ae=H+Y*A+ne,ge=H+(Y+1)*A+ne;this.indexArray.emplaceBack(ae,ge+1,ae+1),this.indexArray.emplaceBack(ae,ge,ge+1)}Z.vertexLength+=A*A,Z.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,p,{imagePositions:{},canonical:h})}}function Nw(l,n){for(let o=0;o<l.length;o++)if(Dd(n,l[o]))return!0;for(let o=0;o<n.length;o++)if(Dd(l,n[o]))return!0;return!!U0(l,n)}function Zy(l,n,o){return!!Dd(l,n)||!!j0(n,l,o)}function Fw(l,n){if(l.length===1)return Kw(n,l[0]);for(let o=0;o<n.length;o++){const p=n[o];for(let h=0;h<p.length;h++)if(Dd(l,p[h]))return!0}for(let o=0;o<l.length;o++)if(Kw(n,l[o]))return!0;for(let o=0;o<n.length;o++)if(U0(l,n[o]))return!0;return!1}function NM(l,n,o){if(l.length>1){if(U0(l,n))return!0;for(let p=0;p<n.length;p++)if(j0(n[p],l,o))return!0}for(let p=0;p<l.length;p++)if(j0(l[p],n,o))return!0;return!1}function U0(l,n){if(l.length===0||n.length===0)return!1;for(let o=0;o<l.length-1;o++){const p=l[o],h=l[o+1];for(let b=0;b<n.length-1;b++)if(FM(p,h,n[b],n[b+1]))return!0}return!1}function FM(l,n,o,p){return Xr(l,o,p)!==Xr(n,o,p)&&Xr(l,n,o)!==Xr(l,n,p)}function j0(l,n,o){const p=o*o;if(n.length===1)return l.distSqr(n[0])<p;for(let h=1;h<n.length;h++)if(qw(l,n[h-1],n[h])<p)return!0;return!1}function qw(l,n,o){const p=n.distSqr(o);if(p===0)return l.distSqr(n);const h=((l.x-n.x)*(o.x-n.x)+(l.y-n.y)*(o.y-n.y))/p;return l.distSqr(h<0?n:h>1?o:o.sub(n)._mult(h)._add(n))}function Kw(l,n){let o,p,h,b=!1;for(let x=0;x<l.length;x++){o=l[x];for(let A=0,T=o.length-1;A<o.length;T=A++)p=o[A],h=o[T],p.y>n.y!=h.y>n.y&&n.x<(h.x-p.x)*(n.y-p.y)/(h.y-p.y)+p.x&&(b=!b)}return b}function Dd(l,n){let o=!1;for(let p=0,h=l.length-1;p<l.length;h=p++){const b=l[p],x=l[h];b.y>n.y!=x.y>n.y&&n.x<(x.x-b.x)*(n.y-b.y)/(x.y-b.y)+b.x&&(o=!o)}return o}function qM(l,n,o){const p=o[0],h=o[2];if(l.x<p.x&&n.x<p.x||l.x>h.x&&n.x>h.x||l.y<p.y&&n.y<p.y||l.y>h.y&&n.y>h.y)return!1;const b=Xr(l,n,o[0]);return b!==Xr(l,n,o[1])||b!==Xr(l,n,o[2])||b!==Xr(l,n,o[3])}function Id(l,n,o){const p=n.paint.get(l).value;return p.kind==="constant"?p.value:o.programConfigurations.get(n.id).getMaxValue(l)}function Hy(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Xy(l,n,o,p,h){if(!n[0]&&!n[1])return l;const b=g.convert(n)._mult(h);o==="viewport"&&b._rotate(-p);const x=[];for(let A=0;A<l.length;A++)x.push(l[A].sub(b));return x}function KM({queryGeometry:l,size:n},o){return Zy(l,o,n)}function GM({queryGeometry:l,size:n,transform:o,unwrappedTileID:p,getElevation:h},b){return Zy(l,b,n*(o.projectTileCoordinates(b.x,b.y,p,h).signedDistanceFromCamera/o.cameraToCenterDistance))}function $M({queryGeometry:l,size:n,transform:o,unwrappedTileID:p,getElevation:h},b){const x=o.projectTileCoordinates(b.x,b.y,p,h).signedDistanceFromCamera,A=n*(o.cameraToCenterDistance/x);return Zy(l,N0(b,o,p,h),A)}function ZM({queryGeometry:l,size:n,transform:o,unwrappedTileID:p,getElevation:h},b){return Zy(l,N0(b,o,p,h),n)}function Gw({queryGeometry:l,size:n,transform:o,unwrappedTileID:p,getElevation:h,pitchAlignment:b="map",pitchScale:x="map"},A){const T=b==="map"?x==="map"?KM:GM:x==="map"?$M:ZM,I={queryGeometry:l,size:n,transform:o,unwrappedTileID:p,getElevation:h};for(const z of A)for(const q of z)if(T(I,q))return!0;return!1}function N0(l,n,o,p){const h=n.projectTileCoordinates(l.x,l.y,o,p).point;return new g((.5*h.x+.5)*n.width,(.5*-h.y+.5)*n.height)}let $w,Zw;It("CircleBucket",V0,{omit:["layers"]});var HM={get paint(){return Zw=Zw||new On({"circle-radius":new rr(Ke.paint_circle["circle-radius"]),"circle-color":new rr(Ke.paint_circle["circle-color"]),"circle-blur":new rr(Ke.paint_circle["circle-blur"]),"circle-opacity":new rr(Ke.paint_circle["circle-opacity"]),"circle-translate":new Kt(Ke.paint_circle["circle-translate"]),"circle-translate-anchor":new Kt(Ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kt(Ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kt(Ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rr(Ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rr(Ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rr(Ke.paint_circle["circle-stroke-opacity"])})},get layout(){return $w=$w||new On({"circle-sort-key":new rr(Ke.layout_circle["circle-sort-key"])})}};class XM extends js{constructor(n,o){super(n,HM,o)}createBucket(n){return new V0(n)}queryRadius(n){const o=n;return Id("circle-radius",this,o)+Id("circle-stroke-width",this,o)+Hy(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:p,geometry:h,transform:b,pixelsToTileUnits:x,unwrappedTileID:A,getElevation:T}){const I=Xy(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,x),z=this.paint.get("circle-radius").evaluate(o,p)+this.paint.get("circle-stroke-width").evaluate(o,p),q=this.paint.get("circle-pitch-scale"),Z=this.paint.get("circle-pitch-alignment");let H,Y;return Z==="map"?(H=I,Y=z*x):(H=(function(ne,ae,ge,qe){return ne.map((Ce=>N0(Ce,ae,ge,qe)))})(I,b,A,T),Y=z),Gw({queryGeometry:H,size:Y,transform:b,unwrappedTileID:A,getElevation:T,pitchAlignment:Z,pitchScale:q},h)}}class Hw extends V0{}let Xw;It("HeatmapBucket",Hw,{omit:["layers"]});var WM={get paint(){return Xw=Xw||new On({"heatmap-radius":new rr(Ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rr(Ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kt(Ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Td(Ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kt(Ke.paint_heatmap["heatmap-opacity"])})}};function F0(l,{width:n,height:o},p,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==n*o*p)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${n*o*p}`)}else h=new Uint8Array(n*o*p);return l.width=n,l.height=o,l.data=h,l}function Ww(l,{width:n,height:o},p){if(n===l.width&&o===l.height)return;const h=F0({},{width:n,height:o},p);q0(l,h,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,n),height:Math.min(l.height,o)},p),l.width=n,l.height=o,l.data=h.data}function q0(l,n,o,p,h,b){if(h.width===0||h.height===0)return n;if(h.width>l.width||h.height>l.height||o.x>l.width-h.width||o.y>l.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>n.width||h.height>n.height||p.x>n.width-h.width||p.y>n.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const x=l.data,A=n.data;if(x===A)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<h.height;T++){const I=((o.y+T)*l.width+o.x)*b,z=((p.y+T)*n.width+p.x)*b;for(let q=0;q<h.width*b;q++)A[z+q]=x[I+q]}return n}class mh{constructor(n,o){F0(this,n,1,o)}resize(n){Ww(this,n,1)}clone(){return new mh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,p,h,b){q0(n,o,p,h,b,1)}}class cs{constructor(n,o){F0(this,n,4,o)}resize(n){Ww(this,n,4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new cs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,p,h,b){q0(n,o,p,h,b,4)}setPixel(n,o,p){const h=4*(n*this.width+o);this.data[h+0]=Math.round(255*p.r/p.a),this.data[h+1]=Math.round(255*p.g/p.a),this.data[h+2]=Math.round(255*p.b/p.a),this.data[h+3]=Math.round(255*p.a)}}function Yw(l){const n={},o=l.resolution||256,p=l.clips?l.clips.length:1,h=l.image||new cs({width:o,height:p});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const b=(x,A,T)=>{n[l.evaluationKey]=T;const I=l.expression.evaluate(n);h.setPixel(x/4/o,A/4,I)};if(l.clips)for(let x=0,A=0;x<p;++x,A+=4*o)for(let T=0,I=0;T<o;T++,I+=4){const z=T/(o-1),{start:q,end:Z}=l.clips[x];b(A,I,q*(1-z)+Z*z)}else for(let x=0,A=0;x<o;x++,A+=4)b(0,A,x/(o-1));return h}It("AlphaImage",mh),It("RGBAImage",cs);const K0="big-fb";class YM extends js{createBucket(n){return new Hw(n)}constructor(n,o){super(n,WM,o),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yw({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(K0)&&this.heatmapFbos.delete(K0)}queryRadius(n){return Id("heatmap-radius",this,n)}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:p,geometry:h,transform:b,pixelsToTileUnits:x,unwrappedTileID:A,getElevation:T}){return Gw({queryGeometry:n,size:this.paint.get("heatmap-radius").evaluate(o,p)*x,transform:b,unwrappedTileID:A,getElevation:T},h)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Jw;var JM={get paint(){return Jw=Jw||new On({"hillshade-illumination-direction":new Kt(Ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Kt(Ke.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Kt(Ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kt(Ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kt(Ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kt(Ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kt(Ke.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Kt(Ke.paint_hillshade["hillshade-method"])})}};class QM extends js{constructor(n,o){super(n,JM,o),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let n=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const b=Math.max(n.length,o.length,p.length,h.length);n=n.concat(Array(b-n.length).fill(n.at(-1))),o=o.concat(Array(b-o.length).fill(o.at(-1))),p=p.concat(Array(b-p.length).fill(p.at(-1))),h=h.concat(Array(b-h.length).fill(h.at(-1)));const x=o.map(Oi);return{directionRadians:n.map(Oi),altitudeRadians:x,shadowColor:h,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Qw;var ez={get paint(){return Qw=Qw||new On({"color-relief-opacity":new Kt(Ke["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Td(Ke["paint_color-relief"]["color-relief-color"])})}};class G0{constructor(n,o,p,h){this.context=n,this.format=p,this.texture=n.gl.createTexture(),this.update(o,h)}update(n,o,p){const{width:h,height:b}=n,x=!(this.size&&this.size[0]===h&&this.size[1]===b||p),{context:A}=this,{gl:T}=A;if(this.useMipmap=!!(o&&o.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!o||o.premultiply!==!1)),x)this.size=[h,b],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||er(n)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,n):T.texImage2D(T.TEXTURE_2D,0,this.format,h,b,0,this.format,T.UNSIGNED_BYTE,n.data);else{const{x:I,y:z}=p||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||er(n)?T.texSubImage2D(T.TEXTURE_2D,0,I,z,T.RGBA,T.UNSIGNED_BYTE,n):T.texSubImage2D(T.TEXTURE_2D,0,I,z,h,b,T.RGBA,T.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(n,o,p){const{context:h}=this,{gl:b}=h;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),n!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,n),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||n),this.filter=n),o!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,o),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class eE{constructor(n,o,p,h=1,b=1,x=1,A=0){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void nr(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const T=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=b,this.blueFactor=x,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<T;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(T,I)]=this.data[this._idx(T-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,T)]=this.data[this._idx(I,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<T;I++)for(let z=0;z<T;z++){const q=this.get(I,z);q>this.max&&(this.max=q),q<this.min&&(this.min=q)}}get(n,o){const p=new Uint8Array(this.data.buffer),h=4*this._idx(n,o);return this.unpack(p[h],p[h+1],p[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}unpack(n,o,p){return n*this.redFactor+o*this.greenFactor+p*this.blueFactor-this.baseShift}pack(n){return tE(n,this.getUnpackVector())}getPixels(){return new cs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,o,p){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let h=o*this.dim,b=o*this.dim+this.dim,x=p*this.dim,A=p*this.dim+this.dim;switch(o){case-1:h=b-1;break;case 1:b=h+1}switch(p){case-1:x=A-1;break;case 1:A=x+1}const T=-o*this.dim,I=-p*this.dim;for(let z=x;z<A;z++)for(let q=h;q<b;q++)this.data[this._idx(q,z)]=n.data[this._idx(q+T,z+I)]}}function tE(l,n){const o=n[0],p=n[1],h=n[2],b=n[3],x=Math.min(o,p,h),A=Math.round((l+b)/x);return{r:Math.floor(A*x/o)%256,g:Math.floor(A*x/p)%256,b:Math.floor(A*x/h)%256}}It("DEMData",eE);class tz extends js{constructor(n,o){super(n,ez,o)}_createColorRamp(n){const o={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof dd&&p._styleExpression.expression instanceof Hi){this.colorRampExpression=p;const x=p._styleExpression.expression;o.elevationStops=x.labels,o.colorStops=[];for(const A of o.elevationStops)o.colorStops.push(x.evaluate({globals:{elevation:A}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[Tr.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=n)return o;const h={elevationStops:[],colorStops:[]},b=(o.elevationStops.length-1)/(n-1);for(let x=0;x<o.elevationStops.length-.5;x+=b)h.elevationStops.push(o.elevationStops[Math.round(x)]),h.colorStops.push(o.colorStops[Math.round(x)]);return nr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),h}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(n,o,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const h=this._createColorRamp(o),b=new cs({width:h.colorStops.length,height:1}),x=new cs({width:h.colorStops.length,height:1});for(let A=0;A<h.elevationStops.length;A++){const T=tE(h.elevationStops[A],p);x.setPixel(0,A,new Tr(T.r/255,T.g/255,T.b/255,1)),b.setPixel(0,A,h.colorStops[A])}return this.colorRampTextures={elevationTexture:new G0(n,x,n.gl.RGBA),colorTexture:new G0(n,b,n.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const rz=Mi([{name:"a_pos",components:2,type:"Int16"}],4),{members:iz}=rz;function Wy(l,n,o){const p=o.patternDependencies;let h=!1;for(const b of n){const x=b.paint.get(`${l}-pattern`);x.isConstant()||(h=!0);const A=x.constantOr(null);A&&(h=!0,p[A.to]=!0,p[A.from]=!0)}return h}function $0(l,n,o,p,h){const{zoom:b}=p,x=h.patternDependencies;for(const A of n){const T=A.paint.get(`${l}-pattern`).value;if(T.kind!=="constant"){let I=T.evaluate({zoom:b-1},o,{},h.availableImages),z=T.evaluate({zoom:b},o,{},h.availableImages),q=T.evaluate({zoom:b+1},o,{},h.availableImages);I=I&&I.name?I.name:I,z=z&&z.name?z.name:z,q=q&&q.name?q.name:q,x[I]=!0,x[z]=!0,x[q]=!0,o.patterns[A.id]={min:I,mid:z,max:q}}}return o}function rE(l,n,o,p,h){let b;if(h===(function(x,A,T,I){let z=0;for(let q=A,Z=T-I;q<T;q+=I)z+=(x[Z]-x[q])*(x[q+1]+x[Z+1]),Z=q;return z})(l,n,o,p)>0)for(let x=n;x<o;x+=p)b=oE(x/p|0,l[x],l[x+1],b);else for(let x=o-p;x>=n;x-=p)b=oE(x/p|0,l[x],l[x+1],b);return b&&Bd(b,b.next)&&(bh(b),b=b.next),b}function Xu(l,n){if(!l)return l;n||(n=l);let o,p=l;do if(o=!1,p.steiner||!Bd(p,p.next)&&qi(p.prev,p,p.next)!==0)p=p.next;else{if(bh(p),p=n=p.prev,p===p.next)break;o=!0}while(o||p!==n);return n}function yh(l,n,o,p,h,b,x){if(!l)return;!x&&b&&(function(T,I,z,q){let Z=T;do Z.z===0&&(Z.z=Z0(Z.x,Z.y,I,z,q)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==T);Z.prevZ.nextZ=null,Z.prevZ=null,(function(H){let Y,ne=1;do{let ae,ge=H;H=null;let qe=null;for(Y=0;ge;){Y++;let Ce=ge,ze=0;for(let ot=0;ot<ne&&(ze++,Ce=Ce.nextZ,Ce);ot++);let Je=ne;for(;ze>0||Je>0&&Ce;)ze!==0&&(Je===0||!Ce||ge.z<=Ce.z)?(ae=ge,ge=ge.nextZ,ze--):(ae=Ce,Ce=Ce.nextZ,Je--),qe?qe.nextZ=ae:H=ae,ae.prevZ=qe,qe=ae;ge=Ce}qe.nextZ=null,ne*=2}while(Y>1)})(Z)})(l,p,h,b);let A=l;for(;l.prev!==l.next;){const T=l.prev,I=l.next;if(b?sz(l,p,h,b):nz(l))n.push(T.i,l.i,I.i),bh(l),l=I.next,A=I.next;else if((l=I)===A){x?x===1?yh(l=oz(Xu(l),n),n,o,p,h,b,2):x===2&&az(l,n,o,p,h,b):yh(Xu(l),n,o,p,h,b,1);break}}}function nz(l){const n=l.prev,o=l,p=l.next;if(qi(n,o,p)>=0)return!1;const h=n.x,b=o.x,x=p.x,A=n.y,T=o.y,I=p.y,z=Math.min(h,b,x),q=Math.min(A,T,I),Z=Math.max(h,b,x),H=Math.max(A,T,I);let Y=p.next;for(;Y!==n;){if(Y.x>=z&&Y.x<=Z&&Y.y>=q&&Y.y<=H&&gh(h,A,b,T,x,I,Y.x,Y.y)&&qi(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function sz(l,n,o,p){const h=l.prev,b=l,x=l.next;if(qi(h,b,x)>=0)return!1;const A=h.x,T=b.x,I=x.x,z=h.y,q=b.y,Z=x.y,H=Math.min(A,T,I),Y=Math.min(z,q,Z),ne=Math.max(A,T,I),ae=Math.max(z,q,Z),ge=Z0(H,Y,n,o,p),qe=Z0(ne,ae,n,o,p);let Ce=l.prevZ,ze=l.nextZ;for(;Ce&&Ce.z>=ge&&ze&&ze.z<=qe;){if(Ce.x>=H&&Ce.x<=ne&&Ce.y>=Y&&Ce.y<=ae&&Ce!==h&&Ce!==x&&gh(A,z,T,q,I,Z,Ce.x,Ce.y)&&qi(Ce.prev,Ce,Ce.next)>=0||(Ce=Ce.prevZ,ze.x>=H&&ze.x<=ne&&ze.y>=Y&&ze.y<=ae&&ze!==h&&ze!==x&&gh(A,z,T,q,I,Z,ze.x,ze.y)&&qi(ze.prev,ze,ze.next)>=0))return!1;ze=ze.nextZ}for(;Ce&&Ce.z>=ge;){if(Ce.x>=H&&Ce.x<=ne&&Ce.y>=Y&&Ce.y<=ae&&Ce!==h&&Ce!==x&&gh(A,z,T,q,I,Z,Ce.x,Ce.y)&&qi(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.prevZ}for(;ze&&ze.z<=qe;){if(ze.x>=H&&ze.x<=ne&&ze.y>=Y&&ze.y<=ae&&ze!==h&&ze!==x&&gh(A,z,T,q,I,Z,ze.x,ze.y)&&qi(ze.prev,ze,ze.next)>=0)return!1;ze=ze.nextZ}return!0}function oz(l,n){let o=l;do{const p=o.prev,h=o.next.next;!Bd(p,h)&&nE(p,o,o.next,h)&&_h(p,h)&&_h(h,p)&&(n.push(p.i,o.i,h.i),bh(o),bh(o.next),o=l=h),o=o.next}while(o!==l);return Xu(o)}function az(l,n,o,p,h,b){let x=l;do{let A=x.next.next;for(;A!==x.prev;){if(x.i!==A.i&&pz(x,A)){let T=sE(x,A);return x=Xu(x,x.next),T=Xu(T,T.next),yh(x,n,o,p,h,b,0),void yh(T,n,o,p,h,b,0)}A=A.next}x=x.next}while(x!==l)}function lz(l,n){let o=l.x-n.x;return o===0&&(o=l.y-n.y,o===0)&&(o=(l.next.y-l.y)/(l.next.x-l.x)-(n.next.y-n.y)/(n.next.x-n.x)),o}function uz(l,n){const o=(function(h,b){let x=b;const A=h.x,T=h.y;let I,z=-1/0;if(Bd(h,x))return x;do{if(Bd(h,x.next))return x.next;if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){const ne=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(ne<=A&&ne>z&&(z=ne,I=x.x<x.next.x?x:x.next,ne===A))return I}x=x.next}while(x!==b);if(!I)return null;const q=I,Z=I.x,H=I.y;let Y=1/0;x=I;do{if(A>=x.x&&x.x>=Z&&A!==x.x&&iE(T<H?A:z,T,Z,H,T<H?z:A,T,x.x,x.y)){const ne=Math.abs(T-x.y)/(A-x.x);_h(x,h)&&(ne<Y||ne===Y&&(x.x>I.x||x.x===I.x&&cz(I,x)))&&(I=x,Y=ne)}x=x.next}while(x!==q);return I})(l,n);if(!o)return n;const p=sE(o,l);return Xu(p,p.next),Xu(o,o.next)}function cz(l,n){return qi(l.prev,l,n.prev)<0&&qi(n.next,l,l.next)<0}function Z0(l,n,o,p,h){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*h|0)|l<<8))|l<<4))|l<<2))|l<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-p)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function dz(l){let n=l,o=l;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==l);return o}function iE(l,n,o,p,h,b,x,A){return(h-x)*(n-A)>=(l-x)*(b-A)&&(l-x)*(p-A)>=(o-x)*(n-A)&&(o-x)*(b-A)>=(h-x)*(p-A)}function gh(l,n,o,p,h,b,x,A){return!(l===x&&n===A)&&iE(l,n,o,p,h,b,x,A)}function pz(l,n){return l.next.i!==n.i&&l.prev.i!==n.i&&!(function(o,p){let h=o;do{if(h.i!==o.i&&h.next.i!==o.i&&h.i!==p.i&&h.next.i!==p.i&&nE(h,h.next,o,p))return!0;h=h.next}while(h!==o);return!1})(l,n)&&(_h(l,n)&&_h(n,l)&&(function(o,p){let h=o,b=!1;const x=(o.x+p.x)/2,A=(o.y+p.y)/2;do h.y>A!=h.next.y>A&&h.next.y!==h.y&&x<(h.next.x-h.x)*(A-h.y)/(h.next.y-h.y)+h.x&&(b=!b),h=h.next;while(h!==o);return b})(l,n)&&(qi(l.prev,l,n.prev)||qi(l,n.prev,n))||Bd(l,n)&&qi(l.prev,l,l.next)>0&&qi(n.prev,n,n.next)>0)}function qi(l,n,o){return(n.y-l.y)*(o.x-n.x)-(n.x-l.x)*(o.y-n.y)}function Bd(l,n){return l.x===n.x&&l.y===n.y}function nE(l,n,o,p){const h=Jy(qi(l,n,o)),b=Jy(qi(l,n,p)),x=Jy(qi(o,p,l)),A=Jy(qi(o,p,n));return h!==b&&x!==A||!(h!==0||!Yy(l,o,n))||!(b!==0||!Yy(l,p,n))||!(x!==0||!Yy(o,l,p))||!(A!==0||!Yy(o,n,p))}function Yy(l,n,o){return n.x<=Math.max(l.x,o.x)&&n.x>=Math.min(l.x,o.x)&&n.y<=Math.max(l.y,o.y)&&n.y>=Math.min(l.y,o.y)}function Jy(l){return l>0?1:l<0?-1:0}function _h(l,n){return qi(l.prev,l,l.next)<0?qi(l,n,l.next)>=0&&qi(l,l.prev,n)>=0:qi(l,n,l.prev)<0||qi(l,l.next,n)<0}function sE(l,n){const o=H0(l.i,l.x,l.y),p=H0(n.i,n.x,n.y),h=l.next,b=n.prev;return l.next=n,n.prev=l,o.next=h,h.prev=o,p.next=o,o.prev=p,b.next=p,p.prev=b,p}function oE(l,n,o,p){const h=H0(l,n,o);return p?(h.next=p.next,h.prev=p,p.next.prev=h,p.next=h):(h.prev=h,h.next=h),h}function bh(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function H0(l,n,o){return{i:l,x:n,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Md{constructor(n,o){if(o>n)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=n,this._minGranularity=o}getGranularityForZoomLevel(n){return Math.max(Math.floor(this._baseZoomGranularity/(1<<n)),this._minGranularity,1)}}class Qy{constructor(n){this.fill=n.fill,this.line=n.line,this.tile=n.tile,this.stencil=n.stencil,this.circle=n.circle}}Qy.noSubdivision=new Qy({fill:new Md(0,0),line:new Md(0,0),tile:new Md(0,0),stencil:new Md(0,0),circle:1}),It("SubdivisionGranularityExpression",Md),It("SubdivisionGranularitySetting",Qy);const zd=-32768,vh=32767;class fz{constructor(n,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=n,this._granularityCellSize=lt/n,this._canonical=o}_getKey(n,o){return(n+=32768)<<16|o+32768}_vertexToIndex(n,o){if(n<-32768||o<-32768||n>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(n),h=0|Math.round(o),b=this._getKey(p,h);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,x),this._vertexBuffer.push(p,h),x}_subdivideTrianglesScanline(n){if(this._granularity<2)return(function(h,b){const x=[];for(let A=0;A<b.length;A+=3){const T=b[A],I=b[A+1],z=b[A+2],q=h[2*T],Z=h[2*T+1];(h[2*I]-q)*(h[2*z+1]-Z)-(h[2*I+1]-Z)*(h[2*z]-q)>0?(x.push(T),x.push(z),x.push(I)):(x.push(T),x.push(I),x.push(z))}return x})(this._vertexBuffer,n);const o=[],p=n.length;for(let h=0;h<p;h+=3){const b=[n[h+0],n[h+1],n[h+2]],x=[this._vertexBuffer[2*n[h+0]+0],this._vertexBuffer[2*n[h+0]+1],this._vertexBuffer[2*n[h+1]+0],this._vertexBuffer[2*n[h+1]+1],this._vertexBuffer[2*n[h+2]+0],this._vertexBuffer[2*n[h+2]+1]];let A=1/0,T=1/0,I=-1/0,z=-1/0;for(let ne=0;ne<3;ne++){const ae=x[2*ne],ge=x[2*ne+1];A=Math.min(A,ae),I=Math.max(I,ae),T=Math.min(T,ge),z=Math.max(z,ge)}if(A===I||T===z)continue;const q=Math.floor(A/this._granularityCellSize),Z=Math.ceil(I/this._granularityCellSize),H=Math.floor(T/this._granularityCellSize),Y=Math.ceil(z/this._granularityCellSize);if(q!==Z||H!==Y)for(let ne=H;ne<Y;ne++){const ae=this._scanlineGenerateVertexRingForCellRow(ne,x,b);hz(this._vertexBuffer,ae,o)}else o.push(...b)}return o}_scanlineGenerateVertexRingForCellRow(n,o,p){const h=n*this._granularityCellSize,b=h+this._granularityCellSize,x=[];for(let A=0;A<3;A++){const T=o[2*A],I=o[2*A+1],z=o[2*(A+1)%6],q=o[(2*(A+1)+1)%6],Z=o[2*(A+2)%6],H=o[(2*(A+2)+1)%6],Y=z-T,ne=q-I,ae=Y===0,ge=ne===0,qe=(h-I)/ne,Ce=(b-I)/ne,ze=Math.min(qe,Ce),Je=Math.max(qe,Ce);if(!ge&&(ze>=1||Je<=0)||ge&&(I<h||I>b)){q>=h&&q<=b&&x.push(p[(A+1)%3]);continue}!ge&&ze>0&&x.push(this._vertexToIndex(T+Y*ze,I+ne*ze));const ot=T+Y*Math.max(ze,0),yt=T+Y*Math.min(Je,1);ae||this._generateIntraEdgeVertices(x,T,I,z,q,ot,yt),!ge&&Je<1&&x.push(this._vertexToIndex(T+Y*Je,I+ne*Je)),(ge||q>=h&&q<=b)&&x.push(p[(A+1)%3]),!ge&&(q<=h||q>=b)&&this._generateInterEdgeVertices(x,T,I,z,q,Z,H,yt,h,b)}return x}_generateIntraEdgeVertices(n,o,p,h,b,x,A){const T=h-o,I=b-p,z=I===0,q=z?Math.min(o,h):Math.min(x,A),Z=z?Math.max(o,h):Math.max(x,A),H=Math.floor(q/this._granularityCellSize)+1,Y=Math.ceil(Z/this._granularityCellSize)-1;if(z?o<h:x<A)for(let ne=H;ne<=Y;ne++){const ae=ne*this._granularityCellSize;n.push(this._vertexToIndex(ae,p+I*(ae-o)/T))}else for(let ne=Y;ne>=H;ne--){const ae=ne*this._granularityCellSize;n.push(this._vertexToIndex(ae,p+I*(ae-o)/T))}}_generateInterEdgeVertices(n,o,p,h,b,x,A,T,I,z){const q=b-p,Z=x-h,H=A-b,Y=(I-b)/H,ne=(z-b)/H,ae=Math.min(Y,ne),ge=Math.max(Y,ne),qe=h+Z*ae;let Ce=Math.floor(Math.min(qe,T)/this._granularityCellSize)+1,ze=Math.ceil(Math.max(qe,T)/this._granularityCellSize)-1,Je=T<qe;const ot=H===0;if(ot&&(A===I||A===z))return;if(ot||ae>=1||ge<=0){const Dt=p-A,Rt=x+(o-x)*Math.min((I-A)/Dt,(z-A)/Dt);Ce=Math.floor(Math.min(Rt,T)/this._granularityCellSize)+1,ze=Math.ceil(Math.max(Rt,T)/this._granularityCellSize)-1,Je=T<Rt}const yt=q>0?z:I;if(Je)for(let Dt=Ce;Dt<=ze;Dt++)n.push(this._vertexToIndex(Dt*this._granularityCellSize,yt));else for(let Dt=ze;Dt>=Ce;Dt--)n.push(this._vertexToIndex(Dt*this._granularityCellSize,yt))}_generateOutline(n){const o=[];for(const p of n){const h=Wu(p,this._granularity,!0),b=this._pointArrayToIndices(h),x=[];for(let A=1;A<b.length;A++)x.push(b[A-1]),x.push(b[A]);o.push(x)}return o}_handlePoles(n){let o=!1,p=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(o||p)&&this._fillPoles(n,o,p)}_ensureNoPoleVertices(){const n=this._vertexBuffer;for(let o=0;o<n.length;o+=2){const p=n[o+1];p===zd&&(n[o+1]=-32767),p===vh&&(n[o+1]=32766)}}_generatePoleQuad(n,o,p,h,b,x){h>b!=(x===zd)?(n.push(o),n.push(p),n.push(this._vertexToIndex(h,x)),n.push(p),n.push(this._vertexToIndex(b,x)),n.push(this._vertexToIndex(h,x))):(n.push(p),n.push(o),n.push(this._vertexToIndex(h,x)),n.push(this._vertexToIndex(b,x)),n.push(p),n.push(this._vertexToIndex(h,x)))}_fillPoles(n,o,p){const h=this._vertexBuffer,b=lt,x=n.length;for(let A=2;A<x;A+=3){const T=n[A-2],I=n[A-1],z=n[A],q=h[2*T],Z=h[2*T+1],H=h[2*I],Y=h[2*I+1],ne=h[2*z],ae=h[2*z+1];o&&(Z===0&&Y===0&&this._generatePoleQuad(n,T,I,q,H,zd),Y===0&&ae===0&&this._generatePoleQuad(n,I,z,H,ne,zd),ae===0&&Z===0&&this._generatePoleQuad(n,z,T,ne,q,zd)),p&&(Z===b&&Y===b&&this._generatePoleQuad(n,T,I,q,H,vh),Y===b&&ae===b&&this._generatePoleQuad(n,I,z,H,ne,vh),ae===b&&Z===b&&this._generatePoleQuad(n,z,T,ne,q,vh))}}_initializeVertices(n){for(let o=0;o<n.length;o+=2)this._vertexToIndex(n[o],n[o+1])}subdividePolygonInternal(n,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:h}=(function(A){const T=[],I=[];for(const z of A)if(z.length!==0){z!==A[0]&&T.push(I.length/2);for(let q=0;q<z.length;q++)I.push(z[q].x),I.push(z[q].y)}return{flattened:I,holeIndices:T}})(n);let b;this._initializeVertices(p);try{const A=(function(I,z,q=2){const Z=z&&z.length,H=Z?z[0]*q:I.length;let Y=rE(I,0,H,q,!0);const ne=[];if(!Y||Y.next===Y.prev)return ne;let ae,ge,qe;if(Z&&(Y=(function(Ce,ze,Je,ot){const yt=[];for(let Dt=0,Rt=ze.length;Dt<Rt;Dt++){const Pt=rE(Ce,ze[Dt]*ot,Dt<Rt-1?ze[Dt+1]*ot:Ce.length,ot,!1);Pt===Pt.next&&(Pt.steiner=!0),yt.push(dz(Pt))}yt.sort(lz);for(let Dt=0;Dt<yt.length;Dt++)Je=uz(yt[Dt],Je);return Je})(I,z,Y,q)),I.length>80*q){ae=I[0],ge=I[1];let Ce=ae,ze=ge;for(let Je=q;Je<H;Je+=q){const ot=I[Je],yt=I[Je+1];ot<ae&&(ae=ot),yt<ge&&(ge=yt),ot>Ce&&(Ce=ot),yt>ze&&(ze=yt)}qe=Math.max(Ce-ae,ze-ge),qe=qe!==0?32767/qe:0}return yh(Y,ne,q,ae,ge,qe,0),ne})(p,h),T=this._convertIndices(p,A);b=this._subdivideTrianglesScanline(T)}catch(A){console.error(A)}let x=[];return o&&(x=this._generateOutline(n)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:x}}_convertIndices(n,o){const p=[];for(let h=0;h<o.length;h++)p.push(this._vertexToIndex(n[2*o[h]],n[2*o[h]+1]));return p}_pointArrayToIndices(n){const o=[];for(let p=0;p<n.length;p++){const h=n[p];o.push(this._vertexToIndex(h.x,h.y))}return o}}function aE(l,n,o,p=!0){return new fz(o,n).subdividePolygonInternal(l,p)}function Wu(l,n,o=!1){if(!l||l.length<1)return[];if(l.length<2)return[];const p=l[0],h=l[l.length-1],b=o&&(p.x!==h.x||p.y!==h.y);if(n<2)return b?[...l,l[0]]:[...l];const x=Math.floor(lt/n),A=[];A.push(new g(l[0].x,l[0].y));const T=l.length,I=b?T:T-1;for(let z=0;z<I;z++){const q=l[z],Z=z<T-1?l[z+1]:l[0],H=q.x,Y=q.y,ne=Z.x,ae=Z.y,ge=H!==ne,qe=Y!==ae;if(!ge&&!qe)continue;const Ce=ne-H,ze=ae-Y,Je=Math.abs(Ce),ot=Math.abs(ze);let yt=H,Dt=Y;for(;;){const Pt=Ce>0?(Math.floor(yt/x)+1)*x:(Math.ceil(yt/x)-1)*x,Zt=ze>0?(Math.floor(Dt/x)+1)*x:(Math.ceil(Dt/x)-1)*x,kt=Math.abs(yt-Pt),Lt=Math.abs(Dt-Zt),ct=Math.abs(yt-ne),ar=Math.abs(Dt-ae),pr=ge?kt/Je:Number.POSITIVE_INFINITY,Jt=qe?Lt/ot:Number.POSITIVE_INFINITY;if((ct<=kt||!ge)&&(ar<=Lt||!qe))break;if(pr<Jt&&ge||!qe){yt=Pt,Dt+=ze*pr;const Gt=new g(yt,Math.round(Dt));A[A.length-1].x===Gt.x&&A[A.length-1].y===Gt.y||A.push(Gt)}else{yt+=Ce*Jt,Dt=Zt;const Gt=new g(Math.round(yt),Dt);A[A.length-1].x===Gt.x&&A[A.length-1].y===Gt.y||A.push(Gt)}}const Rt=new g(ne,ae);A[A.length-1].x===Rt.x&&A[A.length-1].y===Rt.y||A.push(Rt)}return A}function hz(l,n,o){if(n.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,h=l[2*n[0]];for(let T=1;T<n.length;T++){const I=l[2*n[T]];I<h&&(h=I,p=T)}const b=n.length;let x=p,A=(x+1)%b;for(;;){const T=x-1>=0?x-1:b-1,I=(A+1)%b,z=l[2*n[T]],q=l[2*n[I]],Z=l[2*n[x]],H=l[2*n[x]+1],Y=l[2*n[A]+1];let ne=!1;if(z<q)ne=!0;else if(z>q)ne=!1;else{const ae=Y-H,ge=-(l[2*n[A]]-Z),qe=H<Y?1:-1;((z-Z)*ae+(l[2*n[T]+1]-H)*ge)*qe>((q-Z)*ae+(l[2*n[I]+1]-H)*ge)*qe&&(ne=!0)}if(ne){const ae=n[T],ge=n[x],qe=n[A];ae!==ge&&ae!==qe&&ge!==qe&&o.push(qe,ge,ae),x--,x<0&&(x=b-1)}else{const ae=n[I],ge=n[x],qe=n[A];ae!==ge&&ae!==qe&&ge!==qe&&o.push(qe,ge,ae),A++,A>=b&&(A=0)}if(T===I)break}}function lE(l,n,o,p,h,b,x,A,T){const I=h.length/2,z=x&&A&&T;if(I<Nr.MAX_VERTEX_ARRAY_LENGTH){const q=n.prepareSegment(I,o,p),Z=q.vertexLength;for(let ne=0;ne<b.length;ne+=3)p.emplaceBack(Z+b[ne],Z+b[ne+1],Z+b[ne+2]);let H,Y;q.vertexLength+=I,q.primitiveLength+=b.length/3,z&&(Y=x.prepareSegment(I,o,A),H=Y.vertexLength,Y.vertexLength+=I);for(let ne=0;ne<h.length;ne+=2)l(h[ne],h[ne+1]);if(z)for(let ne=0;ne<T.length;ne++){const ae=T[ne];for(let ge=1;ge<ae.length;ge+=2)A.emplaceBack(H+ae[ge-1],H+ae[ge]);Y.primitiveLength+=ae.length/2}}else(function(q,Z,H,Y,ne,ae){const ge=[];for(let ot=0;ot<Y.length/2;ot++)ge.push(-1);const qe={count:0};let Ce=0,ze=q.getOrCreateLatestSegment(Z,H),Je=ze.vertexLength;for(let ot=2;ot<ne.length;ot+=3){const yt=ne[ot-2],Dt=ne[ot-1],Rt=ne[ot];let Pt=ge[yt]<Ce,Zt=ge[Dt]<Ce,kt=ge[Rt]<Ce;ze.vertexLength+((Pt?1:0)+(Zt?1:0)+(kt?1:0))>Nr.MAX_VERTEX_ARRAY_LENGTH&&(ze=q.createNewSegment(Z,H),Ce=qe.count,Pt=!0,Zt=!0,kt=!0,Je=0);const Lt=xh(ge,Y,ae,qe,yt,Pt,ze),ct=xh(ge,Y,ae,qe,Dt,Zt,ze),ar=xh(ge,Y,ae,qe,Rt,kt,ze);H.emplaceBack(Je+Lt-Ce,Je+ct-Ce,Je+ar-Ce),ze.primitiveLength++}})(n,o,p,h,b,l),z&&(function(q,Z,H,Y,ne,ae){const ge=[];for(let ot=0;ot<Y.length/2;ot++)ge.push(-1);const qe={count:0};let Ce=0,ze=q.getOrCreateLatestSegment(Z,H),Je=ze.vertexLength;for(let ot=0;ot<ne.length;ot++){const yt=ne[ot];for(let Dt=1;Dt<ne[ot].length;Dt+=2){const Rt=yt[Dt-1],Pt=yt[Dt];let Zt=ge[Rt]<Ce,kt=ge[Pt]<Ce;ze.vertexLength+((Zt?1:0)+(kt?1:0))>Nr.MAX_VERTEX_ARRAY_LENGTH&&(ze=q.createNewSegment(Z,H),Ce=qe.count,Zt=!0,kt=!0,Je=0);const Lt=xh(ge,Y,ae,qe,Rt,Zt,ze),ct=xh(ge,Y,ae,qe,Pt,kt,ze);H.emplaceBack(Je+Lt-Ce,Je+ct-Ce),ze.primitiveLength++}}})(x,o,A,h,T,l),n.forceNewSegmentOnNextPrepare(),x?.forceNewSegmentOnNextPrepare()}function xh(l,n,o,p,h,b,x){if(b){const A=p.count;return o(n[2*h],n[2*h+1]),l[h]=p.count,p.count++,x.vertexLength++,A}return l[h]}class X0{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=n.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Fe,this.indexArray=new ii,this.indexArray2=new ui,this.programConfigurations=new oa(n.layers,n.zoom),this.segments=new Nr,this.segments2=new Nr,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(n,o,p){this.hasDependencies=Wy("fill",this.layers,o);const h=this.layers[0].layout.get("fill-sort-key"),b=!h.isConstant(),x=[];for(const{feature:A,id:T,index:I,sourceLayerIndex:z}of n){const q=this.layers[0]._featureFilter.needGeometry,Z=Hu(A,q);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),Z,p))continue;const H=b?h.evaluate(Z,{},p,o.availableImages):void 0,Y={id:T,properties:A.properties,type:A.type,sourceLayerIndex:z,index:I,geometry:q?Z.geometry:Zu(A),patterns:{},sortKey:H};x.push(Y)}b&&x.sort(((A,T)=>A.sortKey-T.sortKey));for(const A of x){const{geometry:T,index:I,sourceLayerIndex:z}=A;if(this.hasDependencies){const q=$0("fill",this.layers,A,{zoom:this.zoom},o);this.patternFeatures.push(q)}else this.addFeature(A,T,I,p,{},o.subdivisionGranularity);o.featureIndex.insert(n[I].feature,T,I,z,this.index)}}update(n,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:p})}addFeatures(n,o,p){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,o,p,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,iz),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,p,h,b,x){for(const A of Qc(o,500)){const T=aE(A,h,x.fill.getGranularityForZoomLevel(h.z)),I=this.layoutVertexArray;lE(((z,q)=>{I.emplaceBack(z,q)}),this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,p,{imagePositions:b,canonical:h})}}let uE,cE;It("FillBucket",X0,{omit:["layers","patternFeatures"]});var mz={get paint(){return cE=cE||new On({"fill-antialias":new Kt(Ke.paint_fill["fill-antialias"]),"fill-opacity":new rr(Ke.paint_fill["fill-opacity"]),"fill-color":new rr(Ke.paint_fill["fill-color"]),"fill-outline-color":new rr(Ke.paint_fill["fill-outline-color"]),"fill-translate":new Kt(Ke.paint_fill["fill-translate"]),"fill-translate-anchor":new Kt(Ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new Dl(Ke.paint_fill["fill-pattern"])})},get layout(){return uE=uE||new On({"fill-sort-key":new rr(Ke.layout_fill["fill-sort-key"])})}};class yz extends js{constructor(n,o){super(n,mz,o)}recalculate(n,o){super.recalculate(n,o);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new X0(n)}queryRadius(){return Hy(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:n,geometry:o,transform:p,pixelsToTileUnits:h}){return Fw(Xy(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,h),o)}isTileClipped(){return!0}}const gz=Mi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),_z=Mi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:bz}=gz;class Od{constructor(n,o,p,h,b){this.properties={},this.extent=p,this.type=0,this.id=void 0,this._pbf=n,this._geometry=-1,this._keys=h,this._values=b,n.readFields(vz,this,o)}loadGeometry(){const n=this._pbf;n.pos=this._geometry;const o=n.readVarint()+n.pos,p=[];let h,b=1,x=0,A=0,T=0;for(;n.pos<o;){if(x<=0){const I=n.readVarint();b=7&I,x=I>>3}if(x--,b===1||b===2)A+=n.readSVarint(),T+=n.readSVarint(),b===1&&(h&&p.push(h),h=[]),h&&h.push(new g(A,T));else{if(b!==7)throw new Error(`unknown command ${b}`);h&&h.push(h[0].clone())}}return h&&p.push(h),p}bbox(){const n=this._pbf;n.pos=this._geometry;const o=n.readVarint()+n.pos;let p=1,h=0,b=0,x=0,A=1/0,T=-1/0,I=1/0,z=-1/0;for(;n.pos<o;){if(h<=0){const q=n.readVarint();p=7&q,h=q>>3}if(h--,p===1||p===2)b+=n.readSVarint(),x+=n.readSVarint(),b<A&&(A=b),b>T&&(T=b),x<I&&(I=x),x>z&&(z=x);else if(p!==7)throw new Error(`unknown command ${p}`)}return[A,I,T,z]}toGeoJSON(n,o,p){const h=this.extent*Math.pow(2,p),b=this.extent*n,x=this.extent*o,A=this.loadGeometry();function T(Z){return[360*(Z.x+b)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(Z.y+x)/h)*Math.PI))-90]}function I(Z){return Z.map(T)}let z;if(this.type===1){const Z=[];for(const Y of A)Z.push(Y[0]);const H=I(Z);z=Z.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const Z=A.map(I);z=Z.length===1?{type:"LineString",coordinates:Z[0]}:{type:"MultiLineString",coordinates:Z}}else{if(this.type!==3)throw new Error("unknown feature type");{const Z=(function(Y){const ne=Y.length;if(ne<=1)return[Y];const ae=[];let ge,qe;for(let Ce=0;Ce<ne;Ce++){const ze=xz(Y[Ce]);ze!==0&&(qe===void 0&&(qe=ze<0),qe===ze<0?(ge&&ae.push(ge),ge=[Y[Ce]]):ge&&ge.push(Y[Ce]))}return ge&&ae.push(ge),ae})(A),H=[];for(const Y of Z)H.push(Y.map(I));z=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const q={type:"Feature",geometry:z,properties:this.properties};return this.id!=null&&(q.id=this.id),q}}function vz(l,n,o){l===1?n.id=o.readVarint():l===2?(function(p,h){const b=p.readVarint()+p.pos;for(;p.pos<b;){const x=h._keys[p.readVarint()],A=h._values[p.readVarint()];h.properties[x]=A}})(o,n):l===3?n.type=o.readVarint():l===4&&(n._geometry=o.pos)}function xz(l){let n=0;for(let o,p,h=0,b=l.length,x=b-1;h<b;x=h++)o=l[h],p=l[x],n+=(p.x-o.x)*(o.y+p.y);return n}Od.types=["Unknown","Point","LineString","Polygon"];class dE{constructor(n,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(wz,this,o),this.length=this._features.length}feature(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];const o=this._pbf.readVarint()+this._pbf.pos;return new Od(this._pbf,o,this.extent,this._keys,this._values)}}function wz(l,n,o){l===15?n.version=o.readVarint():l===1?n.name=o.readString():l===5?n.extent=o.readVarint():l===2?n._features.push(o.pos):l===3?n._keys.push(o.readString()):l===4&&n._values.push((function(p){let h=null;const b=p.readVarint()+p.pos;for(;p.pos<b;){const x=p.readVarint()>>3;h=x===1?p.readString():x===2?p.readFloat():x===3?p.readDouble():x===4?p.readVarint64():x===5?p.readVarint():x===6?p.readSVarint():x===7?p.readBoolean():null}if(h==null)throw new Error("unknown feature value");return h})(o))}class pE{constructor(n,o){this.layers=n.readFields(Ez,{},o)}}function Ez(l,n,o){if(l===3){const p=new dE(o,o.readVarint()+o.pos);p.length&&(n[p.name]=p)}}const W0=Math.pow(2,13);function wh(l,n,o,p,h,b,x,A){l.emplaceBack(n,o,2*Math.floor(p*W0)+x,h*W0*2,b*W0*2,Math.round(A))}class Y0{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=n.index,this.hasDependencies=!1,this.layoutVertexArray=new st,this.centroidVertexArray=new Ue,this.indexArray=new ii,this.programConfigurations=new oa(n.layers,n.zoom),this.segments=new Nr,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(n,o,p){this.features=[],this.hasDependencies=Wy("fill-extrusion",this.layers,o);for(const{feature:h,id:b,index:x,sourceLayerIndex:A}of n){const T=this.layers[0]._featureFilter.needGeometry,I=Hu(h,T);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),I,p))continue;const z={id:b,sourceLayerIndex:A,index:x,geometry:T?I.geometry:Zu(h),properties:h.properties,type:h.type,patterns:{}};this.hasDependencies?this.features.push($0("fill-extrusion",this.layers,z,{zoom:this.zoom},o)):this.addFeature(z,z.geometry,x,p,{},o.subdivisionGranularity),o.featureIndex.insert(h,z.geometry,x,A,this.index,!0)}}addFeatures(n,o,p){for(const h of this.features){const{geometry:b}=h;this.addFeature(h,b,h.index,o,p,n.subdivisionGranularity)}}update(n,o,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:p})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,bz),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,_z.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,o,p,h,b,x){for(const A of Qc(o,500)){const T={x:0,y:0,sampleCount:0},I=this.layoutVertexArray.length;this.processPolygon(T,h,n,A,x);const z=this.layoutVertexArray.length-I,q=Math.floor(T.x/T.sampleCount),Z=Math.floor(T.y/T.sampleCount);for(let H=0;H<z;H++)this.centroidVertexArray.emplaceBack(q,Z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,p,{imagePositions:b,canonical:h})}processPolygon(n,o,p,h,b){if(h.length<1||fE(h[0]))return;for(const q of h)q.length!==0&&Az(n,q);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=b.fill.getGranularityForZoomLevel(o.z),T=Od.types[p.type]==="Polygon";for(const q of h){if(q.length===0||fE(q))continue;const Z=Wu(q,A,T);this._generateSideFaces(Z,x)}if(!T)return;const I=aE(h,o,A,!1),z=this.layoutVertexArray;lE(((q,Z)=>{wh(z,q,Z,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles)}_generateSideFaces(n,o){let p=0;for(let h=1;h<n.length;h++){const b=n[h],x=n[h-1];if(Rz(b,x))continue;o.segment.vertexLength+4>Nr.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=b.sub(x)._perp()._unit(),T=x.dist(b);p+T>32768&&(p=0),wh(this.layoutVertexArray,b.x,b.y,A.x,A.y,0,0,p),wh(this.layoutVertexArray,b.x,b.y,A.x,A.y,0,1,p),p+=T,wh(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,0,p),wh(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,1,p);const I=o.segment.vertexLength;this.indexArray.emplaceBack(I,I+2,I+1),this.indexArray.emplaceBack(I+1,I+2,I+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function Az(l,n){for(let o=0;o<n.length;o++){const p=n[o];o===n.length-1&&n[0].x===p.x&&n[0].y===p.y||(l.x+=p.x,l.y+=p.y,l.sampleCount++)}}function Rz(l,n){return l.x===n.x&&(l.x<0||l.x>lt)||l.y===n.y&&(l.y<0||l.y>lt)}function fE(l){return l.every((n=>n.x<0))||l.every((n=>n.x>lt))||l.every((n=>n.y<0))||l.every((n=>n.y>lt))}let hE;It("FillExtrusionBucket",Y0,{omit:["layers","features"]});var Sz={get paint(){return hE=hE||new On({"fill-extrusion-opacity":new Kt(Ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rr(Ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kt(Ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kt(Ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Dl(Ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rr(Ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rr(Ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Kt(Ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Tz extends js{constructor(n,o){super(n,Sz,o)}createBucket(n){return new Y0(n)}queryRadius(){return Hy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:p,geometry:h,transform:b,pixelsToTileUnits:x,pixelPosMatrix:A}){const T=Xy(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,x),I=this.paint.get("fill-extrusion-height").evaluate(o,p),z=this.paint.get("fill-extrusion-base").evaluate(o,p),q=(function(H,Y){const ne=[];for(const ae of H){const ge=[ae.x,ae.y,0,1];Be(ge,ge,Y),ne.push(new g(ge[0]/ge[3],ge[1]/ge[3]))}return ne})(T,A),Z=(function(H,Y,ne,ae){const ge=[],qe=[],Ce=ae[8]*Y,ze=ae[9]*Y,Je=ae[10]*Y,ot=ae[11]*Y,yt=ae[8]*ne,Dt=ae[9]*ne,Rt=ae[10]*ne,Pt=ae[11]*ne;for(const Zt of H){const kt=[],Lt=[];for(const ct of Zt){const ar=ct.x,pr=ct.y,Jt=ae[0]*ar+ae[4]*pr+ae[12],Gt=ae[1]*ar+ae[5]*pr+ae[13],Ur=ae[2]*ar+ae[6]*pr+ae[14],ki=ae[3]*ar+ae[7]*pr+ae[15],Wi=Ur+Je,Pn=ki+ot,Ks=Jt+yt,ds=Gt+Dt,En=Ur+Rt,Si=ki+Pt,un=new g((Jt+Ce)/Pn,(Gt+ze)/Pn);un.z=Wi/Pn,kt.push(un);const An=new g(Ks/Si,ds/Si);An.z=En/Si,Lt.push(An)}ge.push(kt),qe.push(Lt)}return[ge,qe]})(h,z,I,A);return(function(H,Y,ne){let ae=1/0;Fw(ne,Y)&&(ae=mE(ne,Y[0]));for(let ge=0;ge<Y.length;ge++){const qe=Y[ge],Ce=H[ge];for(let ze=0;ze<qe.length-1;ze++){const Je=qe[ze],ot=[Je,qe[ze+1],Ce[ze+1],Ce[ze],Je];Nw(ne,ot)&&(ae=Math.min(ae,mE(ne,ot)))}}return ae!==1/0&&ae})(Z[0],Z[1],q)}}function Eh(l,n){return l.x*n.x+l.y*n.y}function mE(l,n){if(l.length===1){let o=0;const p=n[o++];let h;for(;!h||p.equals(h);)if(h=n[o++],!h)return 1/0;for(;o<n.length;o++){const b=n[o],x=l[0],A=h.sub(p),T=b.sub(p),I=x.sub(p),z=Eh(A,A),q=Eh(A,T),Z=Eh(T,T),H=Eh(I,A),Y=Eh(I,T),ne=z*Z-q*q,ae=(Z*H-q*Y)/ne,ge=(z*Y-q*H)/ne,qe=p.z*(1-ae-ge)+h.z*ae+b.z*ge;if(isFinite(qe))return qe}return 1/0}{let o=1/0;for(const p of n)o=Math.min(o,p.z);return o}}const Cz=Mi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:kz}=Cz,Pz=Mi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Lz}=Pz,Dz=Math.cos(Math.PI/180*37.5),yE=Math.pow(2,14)/.5;class J0{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((o=>o.id)),this.index=n.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((o=>{this.gradients[o.id]={}})),this.layoutVertexArray=new Ye,this.layoutVertexArray2=new tt,this.indexArray=new ii,this.programConfigurations=new oa(n.layers,n.zoom),this.segments=new Nr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id))}populate(n,o,p){this.hasDependencies=Wy("line",this.layers,o)||this.hasLineDasharray(this.layers);const h=this.layers[0].layout.get("line-sort-key"),b=!h.isConstant(),x=[];for(const{feature:A,id:T,index:I,sourceLayerIndex:z}of n){const q=this.layers[0]._featureFilter.needGeometry,Z=Hu(A,q);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),Z,p))continue;const H=b?h.evaluate(Z,{},p):void 0,Y={id:T,properties:A.properties,type:A.type,sourceLayerIndex:z,index:I,geometry:q?Z.geometry:Zu(A),patterns:{},dashes:{},sortKey:H};x.push(Y)}b&&x.sort(((A,T)=>A.sortKey-T.sortKey));for(const A of x){const{geometry:T,index:I,sourceLayerIndex:z}=A;this.hasDependencies?(Wy("line",this.layers,o)?$0("line",this.layers,A,{zoom:this.zoom},o):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,A,this.zoom,o),this.patternFeatures.push(A)):this.addFeature(A,T,I,p,{},{},o.subdivisionGranularity),o.featureIndex.insert(n[I].feature,T,I,z,this.index)}}update(n,o,p,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:p,dashPositions:h})}addFeatures(n,o,p,h){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,p,h,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,Lz)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,kz),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,p,h,b,x,A){const T=this.layers[0].layout,I=T.get("line-join").evaluate(n,{}),z=T.get("line-cap"),q=T.get("line-miter-limit"),Z=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const H of o)this.addLine(H,n,I,z,q,Z,h,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,p,{imagePositions:b,dashPositions:x,canonical:h})}addLine(n,o,p,h,b,x,A,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n=Wu(n,A?T.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ce=0;Ce<n.length-1;Ce++)this.totalDistance+=n[Ce].dist(n[Ce+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=Od.types[o.type]==="Polygon";let z=n.length;for(;z>=2&&n[z-1].equals(n[z-2]);)z--;let q=0;for(;q<z-1&&n[q].equals(n[q+1]);)q++;if(z<(I?3:2))return;p==="bevel"&&(b=1.05);const Z=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let Y,ne,ae,ge,qe;this.e1=this.e2=-1,I&&(Y=n[z-2],qe=n[q].sub(Y)._unit()._perp());for(let Ce=q;Ce<z;Ce++){if(ae=Ce===z-1?I?n[q+1]:void 0:n[Ce+1],ae&&n[Ce].equals(ae))continue;qe&&(ge=qe),Y&&(ne=Y),Y=n[Ce],qe=ae?ae.sub(Y)._unit()._perp():ge,ge=ge||qe;let ze=ge.add(qe);ze.x===0&&ze.y===0||ze._unit();const Je=ge.x*qe.x+ge.y*qe.y,ot=ze.x*qe.x+ze.y*qe.y,yt=ot!==0?1/ot:1/0,Dt=2*Math.sqrt(2-2*ot),Rt=ot<Dz&&ne&&ae,Pt=ge.x*qe.y-ge.y*qe.x>0;if(Rt&&Ce>q){const Lt=Y.dist(ne);if(Lt>2*Z){const ct=Y.sub(Y.sub(ne)._mult(Z/Lt)._round());this.updateDistance(ne,ct),this.addCurrentVertex(ct,ge,0,0,H),ne=ct}}const Zt=ne&&ae;let kt=Zt?p:I?"butt":h;if(Zt&&kt==="round"&&(yt<x?kt="miter":yt<=2&&(kt="fakeround")),kt==="miter"&&yt>b&&(kt="bevel"),kt==="bevel"&&(yt>2&&(kt="flipbevel"),yt<b&&(kt="miter")),ne&&this.updateDistance(ne,Y),kt==="miter")ze._mult(yt),this.addCurrentVertex(Y,ze,0,0,H);else if(kt==="flipbevel"){if(yt>100)ze=qe.mult(-1);else{const Lt=yt*ge.add(qe).mag()/ge.sub(qe).mag();ze._perp()._mult(Lt*(Pt?-1:1))}this.addCurrentVertex(Y,ze,0,0,H),this.addCurrentVertex(Y,ze.mult(-1),0,0,H)}else if(kt==="bevel"||kt==="fakeround"){const Lt=-Math.sqrt(yt*yt-1),ct=Pt?Lt:0,ar=Pt?0:Lt;if(ne&&this.addCurrentVertex(Y,ge,ct,ar,H),kt==="fakeround"){const pr=Math.round(180*Dt/Math.PI/20);for(let Jt=1;Jt<pr;Jt++){let Gt=Jt/pr;if(Gt!==.5){const ki=Gt-.5;Gt+=Gt*ki*(Gt-1)*((1.0904+Je*(Je*(3.55645-1.43519*Je)-3.2452))*ki*ki+(.848013+Je*(.215638*Je-1.06021)))}const Ur=qe.sub(ge)._mult(Gt)._add(ge)._unit()._mult(Pt?-1:1);this.addHalfVertex(Y,Ur.x,Ur.y,!1,Pt,0,H)}}ae&&this.addCurrentVertex(Y,qe,-ct,-ar,H)}else if(kt==="butt")this.addCurrentVertex(Y,ze,0,0,H);else if(kt==="square"){const Lt=ne?1:-1;this.addCurrentVertex(Y,ze,Lt,Lt,H)}else kt==="round"&&(ne&&(this.addCurrentVertex(Y,ge,0,0,H),this.addCurrentVertex(Y,ge,1,1,H,!0)),ae&&(this.addCurrentVertex(Y,qe,-1,-1,H,!0),this.addCurrentVertex(Y,qe,0,0,H)));if(Rt&&Ce<z-1){const Lt=Y.dist(ae);if(Lt>2*Z){const ct=Y.add(ae.sub(Y)._mult(Z/Lt)._round());this.updateDistance(Y,ct),this.addCurrentVertex(ct,qe,0,0,H),Y=ct}}}}addCurrentVertex(n,o,p,h,b,x=!1){const A=o.y*h-o.x,T=-o.y-o.x*h;this.addHalfVertex(n,o.x+o.y*p,o.y-o.x*p,x,!1,p,b),this.addHalfVertex(n,A,T,x,!0,-h,b),this.distance>yE/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,o,p,h,b,x))}addHalfVertex({x:n,y:o},p,h,b,x,A,T){const I=.5*(this.lineClips?this.scaledDistance*(yE-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(b?1:0),(o<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*h)+128,1+(A===0?0:A<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,z,this.e2),T.primitiveLength++),x?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}hasLineDasharray(n){for(const o of n){const p=o.paint.get("line-dasharray");if(p&&!p.isConstant())return!0}return!1}addLineDashDependencies(n,o,p,h){for(const b of n){const x=b.paint.get("line-dasharray");if(!x||x.value.kind==="constant")continue;const A=b.layout.get("line-cap")==="round",T={dasharray:x.value.evaluate({zoom:p-1},o,{}),round:A},I={dasharray:x.value.evaluate({zoom:p},o,{}),round:A},z={dasharray:x.value.evaluate({zoom:p+1},o,{}),round:A},q=`${T.dasharray.join(",")},${T.round}`,Z=`${I.dasharray.join(",")},${I.round}`,H=`${z.dasharray.join(",")},${z.round}`;h.dashDependencies[q]=T,h.dashDependencies[Z]=I,h.dashDependencies[H]=z,o.dashes[b.id]={min:q,mid:Z,max:H}}}}let gE,_E;It("LineBucket",J0,{omit:["layers","patternFeatures"]});var bE={get paint(){return _E=_E||new On({"line-opacity":new rr(Ke.paint_line["line-opacity"]),"line-color":new rr(Ke.paint_line["line-color"]),"line-translate":new Kt(Ke.paint_line["line-translate"]),"line-translate-anchor":new Kt(Ke.paint_line["line-translate-anchor"]),"line-width":new rr(Ke.paint_line["line-width"]),"line-gap-width":new rr(Ke.paint_line["line-gap-width"]),"line-offset":new rr(Ke.paint_line["line-offset"]),"line-blur":new rr(Ke.paint_line["line-blur"]),"line-dasharray":new Dl(Ke.paint_line["line-dasharray"]),"line-pattern":new Dl(Ke.paint_line["line-pattern"]),"line-gradient":new Td(Ke.paint_line["line-gradient"])})},get layout(){return gE=gE||new On({"line-cap":new Kt(Ke.layout_line["line-cap"]),"line-join":new rr(Ke.layout_line["line-join"]),"line-miter-limit":new Kt(Ke.layout_line["line-miter-limit"]),"line-round-limit":new Kt(Ke.layout_line["line-round-limit"]),"line-sort-key":new rr(Ke.layout_line["line-sort-key"])})}};class Iz extends rr{possiblyEvaluate(n,o){return o=new mi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,p,h){return o=lr({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,p,h)}}let eg;class Bz extends js{constructor(n,o){super(n,bE,o),this.gradientVersion=0,eg||(eg=new Iz(bE.paint.properties["line-width"].specification),eg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!(function(p){return p._styleExpression!==void 0})(o)&&o._styleExpression.expression instanceof Wo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,o){super.recalculate(n,o),this.paint._values["line-floorwidth"]=eg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new J0(n)}queryRadius(n){const o=n,p=vE(Id("line-width",this,o),Id("line-gap-width",this,o)),h=Id("line-offset",this,o);return p/2+Math.abs(h)+Hy(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:p,geometry:h,transform:b,pixelsToTileUnits:x}){const A=Xy(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,x),T=x/2*vE(this.paint.get("line-width").evaluate(o,p),this.paint.get("line-gap-width").evaluate(o,p)),I=this.paint.get("line-offset").evaluate(o,p);return I&&(h=(function(z,q){const Z=[];for(let H=0;H<z.length;H++){const Y=z[H],ne=[];for(let ae=0;ae<Y.length;ae++){const ge=Y[ae-1],qe=Y[ae],Ce=Y[ae+1],ze=ae===0?new g(0,0):qe.sub(ge)._unit()._perp(),Je=ae===Y.length-1?new g(0,0):Ce.sub(qe)._unit()._perp(),ot=ze._add(Je)._unit(),yt=ot.x*Je.x+ot.y*Je.y;yt!==0&&ot._mult(1/yt),ne.push(ot._mult(q)._add(qe))}Z.push(ne)}return Z})(h,I*x)),(function(z,q,Z){for(let H=0;H<q.length;H++){const Y=q[H];if(z.length>=3){for(let ne=0;ne<Y.length;ne++)if(Dd(z,Y[ne]))return!0}if(NM(z,Y,Z))return!0}return!1})(A,h,T)}isTileClipped(){return!0}}function vE(l,n){return n>0?n+2*l:l}const Mz=Mi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zz=Mi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Mi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Oz=Mi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Mi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const xE=Mi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Vz=Mi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Uz(l,n,o){return l.sections.forEach((p=>{p.text=(function(h,b,x){const A=b.layout.get("text-transform").evaluate(x,{});return A==="uppercase"?h=h.toLocaleUpperCase():A==="lowercase"&&(h=h.toLocaleLowerCase()),Qo.applyArabicShaping&&(h=Qo.applyArabicShaping(h)),h})(p.text,n,o)})),l}Mi([{name:"triangle",components:3,type:"Uint16"}]),Mi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Mi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Mi([{type:"Float32",name:"offsetX"}]),Mi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Mi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ah={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ln=24;const Q0=4294967296,wE=1/Q0,EE=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class ex{constructor(n=new Uint8Array(16)){this.buf=ArrayBuffer.isView(n)?n:new Uint8Array(n),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(n,o,p=this.length){for(;this.pos<p;){const h=this.readVarint(),b=h>>3,x=this.pos;this.type=7&h,n(b,o,this),this.pos===x&&this.skip(h)}return o}readMessage(n,o){return this.readFields(n,o,this.readVarint()+this.pos)}readFixed32(){const n=this.dataView.getUint32(this.pos,!0);return this.pos+=4,n}readSFixed32(){const n=this.dataView.getInt32(this.pos,!0);return this.pos+=4,n}readFixed64(){const n=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Q0;return this.pos+=8,n}readSFixed64(){const n=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Q0;return this.pos+=8,n}readFloat(){const n=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,n}readDouble(){const n=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,n}readVarint(n){const o=this.buf;let p,h;return h=o[this.pos++],p=127&h,h<128?p:(h=o[this.pos++],p|=(127&h)<<7,h<128?p:(h=o[this.pos++],p|=(127&h)<<14,h<128?p:(h=o[this.pos++],p|=(127&h)<<21,h<128?p:(h=o[this.pos],p|=(15&h)<<28,(function(b,x,A){const T=A.buf;let I,z;if(z=T[A.pos++],I=(112&z)>>4,z<128||(z=T[A.pos++],I|=(127&z)<<3,z<128)||(z=T[A.pos++],I|=(127&z)<<10,z<128)||(z=T[A.pos++],I|=(127&z)<<17,z<128)||(z=T[A.pos++],I|=(127&z)<<24,z<128)||(z=T[A.pos++],I|=(1&z)<<31,z<128))return Vd(b,I,x);throw new Error("Expected varint not more than 10 bytes")})(p,n,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const n=this.readVarint();return n%2==1?(n+1)/-2:n/2}readBoolean(){return!!this.readVarint()}readString(){const n=this.readVarint()+this.pos,o=this.pos;return this.pos=n,n-o>=12&&EE?EE.decode(this.buf.subarray(o,n)):(function(p,h,b){let x="",A=h;for(;A<b;){const T=p[A];let I,z,q,Z=null,H=T>239?4:T>223?3:T>191?2:1;if(A+H>b)break;H===1?T<128&&(Z=T):H===2?(I=p[A+1],(192&I)==128&&(Z=(31&T)<<6|63&I,Z<=127&&(Z=null))):H===3?(I=p[A+1],z=p[A+2],(192&I)==128&&(192&z)==128&&(Z=(15&T)<<12|(63&I)<<6|63&z,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):H===4&&(I=p[A+1],z=p[A+2],q=p[A+3],(192&I)==128&&(192&z)==128&&(192&q)==128&&(Z=(15&T)<<18|(63&I)<<12|(63&z)<<6|63&q,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,H=1):Z>65535&&(Z-=65536,x+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|1023&Z),x+=String.fromCharCode(Z),A+=H}return x})(this.buf,o,n)}readBytes(){const n=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,n);return this.pos=n,o}readPackedVarint(n=[],o){const p=this.readPackedEnd();for(;this.pos<p;)n.push(this.readVarint(o));return n}readPackedSVarint(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readSVarint());return n}readPackedBoolean(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readBoolean());return n}readPackedFloat(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readFloat());return n}readPackedDouble(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readDouble());return n}readPackedFixed32(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readFixed32());return n}readPackedSFixed32(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readSFixed32());return n}readPackedFixed64(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readFixed64());return n}readPackedSFixed64(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readSFixed64());return n}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(n){const o=7&n;if(o===0)for(;this.buf[this.pos++]>127;);else if(o===2)this.pos=this.readVarint()+this.pos;else if(o===5)this.pos+=4;else{if(o!==1)throw new Error(`Unimplemented type: ${o}`);this.pos+=8}}writeTag(n,o){this.writeVarint(n<<3|o)}realloc(n){let o=this.length||16;for(;o<this.pos+n;)o*=2;if(o!==this.length){const p=new Uint8Array(o);p.set(this.buf),this.buf=p,this.dataView=new DataView(p.buffer),this.length=o}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(n){this.realloc(4),this.dataView.setInt32(this.pos,n,!0),this.pos+=4}writeSFixed32(n){this.realloc(4),this.dataView.setInt32(this.pos,n,!0),this.pos+=4}writeFixed64(n){this.realloc(8),this.dataView.setInt32(this.pos,-1&n,!0),this.dataView.setInt32(this.pos+4,Math.floor(n*wE),!0),this.pos+=8}writeSFixed64(n){this.realloc(8),this.dataView.setInt32(this.pos,-1&n,!0),this.dataView.setInt32(this.pos+4,Math.floor(n*wE),!0),this.pos+=8}writeVarint(n){(n=+n||0)>268435455||n<0?(function(o,p){let h,b;if(o>=0?(h=o%4294967296|0,b=o/4294967296|0):(h=~(-o%4294967296),b=~(-o/4294967296),4294967295^h?h=h+1|0:(h=0,b=b+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),(function(x,A,T){T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,T.buf[T.pos]=127&(x>>>=7)})(h,0,p),(function(x,A){const T=(7&x)<<4;A.buf[A.pos++]|=T|((x>>>=3)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x)))))})(b,p)})(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))}writeSVarint(n){this.writeVarint(n<0?2*-n-1:2*n)}writeBoolean(n){this.writeVarint(+n)}writeString(n){n=String(n),this.realloc(4*n.length),this.pos++;const o=this.pos;this.pos=(function(h,b,x){for(let A,T,I=0;I<b.length;I++){if(A=b.charCodeAt(I),A>55295&&A<57344){if(!T){A>56319||I+1===b.length?(h[x++]=239,h[x++]=191,h[x++]=189):T=A;continue}if(A<56320){h[x++]=239,h[x++]=191,h[x++]=189,T=A;continue}A=T-55296<<10|A-56320|65536,T=null}else T&&(h[x++]=239,h[x++]=191,h[x++]=189,T=null);A<128?h[x++]=A:(A<2048?h[x++]=A>>6|192:(A<65536?h[x++]=A>>12|224:(h[x++]=A>>18|240,h[x++]=A>>12&63|128),h[x++]=A>>6&63|128),h[x++]=63&A|128)}return x})(this.buf,n,this.pos);const p=this.pos-o;p>=128&&AE(o,p,this),this.pos=o-1,this.writeVarint(p),this.pos+=p}writeFloat(n){this.realloc(4),this.dataView.setFloat32(this.pos,n,!0),this.pos+=4}writeDouble(n){this.realloc(8),this.dataView.setFloat64(this.pos,n,!0),this.pos+=8}writeBytes(n){const o=n.length;this.writeVarint(o),this.realloc(o);for(let p=0;p<o;p++)this.buf[this.pos++]=n[p]}writeRawMessage(n,o){this.pos++;const p=this.pos;n(o,this);const h=this.pos-p;h>=128&&AE(p,h,this),this.pos=p-1,this.writeVarint(h),this.pos+=h}writeMessage(n,o,p){this.writeTag(n,2),this.writeRawMessage(o,p)}writePackedVarint(n,o){o.length&&this.writeMessage(n,jz,o)}writePackedSVarint(n,o){o.length&&this.writeMessage(n,Nz,o)}writePackedBoolean(n,o){o.length&&this.writeMessage(n,Kz,o)}writePackedFloat(n,o){o.length&&this.writeMessage(n,Fz,o)}writePackedDouble(n,o){o.length&&this.writeMessage(n,qz,o)}writePackedFixed32(n,o){o.length&&this.writeMessage(n,Gz,o)}writePackedSFixed32(n,o){o.length&&this.writeMessage(n,$z,o)}writePackedFixed64(n,o){o.length&&this.writeMessage(n,Zz,o)}writePackedSFixed64(n,o){o.length&&this.writeMessage(n,Hz,o)}writeBytesField(n,o){this.writeTag(n,2),this.writeBytes(o)}writeFixed32Field(n,o){this.writeTag(n,5),this.writeFixed32(o)}writeSFixed32Field(n,o){this.writeTag(n,5),this.writeSFixed32(o)}writeFixed64Field(n,o){this.writeTag(n,1),this.writeFixed64(o)}writeSFixed64Field(n,o){this.writeTag(n,1),this.writeSFixed64(o)}writeVarintField(n,o){this.writeTag(n,0),this.writeVarint(o)}writeSVarintField(n,o){this.writeTag(n,0),this.writeSVarint(o)}writeStringField(n,o){this.writeTag(n,2),this.writeString(o)}writeFloatField(n,o){this.writeTag(n,5),this.writeFloat(o)}writeDoubleField(n,o){this.writeTag(n,1),this.writeDouble(o)}writeBooleanField(n,o){this.writeVarintField(n,+o)}}function Vd(l,n,o){return o?4294967296*n+(l>>>0):4294967296*(n>>>0)+(l>>>0)}function AE(l,n,o){const p=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(p);for(let h=o.pos-1;h>=l;h--)o.buf[h+p]=o.buf[h]}function jz(l,n){for(let o=0;o<l.length;o++)n.writeVarint(l[o])}function Nz(l,n){for(let o=0;o<l.length;o++)n.writeSVarint(l[o])}function Fz(l,n){for(let o=0;o<l.length;o++)n.writeFloat(l[o])}function qz(l,n){for(let o=0;o<l.length;o++)n.writeDouble(l[o])}function Kz(l,n){for(let o=0;o<l.length;o++)n.writeBoolean(l[o])}function Gz(l,n){for(let o=0;o<l.length;o++)n.writeFixed32(l[o])}function $z(l,n){for(let o=0;o<l.length;o++)n.writeSFixed32(l[o])}function Zz(l,n){for(let o=0;o<l.length;o++)n.writeFixed64(l[o])}function Hz(l,n){for(let o=0;o<l.length;o++)n.writeSFixed64(l[o])}function Xz(l,n,o){l===1&&o.readMessage(Wz,n)}function Wz(l,n,o){if(l===3){const{id:p,bitmap:h,width:b,height:x,left:A,top:T,advance:I}=o.readMessage(Yz,{});n.push({id:p,bitmap:new mh({width:b+6,height:x+6},h),metrics:{width:b,height:x,left:A,top:T,advance:I}})}}function Yz(l,n,o){l===1?n.id=o.readVarint():l===2?n.bitmap=o.readBytes():l===3?n.width=o.readVarint():l===4?n.height=o.readVarint():l===5?n.left=o.readSVarint():l===6?n.top=o.readSVarint():l===7&&(n.advance=o.readVarint())}function RE(l){let n=0,o=0;for(const x of l)n+=x.w*x.h,o=Math.max(o,x.w);l.sort(((x,A)=>A.h-x.h));const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let h=0,b=0;for(const x of l)for(let A=p.length-1;A>=0;A--){const T=p[A];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,b=Math.max(b,x.y+x.h),h=Math.max(h,x.x+x.w),x.w===T.w&&x.h===T.h){const I=p.pop();I&&A<p.length&&(p[A]=I)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(p.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:h,h:b,fill:n/(h*b)||0}}class tx{constructor(n,{pixelRatio:o,version:p,stretchX:h,stretchY:b,content:x,textFitWidth:A,textFitHeight:T}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=h,this.stretchY=b,this.content=x,this.version=p,this.textFitWidth=A,this.textFitHeight=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class SE{constructor(n,o){const p={},h={};this.haveRenderCallbacks=[];const b=[];this.addImages(n,p,b),this.addImages(o,h,b);const{w:x,h:A}=RE(b),T=new cs({width:x||1,height:A||1});for(const I in n){const z=n[I],q=p[I].paddedRect;cs.copy(z.data,T,{x:0,y:0},{x:q.x+1,y:q.y+1},z.data)}for(const I in o){const z=o[I],q=h[I].paddedRect,Z=q.x+1,H=q.y+1,Y=z.data.width,ne=z.data.height;cs.copy(z.data,T,{x:0,y:0},{x:Z,y:H},z.data),cs.copy(z.data,T,{x:0,y:ne-1},{x:Z,y:H-1},{width:Y,height:1}),cs.copy(z.data,T,{x:0,y:0},{x:Z,y:H+ne},{width:Y,height:1}),cs.copy(z.data,T,{x:Y-1,y:0},{x:Z-1,y:H},{width:1,height:ne}),cs.copy(z.data,T,{x:0,y:0},{x:Z+Y,y:H},{width:1,height:ne})}this.image=T,this.iconPositions=p,this.patternPositions=h}addImages(n,o,p){for(const h in n){const b=n[h],x={x:0,y:0,w:b.data.width+2,h:b.data.height+2};p.push(x),o[h]=new tx(x,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(n,o){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in n.updatedImages)this.patchUpdatedImage(this.iconPositions[p],n.getImage(p),o),this.patchUpdatedImage(this.patternPositions[p],n.getImage(p),o)}patchUpdatedImage(n,o,p){if(!n||!o||n.version===o.version)return;n.version=o.version;const[h,b]=n.tl;p.update(o.data,void 0,{x:h,y:b})}}var Ol;It("ImagePosition",tx),It("ImageAtlas",SE),e.ao=void 0,(Ol=e.ao||(e.ao={}))[Ol.none=0]="none",Ol[Ol.horizontal=1]="horizontal",Ol[Ol.vertical=2]="vertical",Ol[Ol.horizontalOnly=3]="horizontalOnly";class Rh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(n,o,p){const h=new Rh;return h.scale=n||1,h.fontStack=o,h.verticalAlign=p||"bottom",h}static forImage(n,o){const p=new Rh;return p.imageName=n,p.verticalAlign=o||"bottom",p}}class Ud{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const p=new Ud;for(let h=0;h<n.sections.length;h++){const b=n.sections[h];b.image?p.addImageSection(b):p.addTextSection(b,o)}return p}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=(function(n){let o="";for(let p=0;p<n.length;p++){const h=n.charCodeAt(p+1)||null,b=n.charCodeAt(p-1)||null;o+=h&&Vy(h)&&!Ah[n[p+1]]||b&&Vy(b)&&!Ah[n[p-1]]||!Ah[n[p]]?n[p]:Ah[n[p]]}return o})(this.text)}trim(){let n=0;for(let p=0;p<this.text.length&&rg[this.text.charCodeAt(p)];p++)n++;let o=this.text.length;for(let p=this.text.length-1;p>=0&&p>=n&&rg[this.text.charCodeAt(p)];p--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const p=new Ud;return p.text=this.text.substring(n,o),p.sectionIndex=this.sectionIndex.slice(n,o),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((n,o)=>Math.max(n,this.sections[o].scale)),0)}getMaxImageSize(n){let o=0,p=0;for(let h=0;h<this.length();h++){const b=this.getSection(h);if(b.imageName){const x=n[b.imageName];if(!x)continue;const A=x.displaySize;o=Math.max(o,A[0]),p=Math.max(p,A[1])}}return{maxImageWidth:o,maxImageHeight:p}}addTextSection(n,o){this.text+=n.text,this.sections.push(Rh.forText(n.scale,n.fontStack||o,n.verticalAlign));const p=this.sections.length-1;for(let h=0;h<n.text.length;++h)this.sectionIndex.push(p)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void nr("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Rh.forImage(o,n.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):nr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function tg(l,n,o,p,h,b,x,A,T,I,z,q,Z,H,Y){const ne=Ud.fromFeature(l,h);let ae;q===e.ao.vertical&&ne.verticalizePunctuation();const{processBidirectionalText:ge,processStyledBidirectionalText:qe}=Qo;if(ge&&ne.sections.length===1){ae=[];const Je=ge(ne.toString(),rx(ne,I,b,n,p,H));for(const ot of Je){const yt=new Ud;yt.text=ot,yt.sections=ne.sections;for(let Dt=0;Dt<ot.length;Dt++)yt.sectionIndex.push(0);ae.push(yt)}}else if(qe){ae=[];const Je=qe(ne.text,ne.sectionIndex,rx(ne,I,b,n,p,H));for(const ot of Je){const yt=new Ud;yt.text=ot[0],yt.sectionIndex=ot[1],yt.sections=ne.sections,ae.push(yt)}}else ae=(function(Je,ot){const yt=[],Dt=Je.text;let Rt=0;for(const Pt of ot)yt.push(Je.substring(Rt,Pt)),Rt=Pt;return Rt<Dt.length&&yt.push(Je.substring(Rt,Dt.length)),yt})(ne,rx(ne,I,b,n,p,H));const Ce=[],ze={positionedLines:Ce,text:ne.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:q,iconsInText:!1,verticalizable:!1};return(function(Je,ot,yt,Dt,Rt,Pt,Zt,kt,Lt,ct,ar,pr){let Jt=0,Gt=0,Ur=0,ki=0;const Wi=kt==="right"?1:kt==="left"?0:.5,Pn=ln/pr;let Ks=0;for(const Si of Rt){Si.trim();const un=Si.getMaxScale(),An={positionedGlyphs:[],lineOffset:0};Je.positionedLines[Ks]=An;const Rn=An.positionedGlyphs;let Wn=0;if(!Si.length()){Gt+=Pt,++Ks;continue}const Gs=t3(Dt,Si,Pn);for(let ps=0;ps<Si.length();ps++){const Yi=Si.getSection(ps),dn=Si.getSectionIndex(ps),pn=Si.getCharCode(ps),$i=r3(Lt,ar,pn);let vi;if(Yi.imageName){if(Je.iconsInText=!0,Yi.scale=Yi.scale*Pn,vi=n3(Yi,$i,un,Gs,Dt),!vi)continue;Wn=Math.max(Wn,vi.imageOffset)}else if(vi=i3(Yi,pn,$i,Gs,ot,yt),!vi)continue;const{rect:Lo,metrics:qd,baselineOffset:Do}=vi;Rn.push({glyph:pn,imageName:Yi.imageName,x:Jt,y:Gt+Do+-17,vertical:$i,scale:Yi.scale,fontStack:Yi.fontStack,sectionIndex:dn,metrics:qd,rect:Lo}),$i?(Je.verticalizable=!0,Jt+=(Yi.imageName?qd.advance:ln)*Yi.scale+ct):Jt+=qd.advance*Yi.scale+ct}Rn.length!==0&&(Ur=Math.max(Jt-ct,Ur),s3(Rn,0,Rn.length-1,Wi)),Jt=0,An.lineOffset=Math.max(Wn,(un-1)*ln);const cn=Pt*un+Wn;Gt+=cn,ki=Math.max(cn,ki),++Ks}const{horizontalAlign:ds,verticalAlign:En}=ix(Zt);(function(Si,un,An,Rn,Wn,Gs,cn,ps,Yi){const dn=(un-An)*Wn;let pn=0;pn=Gs!==cn?-ps*Rn- -17:-Rn*Yi*cn+.5*cn;for(const $i of Si)for(const vi of $i.positionedGlyphs)vi.x+=dn,vi.y+=pn})(Je.positionedLines,Wi,ds,En,Ur,ki,Pt,Gt,Rt.length),Je.top+=-En*Gt,Je.bottom=Je.top+Gt,Je.left+=-ds*Ur,Je.right=Je.left+Ur})(ze,n,o,p,ae,x,A,T,q,I,Z,Y),!(function(Je){for(const ot of Je)if(ot.positionedGlyphs.length!==0)return!1;return!0})(Ce)&&ze}const rg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Jz={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Qz={40:!0};function TE(l,n,o,p,h,b){if(n.imageName){const x=p[n.imageName];return x?x.displaySize[0]*n.scale*ln/b+h:0}{const x=o[n.fontStack],A=x&&x[l];return A?A.metrics.advance*n.scale+h:0}}function CE(l,n,o,p){const h=Math.pow(l-n,2);return p?l<n?h/2:2*h:h+Math.abs(o)*o}function e3(l,n,o){let p=0;return l===10&&(p-=1e4),o&&(p+=150),l!==40&&l!==65288||(p+=50),n!==41&&n!==65289||(p+=50),p}function kE(l,n,o,p,h,b){let x=null,A=CE(n,o,h,b);for(const T of p){const I=CE(n-T.x,o,h,b)+T.badness;I<=A&&(x=T,A=I)}return{index:l,x:n,priorBreak:x,badness:A}}function PE(l){return l?PE(l.priorBreak).concat(l.index):[]}function rx(l,n,o,p,h,b){if(!l)return[];const x=[],A=(function(q,Z,H,Y,ne,ae){let ge=0;for(let qe=0;qe<q.length();qe++){const Ce=q.getSection(qe);ge+=TE(q.getCharCode(qe),Ce,Y,ne,Z,ae)}return ge/Math.max(1,Math.ceil(ge/H))})(l,n,o,p,h,b),T=l.text.indexOf("​")>=0;let I=0;for(let q=0;q<l.length();q++){const Z=l.getSection(q),H=l.getCharCode(q);if(rg[H]||(I+=TE(H,Z,p,h,n,b)),q<l.length()-1){const Y=!((z=H)<11904)&&(!!Or["CJK Compatibility Forms"](z)||!!Or["CJK Compatibility"](z)||!!Or["CJK Strokes"](z)||!!Or["CJK Symbols and Punctuation"](z)||!!Or["Enclosed CJK Letters and Months"](z)||!!Or["Halfwidth and Fullwidth Forms"](z)||!!Or["Ideographic Description Characters"](z)||!!Or["Vertical Forms"](z)||Oy.test(String.fromCodePoint(z)));(Jz[H]||Y||Z.imageName||q!==l.length()-2&&Qz[l.getCharCode(q+1)])&&x.push(kE(q+1,I,A,x,e3(H,l.getCharCode(q+1),Y&&T),!1))}}var z;return PE(kE(l.length(),I,A,x,0,!0))}function ix(l){let n=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function t3(l,n,o){const p=n.getMaxScale()*ln,{maxImageWidth:h,maxImageHeight:b}=n.getMaxImageSize(l),x=Math.max(p,b*o);return{verticalLineContentWidth:Math.max(p,h*o),horizontalLineContentHeight:x}}function LE(l){switch(l){case"top":return 0;case"center":return .5;default:return 1}}function r3(l,n,o){return!(l===e.ao.horizontal||!n&&!Ad(o)||n&&(rg[o]||(p=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function i3(l,n,o,p,h,b){const x=b[l.fontStack],A=(function(I,z,q,Z){if(I&&I.rect)return I;const H=z[q.fontStack],Y=H&&H[Z];return Y?{rect:null,metrics:Y.metrics}:null})(x&&x[n],h,l,n);if(A===null)return null;let T;if(o)T=p.verticalLineContentWidth-l.scale*ln;else{const I=LE(l.verticalAlign);T=(p.horizontalLineContentHeight-l.scale*ln)*I}return{rect:A.rect,metrics:A.metrics,baselineOffset:T}}function n3(l,n,o,p,h){const b=h[l.imageName];if(!b)return null;const x=b.paddedRect,A=b.displaySize,T={width:A[0],height:A[1],left:1,top:-3,advance:n?A[1]:A[0]};let I;if(n)I=p.verticalLineContentWidth-A[1]*l.scale;else{const z=LE(l.verticalAlign);I=(p.horizontalLineContentHeight-A[1]*l.scale)*z}return{rect:x,metrics:T,baselineOffset:I,imageOffset:(n?A[0]:A[1])*l.scale-ln*o}}function s3(l,n,o,p){if(p===0)return;const h=l[o],b=(l[o].x+h.metrics.advance*h.scale)*p;for(let x=n;x<=o;x++)l[x].x-=b}function o3(l,n,o){const{horizontalAlign:p,verticalAlign:h}=ix(o),b=n[0]-l.displaySize[0]*p,x=n[1]-l.displaySize[1]*h;return{image:l,top:x,bottom:x+l.displaySize[1],left:b,right:b+l.displaySize[0]}}function DE(l){var n,o;let p=l.left,h=l.top,b=l.right-p,x=l.bottom-h;const A=(n=l.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",T=(o=l.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",I=(l.image.content[2]-l.image.content[0])/(l.image.content[3]-l.image.content[1]);if(T==="proportional"){if(A==="stretchOnly"&&b/x<I||A==="proportional"){const z=Math.ceil(x*I);p*=z/b,b=z}}else if(A==="proportional"&&T==="stretchOnly"&&I!==0&&b/x>I){const z=Math.ceil(b/I);h*=z/x,x=z}return{x1:p,y1:h,x2:p+b,y2:h+x}}function IE(l,n,o,p,h,b){const x=l.image;let A;if(x.content){const ae=x.content,ge=x.pixelRatio||1;A=[ae[0]/ge,ae[1]/ge,x.displaySize[0]-ae[2]/ge,x.displaySize[1]-ae[3]/ge]}const T=n.left*b,I=n.right*b;let z,q,Z,H;o==="width"||o==="both"?(H=h[0]+T-p[3],q=h[0]+I+p[1]):(H=h[0]+(T+I-x.displaySize[0])/2,q=H+x.displaySize[0]);const Y=n.top*b,ne=n.bottom*b;return o==="height"||o==="both"?(z=h[1]+Y-p[0],Z=h[1]+ne+p[2]):(z=h[1]+(Y+ne-x.displaySize[1])/2,Z=z+x.displaySize[1]),{image:x,top:z,right:q,bottom:Z,left:H,collisionPadding:A}}const Ga=128,Vl=32640;function BE(l,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new mi(l+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:h}=o;let b=0;for(;b<p.length&&p[b]<=l;)b++;b=Math.max(0,b-1);let x=b;for(;x<p.length&&p[x]<l+1;)x++;x=Math.min(p.length-1,x);const A=p[b],T=p[x];return o.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:T,interpolationType:h}:{kind:"camera",minZoom:A,maxZoom:T,minSize:o.evaluate(new mi(A)),maxSize:o.evaluate(new mi(T)),interpolationType:h}}}function nx(l,n,o){let p="never";const h=l.get(n);return h?p=h:l.get(o)&&(p="always"),p}const a3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ig(l,n,o,p,h,b,x,A,T,I,z,q,Z){const H=A?Math.min(Vl,Math.round(A[0])):0,Y=A?Math.min(Vl,Math.round(A[1])):0;l.emplaceBack(n,o,Math.round(32*p),Math.round(32*h),b,x,(H<<1)+(T?1:0),Y,16*I,16*z,256*q,256*Z)}function sx(l,n,o){l.emplaceBack(n.x,n.y,o),l.emplaceBack(n.x,n.y,o),l.emplaceBack(n.x,n.y,o),l.emplaceBack(n.x,n.y,o)}function l3(l){for(const n of l.sections)if(Fy(n.text))return!0;return!1}class ox{constructor(n){this.layoutVertexArray=new wt,this.indexArray=new ii,this.programConfigurations=n,this.segments=new Nr,this.dynamicLayoutVertexArray=new ft,this.opacityVertexArray=new jt,this.hasVisibleVertices=!1,this.placedSymbolArray=new X}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,p,h){this.isEmpty()||(p&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Mz.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,zz.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,a3,!0),this.opacityVertexBuffer.itemSize=1),(p||h)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}It("SymbolBuffers",ox);class ax{constructor(n,o,p){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new p,this.segments=new Nr,this.collisionVertexArray=new ri}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Oz.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}It("CollisionBuffers",ax);class jd{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=Ct(globalThis)?Math.min(n.overscaling,128):n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((x=>x.id)),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=BE(this.zoom,o["text-size"]),this.iconSizeData=BE(this.zoom,o["icon-size"]);const p=this.layers[0].layout,h=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=nx(p,"text-overlap","text-allow-overlap")!=="never"||nx(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map((x=>e.ao[x]))),this.stateDependentLayerIds=this.layers.filter((x=>x.isStateDependent())).map((x=>x.id)),this.sourceID=n.sourceID}createArrays(){this.text=new ox(new oa(this.layers,this.zoom,(n=>/^text/.test(n)))),this.icon=new ox(new oa(this.layers,this.zoom,(n=>/^icon/.test(n)))),this.glyphOffsetArray=new ce,this.lineVertexArray=new de,this.symbolInstances=new ue,this.textAnchorOffsets=new Ae}calculateGlyphDependencies(n,o,p,h,b){for(let x=0;x<n.length;x++)if(o[n.charCodeAt(x)]=!0,(p||h)&&b){const A=Ah[n.charAt(x)];A&&(o[A.charCodeAt(0)]=!0)}}populate(n,o,p){const h=this.layers[0],b=h.layout,x=b.get("text-font"),A=b.get("text-field"),T=b.get("icon-image"),I=(A.value.kind!=="constant"||A.value.value instanceof Zn&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),z=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,q=b.get("symbol-sort-key");if(this.features=[],!I&&!z)return;const Z=o.iconDependencies,H=o.glyphDependencies,Y=o.availableImages,ne=new mi(this.zoom);for(const{feature:ae,id:ge,index:qe,sourceLayerIndex:Ce}of n){const ze=h._featureFilter.needGeometry,Je=Hu(ae,ze);if(!h._featureFilter.filter(ne,Je,p))continue;let ot,yt;if(ze||(Je.geometry=Zu(ae)),I){const Rt=h.getValueAndResolveTokens("text-field",Je,p,Y),Pt=Zn.factory(Rt),Zt=this.hasRTLText=this.hasRTLText||l3(Pt);(!Zt||Qo.getRTLTextPluginStatus()==="unavailable"||Zt&&Qo.isParsed())&&(ot=Uz(Pt,h,Je))}if(z){const Rt=h.getValueAndResolveTokens("icon-image",Je,p,Y);yt=Rt instanceof os?Rt:os.fromString(Rt)}if(!ot&&!yt)continue;const Dt=this.sortFeaturesByKey?q.evaluate(Je,{},p):void 0;if(this.features.push({id:ge,text:ot,icon:yt,index:qe,sourceLayerIndex:Ce,geometry:Je.geometry,properties:ae.properties,type:Od.types[ae.type],sortKey:Dt}),yt&&(Z[yt.name]=!0),ot){const Rt=x.evaluate(Je,{},p).join(","),Pt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ao.vertical)>=0;for(const Zt of ot.sections)if(Zt.image)Z[Zt.image.name]=!0;else{const kt=wd(ot.toString()),Lt=Zt.fontStack||Rt,ct=H[Lt]=H[Lt]||{};this.calculateGlyphDependencies(Zt.text,ct,Pt,this.allowVerticalPlacement,kt)}}}b.get("symbol-placement")==="line"&&(this.features=(function(ae){const ge={},qe={},Ce=[];let ze=0;function Je(Rt){Ce.push(ae[Rt]),ze++}function ot(Rt,Pt,Zt){const kt=qe[Rt];return delete qe[Rt],qe[Pt]=kt,Ce[kt].geometry[0].pop(),Ce[kt].geometry[0]=Ce[kt].geometry[0].concat(Zt[0]),kt}function yt(Rt,Pt,Zt){const kt=ge[Pt];return delete ge[Pt],ge[Rt]=kt,Ce[kt].geometry[0].shift(),Ce[kt].geometry[0]=Zt[0].concat(Ce[kt].geometry[0]),kt}function Dt(Rt,Pt,Zt){const kt=Zt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${Rt}:${kt.x}:${kt.y}`}for(let Rt=0;Rt<ae.length;Rt++){const Pt=ae[Rt],Zt=Pt.geometry,kt=Pt.text?Pt.text.toString():null;if(!kt){Je(Rt);continue}const Lt=Dt(kt,Zt),ct=Dt(kt,Zt,!0);if(Lt in qe&&ct in ge&&qe[Lt]!==ge[ct]){const ar=yt(Lt,ct,Zt),pr=ot(Lt,ct,Ce[ar].geometry);delete ge[Lt],delete qe[ct],qe[Dt(kt,Ce[pr].geometry,!0)]=pr,Ce[ar].geometry=null}else Lt in qe?ot(Lt,ct,Zt):ct in ge?yt(Lt,ct,Zt):(Je(Rt),ge[Lt]=ze-1,qe[ct]=ze-1)}return Ce.filter((Rt=>Rt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ae,ge)=>ae.sortKey-ge.sortKey))}update(n,o,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,{imagePositions:p}),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,{imagePositions:p}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const p=this.lineVertexArray.length;if(n.segment!==void 0){let h=n.dist(o[n.segment+1]),b=n.dist(o[n.segment]);const x={};for(let A=n.segment+1;A<o.length;A++)x[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:h},A<o.length-1&&(h+=o[A+1].dist(o[A]));for(let A=n.segment||0;A>=0;A--)x[A]={x:o[A].x,y:o[A].y,tileUnitDistanceFromAnchor:b},A>0&&(b+=o[A-1].dist(o[A]));for(let A=0;A<o.length;A++){const T=x[A];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(n,o,p,h,b,x,A,T,I,z,q,Z){const H=n.indexArray,Y=n.layoutVertexArray,ne=n.segments.prepareSegment(4*o.length,Y,H,this.canOverlap?x.sortKey:void 0),ae=this.glyphOffsetArray.length,ge=ne.vertexLength,qe=this.allowVerticalPlacement&&A===e.ao.vertical?Math.PI/2:0,Ce=x.text&&x.text.sections;for(let ze=0;ze<o.length;ze++){const{tl:Je,tr:ot,bl:yt,br:Dt,tex:Rt,pixelOffsetTL:Pt,pixelOffsetBR:Zt,minFontScaleX:kt,minFontScaleY:Lt,glyphOffset:ct,isSDF:ar,sectionIndex:pr}=o[ze],Jt=ne.vertexLength,Gt=ct[1];ig(Y,T.x,T.y,Je.x,Gt+Je.y,Rt.x,Rt.y,p,ar,Pt.x,Pt.y,kt,Lt),ig(Y,T.x,T.y,ot.x,Gt+ot.y,Rt.x+Rt.w,Rt.y,p,ar,Zt.x,Pt.y,kt,Lt),ig(Y,T.x,T.y,yt.x,Gt+yt.y,Rt.x,Rt.y+Rt.h,p,ar,Pt.x,Zt.y,kt,Lt),ig(Y,T.x,T.y,Dt.x,Gt+Dt.y,Rt.x+Rt.w,Rt.y+Rt.h,p,ar,Zt.x,Zt.y,kt,Lt),sx(n.dynamicLayoutVertexArray,T,qe),H.emplaceBack(Jt,Jt+2,Jt+1),H.emplaceBack(Jt+1,Jt+2,Jt+3),ne.vertexLength+=4,ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ct[0]),ze!==o.length-1&&pr===o[ze+1].sectionIndex||n.programConfigurations.populatePaintArrays(Y.length,x,x.index,{imagePositions:{},canonical:Z,formattedSection:Ce&&Ce[pr]})}n.placedSymbolArray.emplaceBack(T.x,T.y,ae,this.glyphOffsetArray.length-ae,ge,I,z,T.segment,p?p[0]:0,p?p[1]:0,h[0],h[1],A,0,!1,0,q)}_addCollisionDebugVertex(n,o,p,h,b,x){return o.emplaceBack(0,0),n.emplaceBack(p.x,p.y,h,b,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,o,p,h,b,x,A){const T=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),I=T.vertexLength,z=b.layoutVertexArray,q=b.collisionVertexArray,Z=A.anchorX,H=A.anchorY;this._addCollisionDebugVertex(z,q,x,Z,H,new g(n,o)),this._addCollisionDebugVertex(z,q,x,Z,H,new g(p,o)),this._addCollisionDebugVertex(z,q,x,Z,H,new g(p,h)),this._addCollisionDebugVertex(z,q,x,Z,H,new g(n,h)),T.vertexLength+=4;const Y=b.indexArray;Y.emplaceBack(I,I+1),Y.emplaceBack(I+1,I+2),Y.emplaceBack(I+2,I+3),Y.emplaceBack(I+3,I),T.primitiveLength+=4}addDebugCollisionBoxes(n,o,p,h){for(let b=n;b<o;b++){const x=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,h?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ax(mr,xE.members,ui),this.iconCollisionBox=new ax(mr,xE.members,ui);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(n,o,p,h,b,x,A,T,I){const z={};for(let q=o;q<p;q++){const Z=n.get(q);z.textBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.textFeatureIndex=Z.featureIndex;break}for(let q=h;q<b;q++){const Z=n.get(q);z.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.verticalTextFeatureIndex=Z.featureIndex;break}for(let q=x;q<A;q++){const Z=n.get(q);z.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.iconFeatureIndex=Z.featureIndex;break}for(let q=T;q<I;q++){const Z=n.get(q);z.verticalIconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.verticalIconFeatureIndex=Z.featureIndex;break}return z}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const p=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const p=n.placedSymbolArray.get(o),h=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<h;b+=4)n.indexArray.emplaceBack(b,b+2,b+1),n.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),p=Math.cos(n),h=[],b=[],x=[];for(let A=0;A<this.symbolInstances.length;++A){x.push(A);const T=this.symbolInstances.get(A);h.push(0|Math.round(o*T.anchorX+p*T.anchorY)),b.push(T.featureIndex)}return x.sort(((A,T)=>h[A]-h[T]||b[T]-b[A])),x}addToSortKeyRanges(n,o){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===o?p.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const p=this.symbolInstances.get(o);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(((h,b,x)=>{h>=0&&x.indexOf(h)===b&&this.addIndicesForPlacedSymbol(this.text,h)})),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ME,zE;It("SymbolBucket",jd,{omit:["layers","collisionBoxArray","features","compareText"]}),jd.MAX_GLYPHS=65535,jd.addDynamicAttributes=sx;var lx={get paint(){return zE=zE||new On({"icon-opacity":new rr(Ke.paint_symbol["icon-opacity"]),"icon-color":new rr(Ke.paint_symbol["icon-color"]),"icon-halo-color":new rr(Ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new rr(Ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rr(Ke.paint_symbol["icon-halo-blur"]),"icon-translate":new Kt(Ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kt(Ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new rr(Ke.paint_symbol["text-opacity"]),"text-color":new rr(Ke.paint_symbol["text-color"],{runtimeType:Gi,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new rr(Ke.paint_symbol["text-halo-color"]),"text-halo-width":new rr(Ke.paint_symbol["text-halo-width"]),"text-halo-blur":new rr(Ke.paint_symbol["text-halo-blur"]),"text-translate":new Kt(Ke.paint_symbol["text-translate"]),"text-translate-anchor":new Kt(Ke.paint_symbol["text-translate-anchor"])})},get layout(){return ME=ME||new On({"symbol-placement":new Kt(Ke.layout_symbol["symbol-placement"]),"symbol-spacing":new Kt(Ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kt(Ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rr(Ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Kt(Ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Kt(Ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Kt(Ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Kt(Ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kt(Ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kt(Ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new rr(Ke.layout_symbol["icon-size"]),"icon-text-fit":new Kt(Ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kt(Ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new rr(Ke.layout_symbol["icon-image"]),"icon-rotate":new rr(Ke.layout_symbol["icon-rotate"]),"icon-padding":new rr(Ke.layout_symbol["icon-padding"]),"icon-keep-upright":new Kt(Ke.layout_symbol["icon-keep-upright"]),"icon-offset":new rr(Ke.layout_symbol["icon-offset"]),"icon-anchor":new rr(Ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kt(Ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kt(Ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kt(Ke.layout_symbol["text-rotation-alignment"]),"text-field":new rr(Ke.layout_symbol["text-field"]),"text-font":new rr(Ke.layout_symbol["text-font"]),"text-size":new rr(Ke.layout_symbol["text-size"]),"text-max-width":new rr(Ke.layout_symbol["text-max-width"]),"text-line-height":new Kt(Ke.layout_symbol["text-line-height"]),"text-letter-spacing":new rr(Ke.layout_symbol["text-letter-spacing"]),"text-justify":new rr(Ke.layout_symbol["text-justify"]),"text-radial-offset":new rr(Ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Kt(Ke.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rr(Ke.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rr(Ke.layout_symbol["text-anchor"]),"text-max-angle":new Kt(Ke.layout_symbol["text-max-angle"]),"text-writing-mode":new Kt(Ke.layout_symbol["text-writing-mode"]),"text-rotate":new rr(Ke.layout_symbol["text-rotate"]),"text-padding":new Kt(Ke.layout_symbol["text-padding"]),"text-keep-upright":new Kt(Ke.layout_symbol["text-keep-upright"]),"text-transform":new rr(Ke.layout_symbol["text-transform"]),"text-offset":new rr(Ke.layout_symbol["text-offset"]),"text-allow-overlap":new Kt(Ke.layout_symbol["text-allow-overlap"]),"text-overlap":new Kt(Ke.layout_symbol["text-overlap"]),"text-ignore-placement":new Kt(Ke.layout_symbol["text-ignore-placement"]),"text-optional":new Kt(Ke.layout_symbol["text-optional"])})}};class OE{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:at,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}It("FormatSectionOverride",OE,{omit:["defaultValue"]});class ng extends js{constructor(n,o){super(n,lx,o)}recalculate(n,o){if(super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const h=[];for(const b of p)h.indexOf(b)<0&&h.push(b);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,o,p,h){const b=this.layout.get(n).evaluate(o,{},p,h),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||ud(x.value)||!b?b:(function(A,T){return T.replace(/{([^{}]+)}/g,((I,z)=>A&&z in A?String(A[z]):""))})(o.properties,b)}createBucket(n){return new jd(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of lx.paint.overridableProperties){if(!ng.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),p=new OE(o),h=new $f(p,o.property.specification);let b=null;b=o.value.kind==="constant"||o.value.kind==="source"?new dd("source",h):new pd("composite",h,o.value.zoomStops),this.paint._values[n]=new uo(o.property,b,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,p){return!(!this.layout||o.isDataDriven()||p.isDataDriven())&&ng.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const p=n.get("text-field"),h=lx.paint.properties[o];let b=!1;const x=A=>{for(const T of A)if(h.overrides&&h.overrides.hasOverride(T))return void(b=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Zn)x(p.value.value.sections);else if(p.value.kind==="source"||p.value.kind==="composite"){const A=I=>{b||(I instanceof hr&&Ci(I.value)===ss?x(I.value.sections):I instanceof Yc?x(I.sections):I.eachChild(A))},T=p.value;T._styleExpression&&A(T._styleExpression.expression)}return b}}let VE;var u3={get paint(){return VE=VE||new On({"background-color":new Kt(Ke.paint_background["background-color"]),"background-pattern":new Gy(Ke.paint_background["background-pattern"]),"background-opacity":new Kt(Ke.paint_background["background-opacity"])})}};class c3 extends js{constructor(n,o){super(n,u3,o)}}class d3 extends js{constructor(n,o){super(n,{},o),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class p3{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const f3={once:!0},ux=63710088e-1;class Ul{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ul(qr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,p=this.lat*o,h=n.lat*o,b=Math.sin(p)*Math.sin(h)+Math.cos(p)*Math.cos(h)*Math.cos((n.lng-this.lng)*o);return ux*Math.acos(Math.min(b,1))}static convert(n){if(n instanceof Ul)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Ul(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Ul(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const UE=2*Math.PI*ux;function jE(l){return UE*Math.cos(l*Math.PI/180)}function NE(l){return(180+l)/360}function FE(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function qE(l,n){return l/jE(n)}function cx(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function KE(l,n){return l*jE(cx(n))}class Sh{constructor(n,o,p=0){this.x=+n,this.y=+o,this.z=+p}static fromLngLat(n,o=0){const p=Ul.convert(n);return new Sh(NE(p.lng),FE(p.lat),qE(o,p.lat))}toLngLat(){return new Ul(360*this.x-180,cx(this.y))}toAltitude(){return KE(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/UE*(n=cx(this.y),1/Math.cos(n*Math.PI/180));var n}}function GE(l,n,o){var p=2*Math.PI*6378137/256/Math.pow(2,o);return[l*p-2*Math.PI*6378137/2,n*p-2*Math.PI*6378137/2]}class dx{constructor(n,o,p){if(!(function(h,b,x){return!(h<0||h>25||x<0||x>=Math.pow(2,h)||b<0||b>=Math.pow(2,h))})(n,o,p))throw new Error(`x=${o}, y=${p}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=o,this.y=p,this.key=Nd(0,n,n,o,p)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o,p){const h=(x=this.y,A=this.z,T=GE(256*(b=this.x),256*(x=Math.pow(2,A)-x-1),A),I=GE(256*(b+1),256*(x+1),A),T[0]+","+T[1]+","+I[0]+","+I[1]);var b,x,A,T,I;const z=(function(q,Z,H){let Y,ne="";for(let ae=q;ae>0;ae--)Y=1<<ae-1,ne+=(Z&Y?1:0)+(H&Y?2:0);return ne})(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,h)}isChildOf(n){const o=this.z-n.z;return o>0&&n.x===this.x>>o&&n.y===this.y>>o}getTilePoint(n){const o=Math.pow(2,this.z);return new g((n.x*o-this.x)*lt,(n.y*o-this.y)*lt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class $E{constructor(n,o){this.wrap=n,this.canonical=o,this.key=Nd(n,o.z,o.z,o.x,o.y)}}class qs{constructor(n,o,p,h,b){if(this.terrainRttPosMatrix32f=null,n<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${p}`);this.overscaledZ=n,this.wrap=o,this.canonical=new dx(p,+h,+b),this.key=Nd(o,n,p,h,b)}clone(){return new qs(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-n;return n>this.canonical.z?new qs(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qs(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(n,o){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-n;return n>this.canonical.z?Nd(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y):Nd(this.wrap*+o,n,n,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(n){if(n.wrap!==this.wrap||this.overscaledZ-n.overscaledZ<=0)return!1;if(n.overscaledZ===0)return this.overscaledZ>0;const o=this.canonical.z-n.canonical.z;return!(o<0)&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new qs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,p=2*this.canonical.x,h=2*this.canonical.y;return[new qs(o,this.wrap,o,p,h),new qs(o,this.wrap,o,p+1,h),new qs(o,this.wrap,o,p,h+1),new qs(o,this.wrap,o,p+1,h+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new qs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new qs(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new $E(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Sh(n.x-this.wrap,n.y))}}function Nd(l,n,o,p,h){(l*=2)<0&&(l=-1*l-1);const b=1<<o;return(b*b*l+b*h+p).toString(36)+o.toString(36)+n.toString(36)}function Th(l,n){return n?l.properties[n]:l.id}It("CanonicalTileID",dx),It("OverscaledTileID",qs,{omit:["terrainRttPosMatrix32f"]});class Yu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(n){return this.minX=Math.min(this.minX,n.x),this.minY=Math.min(this.minY,n.y),this.maxX=Math.max(this.maxX,n.x),this.maxY=Math.max(this.maxY,n.y),this}expandBy(n){return this.minX-=n,this.minY-=n,this.maxX+=n,this.maxY+=n,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(n){return this.expandBy(-n)}map(n){const o=new Yu;return o.extend(n(new g(this.minX,this.minY))),o.extend(n(new g(this.maxX,this.minY))),o.extend(n(new g(this.minX,this.maxY))),o.extend(n(new g(this.maxX,this.maxY))),o}static fromPoints(n){const o=new Yu;for(const p of n)o.extend(p);return o}contains(n){return n.x>=this.minX&&n.x<=this.maxX&&n.y>=this.minY&&n.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(n){return!this.empty()&&!n.empty()&&n.minX>=this.minX&&n.maxX<=this.maxX&&n.minY>=this.minY&&n.maxY<=this.maxY}intersects(n){return!this.empty()&&!n.empty()&&n.minX<=this.maxX&&n.maxX>=this.minX&&n.minY<=this.maxY&&n.maxY>=this.minY}}class ZE{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const p=n[o];this._stringToNumber[p]=o,this._numberToString[o]=p}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class HE{constructor(n,o,p,h,b){this.type="Feature",this._vectorTileFeature=n,n._z=o,n._x=p,n._y=h,this.properties=n.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(n[o]=this[o]);return n}}class XE{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Uu(lt,16,0),this.grid3D=new Uu(lt,16,0),this.featureIndexArray=new Ie,this.promoteId=o}insert(n,o,p,h,b,x){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,h,b);const T=x?this.grid3D:this.grid;for(let I=0;I<o.length;I++){const z=o[I],q=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<z.length;Z++){const H=z[Z];q[0]=Math.min(q[0],H.x),q[1]=Math.min(q[1],H.y),q[2]=Math.max(q[2],H.x),q[3]=Math.max(q[3],H.y)}q[0]<lt&&q[1]<lt&&q[2]>=0&&q[3]>=0&&T.insert(A,q[0],q[1],q[2],q[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new pE(new ex(this.rawTileData)).layers,this.sourceLayerCoder=new ZE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,o,p,h){this.loadVTLayers();const b=n.params,x=lt/n.tileSize/n.scale,A=Bu(b.filter,b.globalState),T=n.queryGeometry,I=n.queryPadding*x,z=Yu.fromPoints(T),q=this.grid.query(z.minX-I,z.minY-I,z.maxX+I,z.maxY+I),Z=Yu.fromPoints(n.cameraQueryGeometry).expandBy(I),H=this.grid3D.query(Z.minX,Z.minY,Z.maxX,Z.maxY,((ae,ge,qe,Ce)=>(function(ze,Je,ot,yt,Dt){for(const Pt of ze)if(Je<=Pt.x&&ot<=Pt.y&&yt>=Pt.x&&Dt>=Pt.y)return!0;const Rt=[new g(Je,ot),new g(Je,Dt),new g(yt,Dt),new g(yt,ot)];if(ze.length>2){for(const Pt of Rt)if(Dd(ze,Pt))return!0}for(let Pt=0;Pt<ze.length-1;Pt++)if(qM(ze[Pt],ze[Pt+1],Rt))return!0;return!1})(n.cameraQueryGeometry,ae-I,ge-I,qe+I,Ce+I)));for(const ae of H)q.push(ae);q.sort(h3);const Y={};let ne;for(let ae=0;ae<q.length;ae++){const ge=q[ae];if(ge===ne)continue;ne=ge;const qe=this.featureIndexArray.get(ge);let Ce=null;this.loadMatchingFeature(Y,qe.bucketIndex,qe.sourceLayerIndex,qe.featureIndex,A,b.layers,b.availableImages,o,p,h,((ze,Je,ot)=>(Ce||(Ce=Zu(ze)),Je.queryIntersectsFeature({queryGeometry:T,feature:ze,featureState:ot,geometry:Ce,zoom:this.z,transform:n.transform,pixelsToTileUnits:x,pixelPosMatrix:n.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:n.getElevation}))))}return Y}loadMatchingFeature(n,o,p,h,b,x,A,T,I,z,q){const Z=this.bucketLayerIDs[o];if(x&&!Z.some((ae=>x.has(ae))))return;const H=this.sourceLayerCoder.decode(p),Y=this.vtLayers[H].feature(h);if(b.needGeometry){const ae=Hu(Y,!0);if(!b.filter(new mi(this.tileID.overscaledZ),ae,this.tileID.canonical))return}else if(!b.filter(new mi(this.tileID.overscaledZ),Y))return;const ne=this.getId(Y,H);for(let ae=0;ae<Z.length;ae++){const ge=Z[ae];if(x&&!x.has(ge))continue;const qe=T[ge];if(!qe)continue;let Ce={};ne&&z&&(Ce=z.getState(qe.sourceLayer||"_geojsonTileLayer",ne));const ze=lr({},I[ge]);ze.paint=WE(ze.paint,qe.paint,Y,Ce,A),ze.layout=WE(ze.layout,qe.layout,Y,Ce,A);const Je=!q||q(Y,qe,Ce);if(!Je)continue;const ot=new HE(Y,this.z,this.x,this.y,ne);ot.layer=ze;let yt=n[ge];yt===void 0&&(yt=n[ge]=[]),yt.push({featureIndex:h,feature:ot,intersectionZ:Je})}}lookupSymbolFeatures(n,o,p,h,b,x,A,T){const I={};this.loadVTLayers();const z=Bu(b.filterSpec,b.globalState);for(const q of n)this.loadMatchingFeature(I,p,h,q,z,x,A,T,o);return I}hasLayer(n){for(const o of this.bucketLayerIDs)for(const p of o)if(n===p)return!0;return!1}getId(n,o){var p;let h=n.id;return this.promoteId&&(h=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((p=n.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(h=Number(n.properties.cluster_id))),h}}function WE(l,n,o,p,h){return Sr(l,((b,x)=>{const A=n instanceof Sd?n.get(x):null;return A&&A.evaluate?A.evaluate(o,p,h):A}))}function h3(l,n){return n-l}function YE(l,n,o,p,h){const b=[];for(let x=0;x<l.length;x++){const A=l[x];let T;for(let I=0;I<A.length-1;I++){let z=A[I],q=A[I+1];z.x<n&&q.x<n||(z.x<n?z=new g(n,z.y+(n-z.x)/(q.x-z.x)*(q.y-z.y))._round():q.x<n&&(q=new g(n,z.y+(n-z.x)/(q.x-z.x)*(q.y-z.y))._round()),z.y<o&&q.y<o||(z.y<o?z=new g(z.x+(o-z.y)/(q.y-z.y)*(q.x-z.x),o)._round():q.y<o&&(q=new g(z.x+(o-z.y)/(q.y-z.y)*(q.x-z.x),o)._round()),z.x>=p&&q.x>=p||(z.x>=p?z=new g(p,z.y+(p-z.x)/(q.x-z.x)*(q.y-z.y))._round():q.x>=p&&(q=new g(p,z.y+(p-z.x)/(q.x-z.x)*(q.y-z.y))._round()),z.y>=h&&q.y>=h||(z.y>=h?z=new g(z.x+(h-z.y)/(q.y-z.y)*(q.x-z.x),h)._round():q.y>=h&&(q=new g(z.x+(h-z.y)/(q.y-z.y)*(q.x-z.x),h)._round()),T&&z.equals(T[T.length-1])||(T=[z],b.push(T)),T.push(q)))))}}return b}It("FeatureIndex",XE,{omit:["rawTileData","sourceLayerCoder"]});class jl extends g{constructor(n,o,p,h){super(n,o),this.angle=p,h!==void 0&&(this.segment=h)}clone(){return new jl(this.x,this.y,this.angle,this.segment)}}function JE(l,n,o,p,h){if(n.segment===void 0||o===0)return!0;let b=n,x=n.segment+1,A=0;for(;A>-o/2;){if(x--,x<0)return!1;A-=l[x].dist(b),b=l[x]}A+=l[x].dist(l[x+1]),x++;const T=[];let I=0;for(;A<o/2;){const z=l[x],q=l[x+1];if(!q)return!1;let Z=l[x-1].angleTo(z)-z.angleTo(q);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:A,angleDelta:Z}),I+=Z;A-T[0].distance>p;)I-=T.shift().angleDelta;if(I>h)return!1;x++,A+=z.dist(q)}return!0}function QE(l){let n=0;for(let o=0;o<l.length-1;o++)n+=l[o].dist(l[o+1]);return n}function eA(l,n,o){return l?.6*n*o:0}function tA(l,n){return Math.max(l?l.right-l.left:0,n?n.right-n.left:0)}function m3(l,n,o,p,h,b){const x=eA(o,h,b),A=tA(o,p)*b;let T=0;const I=QE(l)/2;for(let z=0;z<l.length-1;z++){const q=l[z],Z=l[z+1],H=q.dist(Z);if(T+H>I){const Y=(I-T)/H,ne=ws.number(q.x,Z.x,Y),ae=ws.number(q.y,Z.y,Y),ge=new jl(ne,ae,Z.angleTo(q),z);return ge._round(),!x||JE(l,ge,A,x,n)?ge:void 0}T+=H}}function y3(l,n,o,p,h,b,x,A,T){const I=eA(p,b,x),z=tA(p,h),q=z*x,Z=l[0].x===0||l[0].x===T||l[0].y===0||l[0].y===T;return n-q<n/4&&(n=q+n/4),rA(l,Z?n/2*A%n:(z/2+2*b)*x*A%n,n,I,o,q,Z,!1,T)}function rA(l,n,o,p,h,b,x,A,T){const I=b/2,z=QE(l);let q=0,Z=n-o,H=[];for(let Y=0;Y<l.length-1;Y++){const ne=l[Y],ae=l[Y+1],ge=ne.dist(ae),qe=ae.angleTo(ne);for(;Z+o<q+ge;){Z+=o;const Ce=(Z-q)/ge,ze=ws.number(ne.x,ae.x,Ce),Je=ws.number(ne.y,ae.y,Ce);if(ze>=0&&ze<T&&Je>=0&&Je<T&&Z-I>=0&&Z+I<=z){const ot=new jl(ze,Je,qe,Y);ot._round(),p&&!JE(l,ot,b,p,h)||H.push(ot)}}q+=ge}return A||H.length||x||(H=rA(l,q/2,o,p,h,b,x,!0,T)),H}function iA(l,n,o,p){const h=[],b=l.image,x=b.pixelRatio,A=b.paddedRect.w-2,T=b.paddedRect.h-2;let I={x1:l.left,y1:l.top,x2:l.right,y2:l.bottom};const z=b.stretchX||[[0,A]],q=b.stretchY||[[0,T]],Z=(ct,ar)=>ct+ar[1]-ar[0],H=z.reduce(Z,0),Y=q.reduce(Z,0),ne=A-H,ae=T-Y;let ge=0,qe=H,Ce=0,ze=Y,Je=0,ot=ne,yt=0,Dt=ae;if(b.content&&p){const ct=b.content,ar=ct[2]-ct[0],pr=ct[3]-ct[1];(b.textFitWidth||b.textFitHeight)&&(I=DE(l)),ge=sg(z,0,ct[0]),Ce=sg(q,0,ct[1]),qe=sg(z,ct[0],ct[2]),ze=sg(q,ct[1],ct[3]),Je=ct[0]-ge,yt=ct[1]-Ce,ot=ar-qe,Dt=pr-ze}const Rt=I.x1,Pt=I.y1,Zt=I.x2-Rt,kt=I.y2-Pt,Lt=(ct,ar,pr,Jt)=>{const Gt=og(ct.stretch-ge,qe,Zt,Rt),Ur=ag(ct.fixed-Je,ot,ct.stretch,H),ki=og(ar.stretch-Ce,ze,kt,Pt),Wi=ag(ar.fixed-yt,Dt,ar.stretch,Y),Pn=og(pr.stretch-ge,qe,Zt,Rt),Ks=ag(pr.fixed-Je,ot,pr.stretch,H),ds=og(Jt.stretch-Ce,ze,kt,Pt),En=ag(Jt.fixed-yt,Dt,Jt.stretch,Y),Si=new g(Gt,ki),un=new g(Pn,ki),An=new g(Pn,ds),Rn=new g(Gt,ds),Wn=new g(Ur/x,Wi/x),Gs=new g(Ks/x,En/x),cn=n*Math.PI/180;if(cn){const dn=Math.sin(cn),pn=Math.cos(cn),$i=[pn,-dn,dn,pn];Si._matMult($i),un._matMult($i),Rn._matMult($i),An._matMult($i)}const ps=ct.stretch+ct.fixed,Yi=ar.stretch+ar.fixed;return{tl:Si,tr:un,bl:Rn,br:An,tex:{x:b.paddedRect.x+1+ps,y:b.paddedRect.y+1+Yi,w:pr.stretch+pr.fixed-ps,h:Jt.stretch+Jt.fixed-Yi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wn,pixelOffsetBR:Gs,minFontScaleX:ot/x/Zt,minFontScaleY:Dt/x/kt,isSDF:o}};if(p&&(b.stretchX||b.stretchY)){const ct=nA(z,ne,H),ar=nA(q,ae,Y);for(let pr=0;pr<ct.length-1;pr++){const Jt=ct[pr],Gt=ct[pr+1];for(let Ur=0;Ur<ar.length-1;Ur++)h.push(Lt(Jt,ar[Ur],Gt,ar[Ur+1]))}}else h.push(Lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:T+1}));return h}function sg(l,n,o){let p=0;for(const h of l)p+=Math.max(n,Math.min(o,h[1]))-Math.max(n,Math.min(o,h[0]));return p}function nA(l,n,o){const p=[{fixed:-1,stretch:0}];for(const[h,b]of l){const x=p[p.length-1];p.push({fixed:h-x.stretch,stretch:x.stretch}),p.push({fixed:h-x.stretch,stretch:x.stretch+(b-h)})}return p.push({fixed:n+1,stretch:o}),p}function og(l,n,o,p){return l/n*o+p}function ag(l,n,o,p){return l-n*o/p}It("Anchor",jl);class lg{constructor(n,o,p,h,b,x,A,T,I,z){var q;if(this.boxStartIndex=n.length,I){let Z=x.top,H=x.bottom;const Y=x.collisionPadding;Y&&(Z-=Y[1],H+=Y[3]);let ne=H-Z;ne>0&&(ne=Math.max(10,ne),this.circleDiameter=ne)}else{const Z=!((q=x.image)===null||q===void 0)&&q.content&&(x.image.textFitWidth||x.image.textFitHeight)?DE(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};Z.y1=Z.y1*A-T[0],Z.y2=Z.y2*A+T[2],Z.x1=Z.x1*A-T[3],Z.x2=Z.x2*A+T[1];const H=x.collisionPadding;if(H&&(Z.x1-=H[0]*A,Z.y1-=H[1]*A,Z.x2+=H[2]*A,Z.y2+=H[3]*A),z){const Y=new g(Z.x1,Z.y1),ne=new g(Z.x2,Z.y1),ae=new g(Z.x1,Z.y2),ge=new g(Z.x2,Z.y2),qe=z*Math.PI/180;Y._rotate(qe),ne._rotate(qe),ae._rotate(qe),ge._rotate(qe),Z.x1=Math.min(Y.x,ne.x,ae.x,ge.x),Z.x2=Math.max(Y.x,ne.x,ae.x,ge.x),Z.y1=Math.min(Y.y,ne.y,ae.y,ge.y),Z.y2=Math.max(Y.y,ne.y,ae.y,ge.y)}n.emplaceBack(o.x,o.y,Z.x1,Z.y1,Z.x2,Z.y2,p,h,b)}this.boxEndIndex=n.length}}class g3{constructor(n=[],o=(p,h)=>p<h?-1:p>h?1:0){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:p}=this,h=o[n];for(;n>0;){const b=n-1>>1,x=o[b];if(p(h,x)>=0)break;o[n]=x,n=b}o[n]=h}_down(n){const{data:o,compare:p}=this,h=this.length>>1,b=o[n];for(;n<h;){let x=1+(n<<1);const A=x+1;if(A<this.length&&p(o[A],o[x])<0&&(x=A),p(o[x],b)>=0)break;o[n]=o[x],n=x}o[n]=b}}function _3(l,n=1,o=!1){const p=Yu.fromPoints(l[0]),h=Math.min(p.width(),p.height());let b=h/2;const x=new g3([],b3),{minX:A,minY:T,maxX:I,maxY:z}=p;if(h===0)return new g(A,T);for(let H=A;H<I;H+=h)for(let Y=T;Y<z;Y+=h)x.push(new Fd(H+b,Y+b,b,l));let q=(function(H){let Y=0,ne=0,ae=0;const ge=H[0];for(let qe=0,Ce=ge.length,ze=Ce-1;qe<Ce;ze=qe++){const Je=ge[qe],ot=ge[ze],yt=Je.x*ot.y-ot.x*Je.y;ne+=(Je.x+ot.x)*yt,ae+=(Je.y+ot.y)*yt,Y+=3*yt}return new Fd(ne/Y,ae/Y,0,H)})(l),Z=x.length;for(;x.length;){const H=x.pop();(H.d>q.d||!q.d)&&(q=H,o&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,Z)),H.max-q.d<=n||(b=H.h/2,x.push(new Fd(H.p.x-b,H.p.y-b,b,l)),x.push(new Fd(H.p.x+b,H.p.y-b,b,l)),x.push(new Fd(H.p.x-b,H.p.y+b,b,l)),x.push(new Fd(H.p.x+b,H.p.y+b,b,l)),Z+=4)}return o&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${q.d}`)),q.p}function b3(l,n){return n.max-l.max}function Fd(l,n,o,p){this.p=new g(l,n),this.h=o,this.d=(function(h,b){let x=!1,A=1/0;for(let T=0;T<b.length;T++){const I=b[T];for(let z=0,q=I.length,Z=q-1;z<q;Z=z++){const H=I[z],Y=I[Z];H.y>h.y!=Y.y>h.y&&h.x<(Y.x-H.x)*(h.y-H.y)/(Y.y-H.y)+H.x&&(x=!x),A=Math.min(A,qw(h,H,Y))}}return(x?1:-1)*Math.sqrt(A)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}var kn;e.aE=void 0,(kn=e.aE||(e.aE={}))[kn.center=1]="center",kn[kn.left=2]="left",kn[kn.right=3]="right",kn[kn.top=4]="top",kn[kn.bottom=5]="bottom",kn[kn["top-left"]=6]="top-left",kn[kn["top-right"]=7]="top-right",kn[kn["bottom-left"]=8]="bottom-left",kn[kn["bottom-right"]=9]="bottom-right";const px=Number.POSITIVE_INFINITY;function sA(l,n){return n[1]!==px?(function(o,p,h){let b=0,x=0;switch(p=Math.abs(p),h=Math.abs(h),o){case"top-right":case"top-left":case"top":x=h-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-h}switch(o){case"top-right":case"bottom-right":case"right":b=-p;break;case"top-left":case"bottom-left":case"left":b=p}return[b,x]})(l,n[0],n[1]):(function(o,p){let h=0,b=0;p<0&&(p=0);const x=p/Math.SQRT2;switch(o){case"top-right":case"top-left":b=x-7;break;case"bottom-right":case"bottom-left":b=7-x;break;case"bottom":b=7-p;break;case"top":b=p-7}switch(o){case"top-right":case"bottom-right":h=-x;break;case"top-left":case"bottom-left":h=x;break;case"left":h=p;break;case"right":h=-p}return[h,b]})(l,n[0])}function oA(l,n,o){var p;const h=l.layout,b=(p=h.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(n,{},o);if(b){const A=b.values,T=[];for(let I=0;I<A.length;I+=2){const z=T[I]=A[I],q=A[I+1].map((Z=>Z*ln));z.startsWith("top")?q[1]-=7:z.startsWith("bottom")&&(q[1]+=7),T[I+1]=q}return new zn(T)}const x=h.get("text-variable-anchor");if(x){let A;A=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(n,{},o)*ln,px]:h.get("text-offset").evaluate(n,{},o).map((I=>I*ln));const T=[];for(const I of x)T.push(I,sA(I,A));return new zn(T)}return null}function fx(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function v3(l,n,o,p,h,b,x,A,T,I,z,q){let Z=b.textMaxSize.evaluate(n,{});Z===void 0&&(Z=x);const H=l.layers[0].layout,Y=H.get("icon-offset").evaluate(n,{},z),ne=lA(o.horizontal),ae=x/24,ge=l.tilePixelRatio*ae,qe=l.tilePixelRatio*Z/24,Ce=l.tilePixelRatio*A,ze=l.tilePixelRatio*H.get("symbol-spacing"),Je=H.get("text-padding")*l.tilePixelRatio,ot=(function(pr,Jt,Gt,Ur=1){const ki=pr.get("icon-padding").evaluate(Jt,{},Gt),Wi=ki&&ki.values;return[Wi[0]*Ur,Wi[1]*Ur,Wi[2]*Ur,Wi[3]*Ur]})(H,n,z,l.tilePixelRatio),yt=H.get("text-max-angle")/180*Math.PI,Dt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Rt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",Pt=H.get("symbol-placement"),Zt=ze/2,kt=H.get("icon-text-fit");let Lt;p&&kt!=="none"&&(l.allowVerticalPlacement&&o.vertical&&(Lt=IE(p,o.vertical,kt,H.get("icon-text-fit-padding"),Y,ae)),ne&&(p=IE(p,ne,kt,H.get("icon-text-fit-padding"),Y,ae)));const ct=z?q.line.getGranularityForZoomLevel(z.z):1,ar=(pr,Jt)=>{Jt.x<0||Jt.x>=lt||Jt.y<0||Jt.y>=lt||(function(Gt,Ur,ki,Wi,Pn,Ks,ds,En,Si,un,An,Rn,Wn,Gs,cn,ps,Yi,dn,pn,$i,vi,Lo,qd,Do,E3){const Kd=Gt.addToLineVertexArray(Ur,ki);let Ju,Gd,$d,Zd,pA=0,fA=0,hA=0,mA=0,xx=-1,wx=-1;const $a={};let yA=zl("");if(Gt.allowVerticalPlacement&&Wi.vertical){const Un=En.layout.get("text-rotate").evaluate(vi,{},Do)+90;$d=new lg(Si,Ur,un,An,Rn,Wi.vertical,Wn,Gs,cn,Un),ds&&(Zd=new lg(Si,Ur,un,An,Rn,ds,Yi,dn,cn,Un))}if(Pn){const Un=En.layout.get("icon-rotate").evaluate(vi,{}),$s=En.layout.get("icon-text-fit")!=="none",Qu=iA(Pn,Un,qd,$s),Bo=ds?iA(ds,Un,qd,$s):void 0;Gd=new lg(Si,Ur,un,An,Rn,Pn,Yi,dn,!1,Un),pA=4*Qu.length;const ec=Gt.iconSizeData;let aa=null;ec.kind==="source"?(aa=[Ga*En.layout.get("icon-size").evaluate(vi,{})],aa[0]>Vl&&nr(`${Gt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ec.kind==="composite"&&(aa=[Ga*Lo.compositeIconSizes[0].evaluate(vi,{},Do),Ga*Lo.compositeIconSizes[1].evaluate(vi,{},Do)],(aa[0]>Vl||aa[1]>Vl)&&nr(`${Gt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Gt.addSymbols(Gt.icon,Qu,aa,$i,pn,vi,e.ao.none,Ur,Kd.lineStartIndex,Kd.lineLength,-1,Do),xx=Gt.icon.placedSymbolArray.length-1,Bo&&(fA=4*Bo.length,Gt.addSymbols(Gt.icon,Bo,aa,$i,pn,vi,e.ao.vertical,Ur,Kd.lineStartIndex,Kd.lineLength,-1,Do),wx=Gt.icon.placedSymbolArray.length-1)}const gA=Object.keys(Wi.horizontal);for(const Un of gA){const $s=Wi.horizontal[Un];if(!Ju){yA=zl($s.text);const Bo=En.layout.get("text-rotate").evaluate(vi,{},Do);Ju=new lg(Si,Ur,un,An,Rn,$s,Wn,Gs,cn,Bo)}const Qu=$s.positionedLines.length===1;if(hA+=aA(Gt,Ur,$s,Ks,En,cn,vi,ps,Kd,Wi.vertical?e.ao.horizontal:e.ao.horizontalOnly,Qu?gA:[Un],$a,xx,Lo,Do),Qu)break}Wi.vertical&&(mA+=aA(Gt,Ur,Wi.vertical,Ks,En,cn,vi,ps,Kd,e.ao.vertical,["vertical"],$a,wx,Lo,Do));const A3=Ju?Ju.boxStartIndex:Gt.collisionBoxArray.length,R3=Ju?Ju.boxEndIndex:Gt.collisionBoxArray.length,S3=$d?$d.boxStartIndex:Gt.collisionBoxArray.length,T3=$d?$d.boxEndIndex:Gt.collisionBoxArray.length,C3=Gd?Gd.boxStartIndex:Gt.collisionBoxArray.length,k3=Gd?Gd.boxEndIndex:Gt.collisionBoxArray.length,P3=Zd?Zd.boxStartIndex:Gt.collisionBoxArray.length,L3=Zd?Zd.boxEndIndex:Gt.collisionBoxArray.length;let Io=-1;const cg=(Un,$s)=>Un&&Un.circleDiameter?Math.max(Un.circleDiameter,$s):$s;Io=cg(Ju,Io),Io=cg($d,Io),Io=cg(Gd,Io),Io=cg(Zd,Io);const _A=Io>-1?1:0;_A&&(Io*=E3/ln),Gt.glyphOffsetArray.length>=jd.MAX_GLYPHS&&nr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),vi.sortKey!==void 0&&Gt.addToSortKeyRanges(Gt.symbolInstances.length,vi.sortKey);const D3=oA(En,vi,Do),[I3,B3]=(function(Un,$s){const Qu=Un.length,Bo=$s?.values;if(Bo?.length>0)for(let ec=0;ec<Bo.length;ec+=2){const aa=Bo[ec+1];Un.emplaceBack(e.aE[Bo[ec]],aa[0],aa[1])}return[Qu,Un.length]})(Gt.textAnchorOffsets,D3);Gt.symbolInstances.emplaceBack(Ur.x,Ur.y,$a.right>=0?$a.right:-1,$a.center>=0?$a.center:-1,$a.left>=0?$a.left:-1,$a.vertical||-1,xx,wx,yA,A3,R3,S3,T3,C3,k3,P3,L3,un,hA,mA,pA,fA,_A,0,Wn,Io,I3,B3)})(l,Jt,pr,o,p,h,Lt,l.layers[0],l.collisionBoxArray,n.index,n.sourceLayerIndex,l.index,ge,[Je,Je,Je,Je],Dt,T,Ce,ot,Rt,Y,n,b,I,z,x)};if(Pt==="line")for(const pr of YE(n.geometry,0,0,lt,lt)){const Jt=Wu(pr,ct),Gt=y3(Jt,ze,yt,o.vertical||ne,p,24,qe,l.overscaling,lt);for(const Ur of Gt)ne&&x3(l,ne.text,Zt,Ur)||ar(Jt,Ur)}else if(Pt==="line-center"){for(const pr of n.geometry)if(pr.length>1){const Jt=Wu(pr,ct),Gt=m3(Jt,yt,o.vertical||ne,p,24,qe);Gt&&ar(Jt,Gt)}}else if(n.type==="Polygon")for(const pr of Qc(n.geometry,0)){const Jt=_3(pr,16);ar(Wu(pr[0],ct,!0),new jl(Jt.x,Jt.y,0))}else if(n.type==="LineString")for(const pr of n.geometry){const Jt=Wu(pr,ct);ar(Jt,new jl(Jt[0].x,Jt[0].y,0))}else if(n.type==="Point")for(const pr of n.geometry)for(const Jt of pr)ar([Jt],new jl(Jt.x,Jt.y,0))}function aA(l,n,o,p,h,b,x,A,T,I,z,q,Z,H,Y){const ne=(function(qe,Ce,ze,Je,ot,yt,Dt,Rt){const Pt=Je.layout.get("text-rotate").evaluate(yt,{})*Math.PI/180,Zt=[];for(const kt of Ce.positionedLines)for(const Lt of kt.positionedGlyphs){if(!Lt.rect)continue;const ct=Lt.rect||{};let ar=4,pr=!0,Jt=1,Gt=0;const Ur=(ot||Rt)&&Lt.vertical,ki=Lt.metrics.advance*Lt.scale/2;if(Rt&&Ce.verticalizable&&(Gt=kt.lineOffset/2-(Lt.imageName?-(ln-Lt.metrics.width*Lt.scale)/2:(Lt.scale-1)*ln)),Lt.imageName){const dn=Dt[Lt.imageName];pr=dn.sdf,Jt=dn.pixelRatio,ar=1/Jt}const Wi=ot?[Lt.x+ki,Lt.y]:[0,0];let Pn=ot?[0,0]:[Lt.x+ki+ze[0],Lt.y+ze[1]-Gt],Ks=[0,0];Ur&&(Ks=Pn,Pn=[0,0]);const ds=Lt.metrics.isDoubleResolution?2:1,En=(Lt.metrics.left-ar)*Lt.scale-ki+Pn[0],Si=(-Lt.metrics.top-ar)*Lt.scale+Pn[1],un=En+ct.w/ds*Lt.scale/Jt,An=Si+ct.h/ds*Lt.scale/Jt,Rn=new g(En,Si),Wn=new g(un,Si),Gs=new g(En,An),cn=new g(un,An);if(Ur){const dn=new g(-ki,ki- -17),pn=-Math.PI/2,$i=12-ki,vi=new g(22-$i,-(Lt.imageName?$i:0)),Lo=new g(...Ks);Rn._rotateAround(pn,dn)._add(vi)._add(Lo),Wn._rotateAround(pn,dn)._add(vi)._add(Lo),Gs._rotateAround(pn,dn)._add(vi)._add(Lo),cn._rotateAround(pn,dn)._add(vi)._add(Lo)}if(Pt){const dn=Math.sin(Pt),pn=Math.cos(Pt),$i=[pn,-dn,dn,pn];Rn._matMult($i),Wn._matMult($i),Gs._matMult($i),cn._matMult($i)}const ps=new g(0,0),Yi=new g(0,0);Zt.push({tl:Rn,tr:Wn,bl:Gs,br:cn,tex:ct,writingMode:Ce.writingMode,glyphOffset:Wi,sectionIndex:Lt.sectionIndex,isSDF:pr,pixelOffsetTL:ps,pixelOffsetBR:Yi,minFontScaleX:0,minFontScaleY:0})}return Zt})(0,o,A,h,b,x,p,l.allowVerticalPlacement),ae=l.textSizeData;let ge=null;ae.kind==="source"?(ge=[Ga*h.layout.get("text-size").evaluate(x,{})],ge[0]>Vl&&nr(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ae.kind==="composite"&&(ge=[Ga*H.compositeTextSizes[0].evaluate(x,{},Y),Ga*H.compositeTextSizes[1].evaluate(x,{},Y)],(ge[0]>Vl||ge[1]>Vl)&&nr(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,ne,ge,A,b,x,I,n,T.lineStartIndex,T.lineLength,Z,Y);for(const qe of z)q[qe]=l.text.placedSymbolArray.length-1;return 4*ne.length}function lA(l){for(const n in l)return l[n];return null}function x3(l,n,o,p){const h=l.compareText;if(n in h){const b=h[n];for(let x=b.length-1;x>=0;x--)if(p.dist(b[x])<o)return!0}else h[n]=[];return h[n].push(p),!1}const uA=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class hx{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,p]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=p>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const b=uA[15&p];if(!b)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[A]=new Uint32Array(n,4,1);return new hx(A,x,b,n)}constructor(n,o=64,p=Float64Array,h){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=p,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const b=uA.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,A=n*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-A%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${p}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+A+T,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+A+T),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+A+T,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=n,this.coords[this._pos++]=o,p}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return mx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,p,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:x,nodeSize:A}=this,T=[0,b.length-1,0],I=[];for(;T.length;){const z=T.pop()||0,q=T.pop()||0,Z=T.pop()||0;if(q-Z<=A){for(let ae=Z;ae<=q;ae++){const ge=x[2*ae],qe=x[2*ae+1];ge>=n&&ge<=p&&qe>=o&&qe<=h&&I.push(b[ae])}continue}const H=Z+q>>1,Y=x[2*H],ne=x[2*H+1];Y>=n&&Y<=p&&ne>=o&&ne<=h&&I.push(b[H]),(z===0?n<=Y:o<=ne)&&(T.push(Z),T.push(H-1),T.push(1-z)),(z===0?p>=Y:h>=ne)&&(T.push(H+1),T.push(q),T.push(1-z))}return I}within(n,o,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:b,nodeSize:x}=this,A=[0,h.length-1,0],T=[],I=p*p;for(;A.length;){const z=A.pop()||0,q=A.pop()||0,Z=A.pop()||0;if(q-Z<=x){for(let ae=Z;ae<=q;ae++)dA(b[2*ae],b[2*ae+1],n,o)<=I&&T.push(h[ae]);continue}const H=Z+q>>1,Y=b[2*H],ne=b[2*H+1];dA(Y,ne,n,o)<=I&&T.push(h[H]),(z===0?n-p<=Y:o-p<=ne)&&(A.push(Z),A.push(H-1),A.push(1-z)),(z===0?n+p>=Y:o+p>=ne)&&(A.push(H+1),A.push(q),A.push(1-z))}return T}}function mx(l,n,o,p,h,b){if(h-p<=o)return;const x=p+h>>1;cA(l,n,x,p,h,b),mx(l,n,o,p,x-1,1-b),mx(l,n,o,x+1,h,1-b)}function cA(l,n,o,p,h,b){for(;h>p;){if(h-p>600){const I=h-p+1,z=o-p+1,q=Math.log(I),Z=.5*Math.exp(2*q/3),H=.5*Math.sqrt(q*Z*(I-Z)/I)*(z-I/2<0?-1:1);cA(l,n,o,Math.max(p,Math.floor(o-z*Z/I+H)),Math.min(h,Math.floor(o+(I-z)*Z/I+H)),b)}const x=n[2*o+b];let A=p,T=h;for(Ch(l,n,p,o),n[2*h+b]>x&&Ch(l,n,p,h);A<T;){for(Ch(l,n,A,T),A++,T--;n[2*A+b]<x;)A++;for(;n[2*T+b]>x;)T--}n[2*p+b]===x?Ch(l,n,p,T):(T++,Ch(l,n,T,h)),T<=o&&(p=T+1),o<=T&&(h=T-1)}}function Ch(l,n,o,p){yx(l,o,p),yx(n,2*o,2*p),yx(n,2*o+1,2*p+1)}function yx(l,n,o){const p=l[n];l[n]=l[o],l[o]=p}function dA(l,n,o,p){const h=l-o,b=n-p;return h*h+b*b}var gx;e.cx=void 0,(gx=e.cx||(e.cx={})).create="create",gx.load="load",gx.fullLoad="fullLoad";let ug=null,kh=[];const _x=1e3/60,bx="loadTime",vx="fullLoadTime",w3={mark(l){performance.mark(l)},frame(l){const n=l;ug!=null&&kh.push(n-ug),ug=n},clearMetrics(){ug=null,kh=[],performance.clearMeasures(bx),performance.clearMeasures(vx);for(const l in e.cx)performance.clearMarks(e.cx[l])},getPerformanceMetrics(){performance.measure(bx,e.cx.create,e.cx.load),performance.measure(vx,e.cx.create,e.cx.fullLoad);const l=performance.getEntriesByName(bx)[0].duration,n=performance.getEntriesByName(vx)[0].duration,o=kh.length,p=1/(kh.reduce(((b,x)=>b+x),0)/o/1e3),h=kh.filter((b=>b>_x)).reduce(((b,x)=>b+(x-_x)/_x),0);return{loadTime:l,fullLoadTime:n,fps:p,percentDroppedFrames:h/(o+h)*100,totalFrames:o}}};e.$=lt,e.A=le,e.B=function([l,n,o]){return n+=90,n*=Math.PI/180,o*=Math.PI/180,{x:l*Math.cos(n)*Math.sin(o),y:l*Math.sin(n)*Math.sin(o),z:l*Math.cos(o)}},e.C=ws,e.D=Kt,e.E=qt,e.F=mi,e.G=eh,e.H=Ct,e.I=tx,e.J=class{constructor(l,n){this.target=l,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new p3((()=>this.process())),this.subscription=gi(this.target,"message",(o=>this.receive(o)),!1),this.globalScope=Vt(self)?l:window}registerMessageHandler(l,n){this.messageHandlers[l]=n}sendAsync(l,n){return new Promise(((o,p)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),b=n?gi(n.signal,"abort",(()=>{b?.unsubscribe(),delete this.resolveRejects[h];const T={id:h,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)}),f3):null;this.resolveRejects[h]={resolve:T=>{b?.unsubscribe(),o(T)},reject:T=>{b?.unsubscribe(),p(T)}};const x=[],A=Object.assign(Object.assign({},l),{id:h,sourceMapId:this.mapId,origin:location.origin,data:Nu(l.data,x)});this.target.postMessage(A,{transfer:x})}))}receive(l){const n=l.data,o=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[o];const p=this.abortControllers[o];return delete this.abortControllers[o],void(p&&p.abort())}if(Vt(self)||n.mustQueue)return this.tasks[o]=n,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,n)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),n=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(l,n)}processTask(l,n){return a(this,void 0,void 0,(function*(){if(n.type==="<response>"){const h=this.resolveRejects[l];return delete this.resolveRejects[l],h?void(n.error?h.reject(Ua(n.error)):h.resolve(Ua(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=Ua(n.data),p=new AbortController;this.abortControllers[l]=p;try{const h=yield this.messageHandlers[n.type](n.sourceMapId,o,p);this.completeTask(l,null,h)}catch(h){this.completeTask(l,h)}}))}completeTask(l,n,o){const p=[];delete this.abortControllers[l];const h={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?Nu(n):null,data:Nu(o,p)};this.target.postMessage(h,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.K=ve,e.L=function(){var l=new le(16);return le!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},e.M=function(l,n,o){var p,h,b,x,A,T,I,z,q,Z,H,Y,ne=o[0],ae=o[1],ge=o[2];return n===l?(l[12]=n[0]*ne+n[4]*ae+n[8]*ge+n[12],l[13]=n[1]*ne+n[5]*ae+n[9]*ge+n[13],l[14]=n[2]*ne+n[6]*ae+n[10]*ge+n[14],l[15]=n[3]*ne+n[7]*ae+n[11]*ge+n[15]):(h=n[1],b=n[2],x=n[3],A=n[4],T=n[5],I=n[6],z=n[7],q=n[8],Z=n[9],H=n[10],Y=n[11],l[0]=p=n[0],l[1]=h,l[2]=b,l[3]=x,l[4]=A,l[5]=T,l[6]=I,l[7]=z,l[8]=q,l[9]=Z,l[10]=H,l[11]=Y,l[12]=p*ne+A*ae+q*ge+n[12],l[13]=h*ne+T*ae+Z*ge+n[13],l[14]=b*ne+I*ae+H*ge+n[14],l[15]=x*ne+z*ae+Y*ge+n[15]),l},e.N=function(l,n,o){var p=o[0],h=o[1],b=o[2];return l[0]=n[0]*p,l[1]=n[1]*p,l[2]=n[2]*p,l[3]=n[3]*p,l[4]=n[4]*h,l[5]=n[5]*h,l[6]=n[6]*h,l[7]=n[7]*h,l[8]=n[8]*b,l[9]=n[9]*b,l[10]=n[10]*b,l[11]=n[11]*b,l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l},e.O=function(l,n,o){var p=n[0],h=n[1],b=n[2],x=n[3],A=n[4],T=n[5],I=n[6],z=n[7],q=n[8],Z=n[9],H=n[10],Y=n[11],ne=n[12],ae=n[13],ge=n[14],qe=n[15],Ce=o[0],ze=o[1],Je=o[2],ot=o[3];return l[0]=Ce*p+ze*A+Je*q+ot*ne,l[1]=Ce*h+ze*T+Je*Z+ot*ae,l[2]=Ce*b+ze*I+Je*H+ot*ge,l[3]=Ce*x+ze*z+Je*Y+ot*qe,l[4]=(Ce=o[4])*p+(ze=o[5])*A+(Je=o[6])*q+(ot=o[7])*ne,l[5]=Ce*h+ze*T+Je*Z+ot*ae,l[6]=Ce*b+ze*I+Je*H+ot*ge,l[7]=Ce*x+ze*z+Je*Y+ot*qe,l[8]=(Ce=o[8])*p+(ze=o[9])*A+(Je=o[10])*q+(ot=o[11])*ne,l[9]=Ce*h+ze*T+Je*Z+ot*ae,l[10]=Ce*b+ze*I+Je*H+ot*ge,l[11]=Ce*x+ze*z+Je*Y+ot*qe,l[12]=(Ce=o[12])*p+(ze=o[13])*A+(Je=o[14])*q+(ot=o[15])*ne,l[13]=Ce*h+ze*T+Je*Z+ot*ae,l[14]=Ce*b+ze*I+Je*H+ot*ge,l[15]=Ce*x+ze*z+Je*Y+ot*qe,l},e.P=g,e.Q=function(l,n){const o={};for(let p=0;p<n.length;p++){const h=n[p];h in l&&(o[h]=l[h])}return o},e.R=cs,e.S=Ul,e.T=G0,e.U=FE,e.V=NE,e.W=K,e.X=U,e.Y=Lr,e.Z=qs,e._=a,e.a=J,e.a$=te,e.a0=function(l,n){var o,p,h,b,x;if(!l)return n??{};if(!n)return l;let A=Object.assign({},l);if(n.removeAll&&(A={removeAll:!0}),n.remove){const T=new Set(n.remove);A.add&&(A.add=A.add.filter((z=>!T.has(z.id)))),A.update&&(A.update=A.update.filter((z=>!T.has(z.id))));const I=new Set(((o=l.add)!==null&&o!==void 0?o:[]).map((z=>z.id)));n.remove=n.remove.filter((z=>!I.has(z)))}if(n.remove){const T=new Set(A.remove?A.remove.concat(n.remove):n.remove);A.remove=Array.from(T.values())}if(n.add){const T=A.add?A.add.concat(n.add):n.add,I=new Map(T.map((z=>[z.id,z])));A.add=Array.from(I.values())}if(n.update){const T=new Map((p=A.update)===null||p===void 0?void 0:p.map((I=>[I.id,I])));for(const I of n.update){const z=(h=T.get(I.id))!==null&&h!==void 0?h:{id:I.id};I.newGeometry&&(z.newGeometry=I.newGeometry),I.addOrUpdateProperties&&(z.addOrUpdateProperties=((b=z.addOrUpdateProperties)!==null&&b!==void 0?b:[]).concat(I.addOrUpdateProperties)),I.removeProperties&&(z.removeProperties=((x=z.removeProperties)!==null&&x!==void 0?x:[]).concat(I.removeProperties)),I.removeAllProperties&&(z.removeAllProperties=!0),T.set(I.id,z)}A.update=Array.from(T.values())}return A.remove&&A.add&&(A.remove=A.remove.filter((T=>A.add.findIndex((I=>I.id===T))===-1))),A},e.a1=Sh,e.a2=Yu,e.a3=25,e.a4=dx,e.a5=l=>{const n=window.document.createElement("video");return n.muted=!0,new Promise((o=>{n.onloadstart=()=>{o(n)};for(const p of l){const h=window.document.createElement("source");Ne(p)||(n.crossOrigin="Anonymous"),h.src=p,n.appendChild(h)}}))},e.a6=pt,e.a7=function(){return kr++},e.a8=$,e.a9=jd,e.aA=function(l){let n=1/0,o=1/0,p=-1/0,h=-1/0;for(const b of l)n=Math.min(n,b.x),o=Math.min(o,b.y),p=Math.max(p,b.x),h=Math.max(h,b.y);return[n,o,p,h]},e.aB=ln,e.aC=be,e.aD=function(l,n,o,p,h=!1){if(!o[0]&&!o[1])return[0,0];const b=h?p==="map"?-l.bearingInRadians:0:p==="viewport"?l.bearingInRadians:0;if(b){const x=Math.sin(b),A=Math.cos(b);o=[o[0]*A-o[1]*x,o[0]*x+o[1]*A]}return[h?o[0]:be(n,o[0],l.zoom),h?o[1]:be(n,o[1],l.zoom)]},e.aF=nx,e.aG=fx,e.aH=ix,e.aI=hx,e.aJ=Mi,e.aK=Qy,e.aL=Ue,e.aM=Nr,e.aN=ii,e.aO=qr,e.aP=Oe,e.aQ=KE,e.aR=He,e.aS=dt,e.aT=function(l){var n=new le(3);return n[0]=l[0],n[1]=l[1],n[2]=l[2],n},e.aU=function(l,n,o){return l[0]=n[0]-o[0],l[1]=n[1]-o[1],l[2]=n[2]-o[2],l},e.aV=function(l,n){var o=n[0],p=n[1],h=n[2],b=o*o+p*p+h*h;return b>0&&(b=1/Math.sqrt(b)),l[0]=n[0]*b,l[1]=n[1]*b,l[2]=n[2]*b,l},e.aW=et,e.aX=function(l,n){return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]},e.aY=function(l,n,o){return l[0]=n[0]*o[0],l[1]=n[1]*o[1],l[2]=n[2]*o[2],l[3]=n[3]*o[3],l},e.aZ=_e,e.a_=function(l,n,o){const p=n[0]*o[0]+n[1]*o[1]+n[2]*o[2];return p===0?null:(-(l[0]*o[0]+l[1]*o[1]+l[2]*o[2])-o[3])/p},e.aa=Bu,e.ab=Hu,e.ac=HE,e.ad=function(l){const n={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((o,p,h,b)=>{const x=h||b;return n[p]=!x||x.toLowerCase(),""})),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n},e.ae=Oi,e.af=function(l){return Math.pow(2,l)},e.ag=Te,e.ah=tr,e.ai=85.051129,e.aj=qE,e.ak=function(l){return Math.log(l)/Math.LN2},e.al=function(l){var n=l[0],o=l[1];return n*n+o*o},e.am=function(l){if(!l.length)return new Set;const n=Math.max(...l.map((T=>T.canonical.z)));let o=1/0,p=-1/0,h=1/0,b=-1/0;const x=[];for(const T of l){const{x:I,y:z,z:q}=T.canonical,Z=Math.pow(2,n-q),H=I*Z,Y=z*Z;x.push({id:T,x:H,y:Y}),H<o&&(o=H),H>p&&(p=H),Y<h&&(h=Y),Y>b&&(b=Y)}const A=new Set;for(const T of x)T.x!==o&&T.x!==p&&T.y!==h&&T.y!==b||A.add(T.id);return A},e.an=function(l,n){let o=0,p=0;if(l.kind==="constant")p=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:h,minZoom:b,maxZoom:x}=l,A=h?tr(Hi.interpolationFactor(h,n,b,x),0,1):0;l.kind==="camera"?p=ws.number(l.minSize,l.maxSize,A):o=A}return{uSizeT:o,uSize:p}},e.ap=function(l,{uSize:n,uSizeT:o},{lowerSize:p,upperSize:h}){return l.kind==="source"?p/Ga:l.kind==="composite"?ws.number(p/Ga,h/Ga,o):n},e.aq=function(l,n){var o=n[0],p=n[1],h=n[2],b=n[3],x=n[4],A=n[5],T=n[6],I=n[7],z=n[8],q=n[9],Z=n[10],H=n[11],Y=n[12],ne=n[13],ae=n[14],ge=n[15],qe=o*A-p*x,Ce=o*T-h*x,ze=o*I-b*x,Je=p*T-h*A,ot=p*I-b*A,yt=h*I-b*T,Dt=z*ne-q*Y,Rt=z*ae-Z*Y,Pt=z*ge-H*Y,Zt=q*ae-Z*ne,kt=q*ge-H*ne,Lt=Z*ge-H*ae,ct=qe*Lt-Ce*kt+ze*Zt+Je*Pt-ot*Rt+yt*Dt;return ct?(l[0]=(A*Lt-T*kt+I*Zt)*(ct=1/ct),l[1]=(h*kt-p*Lt-b*Zt)*ct,l[2]=(ne*yt-ae*ot+ge*Je)*ct,l[3]=(Z*ot-q*yt-H*Je)*ct,l[4]=(T*Pt-x*Lt-I*Rt)*ct,l[5]=(o*Lt-h*Pt+b*Rt)*ct,l[6]=(ae*ze-Y*yt-ge*Ce)*ct,l[7]=(z*yt-Z*ze+H*Ce)*ct,l[8]=(x*kt-A*Pt+I*Dt)*ct,l[9]=(p*Pt-o*kt-b*Dt)*ct,l[10]=(Y*ot-ne*ze+ge*qe)*ct,l[11]=(q*ze-z*ot-H*qe)*ct,l[12]=(A*Rt-x*Zt-T*Dt)*ct,l[13]=(o*Zt-p*Rt+h*Dt)*ct,l[14]=(ne*Ce-Y*Je-ae*qe)*ct,l[15]=(z*Je-q*Ce+Z*qe)*ct,l):null},e.ar=nt,e.as=function(l){var n=l[0],o=l[1];return Math.sqrt(n*n+o*o)},e.at=function(l){return l[0]=0,l[1]=0,l},e.au=function(l,n,o){return l[0]=n[0]*o,l[1]=n[1]*o,l},e.av=sx,e.aw=Be,e.ax=function(l,n,o,p){const h=n.y-l.y,b=n.x-l.x,x=p.y-o.y,A=p.x-o.x,T=x*b-A*h;if(T===0)return null;const I=(A*(l.y-o.y)-x*(l.x-o.x))/T;return new g(l.x+I*b,l.y+I*h)},e.ay=YE,e.az=Nw,e.b=er,e.b$=class extends ls{constructor(l,n){super(l,n),this.current=new Array}set(l){if(l!=this.current){this.current=l;const n=new Float32Array(l);this.gl.uniform1fv(this.location,n)}}},e.b0=function(l,n,o){return l[0]=n[0]*o,l[1]=n[1]*o,l[2]=n[2]*o,l[3]=n[3]*o,l},e.b1=function(l,n){return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]+l[3]},e.b2=$E,e.b3=Nd,e.b4=function(l,n,o,p,h){var b=1/Math.tan(n/2);if(l[0]=b/o,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=b,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,h!=null&&h!==1/0){var x=1/(p-h);l[10]=(h+p)*x,l[14]=2*h*p*x}else l[10]=-1,l[14]=-2*p;return l},e.b5=function(l){var n=new le(16);return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n},e.b6=function(l,n,o){var p=Math.sin(o),h=Math.cos(o),b=n[0],x=n[1],A=n[2],T=n[3],I=n[4],z=n[5],q=n[6],Z=n[7];return n!==l&&(l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15]),l[0]=b*h+I*p,l[1]=x*h+z*p,l[2]=A*h+q*p,l[3]=T*h+Z*p,l[4]=I*h-b*p,l[5]=z*h-x*p,l[6]=q*h-A*p,l[7]=Z*h-T*p,l},e.b7=function(l,n,o){var p=Math.sin(o),h=Math.cos(o),b=n[4],x=n[5],A=n[6],T=n[7],I=n[8],z=n[9],q=n[10],Z=n[11];return n!==l&&(l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15]),l[4]=b*h+I*p,l[5]=x*h+z*p,l[6]=A*h+q*p,l[7]=T*h+Z*p,l[8]=I*h-b*p,l[9]=z*h-x*p,l[10]=q*h-A*p,l[11]=Z*h-T*p,l},e.b8=function(){const l=new Float32Array(16);return Te(l),l},e.b9=function(){const l=new Float64Array(16);return Te(l),l},e.bA=function(l,n){const o=Ft(l,360),p=Ft(n,360),h=p-o,b=p>o?h-360:h+360;return Math.abs(h)<Math.abs(b)?h:b},e.bB=function(l){return l[0]=0,l[1]=0,l[2]=0,l},e.bC=function(l,n,o,p){const h=Math.sqrt(l*l+n*n),b=Math.sqrt(o*o+p*p);l/=h,n/=h,o/=b,p/=b;const x=Math.acos(l*o+n*p);return-n*o+l*p>0?x:-x},e.bD=function(l,n){const o=Ft(l,2*Math.PI),p=Ft(n,2*Math.PI);return Math.min(Math.abs(o-p),Math.abs(o-p+2*Math.PI),Math.abs(o-p-2*Math.PI))},e.bE=function(){const l={},n=Ke.$version;for(const o in Ke.$root){const p=Ke.$root[o];if(p.required){let h=null;h=o==="version"?n:p.type==="array"?[]:{},h!=null&&(l[o]=h)}}return l},e.bF=Ll,e.bG=je,e.bH=function l(n,o){if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let p=0;p<n.length;p++)if(!l(n[p],o[p]))return!1;return!0}if(typeof n=="object"&&n!==null&&o!==null){if(typeof o!="object"||Object.keys(n).length!==Object.keys(o).length)return!1;for(const p in n)if(!l(n[p],o[p]))return!1;return!0}return n===o},e.bI=function(l){l=l.slice();const n=Object.create(null);for(let o=0;o<l.length;o++)n[l[o].id]=l[o];for(let o=0;o<l.length;o++)"ref"in l[o]&&(l[o]=Dr(l[o],n[l[o].ref]));return l},e.bJ=function(l,n){if(l.type==="custom")return new d3(l,n);switch(l.type){case"background":return new c3(l,n);case"circle":return new XM(l,n);case"color-relief":return new tz(l,n);case"fill":return new yz(l,n);case"fill-extrusion":return new Tz(l,n);case"heatmap":return new YM(l,n);case"hillshade":return new QM(l,n);case"line":return new Bz(l,n);case"raster":return new z0(l,n);case"symbol":return new ng(l,n)}},e.bK=l=>l.type==="raster",e.bL=sr,e.bM=function(l,n){if(!l)return[{command:"setStyle",args:[n]}];let o=[];try{if(!Ot(l.version,n.version))return[{command:"setStyle",args:[n]}];Ot(l.center,n.center)||o.push({command:"setCenter",args:[n.center]}),Ot(l.state,n.state)||o.push({command:"setGlobalState",args:[n.state]}),Ot(l.centerAltitude,n.centerAltitude)||o.push({command:"setCenterAltitude",args:[n.centerAltitude]}),Ot(l.zoom,n.zoom)||o.push({command:"setZoom",args:[n.zoom]}),Ot(l.bearing,n.bearing)||o.push({command:"setBearing",args:[n.bearing]}),Ot(l.pitch,n.pitch)||o.push({command:"setPitch",args:[n.pitch]}),Ot(l.roll,n.roll)||o.push({command:"setRoll",args:[n.roll]}),Ot(l.sprite,n.sprite)||o.push({command:"setSprite",args:[n.sprite]}),Ot(l.glyphs,n.glyphs)||o.push({command:"setGlyphs",args:[n.glyphs]}),Ot(l.transition,n.transition)||o.push({command:"setTransition",args:[n.transition]}),Ot(l.light,n.light)||o.push({command:"setLight",args:[n.light]}),Ot(l.terrain,n.terrain)||o.push({command:"setTerrain",args:[n.terrain]}),Ot(l.sky,n.sky)||o.push({command:"setSky",args:[n.sky]}),Ot(l.projection,n.projection)||o.push({command:"setProjection",args:[n.projection]});const p={},h=[];(function(x,A,T,I){let z;for(z in A=A||{},x=x||{})Object.prototype.hasOwnProperty.call(x,z)&&(Object.prototype.hasOwnProperty.call(A,z)||fi(z,T,I));for(z in A)Object.prototype.hasOwnProperty.call(A,z)&&(Object.prototype.hasOwnProperty.call(x,z)?Ot(x[z],A[z])||(x[z].type==="geojson"&&A[z].type==="geojson"&&_i(x,A,z)?gr(T,{command:"setGeoJSONSourceData",args:[z,A[z].data]}):ti(z,A,T,I)):pi(z,A,T))})(l.sources,n.sources,h,p);const b=[];l.layers&&l.layers.forEach((x=>{"source"in x&&p[x.source]?o.push({command:"removeLayer",args:[x.id]}):b.push(x)})),o=o.concat(h),(function(x,A,T){A=A||[];const I=(x=x||[]).map(oi),z=A.map(oi),q=x.reduce(Mr,{}),Z=A.reduce(Mr,{}),H=I.slice(),Y=Object.create(null);let ne,ae,ge,qe,Ce;for(let ze=0,Je=0;ze<I.length;ze++)ne=I[ze],Object.prototype.hasOwnProperty.call(Z,ne)?Je++:(gr(T,{command:"removeLayer",args:[ne]}),H.splice(H.indexOf(ne,Je),1));for(let ze=0,Je=0;ze<z.length;ze++)ne=z[z.length-1-ze],H[H.length-1-ze]!==ne&&(Object.prototype.hasOwnProperty.call(q,ne)?(gr(T,{command:"removeLayer",args:[ne]}),H.splice(H.lastIndexOf(ne,H.length-Je),1)):Je++,qe=H[H.length-ze],gr(T,{command:"addLayer",args:[Z[ne],qe]}),H.splice(H.length-ze,0,ne),Y[ne]=!0);for(let ze=0;ze<z.length;ze++)if(ne=z[ze],ae=q[ne],ge=Z[ne],!Y[ne]&&!Ot(ae,ge))if(Ot(ae.source,ge.source)&&Ot(ae["source-layer"],ge["source-layer"])&&Ot(ae.type,ge.type)){for(Ce in Kr(ae.layout,ge.layout,T,ne,null,"setLayoutProperty"),Kr(ae.paint,ge.paint,T,ne,null,"setPaintProperty"),Ot(ae.filter,ge.filter)||gr(T,{command:"setFilter",args:[ne,ge.filter]}),Ot(ae.minzoom,ge.minzoom)&&Ot(ae.maxzoom,ge.maxzoom)||gr(T,{command:"setLayerZoomRange",args:[ne,ge.minzoom,ge.maxzoom]}),ae)Object.prototype.hasOwnProperty.call(ae,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?Kr(ae[Ce],ge[Ce],T,ne,Ce.slice(6),"setPaintProperty"):Ot(ae[Ce],ge[Ce])||gr(T,{command:"setLayerProperty",args:[ne,Ce,ge[Ce]]}));for(Ce in ge)Object.prototype.hasOwnProperty.call(ge,Ce)&&!Object.prototype.hasOwnProperty.call(ae,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?Kr(ae[Ce],ge[Ce],T,ne,Ce.slice(6),"setPaintProperty"):Ot(ae[Ce],ge[Ce])||gr(T,{command:"setLayerProperty",args:[ne,Ce,ge[Ce]]}))}else gr(T,{command:"removeLayer",args:[ne]}),qe=H[H.lastIndexOf(ne)+1],gr(T,{command:"addLayer",args:[ge,qe]})})(b,n.layers,o)}catch(p){console.warn("Unable to compute style diff:",p),o=[{command:"setStyle",args:[n]}]}return o},e.bN=function(l){const n=[],o=l.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},e.bO=Sr,e.bP=$r,e.bQ=class extends ls{constructor(l,n){super(l,n),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},e.bR=us,e.bS=class extends ls{constructor(l,n){super(l,n),this.current=an}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let n=1;n<16;n++)if(l[n]!==this.current[n]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},e.bT=Xi,e.bU=class extends ls{constructor(l,n){super(l,n),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},e.bV=class extends ls{constructor(l,n){super(l,n),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},e.bW=Q,e.bX=function(l,n){var o=Math.sin(n),p=Math.cos(n);return l[0]=p,l[1]=o,l[2]=0,l[3]=-o,l[4]=p,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},e.bY=function(l,n,o){var p=n[0],h=n[1],b=n[2];return l[0]=p*o[0]+h*o[3]+b*o[6],l[1]=p*o[1]+h*o[4]+b*o[7],l[2]=p*o[2]+h*o[5]+b*o[8],l},e.bZ=function(l,n,o,p,h,b,x){var A=1/(n-o),T=1/(p-h),I=1/(b-x);return l[0]=-2*A,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*T,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*I,l[11]=0,l[12]=(n+o)*A,l[13]=(h+p)*T,l[14]=(x+b)*I,l[15]=1,l},e.b_=class extends ls{constructor(l,n){super(l,n),this.current=new Array}set(l){if(l!=this.current){this.current=l;const n=new Float32Array(4*l.length);for(let o=0;o<l.length;o++)n[4*o]=l[o].r,n[4*o+1]=l[o].g,n[4*o+2]=l[o].b,n[4*o+3]=l[o].a;this.gl.uniform4fv(this.location,n)}}},e.ba=function(){return new Float64Array(16)},e.bb=function(l,n,o){const p=new Float64Array(4);return ye(p,l,n-90,o),p},e.bc=function(l,n,o,p){var h,b,x,A,T,I=n[0],z=n[1],q=n[2],Z=n[3],H=o[0],Y=o[1],ne=o[2],ae=o[3];return(b=I*H+z*Y+q*ne+Z*ae)<0&&(b=-b,H=-H,Y=-Y,ne=-ne,ae=-ae),1-b>ee?(h=Math.acos(b),x=Math.sin(h),A=Math.sin((1-p)*h)/x,T=Math.sin(p*h)/x):(A=1-p,T=p),l[0]=A*I+T*H,l[1]=A*z+T*Y,l[2]=A*q+T*ne,l[3]=A*Z+T*ae,l},e.bd=function(l){const n=new Float64Array(9);var o,p,h,b,x,A,T,I,z,q,Z,H,Y,ne,ae,ge,qe,Ce;q=(h=(p=l)[0])*(T=h+h),Z=(b=p[1])*T,Y=(x=p[2])*T,ne=x*(I=b+b),ge=(A=p[3])*T,qe=A*I,Ce=A*(z=x+x),(o=n)[0]=1-(H=b*I)-(ae=x*z),o[3]=Z-Ce,o[6]=Y+qe,o[1]=Z+Ce,o[4]=1-q-ae,o[7]=ne-ge,o[2]=Y-qe,o[5]=ne+ge,o[8]=1-q-H;const ze=Oe(-Math.asin(tr(n[2],-1,1)));let Je,ot;return Math.hypot(n[5],n[8])<.001?(Je=0,ot=-Oe(Math.atan2(n[3],n[4]))):(Je=Oe(n[5]===0&&n[8]===0?0:Math.atan2(n[5],n[8])),ot=Oe(n[1]===0&&n[0]===0?0:Math.atan2(n[1],n[0]))),{roll:Je,pitch:ze+90,bearing:ot}},e.be=function(l,n){return l.roll==n.roll&&l.pitch==n.pitch&&l.bearing==n.bearing},e.bf=Tr,e.bg=zi,e.bh=zd,e.bi=vh,e.bj=Md,e.bk=Ut,e.bl=Le,e.bm=Hn,e.bn=function(l,n,o,p,h){return Ut(p,h,tr((l-n)/(o-n),0,1))},e.bo=Ft,e.bp=function(){return new Float64Array(3)},e.bq=function(l,n,o,p){return l[0]=n[0]+o[0]*p,l[1]=n[1]+o[1]*p,l[2]=n[2]+o[2]*p,l},e.br=ye,e.bs=function(l,n,o){var p=o[0],h=o[1],b=o[2],x=o[3],A=n[0],T=n[1],I=n[2],z=h*I-b*T,q=b*A-p*I,Z=p*T-h*A;return l[0]=A+x*(z+=z)+h*(Z+=Z)-b*(q+=q),l[1]=T+x*q+b*z-p*Z,l[2]=I+x*Z+p*q-h*z,l},e.bt=function(l,n,o){const p=(h=[l[0],l[1],l[2],n[0],n[1],n[2],o[0],o[1],o[2]])[0]*((z=h[8])*(x=h[4])-(A=h[5])*(I=h[7]))+h[1]*(-z*(b=h[3])+A*(T=h[6]))+h[2]*(I*b-x*T);var h,b,x,A,T,I,z;if(p===0)return null;const q=et([],[n[0],n[1],n[2]],[o[0],o[1],o[2]]),Z=et([],[o[0],o[1],o[2]],[l[0],l[1],l[2]]),H=et([],[l[0],l[1],l[2]],[n[0],n[1],n[2]]),Y=He([],q,-l[3]);return dt(Y,Y,He([],Z,-n[3])),dt(Y,Y,He([],H,-o[3])),He(Y,Y,1/p),Y},e.bu=ux,e.bv=function(){return new Float64Array(4)},e.bw=function(l,n,o,p){var h=[],b=[];return h[0]=n[0]-o[0],h[1]=n[1]-o[1],h[2]=n[2]-o[2],b[0]=h[0]*Math.cos(p)-h[1]*Math.sin(p),b[1]=h[0]*Math.sin(p)+h[1]*Math.cos(p),b[2]=h[2],l[0]=b[0]+o[0],l[1]=b[1]+o[1],l[2]=b[2]+o[2],l},e.bx=function(l,n,o,p){var h=[],b=[];return h[0]=n[0]-o[0],h[1]=n[1]-o[1],h[2]=n[2]-o[2],b[0]=h[0],b[1]=h[1]*Math.cos(p)-h[2]*Math.sin(p),b[2]=h[1]*Math.sin(p)+h[2]*Math.cos(p),l[0]=b[0]+o[0],l[1]=b[1]+o[1],l[2]=b[2]+o[2],l},e.by=function(l,n,o,p){var h=[],b=[];return h[0]=n[0]-o[0],h[1]=n[1]-o[1],h[2]=n[2]-o[2],b[0]=h[2]*Math.sin(p)+h[0]*Math.cos(p),b[1]=h[1],b[2]=h[2]*Math.cos(p)-h[0]*Math.sin(p),l[0]=b[0]+o[0],l[1]=b[1]+o[1],l[2]=b[2]+o[2],l},e.bz=function(l,n,o){var p=Math.sin(o),h=Math.cos(o),b=n[0],x=n[1],A=n[2],T=n[3],I=n[8],z=n[9],q=n[10],Z=n[11];return n!==l&&(l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15]),l[0]=b*h-I*p,l[1]=x*h-z*p,l[2]=A*h-q*p,l[3]=T*h-Z*p,l[8]=b*p+I*h,l[9]=x*p+z*h,l[10]=A*p+q*h,l[11]=T*p+Z*h,l},e.c=W,e.c0=class extends uh{},e.c1=Vz,e.c2=class extends t{},e.c3=K0,e.c4=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},e.c5=Yw,e.c6=function(l,n,o){var p=n[0],h=n[1],b=n[2],x=o[3]*p+o[7]*h+o[11]*b+o[15];return l[0]=(o[0]*p+o[4]*h+o[8]*b+o[12])/(x=x||1),l[1]=(o[1]*p+o[5]*h+o[9]*b+o[13])/x,l[2]=(o[2]*p+o[6]*h+o[10]*b+o[14])/x,l},e.c7=class extends Cd{},e.c8=class extends P{},e.c9=function(l,n){return l[0]===n[0]&&l[1]===n[1]&&l[2]===n[2]&&l[3]===n[3]&&l[4]===n[4]&&l[5]===n[5]&&l[6]===n[6]&&l[7]===n[7]&&l[8]===n[8]&&l[9]===n[9]&&l[10]===n[10]&&l[11]===n[11]&&l[12]===n[12]&&l[13]===n[13]&&l[14]===n[14]&&l[15]===n[15]},e.cA=function(l,n){J.REGISTERED_PROTOCOLS[l]=n},e.cB=function(l){delete J.REGISTERED_PROTOCOLS[l]},e.cC=function(l,n){const o={};for(let h=0;h<l.length;h++){const b=n&&n[l[h].id]||bd(l[h]);n&&(n[l[h].id]=b);let x=o[b];x||(x=o[b]=[]),x.push(l[h])}const p=[];for(const h in o)p.push(o[h]);return p},e.cD=It,e.cE=ZE,e.cF=XE,e.cG=SE,e.cH=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=lt/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const n=l.bucket.layers[0],o=n.layout,p=n._unevaluatedLayout._values,h={layoutIconSize:p["icon-size"].possiblyEvaluate(new mi(l.bucket.zoom+1),l.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new mi(l.bucket.zoom+1),l.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new mi(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:z}=l.bucket.textSizeData;h.compositeTextSizes=[p["text-size"].possiblyEvaluate(new mi(I),l.canonical),p["text-size"].possiblyEvaluate(new mi(z),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:z}=l.bucket.iconSizeData;h.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new mi(I),l.canonical),p["icon-size"].possiblyEvaluate(new mi(z),l.canonical)]}const b=o.get("text-line-height")*ln,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",A=o.get("text-keep-upright"),T=o.get("text-size");for(const I of l.bucket.features){const z=o.get("text-font").evaluate(I,{},l.canonical).join(","),q=T.evaluate(I,{},l.canonical),Z=h.layoutTextSize.evaluate(I,{},l.canonical),H=h.layoutIconSize.evaluate(I,{},l.canonical),Y={horizontal:{},vertical:void 0},ne=I.text;let ae,ge=[0,0];if(ne){const ze=ne.toString(),Je=o.get("text-letter-spacing").evaluate(I,{},l.canonical)*ln,ot=My(ze)?Je:0,yt=o.get("text-anchor").evaluate(I,{},l.canonical),Dt=oA(n,I,l.canonical);if(!Dt){const kt=o.get("text-radial-offset").evaluate(I,{},l.canonical);ge=kt?sA(yt,[kt*ln,px]):o.get("text-offset").evaluate(I,{},l.canonical).map((Lt=>Lt*ln))}let Rt=x?"center":o.get("text-justify").evaluate(I,{},l.canonical);const Pt=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(I,{},l.canonical)*ln:1/0,Zt=()=>{l.bucket.allowVerticalPlacement&&wd(ze)&&(Y.vertical=tg(ne,l.glyphMap,l.glyphPositions,l.imagePositions,z,Pt,b,yt,"left",ot,ge,e.ao.vertical,!0,Z,q))};if(!x&&Dt){const kt=new Set;if(Rt==="auto")for(let ct=0;ct<Dt.values.length;ct+=2)kt.add(fx(Dt.values[ct]));else kt.add(Rt);let Lt=!1;for(const ct of kt)if(!Y.horizontal[ct])if(Lt)Y.horizontal[ct]=Y.horizontal[0];else{const ar=tg(ne,l.glyphMap,l.glyphPositions,l.imagePositions,z,Pt,b,"center",ct,ot,ge,e.ao.horizontal,!1,Z,q);ar&&(Y.horizontal[ct]=ar,Lt=ar.positionedLines.length===1)}Zt()}else{Rt==="auto"&&(Rt=fx(yt));const kt=tg(ne,l.glyphMap,l.glyphPositions,l.imagePositions,z,Pt,b,yt,Rt,ot,ge,e.ao.horizontal,!1,Z,q);kt&&(Y.horizontal[Rt]=kt),Zt(),wd(ze)&&x&&A&&(Y.vertical=tg(ne,l.glyphMap,l.glyphPositions,l.imagePositions,z,Pt,b,yt,Rt,ot,ge,e.ao.vertical,!1,Z,q))}}let qe=!1;if(I.icon&&I.icon.name){const ze=l.imageMap[I.icon.name];ze&&(ae=o3(l.imagePositions[I.icon.name],o.get("icon-offset").evaluate(I,{},l.canonical),o.get("icon-anchor").evaluate(I,{},l.canonical)),qe=!!ze.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=qe:l.bucket.sdfIcons!==qe&&nr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ze.pixelRatio!==l.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const Ce=lA(Y.horizontal)||Y.vertical;l.bucket.iconsInText=!!Ce&&Ce.iconsInText,(Ce||ae)&&v3(l.bucket,I,Y,ae,l.imageMap,h,Z,H,ge,qe,l.canonical,l.subdivisionGranularity)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},e.cI=X0,e.cJ=Y0,e.cK=J0,e.cL=pE,e.cM=ex,e.cN=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},e.cO=function(l,n,o,p,h){return a(this,void 0,void 0,(function*(){if(U())try{return yield Lr(l,n,o,p,h)}catch{}return(function(b,x,A,T,I){const z=b.width,q=b.height;Jr&&bt||(Jr=new OffscreenCanvas(z,q),bt=Jr.getContext("2d",{willReadFrequently:!0})),Jr.width=z,Jr.height=q,bt.drawImage(b,0,0,z,q);const Z=bt.getImageData(x,A,T,I);return bt.clearRect(0,0,z,q),Z.data})(l,n,o,p,h)}))},e.cP=eE,e.cQ=w,e.cR=dE,e.cS=Od,e.cT=cd,e.cU=function(l,n){const o=new Map;if(l!=null)if(l.type==="Feature")o.set(Th(l,n),l);else for(const p of l.features)o.set(Th(p,n),p);return o},e.cV=function(l,n){if(l==null)return!0;if(l.type==="Feature")return Th(l,n)!=null;if(l.type==="FeatureCollection"){const o=new Set;for(const p of l.features){const h=Th(p,n);if(h==null||o.has(h))return!1;o.add(h)}return!0}return!1},e.cW=function(l,n,o){var p,h,b,x;if(n.removeAll&&l.clear(),n.remove)for(const A of n.remove)l.delete(A);if(n.add)for(const A of n.add){const T=Th(A,o);T!=null&&l.set(T,A)}if(n.update)for(const A of n.update){let T=l.get(A.id);if(T==null)continue;const I=!A.removeAllProperties&&(((p=A.removeProperties)===null||p===void 0?void 0:p.length)>0||((h=A.addOrUpdateProperties)===null||h===void 0?void 0:h.length)>0);if((A.newGeometry||A.removeAllProperties||I)&&(T=Object.assign({},T),l.set(A.id,T),I&&(T.properties=Object.assign({},T.properties))),A.newGeometry&&(T.geometry=A.newGeometry),A.removeAllProperties)T.properties={};else if(((b=A.removeProperties)===null||b===void 0?void 0:b.length)>0)for(const z of A.removeProperties)Object.prototype.hasOwnProperty.call(T.properties,z)&&delete T.properties[z];if(((x=A.addOrUpdateProperties)===null||x===void 0?void 0:x.length)>0)for(const{key:z,value:q}of A.addOrUpdateProperties)T.properties[z]=q}},e.cX=Qo,e.ca=function(l,n){var o=l[0],p=l[1],h=l[2],b=l[3],x=l[4],A=l[5],T=l[6],I=l[7],z=l[8],q=l[9],Z=l[10],H=l[11],Y=l[12],ne=l[13],ae=l[14],ge=l[15],qe=n[0],Ce=n[1],ze=n[2],Je=n[3],ot=n[4],yt=n[5],Dt=n[6],Rt=n[7],Pt=n[8],Zt=n[9],kt=n[10],Lt=n[11],ct=n[12],ar=n[13],pr=n[14],Jt=n[15];return Math.abs(o-qe)<=ee*Math.max(1,Math.abs(o),Math.abs(qe))&&Math.abs(p-Ce)<=ee*Math.max(1,Math.abs(p),Math.abs(Ce))&&Math.abs(h-ze)<=ee*Math.max(1,Math.abs(h),Math.abs(ze))&&Math.abs(b-Je)<=ee*Math.max(1,Math.abs(b),Math.abs(Je))&&Math.abs(x-ot)<=ee*Math.max(1,Math.abs(x),Math.abs(ot))&&Math.abs(A-yt)<=ee*Math.max(1,Math.abs(A),Math.abs(yt))&&Math.abs(T-Dt)<=ee*Math.max(1,Math.abs(T),Math.abs(Dt))&&Math.abs(I-Rt)<=ee*Math.max(1,Math.abs(I),Math.abs(Rt))&&Math.abs(z-Pt)<=ee*Math.max(1,Math.abs(z),Math.abs(Pt))&&Math.abs(q-Zt)<=ee*Math.max(1,Math.abs(q),Math.abs(Zt))&&Math.abs(Z-kt)<=ee*Math.max(1,Math.abs(Z),Math.abs(kt))&&Math.abs(H-Lt)<=ee*Math.max(1,Math.abs(H),Math.abs(Lt))&&Math.abs(Y-ct)<=ee*Math.max(1,Math.abs(Y),Math.abs(ct))&&Math.abs(ne-ar)<=ee*Math.max(1,Math.abs(ne),Math.abs(ar))&&Math.abs(ae-pr)<=ee*Math.max(1,Math.abs(ae),Math.abs(pr))&&Math.abs(ge-Jt)<=ee*Math.max(1,Math.abs(ge),Math.abs(Jt))},e.cb=function(l,n){return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l},e.cc=l=>l.type==="symbol",e.cd=l=>l.type==="circle",e.ce=l=>l.type==="heatmap",e.cf=l=>l.type==="line",e.cg=l=>l.type==="fill",e.ch=l=>l.type==="fill-extrusion",e.ci=l=>l.type==="hillshade",e.cj=l=>l.type==="color-relief",e.ck=l=>l.type==="background",e.cl=l=>l.type==="custom",e.cm=ur,e.cn=function(l,n,o){const p=gt(n.x-o.x,n.y-o.y),h=gt(l.x-o.x,l.y-o.y);var b,x;return Oe(Math.atan2(p[0]*h[1]-p[1]*h[0],(b=p)[0]*(x=h)[0]+b[1]*x[1]))},e.co=Tt,e.cp=function(l,n){return Nt[n]&&(l instanceof MouseEvent||l instanceof WheelEvent)},e.cq=function(l,n){return vt[n]&&"touches"in l},e.cr=function(l){return vt[l]||Nt[l]},e.cs=function(l,n,o){var p=n[0],h=n[1];return l[0]=o[0]*p+o[4]*h+o[12],l[1]=o[1]*p+o[5]*h+o[13],l},e.ct=function(l,n){const{x:o,y:p}=Sh.fromLngLat(n);return!(l<0||l>25||p<0||p>=1||o<0||o>=1)},e.cu=function(l,n){return l[0]=n[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=n[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=n[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},e.cv=class extends Ml{},e.cw=w3,e.cy=function(l){return l.message===we},e.cz=Se,e.d=Ne,e.e=lr,e.f=l=>a(void 0,void 0,void 0,(function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(n)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),e.g=se,e.h=l=>new Promise(((n,o)=>{const p=new Image;p.onload=()=>{n(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame((()=>{p.src=or}))},p.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(l)],{type:"image/png"});p.src=l.byteLength?URL.createObjectURL(h):or})),e.i=Vt,e.j=(l,n)=>Ge(lr(l,{type:"json"}),n),e.k=Mt,e.l=Ze,e.m=Ge,e.n=(l,n)=>Ge(lr(l,{type:"arrayBuffer"}),n),e.o=function(l){return new ex(l).readFields(Xz,[])},e.p=RE,e.q=mh,e.r=On,e.s=gi,e.t=ih,e.u=Or,e.v=Ke,e.w=nr,e.x=I0,e.y=Iy,e.z=Jo})),d("worker",["./shared"],(function(e){class a{constructor(W,J){this.keyCache={},W&&this.replace(W,J)}replace(W,J){this._layerConfigs={},this._layers={},this.update(W,[],J)}update(W,J,se){for(const Se of W){this._layerConfigs[Se.id]=Se;const je=this._layers[Se.id]=e.bJ(Se,se);je._featureFilter=e.aa(je.filter,se),this.keyCache[Se.id]&&delete this.keyCache[Se.id]}for(const Se of J)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const ve=e.cC(Object.values(this._layerConfigs),this.keyCache);for(const Se of ve){const je=Se.map((Mt=>this._layers[Mt.id])),Ge=je[0];if(Ge.visibility==="none")continue;const Ne=Ge.source||"";let Qe=this.familiesBySource[Ne];Qe||(Qe=this.familiesBySource[Ne]={});const mt=Ge.sourceLayer||"_geojsonTileLayer";let Ze=Qe[mt];Ze||(Ze=Qe[mt]=[]),Ze.push(je)}}}class g{constructor(W){const J={},se=[];for(const Ge in W){const Ne=W[Ge],Qe=J[Ge]={};for(const mt in Ne){const Ze=Ne[+mt];if(!Ze||Ze.bitmap.width===0||Ze.bitmap.height===0)continue;const Mt={x:0,y:0,w:Ze.bitmap.width+2,h:Ze.bitmap.height+2};se.push(Mt),Qe[mt]={rect:Mt,metrics:Ze.metrics}}}const{w:ve,h:Se}=e.p(se),je=new e.q({width:ve||1,height:Se||1});for(const Ge in W){const Ne=W[Ge];for(const Qe in Ne){const mt=Ne[+Qe];if(!mt||mt.bitmap.width===0||mt.bitmap.height===0)continue;const Ze=J[Ge][Qe].rect;e.q.copy(mt.bitmap,je,{x:0,y:0},{x:Ze.x+1,y:Ze.y+1},mt.bitmap)}}this.image=je,this.positions=J}}e.cD("GlyphAtlas",g);class w{constructor(W){this.tileID=new e.Z(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,J,se,ve,Se){return e._(this,void 0,void 0,(function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new e.a8;const je=new e.cE(Object.keys(W.layers).sort()),Ge=new e.cF(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];const Ne={},Qe={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:se,subdivisionGranularity:Se},mt=J.familiesBySource[this.source];for(const Mr in mt){const pt=W.layers[Mr];if(!pt)continue;pt.version===1&&e.w(`Vector tile source "${this.source}" layer "${Mr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Vi=je.encode(Mr),Di=[];for(let Ii=0;Ii<pt.length;Ii++){const at=pt.feature(Ii),At=Ge.getId(at,Mr);Di.push({feature:at,id:At,index:Ii,sourceLayerIndex:Vi})}for(const Ii of mt[Mr]){const at=Ii[0];at.source!==this.source&&e.w(`layer.source = ${at.source} does not equal this.source = ${this.source}`),at.minzoom&&this.zoom<Math.floor(at.minzoom)||at.maxzoom&&this.zoom>=at.maxzoom||at.visibility!=="none"&&(R(Ii,this.zoom,se),(Ne[at.id]=at.createBucket({index:Ge.bucketLayerIDs.length,layers:Ii,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vi,sourceID:this.source})).populate(Di,Qe,this.tileID.canonical),Ge.bucketLayerIDs.push(Ii.map((At=>At.id))))}}const Ze=e.bO(Qe.glyphDependencies,(Mr=>Object.keys(Mr).map(Number)));this.inFlightDependencies.forEach((Mr=>Mr?.abort())),this.inFlightDependencies=[];let Mt=Promise.resolve({});if(Object.keys(Ze).length){const Mr=new AbortController;this.inFlightDependencies.push(Mr),Mt=ve.sendAsync({type:"GG",data:{stacks:Ze,source:this.source,tileID:this.tileID,type:"glyphs"}},Mr)}const qt=Object.keys(Qe.iconDependencies);let Ke=Promise.resolve({});if(qt.length){const Mr=new AbortController;this.inFlightDependencies.push(Mr),Ke=ve.sendAsync({type:"GI",data:{icons:qt,source:this.source,tileID:this.tileID,type:"icons"}},Mr)}const yr=Object.keys(Qe.patternDependencies);let Dr=Promise.resolve({});if(yr.length){const Mr=new AbortController;this.inFlightDependencies.push(Mr),Dr=ve.sendAsync({type:"GI",data:{icons:yr,source:this.source,tileID:this.tileID,type:"patterns"}},Mr)}const Ot=Qe.dashDependencies;let gr=Promise.resolve({});if(Object.keys(Ot).length){const Mr=new AbortController;this.inFlightDependencies.push(Mr),gr=ve.sendAsync({type:"GDA",data:{dashes:Ot}},Mr)}const[pi,fi,ti,_i]=yield Promise.all([Mt,Ke,Dr,gr]),Kr=new g(pi),oi=new e.cG(fi,ti);for(const Mr in Ne){const pt=Ne[Mr];pt instanceof e.a9?(R(pt.layers,this.zoom,se),e.cH({bucket:pt,glyphMap:pi,glyphPositions:Kr.positions,imageMap:fi,imagePositions:oi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Qe.subdivisionGranularity})):pt.hasDependencies&&(pt instanceof e.cI||pt instanceof e.cJ||pt instanceof e.cK)&&(R(pt.layers,this.zoom,se),pt.addFeatures(Qe,this.tileID.canonical,oi.patternPositions,_i))}return this.status="done",{buckets:Object.values(Ne).filter((Mr=>!Mr.isEmpty())),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Kr.image,imageAtlas:oi,dashPositions:_i,glyphMap:this.returnDependencies?pi:null,iconMap:this.returnDependencies?fi:null,glyphPositions:this.returnDependencies?Kr.positions:null}}))}}function R(we,W,J){const se=new e.F(W);for(const ve of we)ve.recalculate(se,J)}class S{constructor(W,J,se){this.actor=W,this.layerIndex=J,this.availableImages=se,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,J){return e._(this,void 0,void 0,(function*(){const se=yield e.n(W.request,J);try{return{vectorTile:new e.cL(new e.cM(se.data)),rawData:se.data,cacheControl:se.cacheControl,expires:se.expires}}catch(ve){const Se=new Uint8Array(se.data);let je=`Unable to parse the tile at ${W.request.url}, `;throw je+=Se[0]===31&&Se[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ve.message}`,new Error(je)}}))}loadTile(W){return e._(this,void 0,void 0,(function*(){const J=W.uid,se=!!(W&&W.request&&W.request.collectResourceTiming)&&new e.cN(W.request),ve=new w(W);this.loading[J]=ve;const Se=new AbortController;ve.abort=Se;try{const je=yield this.loadVectorTile(W,Se);if(delete this.loading[J],!je)return null;const Ge=je.rawData,Ne={};je.expires&&(Ne.expires=je.expires),je.cacheControl&&(Ne.cacheControl=je.cacheControl);const Qe={};if(se){const Ze=se.finish();Ze&&(Qe.resourceTiming=JSON.parse(JSON.stringify(Ze)))}ve.vectorTile=je.vectorTile;const mt=ve.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);this.loaded[J]=ve,this.fetching[J]={rawTileData:Ge,cacheControl:Ne,resourceTiming:Qe};try{const Ze=yield mt;return e.e({rawTileData:Ge.slice(0)},Ze,Ne,Qe)}finally{delete this.fetching[J]}}catch(je){throw delete this.loading[J],ve.status="done",this.loaded[J]=ve,je}}))}reloadTile(W){return e._(this,void 0,void 0,(function*(){const J=W.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const se=this.loaded[J];if(se.showCollisionBoxes=W.showCollisionBoxes,se.status==="parsing"){const ve=yield se.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);let Se;if(this.fetching[J]){const{rawTileData:je,cacheControl:Ge,resourceTiming:Ne}=this.fetching[J];delete this.fetching[J],Se=e.e({rawTileData:je.slice(0)},ve,Ge,Ne)}else Se=ve;return Se}if(se.status==="done"&&se.vectorTile)return se.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity)}))}abortTile(W){return e._(this,void 0,void 0,(function*(){const J=this.loading,se=W.uid;J&&J[se]&&J[se].abort&&(J[se].abort.abort(),delete J[se])}))}removeTile(W){return e._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]}))}}class D{constructor(){this.loaded={}}loadTile(W){return e._(this,void 0,void 0,(function*(){const{uid:J,encoding:se,rawImageData:ve,redFactor:Se,greenFactor:je,blueFactor:Ge,baseShift:Ne}=W,Qe=ve.width+2,mt=ve.height+2,Ze=e.b(ve)?new e.R({width:Qe,height:mt},yield e.cO(ve,-1,-1,Qe,mt)):ve,Mt=new e.cP(J,Ze,se,Se,je,Ge,Ne);return this.loaded=this.loaded||{},this.loaded[J]=Mt,Mt}))}removeTile(W){const J=this.loaded,se=W.uid;J&&J[se]&&delete J[se]}}var k,B,F=(function(){if(B)return k;function we(J,se){if(J.length!==0){W(J[0],se);for(var ve=1;ve<J.length;ve++)W(J[ve],!se)}}function W(J,se){for(var ve=0,Se=0,je=0,Ge=J.length,Ne=Ge-1;je<Ge;Ne=je++){var Qe=(J[je][0]-J[Ne][0])*(J[Ne][1]+J[je][1]),mt=ve+Qe;Se+=Math.abs(ve)>=Math.abs(Qe)?ve-mt+Qe:Qe-mt+ve,ve=mt}ve+Se>=0!=!!se&&J.reverse()}return B=1,k=function J(se,ve){var Se,je=se&&se.type;if(je==="FeatureCollection")for(Se=0;Se<se.features.length;Se++)J(se.features[Se],ve);else if(je==="GeometryCollection")for(Se=0;Se<se.geometries.length;Se++)J(se.geometries[Se],ve);else if(je==="Feature")J(se.geometry,ve);else if(je==="Polygon")we(se.coordinates,ve);else if(je==="MultiPolygon")for(Se=0;Se<se.coordinates.length;Se++)we(se.coordinates[Se],ve);return se}})(),K=e.cQ(F);class U extends e.cS{constructor(W,J){super(new e.cM,0,J,[],[]),this.feature=W,this.type=W.type,this.properties=W.tags?W.tags:{},"id"in W&&(typeof W.id=="string"?this.id=parseInt(W.id,10):typeof W.id!="number"||isNaN(W.id)||(this.id=W.id))}loadGeometry(){const W=[],J=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const se of J){const ve=[];for(const Se of se)ve.push(new e.P(Se[0],Se[1]));W.push(ve)}return W}}class ee extends e.cR{constructor(W,J){super(new e.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=J?J.version:1,this.extent=J?J.extent:4096,this.length=W.length,this.features=W}feature(W){return new U(this.features[W],this.extent)}}function le(we,W){W.writeVarintField(15,we.version||1),W.writeStringField(1,we.name||""),W.writeVarintField(5,we.extent||4096);const J={keys:[],values:[],keycache:{},valuecache:{}};for(let Se=0;Se<we.length;Se++)J.feature=we.feature(Se),W.writeMessage(2,Q,J);const se=J.keys;for(const Se of se)W.writeStringField(3,Se);const ve=J.values;for(const Se of ve)W.writeMessage(4,dt,Se)}function Q(we,W){if(!we.feature)return;const J=we.feature;J.id!==void 0&&W.writeVarintField(1,J.id),W.writeMessage(2,Te,we),W.writeVarintField(3,J.type),W.writeMessage(4,Xe,J)}function Te(we,W){for(const J in we.feature?.properties){let se=we.feature.properties[J],ve=we.keycache[J];if(se===null)continue;ve===void 0&&(we.keys.push(J),ve=we.keys.length-1,we.keycache[J]=ve),W.writeVarint(ve),typeof se!="string"&&typeof se!="boolean"&&typeof se!="number"&&(se=JSON.stringify(se));const Se=typeof se+":"+se;let je=we.valuecache[Se];je===void 0&&(we.values.push(se),je=we.values.length-1,we.valuecache[Se]=je),W.writeVarint(je)}}function pe(we,W){return(W<<3)+(7&we)}function _e(we){return we<<1^we>>31}function Xe(we,W){const J=we.loadGeometry(),se=we.type;let ve=0,Se=0;for(const je of J){let Ge=1;se===1&&(Ge=je.length),W.writeVarint(pe(1,Ge));const Ne=se===3?je.length-1:je.length;for(let Qe=0;Qe<Ne;Qe++){Qe===1&&se!==1&&W.writeVarint(pe(2,Ne-1));const mt=je[Qe].x-ve,Ze=je[Qe].y-Se;W.writeVarint(_e(mt)),W.writeVarint(_e(Ze)),ve+=mt,Se+=Ze}we.type===3&&W.writeVarint(pe(7,1))}}function dt(we,W){const J=typeof we;J==="string"?W.writeStringField(1,we):J==="boolean"?W.writeBooleanField(7,we):J==="number"&&(we%1!=0?W.writeDoubleField(3,we):we<0?W.writeSVarintField(6,we):W.writeVarintField(5,we))}const He={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:we=>we},et=Math.fround||(rt=new Float32Array(1),we=>(rt[0]=+we,rt[0]));var rt;class te{constructor(W){this.options=Object.assign(Object.create(He),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:J,minZoom:se,maxZoom:ve}=this.options;J&&console.time("total time");const Se=`prepare ${W.length} points`;J&&console.time(Se),this.points=W;const je=[];for(let Ne=0;Ne<W.length;Ne++){const Qe=W[Ne];if(!Qe.geometry)continue;const[mt,Ze]=Qe.geometry.coordinates,Mt=et(ye(mt)),qt=et(nt(Ze));je.push(Mt,qt,1/0,Ne,-1,1),this.options.reduce&&je.push(0)}let Ge=this.trees[ve+1]=this._createTree(je);J&&console.timeEnd(Se);for(let Ne=ve;Ne>=se;Ne--){const Qe=+Date.now();Ge=this.trees[Ne]=this._createTree(this._cluster(Ge,Ne)),J&&console.log("z%d: %d clusters in %dms",Ne,Ge.numItems,+Date.now()-Qe)}return J&&console.timeEnd("total time"),this}getClusters(W,J){let se=((W[0]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,W[1]));let Se=W[2]===180?180:((W[2]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)se=-180,Se=180;else if(se>Se){const Ze=this.getClusters([se,ve,180,je],J),Mt=this.getClusters([-180,ve,Se,je],J);return Ze.concat(Mt)}const Ge=this.trees[this._limitZoom(J)],Ne=Ge.range(ye(se),nt(je),ye(Se),nt(ve)),Qe=Ge.data,mt=[];for(const Ze of Ne){const Mt=this.stride*Ze;mt.push(Qe[Mt+5]>1?Be(Qe,Mt,this.clusterProps):this.points[Qe[Mt+3]])}return mt}getChildren(W){const J=this._getOriginId(W),se=this._getOriginZoom(W),ve="No cluster with the specified id.",Se=this.trees[se];if(!Se)throw new Error(ve);const je=Se.data;if(J*this.stride>=je.length)throw new Error(ve);const Ge=this.options.radius/(this.options.extent*Math.pow(2,se-1)),Ne=Se.within(je[J*this.stride],je[J*this.stride+1],Ge),Qe=[];for(const mt of Ne){const Ze=mt*this.stride;je[Ze+4]===W&&Qe.push(je[Ze+5]>1?Be(je,Ze,this.clusterProps):this.points[je[Ze+3]])}if(Qe.length===0)throw new Error(ve);return Qe}getLeaves(W,J,se){const ve=[];return this._appendLeaves(ve,W,J=J||10,se=se||0,0),ve}getTile(W,J,se){const ve=this.trees[this._limitZoom(W)],Se=Math.pow(2,W),{extent:je,radius:Ge}=this.options,Ne=Ge/je,Qe=(se-Ne)/Se,mt=(se+1+Ne)/Se,Ze={features:[]};return this._addTileFeatures(ve.range((J-Ne)/Se,Qe,(J+1+Ne)/Se,mt),ve.data,J,se,Se,Ze),J===0&&this._addTileFeatures(ve.range(1-Ne/Se,Qe,1,mt),ve.data,Se,se,Se,Ze),J===Se-1&&this._addTileFeatures(ve.range(0,Qe,Ne/Se,mt),ve.data,-1,se,Se,Ze),Ze.features.length?Ze:null}getClusterExpansionZoom(W){let J=this._getOriginZoom(W)-1;for(;J<=this.options.maxZoom;){const se=this.getChildren(W);if(J++,se.length!==1)break;W=se[0].properties.cluster_id}return J}_appendLeaves(W,J,se,ve,Se){const je=this.getChildren(J);for(const Ge of je){const Ne=Ge.properties;if(Ne&&Ne.cluster?Se+Ne.point_count<=ve?Se+=Ne.point_count:Se=this._appendLeaves(W,Ne.cluster_id,se,ve,Se):Se<ve?Se++:W.push(Ge),W.length===se)break}return Se}_createTree(W){const J=new e.aI(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let se=0;se<W.length;se+=this.stride)J.add(W[se],W[se+1]);return J.finish(),J.data=W,J}_addTileFeatures(W,J,se,ve,Se,je){for(const Ge of W){const Ne=Ge*this.stride,Qe=J[Ne+5]>1;let mt,Ze,Mt;if(Qe)mt=fe(J,Ne,this.clusterProps),Ze=J[Ne],Mt=J[Ne+1];else{const yr=this.points[J[Ne+3]];mt=yr.properties;const[Dr,Ot]=yr.geometry.coordinates;Ze=ye(Dr),Mt=nt(Ot)}const qt={type:1,geometry:[[Math.round(this.options.extent*(Ze*Se-se)),Math.round(this.options.extent*(Mt*Se-ve))]],tags:mt};let Ke;Ke=Qe||this.options.generateId?J[Ne+3]:this.points[J[Ne+3]].id,Ke!==void 0&&(qt.id=Ke),je.features.push(qt)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,J){const{radius:se,extent:ve,reduce:Se,minPoints:je}=this.options,Ge=se/(ve*Math.pow(2,J)),Ne=W.data,Qe=[],mt=this.stride;for(let Ze=0;Ze<Ne.length;Ze+=mt){if(Ne[Ze+2]<=J)continue;Ne[Ze+2]=J;const Mt=Ne[Ze],qt=Ne[Ze+1],Ke=W.within(Ne[Ze],Ne[Ze+1],Ge),yr=Ne[Ze+5];let Dr=yr;for(const Ot of Ke){const gr=Ot*mt;Ne[gr+2]>J&&(Dr+=Ne[gr+5])}if(Dr>yr&&Dr>=je){let Ot,gr=Mt*yr,pi=qt*yr,fi=-1;const ti=(Ze/mt<<5)+(J+1)+this.points.length;for(const _i of Ke){const Kr=_i*mt;if(Ne[Kr+2]<=J)continue;Ne[Kr+2]=J;const oi=Ne[Kr+5];gr+=Ne[Kr]*oi,pi+=Ne[Kr+1]*oi,Ne[Kr+4]=ti,Se&&(Ot||(Ot=this._map(Ne,Ze,!0),fi=this.clusterProps.length,this.clusterProps.push(Ot)),Se(Ot,this._map(Ne,Kr)))}Ne[Ze+4]=ti,Qe.push(gr/Dr,pi/Dr,1/0,ti,-1,Dr),Se&&Qe.push(fi)}else{for(let Ot=0;Ot<mt;Ot++)Qe.push(Ne[Ze+Ot]);if(Dr>1)for(const Ot of Ke){const gr=Ot*mt;if(!(Ne[gr+2]<=J)){Ne[gr+2]=J;for(let pi=0;pi<mt;pi++)Qe.push(Ne[gr+pi])}}}}return Qe}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,J,se){if(W[J+5]>1){const je=this.clusterProps[W[J+6]];return se?Object.assign({},je):je}const ve=this.points[W[J+3]].properties,Se=this.options.map(ve);return se&&Se===ve?Object.assign({},Se):Se}}function Be(we,W,J){return{type:"Feature",id:we[W+3],properties:fe(we,W,J),geometry:{type:"Point",coordinates:[(se=we[W],360*(se-.5)),gt(we[W+1])]}};var se}function fe(we,W,J){const se=we[W+5],ve=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se,Se=we[W+6],je=Se===-1?{}:Object.assign({},J[Se]);return Object.assign(je,{cluster:!0,cluster_id:we[W+3],point_count:se,point_count_abbreviated:ve})}function ye(we){return we/360+.5}function nt(we){const W=Math.sin(we*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function gt(we){const W=(180-360*we)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function lt(we,W,J,se){let ve=se;const Se=W+(J-W>>1);let je,Ge=J-W;const Ne=we[W],Qe=we[W+1],mt=we[J],Ze=we[J+1];for(let Mt=W+3;Mt<J;Mt+=3){const qt=be(we[Mt],we[Mt+1],Ne,Qe,mt,Ze);if(qt>ve)je=Mt,ve=qt;else if(qt===ve){const Ke=Math.abs(Mt-Se);Ke<Ge&&(je=Mt,Ge=Ke)}}ve>se&&(je-W>3&&lt(we,W,je,se),we[je+2]=ve,J-je>3&&lt(we,je,J,se))}function be(we,W,J,se,ve,Se){let je=ve-J,Ge=Se-se;if(je!==0||Ge!==0){const Ne=((we-J)*je+(W-se)*Ge)/(je*je+Ge*Ge);Ne>1?(J=ve,se=Se):Ne>0&&(J+=je*Ne,se+=Ge*Ne)}return je=we-J,Ge=W-se,je*je+Ge*Ge}function Ft(we,W,J,se){const ve={id:we??null,type:W,geometry:J,tags:se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Ut(ve,J);else if(W==="Polygon")Ut(ve,J[0]);else if(W==="MultiLineString")for(const Se of J)Ut(ve,Se);else if(W==="MultiPolygon")for(const Se of J)Ut(ve,Se[0]);return ve}function Ut(we,W){for(let J=0;J<W.length;J+=3)we.minX=Math.min(we.minX,W[J]),we.minY=Math.min(we.minY,W[J+1]),we.maxX=Math.max(we.maxX,W[J]),we.maxY=Math.max(we.maxY,W[J+1])}function Le(we,W,J,se){if(!W.geometry)return;const ve=W.geometry.coordinates;if(ve&&ve.length===0)return;const Se=W.geometry.type,je=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let Ge=[],Ne=W.id;if(J.promoteId?Ne=W.properties[J.promoteId]:J.generateId&&(Ne=se||0),Se==="Point")ur(ve,Ge);else if(Se==="MultiPoint")for(const Qe of ve)ur(Qe,Ge);else if(Se==="LineString")Tt(ve,Ge,je,!1);else if(Se==="MultiLineString"){if(J.lineMetrics){for(const Qe of ve)Ge=[],Tt(Qe,Ge,je,!1),we.push(Ft(Ne,"LineString",Ge,W.properties));return}tr(ve,Ge,je,!1)}else if(Se==="Polygon")tr(ve,Ge,je,!0);else{if(Se!=="MultiPolygon"){if(Se==="GeometryCollection"){for(const Qe of W.geometry.geometries)Le(we,{id:Ne,geometry:Qe,properties:W.properties},J,se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Qe of ve){const mt=[];tr(Qe,mt,je,!0),Ge.push(mt)}}we.push(Ft(Ne,Se,Ge,W.properties))}function ur(we,W){W.push(qr(we[0]),lr(we[1]),0)}function Tt(we,W,J,se){let ve,Se,je=0;for(let Ne=0;Ne<we.length;Ne++){const Qe=qr(we[Ne][0]),mt=lr(we[Ne][1]);W.push(Qe,mt,0),Ne>0&&(je+=se?(ve*mt-Qe*Se)/2:Math.sqrt(Math.pow(Qe-ve,2)+Math.pow(mt-Se,2))),ve=Qe,Se=mt}const Ge=W.length-3;W[2]=1,lt(W,0,Ge,J),W[Ge+2]=1,W.size=Math.abs(je),W.start=0,W.end=W.size}function tr(we,W,J,se){for(let ve=0;ve<we.length;ve++){const Se=[];Tt(we[ve],Se,J,se),W.push(Se)}}function qr(we){return we/360+.5}function lr(we){const W=Math.sin(we*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function kr(we,W,J,se,ve,Se,je,Ge){if(se/=W,Se>=(J/=W)&&je<se)return we;if(je<J||Se>=se)return null;const Ne=[];for(const Qe of we){const mt=Qe.geometry;let Ze=Qe.type;const Mt=ve===0?Qe.minX:Qe.minY,qt=ve===0?Qe.maxX:Qe.maxY;if(Mt>=J&&qt<se){Ne.push(Qe);continue}if(qt<J||Mt>=se)continue;let Ke=[];if(Ze==="Point"||Ze==="MultiPoint")Sr(mt,Ke,J,se,ve);else if(Ze==="LineString")$r(mt,Ke,J,se,ve,!1,Ge.lineMetrics);else if(Ze==="MultiLineString")br(mt,Ke,J,se,ve,!1);else if(Ze==="Polygon")br(mt,Ke,J,se,ve,!0);else if(Ze==="MultiPolygon")for(const yr of mt){const Dr=[];br(yr,Dr,J,se,ve,!0),Dr.length&&Ke.push(Dr)}if(Ke.length){if(Ge.lineMetrics&&Ze==="LineString"){for(const yr of Ke)Ne.push(Ft(Qe.id,Ze,yr,Qe.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||(Ke.length===1?(Ze="LineString",Ke=Ke[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=Ke.length===3?"Point":"MultiPoint"),Ne.push(Ft(Qe.id,Ze,Ke,Qe.tags))}}return Ne.length?Ne:null}function Sr(we,W,J,se,ve){for(let Se=0;Se<we.length;Se+=3){const je=we[Se+ve];je>=J&&je<=se&&nr(W,we[Se],we[Se+1],we[Se+2])}}function $r(we,W,J,se,ve,Se,je){let Ge=sr(we);const Ne=ve===0?Xr:Vt;let Qe,mt,Ze=we.start;for(let Dr=0;Dr<we.length-3;Dr+=3){const Ot=we[Dr],gr=we[Dr+1],pi=we[Dr+2],fi=we[Dr+3],ti=we[Dr+4],_i=ve===0?Ot:gr,Kr=ve===0?fi:ti;let oi=!1;je&&(Qe=Math.sqrt(Math.pow(Ot-fi,2)+Math.pow(gr-ti,2))),_i<J?Kr>J&&(mt=Ne(Ge,Ot,gr,fi,ti,J),je&&(Ge.start=Ze+Qe*mt)):_i>se?Kr<se&&(mt=Ne(Ge,Ot,gr,fi,ti,se),je&&(Ge.start=Ze+Qe*mt)):nr(Ge,Ot,gr,pi),Kr<J&&_i>=J&&(mt=Ne(Ge,Ot,gr,fi,ti,J),oi=!0),Kr>se&&_i<=se&&(mt=Ne(Ge,Ot,gr,fi,ti,se),oi=!0),!Se&&oi&&(je&&(Ge.end=Ze+Qe*mt),W.push(Ge),Ge=sr(we)),je&&(Ze+=Qe)}let Mt=we.length-3;const qt=we[Mt],Ke=we[Mt+1],yr=ve===0?qt:Ke;yr>=J&&yr<=se&&nr(Ge,qt,Ke,we[Mt+2]),Mt=Ge.length-3,Se&&Mt>=3&&(Ge[Mt]!==Ge[0]||Ge[Mt+1]!==Ge[1])&&nr(Ge,Ge[0],Ge[1],Ge[2]),Ge.length&&W.push(Ge)}function sr(we){const W=[];return W.size=we.size,W.start=we.start,W.end=we.end,W}function br(we,W,J,se,ve,Se){for(const je of we)$r(je,W,J,se,ve,Se,!1)}function nr(we,W,J,se){we.push(W,J,se)}function Xr(we,W,J,se,ve,Se){const je=(Se-W)/(se-W);return nr(we,Se,J+(ve-J)*je,1),je}function Vt(we,W,J,se,ve,Se){const je=(Se-J)/(ve-J);return nr(we,W+(se-W)*je,Se,1),je}function Pr(we,W){const J=[];for(let se=0;se<we.length;se++){const ve=we[se],Se=ve.type;let je;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")je=Ct(ve.geometry,W);else if(Se==="MultiLineString"||Se==="Polygon"){je=[];for(const Ge of ve.geometry)je.push(Ct(Ge,W))}else if(Se==="MultiPolygon"){je=[];for(const Ge of ve.geometry){const Ne=[];for(const Qe of Ge)Ne.push(Ct(Qe,W));je.push(Ne)}}J.push(Ft(ve.id,Se,je,ve.tags))}return J}function Ct(we,W){const J=[];J.size=we.size,we.start!==void 0&&(J.start=we.start,J.end=we.end);for(let se=0;se<we.length;se+=3)J.push(we[se]+W,we[se+1],we[se+2]);return J}function er(we,W){if(we.transformed)return we;const J=1<<we.z,se=we.x,ve=we.y;for(const Se of we.features){const je=Se.geometry,Ge=Se.type;if(Se.geometry=[],Ge===1)for(let Ne=0;Ne<je.length;Ne+=2)Se.geometry.push(or(je[Ne],je[Ne+1],W,J,se,ve));else for(let Ne=0;Ne<je.length;Ne++){const Qe=[];for(let mt=0;mt<je[Ne].length;mt+=2)Qe.push(or(je[Ne][mt],je[Ne][mt+1],W,J,se,ve));Se.geometry.push(Qe)}}return we.transformed=!0,we}function or(we,W,J,se,ve,Se){return[Math.round(J*(we*se-ve)),Math.round(J*(W*se-Se))]}function Lr(we,W,J,se,ve){const Se=W===ve.maxZoom?0:ve.tolerance/((1<<W)*ve.extent),je={features:[],numPoints:0,numSimplified:0,numFeatures:we.length,source:null,x:J,y:se,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ge of we)Jr(je,Ge,Se,ve);return je}function Jr(we,W,J,se){const ve=W.geometry,Se=W.type,je=[];if(we.minX=Math.min(we.minX,W.minX),we.minY=Math.min(we.minY,W.minY),we.maxX=Math.max(we.maxX,W.maxX),we.maxY=Math.max(we.maxY,W.maxY),Se==="Point"||Se==="MultiPoint")for(let Ge=0;Ge<ve.length;Ge+=3)je.push(ve[Ge],ve[Ge+1]),we.numPoints++,we.numSimplified++;else if(Se==="LineString")bt(je,ve,we,J,!1,!1);else if(Se==="MultiLineString"||Se==="Polygon")for(let Ge=0;Ge<ve.length;Ge++)bt(je,ve[Ge],we,J,Se==="Polygon",Ge===0);else if(Se==="MultiPolygon")for(let Ge=0;Ge<ve.length;Ge++){const Ne=ve[Ge];for(let Qe=0;Qe<Ne.length;Qe++)bt(je,Ne[Qe],we,J,!0,Qe===0)}if(je.length){let Ge=W.tags||null;if(Se==="LineString"&&se.lineMetrics){Ge={};for(const Qe in W.tags)Ge[Qe]=W.tags[Qe];Ge.mapbox_clip_start=ve.start/ve.size,Ge.mapbox_clip_end=ve.end/ve.size}const Ne={geometry:je,type:Se==="Polygon"||Se==="MultiPolygon"?3:Se==="LineString"||Se==="MultiLineString"?2:1,tags:Ge};W.id!==null&&(Ne.id=W.id),we.features.push(Ne)}}function bt(we,W,J,se,ve,Se){const je=se*se;if(se>0&&W.size<(ve?je:se))return void(J.numPoints+=W.length/3);const Ge=[];for(let Ne=0;Ne<W.length;Ne+=3)(se===0||W[Ne+2]>je)&&(J.numSimplified++,Ge.push(W[Ne],W[Ne+1])),J.numPoints++;ve&&(function(Ne,Qe){let mt=0;for(let Ze=0,Mt=Ne.length,qt=Mt-2;Ze<Mt;qt=Ze,Ze+=2)mt+=(Ne[Ze]-Ne[qt])*(Ne[Ze+1]+Ne[qt+1]);if(mt>0===Qe)for(let Ze=0,Mt=Ne.length;Ze<Mt/2;Ze+=2){const qt=Ne[Ze],Ke=Ne[Ze+1];Ne[Ze]=Ne[Mt-2-Ze],Ne[Ze+1]=Ne[Mt-1-Ze],Ne[Mt-2-Ze]=qt,Ne[Mt-1-Ze]=Ke}})(Ge,Se),we.push(Ge)}const gi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Oi{constructor(W,J){const se=(J=this.options=(function(Se,je){for(const Ge in je)Se[Ge]=je[Ge];return Se})(Object.create(gi),J)).debug;if(se&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let ve=(function(Se,je){const Ge=[];if(Se.type==="FeatureCollection")for(let Ne=0;Ne<Se.features.length;Ne++)Le(Ge,Se.features[Ne],je,Ne);else Le(Ge,Se.type==="Feature"?Se:{geometry:Se},je);return Ge})(W,J);this.tiles={},this.tileCoords=[],se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ve=(function(Se,je){const Ge=je.buffer/je.extent;let Ne=Se;const Qe=kr(Se,1,-1-Ge,Ge,0,-1,2,je),mt=kr(Se,1,1-Ge,2+Ge,0,-1,2,je);return(Qe||mt)&&(Ne=kr(Se,1,-Ge,1+Ge,0,-1,2,je)||[],Qe&&(Ne=Pr(Qe,1).concat(Ne)),mt&&(Ne=Ne.concat(Pr(mt,-1)))),Ne})(ve,J),ve.length&&this.splitTile(ve,0,0,0),se&&(ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,J,se,ve,Se,je,Ge){const Ne=[W,J,se,ve],Qe=this.options,mt=Qe.debug;for(;Ne.length;){ve=Ne.pop(),se=Ne.pop(),J=Ne.pop(),W=Ne.pop();const Ze=1<<J,Mt=Oe(J,se,ve);let qt=this.tiles[Mt];if(!qt&&(mt>1&&console.time("creation"),qt=this.tiles[Mt]=Lr(W,J,se,ve,Qe),this.tileCoords.push({z:J,x:se,y:ve}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,se,ve,qt.numFeatures,qt.numPoints,qt.numSimplified),console.timeEnd("creation"));const oi=`z${J}`;this.stats[oi]=(this.stats[oi]||0)+1,this.total++}if(qt.source=W,Se==null){if(J===Qe.indexMaxZoom||qt.numPoints<=Qe.indexMaxPoints)continue}else{if(J===Qe.maxZoom||J===Se)continue;if(Se!=null){const oi=Se-J;if(se!==je>>oi||ve!==Ge>>oi)continue}}if(qt.source=null,W.length===0)continue;mt>1&&console.time("clipping");const Ke=.5*Qe.buffer/Qe.extent,yr=.5-Ke,Dr=.5+Ke,Ot=1+Ke;let gr=null,pi=null,fi=null,ti=null,_i=kr(W,Ze,se-Ke,se+Dr,0,qt.minX,qt.maxX,Qe),Kr=kr(W,Ze,se+yr,se+Ot,0,qt.minX,qt.maxX,Qe);W=null,_i&&(gr=kr(_i,Ze,ve-Ke,ve+Dr,1,qt.minY,qt.maxY,Qe),pi=kr(_i,Ze,ve+yr,ve+Ot,1,qt.minY,qt.maxY,Qe),_i=null),Kr&&(fi=kr(Kr,Ze,ve-Ke,ve+Dr,1,qt.minY,qt.maxY,Qe),ti=kr(Kr,Ze,ve+yr,ve+Ot,1,qt.minY,qt.maxY,Qe),Kr=null),mt>1&&console.timeEnd("clipping"),Ne.push(gr||[],J+1,2*se,2*ve),Ne.push(pi||[],J+1,2*se,2*ve+1),Ne.push(fi||[],J+1,2*se+1,2*ve),Ne.push(ti||[],J+1,2*se+1,2*ve+1)}}getTile(W,J,se){W=+W,J=+J,se=+se;const ve=this.options,{extent:Se,debug:je}=ve;if(W<0||W>24)return null;const Ge=1<<W,Ne=Oe(W,J=J+Ge&Ge-1,se);if(this.tiles[Ne])return er(this.tiles[Ne],Se);je>1&&console.log("drilling down to z%d-%d-%d",W,J,se);let Qe,mt=W,Ze=J,Mt=se;for(;!Qe&&mt>0;)mt--,Ze>>=1,Mt>>=1,Qe=this.tiles[Oe(mt,Ze,Mt)];return Qe&&Qe.source?(je>1&&(console.log("found parent tile z%d-%d-%d",mt,Ze,Mt),console.time("drilling down")),this.splitTile(Qe.source,mt,Ze,Mt,W,J,se),je>1&&console.timeEnd("drilling down"),this.tiles[Ne]?er(this.tiles[Ne],Se):null):null}}function Oe(we,W,J){return 32*((1<<we)*J+W)+we}class vt extends S{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,J){return e._(this,void 0,void 0,(function*(){const se=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ve=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!ve)return null;const Se=new ee(ve.features,{version:2,extent:e.$});let je=(function(Ge){const Ne=new e.cM;return(function(Qe,mt){for(const Ze in Qe.layers)mt.writeMessage(3,le,Qe.layers[Ze])})(Ge,Ne),Ne.finish()})(Se);return je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),{vectorTile:Se,rawData:je.buffer}}))}loadData(W){return e._(this,void 0,void 0,(function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const se=!!(W&&W.request&&W.request.collectResourceTiming)&&new e.cN(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest);const ve=yield this._pendingData;this._geoJSONIndex=W.cluster?new te((function({superclusterOptions:je,clusterProperties:Ge}){if(!Ge||!je)return je;const Ne={},Qe={},mt={accumulated:null,zoom:0},Ze={properties:null},Mt=Object.keys(Ge);for(const qt of Mt){const[Ke,yr]=Ge[qt],Dr=e.cT(yr),Ot=e.cT(typeof Ke=="string"?[Ke,["accumulated"],["get",qt]]:Ke);Ne[qt]=Dr.value,Qe[qt]=Ot.value}return je.map=qt=>{Ze.properties=qt;const Ke={};for(const yr of Mt)Ke[yr]=Ne[yr].evaluate(mt,Ze);return Ke},je.reduce=(qt,Ke)=>{Ze.properties=Ke;for(const yr of Mt)mt.accumulated=qt[yr],qt[yr]=Qe[yr].evaluate(mt,Ze)},je})(W)).load(ve.features):(function(je,Ge){return new Oi(je,Ge)})(ve,W.geojsonVtOptions),this.loaded={};const Se={data:ve};if(se){const je=se.finish();je&&(Se.resourceTiming={},Se.resourceTiming[W.source]=JSON.parse(JSON.stringify(je)))}return Se}catch(ve){if(delete this._pendingRequest,e.cy(ve))return{abandoned:!0};throw ve}}))}getData(){return e._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(W){const J=this.loaded;return J&&J[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,J){return e._(this,void 0,void 0,(function*(){let se=yield this.loadGeoJSON(W,J);if(delete this._pendingRequest,typeof se!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(K(se,!0),W.filter){const ve=e.cT(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map((je=>`${je.key}: ${je.message}`)).join(", "));se={type:"FeatureCollection",features:se.features.filter((je=>ve.value.evaluate({zoom:0},je)))}}return se}))}loadGeoJSON(W,J){return e._(this,void 0,void 0,(function*(){const{promoteId:se}=W;if(W.request){const ve=yield e.j(W.request,J);return this._dataUpdateable=e.cV(ve.data,se)?e.cU(ve.data,se):void 0,ve.data}if(typeof W.data=="string")try{const ve=JSON.parse(W.data);return this._dataUpdateable=e.cV(ve,se)?e.cU(ve,se):void 0,ve}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return e.cW(this._dataUpdateable,W.dataDiff,se),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(W){return e._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class Nt{constructor(W){this.self=W,this.actor=new e.J(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(J,se)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=se},this.self.addProtocol=e.cA,this.self.removeProtocol=e.cB,this.self.registerRTLTextPlugin=J=>{e.cX.setMethods(J)},this.actor.registerMessageHandler("LDT",((J,se)=>this._getDEMWorkerSource(J,se.source).loadTile(se))),this.actor.registerMessageHandler("RDT",((J,se)=>e._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(J,se.source).removeTile(se)})))),this.actor.registerMessageHandler("GCEZ",((J,se)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,se.type,se.source).getClusterExpansionZoom(se)})))),this.actor.registerMessageHandler("GCC",((J,se)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,se.type,se.source).getClusterChildren(se)})))),this.actor.registerMessageHandler("GCL",((J,se)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,se.type,se.source).getClusterLeaves(se)})))),this.actor.registerMessageHandler("LD",((J,se)=>this._getWorkerSource(J,se.type,se.source).loadData(se))),this.actor.registerMessageHandler("GD",((J,se)=>this._getWorkerSource(J,se.type,se.source).getData())),this.actor.registerMessageHandler("LT",((J,se)=>this._getWorkerSource(J,se.type,se.source).loadTile(se))),this.actor.registerMessageHandler("RT",((J,se)=>this._getWorkerSource(J,se.type,se.source).reloadTile(se))),this.actor.registerMessageHandler("AT",((J,se)=>this._getWorkerSource(J,se.type,se.source).abortTile(se))),this.actor.registerMessageHandler("RMT",((J,se)=>this._getWorkerSource(J,se.type,se.source).removeTile(se))),this.actor.registerMessageHandler("RS",((J,se)=>e._(this,void 0,void 0,(function*(){if(!this.workerSources[J]||!this.workerSources[J][se.type]||!this.workerSources[J][se.type][se.source])return;const ve=this.workerSources[J][se.type][se.source];delete this.workerSources[J][se.type][se.source],ve.removeSource!==void 0&&ve.removeSource(se)})))),this.actor.registerMessageHandler("RM",(J=>e._(this,void 0,void 0,(function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],this.globalStates.delete(J)})))),this.actor.registerMessageHandler("SR",((J,se)=>e._(this,void 0,void 0,(function*(){this.referrer=se})))),this.actor.registerMessageHandler("SRPS",((J,se)=>this._syncRTLPluginState(J,se))),this.actor.registerMessageHandler("IS",((J,se)=>e._(this,void 0,void 0,(function*(){this.self.importScripts(se)})))),this.actor.registerMessageHandler("SI",((J,se)=>this._setImages(J,se))),this.actor.registerMessageHandler("UL",((J,se)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(J).update(se.layers,se.removedIds,this._getGlobalState(J))})))),this.actor.registerMessageHandler("UGS",((J,se)=>e._(this,void 0,void 0,(function*(){const ve=this._getGlobalState(J);for(const Se in se)ve[Se]=se[Se]})))),this.actor.registerMessageHandler("SL",((J,se)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(J).replace(se,this._getGlobalState(J))}))))}_getGlobalState(W){let J=this.globalStates.get(W);return J||(J={},this.globalStates.set(W,J)),J}_setImages(W,J){return e._(this,void 0,void 0,(function*(){this.availableImages[W]=J;for(const se in this.workerSources[W]){const ve=this.workerSources[W][se];for(const Se in ve)ve[Se].availableImages=J}}))}_syncRTLPluginState(W,J){return e._(this,void 0,void 0,(function*(){return yield e.cX.syncState(J,this.self.importScripts)}))}_getAvailableImages(W){let J=this.availableImages[W];return J||(J=[]),J}_getLayerIndex(W){let J=this.layerIndexes[W];return J||(J=this.layerIndexes[W]=new a),J}_getWorkerSource(W,J,se){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][J]||(this.workerSources[W][J]={}),!this.workerSources[W][J][se]){const ve={sendAsync:(Se,je)=>(Se.targetMapId=W,this.actor.sendAsync(Se,je))};switch(J){case"vector":this.workerSources[W][J][se]=new S(ve,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][J][se]=new vt(ve,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][J][se]=new this.externalWorkerSourceTypes[J](ve,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][J][se]}_getDEMWorkerSource(W,J){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][J]||(this.demWorkerSources[W][J]=new D),this.demWorkerSources[W][J]}}return e.i(self)&&(self.worker=new Nt(self)),Nt})),d("index",["exports","./shared"],(function(e,a){var g="5.9.0";function w(){var _=new a.A(4);return a.A!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_}let R,S;const D={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(_,t,u){const f=requestAnimationFrame((v=>{y(),t(v)})),{unsubscribe:y}=a.s(_.signal,"abort",(()=>{y(),cancelAnimationFrame(f),u(a.c())}),!1)},frameAsync(_){return new Promise(((t,u)=>{this.frame(_,t,u)}))},getImageData(_,t=0){return this.getImageCanvasContext(_).getImageData(-t,-t,_.width+2*t,_.height+2*t)},getImageCanvasContext(_){const t=window.document.createElement("canvas"),u=t.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return t.width=_.width,t.height=_.height,u.drawImage(_,0,0,_.width,_.height),u},resolveURL:_=>(R||(R=document.createElement("a")),R.href=_,R.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(S==null&&(S=matchMedia("(prefers-reduced-motion: reduce)")),S.matches)}};class k{static testProp(t){if(!k.docStyle)return t[0];for(let u=0;u<t.length;u++)if(t[u]in k.docStyle)return t[u];return t[0]}static create(t,u,f){const y=window.document.createElement(t);return u!==void 0&&(y.className=u),f&&f.appendChild(y),y}static createNS(t,u){return window.document.createElementNS(t,u)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(t,u){t.style[k.transformProp]=u}static addEventListener(t,u,f,y={}){t.addEventListener(u,f,"passive"in y?y:y.capture)}static removeEventListener(t,u,f,y={}){t.removeEventListener(u,f,"passive"in y?y:y.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",k.suppressClickInternal,!0)}),0)}static getScale(t){const u=t.getBoundingClientRect();return{x:u.width/t.offsetWidth||1,y:u.height/t.offsetHeight||1,boundingClientRect:u}}static getPoint(t,u,f){const y=u.boundingClientRect;return new a.P((f.clientX-y.left)/u.x-t.clientLeft,(f.clientY-y.top)/u.y-t.clientTop)}static mousePos(t,u){const f=k.getScale(t);return k.getPoint(t,f,u)}static touchPos(t,u){const f=[],y=k.getScale(t);for(let v=0;v<u.length;v++)f.push(k.getPoint(t,y,u[v]));return f}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const u=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),f=u.querySelectorAll("script");for(const y of f)y.remove();return k.clean(u),u.innerHTML}static isPossiblyDangerous(t,u){const f=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!f.includes("javascript:")&&!f.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const u=t.children;for(const f of u)k.removeAttributes(f),k.clean(f)}static removeAttributes(t){for(const{name:u,value:f}of t.attributes)k.isPossiblyDangerous(u,f)&&t.removeAttribute(u)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);const B={supported:!1,testSupport:function(_){!U&&K&&(ee?le(_):F=_)}};let F,K,U=!1,ee=!1;function le(_){const t=_.createTexture();_.bindTexture(_.TEXTURE_2D,t);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,K),_.isContextLost())return;B.supported=!0}catch{}_.deleteTexture(t),U=!0}var Q;typeof document<"u"&&(K=document.createElement("img"),K.onload=()=>{F&&le(F),F=null,ee=!0},K.onerror=()=>{U=!0,F=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(_){let t,u,f,y;_.resetRequestQueue=()=>{t=[],u=0,f=0,y={}},_.addThrottleControl=P=>{const V=f++;return y[V]=P,V},_.removeThrottleControl=P=>{delete y[P],E()},_.getImage=(P,V,N=!0)=>new Promise((($,G)=>{B.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),a.e(P,{type:"image"}),t.push({abortController:V,requestParameters:P,supportImageRefresh:N,state:"queued",onError:X=>{G(X)},onSuccess:X=>{$(X)}}),E()}));const v=P=>a._(this,void 0,void 0,(function*(){P.state="running";const{requestParameters:V,supportImageRefresh:N,onError:$,onSuccess:G,abortController:X}=P,ie=N===!1&&!a.i(self)&&!a.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce(((de,xe)=>de&&xe==="accept"),!0));u++;const ue=ie?C(V,X):a.m(V,X);try{const de=yield ue;delete P.abortController,P.state="completed",de.data instanceof HTMLImageElement||a.b(de.data)?G(de):de.data&&G({data:yield(ce=de.data,typeof createImageBitmap=="function"?a.f(ce):a.h(ce)),cacheControl:de.cacheControl,expires:de.expires})}catch(de){delete P.abortController,$(de)}finally{u--,E()}var ce})),E=()=>{const P=(()=>{for(const V of Object.keys(y))if(y[V]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=u;V<P&&t.length>0;V++){const N=t.shift();N.abortController.signal.aborted?V--:v(N)}},C=(P,V)=>new Promise(((N,$)=>{const G=new Image,X=P.url,ie=P.credentials;ie&&ie==="include"?G.crossOrigin="use-credentials":(ie&&ie==="same-origin"||!a.d(X))&&(G.crossOrigin="anonymous"),V.signal.addEventListener("abort",(()=>{G.src="",$(a.c())})),G.fetchPriority="high",G.onload=()=>{G.onerror=G.onload=null,N({data:G})},G.onerror=()=>{G.onerror=G.onload=null,V.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},G.src=X}))})(Q||(Q={})),Q.resetRequestQueue();class Te{constructor(t){this._transformRequestFn=t??null}transformRequest(t,u){return this._transformRequestFn&&this._transformRequestFn(t,u)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function pe(_){const t=[];if(typeof _=="string")t.push({id:"default",url:_});else if(_&&_.length>0){const u=[];for(const{id:f,url:y}of _){const v=`${f}${y}`;u.indexOf(v)===-1&&(u.push(v),t.push({id:f,url:y}))}}return t}function _e(_,t,u){try{const f=new URL(_);return f.pathname+=`${t}${u}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${_}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Xe(_){const{userImage:t}=_;return!!(t&&t.render&&t.render())&&(_.data.replace(new Uint8Array(t.data.buffer)),!0)}class dt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(t){const u=this.images[t];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new a.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(t,u){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,u)&&(this.images[t]=u)}_validate(t,u){let f=!0;const y=u.data||u.spriteData;return this._validateStretch(u.stretchX,y&&y.width)||(this.fire(new a.k(new Error(`Image "${t}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,y&&y.height)||(this.fire(new a.k(new Error(`Image "${t}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new a.k(new Error(`Image "${t}" has invalid "content" value`))),f=!1),f}_validateStretch(t,u){if(!t)return!0;let f=0;for(const y of t){if(y[0]<f||y[1]<y[0]||u<y[1])return!1;f=y[1]}return!0}_validateContent(t,u){if(!t)return!0;if(t.length!==4)return!1;const f=u.spriteData,y=f&&f.width||u.data.width,v=f&&f.height||u.data.height;return!(t[0]<0||y<t[0]||t[1]<0||v<t[1]||t[2]<0||y<t[2]||t[3]<0||v<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,u,f=!0){const y=this.getImage(t);if(f&&(y.data.width!==u.data.width||y.data.height!==u.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=y.version+1,this.images[t]=u,this.updatedImages[t]=!0}removeImage(t){const u=this.images[t];delete this.images[t],delete this.patterns[t],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((u,f)=>{let y=!0;if(!this.isLoaded())for(const v of t)this.images[v]||(y=!1);this.isLoaded()||y?u(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:u})}))}_getImagesForIds(t){const u={};for(const f of t){let y=this.getImage(f);y||(this.fire(new a.l("styleimagemissing",{id:f})),y=this.getImage(f)),y?u[f]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,textFitWidth:y.textFitWidth,textFitHeight:y.textFitHeight,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:a.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:t,height:u}=this.atlasImage;return{width:t,height:u}}getPattern(t){const u=this.patterns[t],f=this.getImage(t);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new a.I(y,f);this.patterns[t]={bin:y,position:v}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const u=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(t,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const v in this.patterns)t.push(this.patterns[v].bin);const{w:u,h:f}=a.p(t),y=this.atlasImage;y.resize({width:u||1,height:f||1});for(const v in this.patterns){const{bin:E}=this.patterns[v],C=E.x+1,P=E.y+1,V=this.getImage(v).data,N=V.width,$=V.height;a.R.copy(V,y,{x:0,y:0},{x:C,y:P},{width:N,height:$}),a.R.copy(V,y,{x:0,y:$-1},{x:C,y:P-1},{width:N,height:1}),a.R.copy(V,y,{x:0,y:0},{x:C,y:P+$},{width:N,height:1}),a.R.copy(V,y,{x:N-1,y:0},{x:C-1,y:P},{width:1,height:$}),a.R.copy(V,y,{x:0,y:0},{x:C+N,y:P},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const u of t){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||a.w(`Image with ID: "${u}" was not found`),Xe(f)&&this.updateImage(u,f)}}}const He=1e20;function et(_,t,u,f,y,v,E,C,P){for(let V=t;V<t+f;V++)rt(_,u*v+V,v,y,E,C,P);for(let V=u;V<u+y;V++)rt(_,V*v+t,1,f,E,C,P)}function rt(_,t,u,f,y,v,E){v[0]=0,E[0]=-He,E[1]=He,y[0]=_[t];for(let C=1,P=0,V=0;C<f;C++){y[C]=_[t+C*u];const N=C*C;do{const $=v[P];V=(y[C]-y[$]+N-$*$)/(C-$)/2}while(V<=E[P]&&--P>-1);P++,v[P]=C,E[P]=V,E[P+1]=He}for(let C=0,P=0;C<f;C++){for(;E[P+1]<C;)P++;const V=v[P],N=C-V;_[t+C*u]=y[V]+N*N}}class te{constructor(t,u,f){this.requestManager=t,this.localIdeographFontFamily=u,this.entries={},this.lang=f}setURL(t){this.url=t}getGlyphs(t){return a._(this,void 0,void 0,(function*(){const u=[];for(const v in t)for(const E of t[v])u.push(this._getAndCacheGlyphsPromise(v,E));const f=yield Promise.all(u),y={};for(const{stack:v,id:E,glyph:C}of f)y[v]||(y[v]={}),y[v][E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return y}))}_getAndCacheGlyphsPromise(t,u){return a._(this,void 0,void 0,(function*(){let f=this.entries[t];f||(f=this.entries[t]={glyphs:{},requests:{},ranges:{}});let y=f.glyphs[u];if(y!==void 0)return{stack:t,id:u,glyph:y};if(y=this._tinySDF(f,t,u),y)return f.glyphs[u]=y,{stack:t,id:u,glyph:y};const v=Math.floor(u/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[v])return{stack:t,id:u,glyph:y};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[v]){const C=te.loadGlyphRange(t,v,this.url,this.requestManager);f.requests[v]=C}const E=yield f.requests[v];for(const C in E)this._doesCharSupportLocalGlyph(+C)||(f.glyphs[+C]=E[+C]);return f.ranges[v]=!0,{stack:t,id:u,glyph:E[u]||null}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||a.u["CJK Unified Ideographs"](t)||a.u["Hangul Syllables"](t)||a.u.Hiragana(t)||a.u.Katakana(t)||a.u["CJK Symbols and Punctuation"](t)||a.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,u,f){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let v=t.tinySDF;if(!v){let C="400";/bold/i.test(u)?C="900":/medium/i.test(u)?C="500":/light/i.test(u)&&(C="200"),v=t.tinySDF=new te.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:y,fontWeight:C})}const E=v.draw(String.fromCharCode(f));return{id:f,bitmap:new a.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}te.loadGlyphRange=function(_,t,u,f){return a._(this,void 0,void 0,(function*(){const y=256*t,v=y+255,E=f.transformRequest(u.replace("{fontstack}",_).replace("{range}",`${y}-${v}`),"Glyphs"),C=yield a.n(E,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${t}, ${y}-${v}`);const P={};for(const V of a.o(C.data))P[V.id]=V;return P}))},te.TinySDF=class{constructor({fontSize:_=24,buffer:t=3,radius:u=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:v="normal",fontStyle:E="normal",lang:C=null}={}){this.buffer=t,this.cutoff=f,this.radius=u,this.lang=C;const P=this.size=_+4*t,V=this._createCanvas(P),N=this.ctx=V.getContext("2d",{willReadFrequently:!0});N.font=`${E} ${v} ${_}px ${y}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(_){const t=document.createElement("canvas");return t.width=t.height=_,t}draw(_){const{width:t,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:v}=this.ctx.measureText(_),E=Math.ceil(u),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-y))),P=Math.min(this.size-this.buffer,E+Math.ceil(f)),V=C+2*this.buffer,N=P+2*this.buffer,$=Math.max(V*N,0),G=new Uint8ClampedArray($),X={data:G,width:V,height:N,glyphWidth:C,glyphHeight:P,glyphTop:E,glyphLeft:0,glyphAdvance:t};if(C===0||P===0)return X;const{ctx:ie,buffer:ue,gridInner:ce,gridOuter:de}=this;this.lang&&(ie.lang=this.lang),ie.clearRect(ue,ue,C,P),ie.fillText(_,ue,ue+E);const xe=ie.getImageData(ue,ue,C,P);de.fill(He,0,$),ce.fill(0,0,$);for(let Ae=0;Ae<P;Ae++)for(let Ee=0;Ee<C;Ee++){const Ie=xe.data[4*(Ae*C+Ee)+3]/255;if(Ie===0)continue;const Ue=(Ae+ue)*V+Ee+ue;if(Ie===1)de[Ue]=0,ce[Ue]=He;else{const Re=.5-Ie;de[Ue]=Re>0?Re*Re:0,ce[Ue]=Re<0?Re*Re:0}}et(de,0,0,V,N,V,this.f,this.v,this.z),et(ce,ue,ue,C,P,V,this.f,this.v,this.z);for(let Ae=0;Ae<$;Ae++){const Ee=Math.sqrt(de[Ae])-Math.sqrt(ce[Ae]);G[Ae]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return X}};class Be{constructor(){this.specification=a.v.light.position}possiblyEvaluate(t,u){return a.B(t.expression.evaluate(u))}interpolate(t,u,f){return{x:a.C.number(t.x,u.x,f),y:a.C.number(t.y,u.y,f),z:a.C.number(t.z,u.z,f)}}}let fe;class ye extends a.E{constructor(t){super(),fe=fe||new a.r({anchor:new a.D(a.v.light.anchor),position:new Be,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.t(fe,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,u={}){if(!this._validate(a.x,t,u))for(const f in t){const y=t[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,u,f){return(!f||f.validate!==!1)&&a.y(this,t.call(a.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const nt=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class gt extends a.E{constructor(t){super(),this._transitionable=new a.t(nt,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0))}setSky(t,u={}){if(!this._validate(a.G,t,u)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in t){const y=t[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,u,f={}){return f?.validate!==!1&&a.y(this,t.call(a.z,a.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class lt{constructor(t,u){this.width=t,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,u){const f=t.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(t,u)),this.dashEntry[f]}getDashRanges(t,u,f){const y=[];let v=t.length%2==1?-t[t.length-1]*f:0,E=t[0]*f,C=!0;y.push({left:v,right:E,isDash:C,zeroLength:t[0]===0});let P=t[0];for(let V=1;V<t.length;V++){C=!C;const N=t[V];v=P*f,P+=N,E=P*f,y.push({left:v,right:E,isDash:C,zeroLength:N===0})}return y}addRoundDash(t,u,f){const y=u/2;for(let v=-f;v<=f;v++){const E=this.width*(this.nextRow+f+v);let C=0,P=t[C];for(let V=0;V<this.width;V++){V/P.right>1&&(P=t[++C]);const N=Math.abs(V-P.left),$=Math.abs(V-P.right),G=Math.min(N,$);let X;const ie=v/f*(y+1);if(P.isDash){const ue=y-Math.abs(ie);X=Math.sqrt(G*G+ue*ue)}else X=y-Math.sqrt(G*G+ie*ie);this.data[E+V]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(t){for(let C=t.length-1;C>=0;--C){const P=t[C],V=t[C+1];P.zeroLength?t.splice(C,1):V&&V.isDash===P.isDash&&(V.left=P.left,t.splice(C,1))}const u=t[0],f=t[t.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const y=this.width*this.nextRow;let v=0,E=t[v];for(let C=0;C<this.width;C++){C/E.right>1&&(E=t[++v]);const P=Math.abs(C-E.left),V=Math.abs(C-E.right),N=Math.min(P,V);this.data[y+C]=Math.max(0,Math.min(255,(E.isDash?N:-N)+128))}}addDash(t,u){const f=u?7:0,y=2*f+1;if(this.nextRow+y>this.height)return a.w("LineAtlas out of space"),null;let v=0;for(let C=0;C<t.length;C++)v+=t[C];if(v!==0){const C=this.width/v,P=this.getDashRanges(t,this.width,C);u?this.addRoundDash(P,C,f):this.addRegularDash(P)}const E={y:this.nextRow+f,height:2*f,width:v};return this.nextRow+=y,this.dirty=!0,E}bind(t){const u=t.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const be="maplibre_preloaded_worker_pool";class Ft{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ft.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((u=>{u.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[be]}numActive(){return Object.keys(this.active).length}}const Ut=Math.floor(D.hardwareConcurrency/2);let Le,ur;function Tt(){return Le||(Le=new Ft),Le}Ft.workerCount=a.H(globalThis)?Math.max(Math.min(Ut,3),1):1;class tr{constructor(t,u){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let y=0;y<f.length;y++){const v=new a.J(f[y],u);v.name=`Worker ${y}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,u){const f=[];for(const y of this.actors)f.push(y.sendAsync({type:t,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((u=>{u.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,u){for(const f of this.actors)f.registerMessageHandler(t,u)}}function qr(){return ur||(ur=new tr(Tt(),a.K),ur.registerMessageHandler("GR",((_,t,u)=>a.m(t,u)))),ur}function lr(_,t){const u=a.L();return a.M(u,u,[1,1,0]),a.N(u,u,[.5*_.width,.5*_.height,1]),_.calculatePosMatrix?a.O(u,u,_.calculatePosMatrix(t.toUnwrapped())):u}function kr(_,t,u,f,y,v,E){var C;const P=(function(G,X,ie){if(G)for(const ue of G){const ce=X[ue];if(ce&&ce.source===ie&&ce.type==="fill-extrusion")return!0}else for(const ue in X){const ce=X[ue];if(ce.source===ie&&ce.type==="fill-extrusion")return!0}return!1})((C=y?.layers)!==null&&C!==void 0?C:null,t,_.id),V=v.maxPitchScaleFactor(),N=_.tilesIn(f,V,P);N.sort(Sr);const $=[];for(const G of N)$.push({wrappedTileID:G.tileID.wrapped().key,queryResults:G.tile.queryRenderedFeatures(t,u,_._state,G.queryGeometry,G.cameraQueryGeometry,G.scale,y,v,V,lr(_.transform,G.tileID),E?(X,ie)=>E(G.tileID,X,ie):void 0)});return(function(G,X){for(const ie in G)for(const ue of G[ie])$r(ue,X);return G})((function(G){const X={},ie={};for(const ue of G){const ce=ue.queryResults,de=ue.wrappedTileID,xe=ie[de]=ie[de]||{};for(const Ae in ce){const Ee=ce[Ae],Ie=xe[Ae]=xe[Ae]||{},Ue=X[Ae]=X[Ae]||[];for(const Re of Ee)Ie[Re.featureIndex]||(Ie[Re.featureIndex]=!0,Ue.push(Re))}}return X})($),_)}function Sr(_,t){const u=_.tileID,f=t.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function $r(_,t){const u=_.feature,f=t.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=f}function sr(_,t,u){return a._(this,void 0,void 0,(function*(){let f=_;if(_.url?f=(yield a.j(t.transformRequest(_.url,"Source"),u)).data:yield D.frameAsync(u),!f)return null;const y=a.Q(a.e(f,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(y.vectorLayerIds=f.vector_layers.map((v=>v.id))),y}))}class br{constructor(t,u){t&&(u?this.setSouthWest(t).setNorthEast(u):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof a.S?new a.S(t.lng,t.lat):a.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof a.S?new a.S(t.lng,t.lat):a.S.convert(t),this}extend(t){const u=this._sw,f=this._ne;let y,v;if(t instanceof a.S)y=t,v=t;else{if(!(t instanceof br))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(br.convert(t)):this.extend(a.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(a.S.convert(t)):this;if(y=t._sw,v=t._ne,!y||!v)return this}return u||f?(u.lng=Math.min(y.lng,u.lng),u.lat=Math.min(y.lat,u.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new a.S(y.lng,y.lat),this._ne=new a.S(v.lng,v.lat)),this}getCenter(){return new a.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.S(this.getWest(),this.getNorth())}getSouthEast(){return new a.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:u,lat:f}=a.S.convert(t);let y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}static convert(t){return t instanceof br?t:t&&new br(t)}static fromLngLat(t,u=0){const f=360*u/40075017,y=f/Math.cos(Math.PI/180*t.lat);return new br(new a.S(t.lng-y,t.lat-f),new a.S(t.lng+y,t.lat+f))}adjustAntiMeridian(){const t=new a.S(this._sw.lng,this._sw.lat),u=new a.S(this._ne.lng,this._ne.lat);return new br(t,t.lng>u.lng?new a.S(u.lng+360,u.lat):u)}}class nr{constructor(t,u,f){this.bounds=br.convert(this.validateBounds(t)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const u=Math.pow(2,t.z),f=Math.floor(a.V(this.bounds.getWest())*u),y=Math.floor(a.U(this.bounds.getNorth())*u),v=Math.ceil(a.V(this.bounds.getEast())*u),E=Math.ceil(a.U(this.bounds.getSouth())*u);return t.x>=f&&t.x<v&&t.y>=y&&t.y<E}}class Xr extends a.E{constructor(t,u,f,y){if(super(),this.id=t,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.Q(u,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield sr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(a.e(this,t),t.bounds&&(this.tileBounds=new nr(t.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(t){return a._(this,void 0,void 0,(function*(){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};f.request.collectResourceTiming=this._collectResourceTiming;let y="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((v,E)=>{t.reloadPromise={resolve:v,reject:E}}))}else t.actor=this.dispatcher.getActor(),y="LT";t.abortController=new AbortController;try{const v=yield t.actor.sendAsync({type:y,data:f},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,v)}catch(v){if(delete t.abortController,t.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(t,null)}}))}_afterTileLoadWorkerResponse(t,u){if(u&&u.resourceTiming&&(t.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&t.setExpiryData(u),t.loadVectorData(u,this.map.painter),t.reloadPromise){const f=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(f.resolve).catch(f.reject)}}abortTile(t){return a._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return a._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Vt extends a.E{constructor(t,u,f,y){super(),this.id=t,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},u),a.e(this,a.Q(u,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield sr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(a.e(this,u),u.bounds&&(this.tileBounds=new nr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(u))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return a.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return a._(this,void 0,void 0,(function*(){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const f=yield Q.getImage(this.map._requestManager.transformRequest(u,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const y=this.map.painter.context,v=y.gl,E=f.data;t.texture=this.map.painter.getTileTexture(E.width),t.texture?t.texture.update(E,{useMipmap:!0}):(t.texture=new a.T(y,E,v.RGBA,{useMipmap:!0}),t.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}}))}abortTile(t){return a._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return a._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class Pr extends Vt{constructor(t,u,f,y){super(t,u,f,y),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(t){return a._(this,void 0,void 0,(function*(){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const y=yield Q.getImage(f,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(y&&y.data){const v=y.data;this.map._refreshExpiredTiles&&(y.cacheControl||y.expires)&&t.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const E=a.b(v)&&a.W()?v:yield this.readImageNow(v),C={type:this.type,uid:t.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const P=yield t.actor.sendAsync({type:"LDT",data:C});t.dem=P,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(y){if(delete t.abortController,t.aborted)t.state="unloaded";else if(y)throw t.state="errored",y}}))}readImageNow(t){return a._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&a.X()){const u=t.width+2,f=t.height+2;try{return new a.R({width:u,height:f},yield a.Y(t,-1,-1,u,f))}catch{}}return D.getImageData(t,1)}))}_getNeighboringTiles(t){const u=t.canonical,f=Math.pow(2,u.z),y=(u.x-1+f)%f,v=u.x===0?t.wrap-1:t.wrap,E=(u.x+1+f)%f,C=u.x+1===f?t.wrap+1:t.wrap,P={};return P[new a.Z(t.overscaledZ,v,u.z,y,u.y).key]={backfilled:!1},P[new a.Z(t.overscaledZ,C,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(P[new a.Z(t.overscaledZ,v,u.z,y,u.y-1).key]={backfilled:!1},P[new a.Z(t.overscaledZ,t.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},P[new a.Z(t.overscaledZ,C,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<f&&(P[new a.Z(t.overscaledZ,v,u.z,y,u.y+1).key]={backfilled:!1},P[new a.Z(t.overscaledZ,t.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},P[new a.Z(t.overscaledZ,C,u.z,E,u.y+1).key]={backfilled:!1}),P}unloadTile(t){return a._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}class Ct extends a.E{constructor(t,u,f,y){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=f.getActor(),this.setEventedParent(y),this._data=u.data,this._options=a.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:a.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(a.$/this.tileSize)}_getClusterMaxZoom(t){const u=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${u}"`),u}load(){return a._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=a.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,(function*(){const t=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map((u=>u.coordinates)).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,(function*(){const t=new br,u=yield this.getData();let f;switch(u.type){case"FeatureCollection":f=u.features.map((y=>this.getCoordinatesFromGeometry(y.geometry))).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(u.geometry);break;default:f=this.getCoordinatesFromGeometry(u)}if(f.length==0)return t;for(let y=0;y<f.length-1;y+=2)t.extend([f[y],f[y+1]]);return t}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:u,offset:f}})}_updateWorkerData(){return a._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:t,diff:u}=this._pendingWorkerUpdate;if(!t&&!u)return void a.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=a.e({type:this.type},this.workerOptions);t?(typeof t=="string"?(f.request=this.map._requestManager.transformRequest(D.resolveURL(t),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):u&&(f.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const y=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||y.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=y.data;let v=null;y.resourceTiming&&y.resourceTiming[this.id]&&(v=y.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&a.e(E,{resourceTiming:v}),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(y){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(y))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(t){return a._(this,void 0,void 0,(function*(){const u=t.actor?"RT":"LT";t.actor=this.actor;const f={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const y=yield this.actor.sendAsync({type:u,data:f},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(y,this.map.painter,u==="RT")}))}abortTile(t){return a._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return a._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class er extends a.E{constructor(t,u,f,y){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=u}load(t){return a._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Q.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,t&&(this.coordinates=t),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new a.k(u))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const u=t.map(a.a1.fromLngLat);var f;return this.tileID=(function(y){const v=a.a2.fromPoints(y),E=v.width(),C=v.height(),P=Math.max(E,C),V=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),N=Math.pow(2,V);return new a.a4(V,Math.floor((v.minX+v.maxX)/2*N),Math.floor((v.minY+v.maxY)/2*N))})(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map((y=>this.tileID.getTilePoint(y)._round())),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,u=t.gl;this.texture||(this.texture=new a.T(t,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const v=this.tiles[y];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return a._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:u,minY:f,maxX:y,maxY:v}=a.a2.fromPoints(t),E={};for(let C=0;C<=a.a3;C++){const P=Math.pow(2,C),V=Math.floor(u*P),N=Math.floor(f*P),$=Math.floor(y*P),G=Math.floor(v*P);E[C]={minTileX:V,minTileY:N,maxTileX:$,maxTileY:G}}return E}}class or extends er{constructor(t,u,f,y){super(t,u,f,y),this.roundZoom=!0,this.type="video",this.options=u}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const u of t.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield a.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new a.k(u))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const u=this.video.seekable;t<u.start(0)||t>u.end(0)?this.fire(new a.k(new a.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,u=t.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(t,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const v=this.tiles[y];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,f=!0)}f&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Lr extends er{constructor(t,u,f,y){super(t,u,f,y),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some((v=>!Array.isArray(v)||v.length!==2||v.some((E=>typeof E!="number"))))||this.fire(new a.k(new a.a6(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a6(`sources.${t}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.k(new a.a6(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a6(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a6(`sources.${t}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,f=u.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(u,this.canvas,f.RGBA,{premultiply:!0});let y=!1;for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,y=!0)}y&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Jr={},bt=_=>{switch(_){case"geojson":return Ct;case"image":return er;case"raster":return Vt;case"raster-dem":return Pr;case"vector":return Xr;case"video":return or;case"canvas":return Lr}return Jr[_]},gi="RTLPluginLoaded";class Oi extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=qr()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((u=>{throw this.status="error",u}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return a._(this,arguments,void 0,(function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=D.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return a._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(gi))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Oe=null;function vt(){return Oe||(Oe=new Oi),Oe}var Nt,we;(function(_){_[_.Base=0]="Base",_[_.Parent=1]="Parent"})(Nt||(Nt={})),(function(_){_[_.Departing=0]="Departing",_[_.Incoming=1]="Incoming"})(we||(we={}));class W{constructor(t,u){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=a.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:u,fadingParentID:f,fadeEndTime:y}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=u,this.fadingParentID=f,this.fadeEndTime=y}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=D.now(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(y,v){const E={};if(!v)return E;for(const C of y){const P=C.layerIds.map((V=>v.getLayer(V))).filter(Boolean);if(P.length!==0){C.layers=P,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map((V=>P.filter((N=>N.id===V))[0])));for(const V of P)E[V.id]=C}}return E})(t.buckets,u?.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const v=this.buckets[y];if(v instanceof a.a9){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const v=this.buckets[y];if(v instanceof a.a9&&v.hasRTLText){this.hasRTLText=!0,vt().lazyLoad();break}}this.queryPadding=0;for(const y in this.buckets){const v=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(y).queryRadius(v))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new a.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(t)}const u=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(t,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(t,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,u,f,y,v,E,C,P,V,N,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:v,scale:E,tileSize:this.tileSize,pixelPosMatrix:N,transform:P,params:C,queryPadding:this.queryPadding*V,getElevation:$},t,u,f):{}}querySourceFeatures(t,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),v=u&&u.sourceLayer?u.sourceLayer:"",E=y._geojsonTileLayer||y[v];if(!E)return;const C=a.aa(u?.filter,u?.globalState),{z:P,x:V,y:N}=this.tileID.canonical,$={z:P,x:V,y:N};for(let G=0;G<E.length;G++){const X=E.feature(G);if(C.needGeometry){const ce=a.ab(X,!0);if(!C.filter(new a.F(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!C.filter(new a.F(this.tileID.overscaledZ),X))continue;const ie=f.getId(X,v),ue=new a.ac(X,P,V,N,ie);ue.tile=$,t.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const u=this.expirationTime;if(t.cacheControl){const f=a.ad(t.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(u)if(this.expirationTime<u)y=!0;else{const v=this.expirationTime-u;v?this.expirationTime=f+Math.max(v,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!u.style.hasLayer(y))continue;const v=this.buckets[y],E=v.layers[0].sourceLayer||"_geojsonTileLayer",C=f[E],P=t[E];if(!C||!P||Object.keys(P).length===0)continue;v.update(P,C,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const V=u&&u.style&&u.style.getLayer(y);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(v)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<D.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=D.now()+t}setDependencies(t,u){const f={};for(const y of u)f[y]=!0;this.dependencies[t]=f}hasDependency(t,u){for(const f of t){const y=this.dependencies[f];if(y){for(const v of u)if(y[v])return!0}}return!1}}class J{constructor(t,u){this.max=t,this.onRemove=u,this.reset()}reset(){for(const t in this.data)for(const u of this.data[t])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(t,u,f){const y=t.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const v={value:u,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout((()=>{this.remove(t,v)}),f)),this.data[y].push(v),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const u=this.data[t].shift();return u.timeout&&clearTimeout(u.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),u.value}getByKey(t){const u=this.data[t];return u?u[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,u){if(!this.has(t))return this;const f=t.wrapped().key,y=u===void 0?0:this.data[f].indexOf(u),v=this.data[f][y];return this.data[f].splice(y,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(t){const u=[];for(const f in this.data)for(const y of this.data[f])t(y.value)||u.push(y);for(const f of u)this.remove(f.value.tileID,f)}}class se{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,u,f){const y=String(u);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][y]=this.stateChanges[t][y]||{},a.e(this.stateChanges[t][y],f),this.deletedStates[t]===null){this.deletedStates[t]={};for(const v in this.state[t])v!==y&&(this.deletedStates[t][v]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][y]===null){this.deletedStates[t][y]={};for(const v in this.state[t][y])f[v]||(this.deletedStates[t][y][v]=null)}else for(const v in f)this.deletedStates[t]&&this.deletedStates[t][y]&&this.deletedStates[t][y][v]===null&&delete this.deletedStates[t][y][v]}removeFeatureState(t,u,f){if(this.deletedStates[t]===null)return;const y=String(u);if(this.deletedStates[t]=this.deletedStates[t]||{},f&&u!==void 0)this.deletedStates[t][y]!==null&&(this.deletedStates[t][y]=this.deletedStates[t][y]||{},this.deletedStates[t][y][f]=null);else if(u!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][y])for(f in this.deletedStates[t][y]={},this.stateChanges[t][y])this.deletedStates[t][y][f]=null;else this.deletedStates[t][y]=null;else this.deletedStates[t]=null}getState(t,u){const f=String(u),y=a.e({},(this.state[t]||{})[f],(this.stateChanges[t]||{})[f]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const v=this.deletedStates[t][u];if(v===null)return{};for(const E in v)delete y[E]}return y}initializeTileState(t,u){t.setFeatureState(this.state,u)}coalesceChanges(t,u){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const v={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),a.e(this.state[y][E],this.stateChanges[y][E]),v[E]=this.state[y][E];f[y]=v}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const v={};if(this.deletedStates[y]===null)for(const E in this.state[y])v[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else for(const C of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][C];v[E]=this.state[y][E]}f[y]=f[y]||{},a.e(f[y],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const y in t)t[y].setFeatureState(f,u)}}const ve=89.25;function Se(_,t){const u=a.ah(t.lat,-a.ai,a.ai);return new a.P(a.V(t.lng)*_,a.U(u)*_)}function je(_,t){return new a.a1(t.x/_,t.y/_).toLngLat()}function Ge(_){return _.cameraToCenterDistance*Math.min(.85*Math.tan(a.ae(90-_.pitch)),Math.tan(a.ae(ve-_.pitch)))}function Ne(_,t){const u=_.canonical,f=t/a.af(u.z),y=u.x+Math.pow(2,u.z)*_.wrap,v=a.ag(new Float64Array(16));return a.M(v,v,[y*f,u.y*f,0]),a.N(v,v,[f/a.$,f/a.$,1]),v}function Qe(_,t,u,f,y){const v=a.a1.fromLngLat(_,t),E=y*a.aj(1,_.lat),C=E*Math.cos(a.ae(u)),P=Math.sqrt(E*E-C*C),V=P*Math.sin(a.ae(-f)),N=P*Math.cos(a.ae(-f));return new a.a1(v.x+V,v.y+N,v.z+C)}function mt(_,t,u){const f=t.intersectsFrustum(_);if(!u||f===0)return f;const y=t.intersectsPlane(u);return y===0?0:f===2&&y===2?2:1}function Ze(_,t,u){let f=0;const y=(u-t)/10;for(let v=0;v<10;v++)f+=y*Math.pow(Math.cos(t+(v+.5)/10*(u-t)),_);return f}function Mt(_,t){return function(u,f,y,v,E){const C=2*((_-1)/a.ak(Math.cos(a.ae(ve-E))/Math.cos(a.ae(ve)))-1),P=Math.acos(y/v),V=2*Ze(C-1,0,a.ae(E/2)),N=Math.min(a.ae(ve),P+a.ae(E/2)),$=Ze(C-1,Math.min(N,P-a.ae(E/2)),N),G=Math.atan(f/y),X=Math.hypot(f,y);let ie=u;return ie+=a.ak(v/X/Math.max(.5,Math.cos(a.ae(E/2)))),ie+=C*a.ak(Math.cos(G))/2,ie-=a.ak(Math.max(1,$/V/t))/2,ie}}const qt=Mt(9.314,3);function Ke(_,t){const u=(t.roundZoom?Math.round:Math.floor)(_.zoom+a.ak(_.tileSize/t.tileSize));return Math.max(0,u)}function yr(_,t){const u=_.getCameraFrustum(),f=_.getClippingPlane(),y=_.screenPointToMercatorCoordinate(_.getCameraPoint()),v=a.a1.fromLngLat(_.center,_.elevation);y.z=v.z+Math.cos(_.pitchInRadians)*_.cameraToCenterDistance/_.worldSize;const E=_.getCoveringTilesDetailsProvider(),C=E.allowVariableZoom(_,t),P=Ke(_,t),V=t.minzoom||0,N=t.maxzoom!==void 0?t.maxzoom:_.maxZoom,$=Math.min(Math.max(0,P),N),G=Math.pow(2,$),X=[G*y.x,G*y.y,0],ie=[G*v.x,G*v.y,0],ue=Math.hypot(v.x-y.x,v.y-y.y),ce=Math.abs(v.z-y.z),de=Math.hypot(ue,ce),xe=Ie=>({zoom:0,x:0,y:0,wrap:Ie,fullyVisible:!1}),Ae=[],Ee=[];if(_.renderWorldCopies&&E.allowWorldCopies())for(let Ie=1;Ie<=3;Ie++)Ae.push(xe(-Ie)),Ae.push(xe(Ie));for(Ae.push(xe(0));Ae.length>0;){const Ie=Ae.pop(),Ue=Ie.x,Re=Ie.y;let Fe=Ie.fullyVisible;const st={x:Ue,y:Re,z:Ie.zoom},Ye=E.getTileBoundingVolume(st,Ie.wrap,_.elevation,t);if(!Fe){const wt=mt(u,Ye,f);if(wt===0)continue;Fe=wt===2}const tt=E.distanceToTile2d(y.x,y.y,st,Ye);let it=P;C&&(it=(t.calculateTileZoom||qt)(_.zoom+a.ak(_.tileSize/t.tileSize),tt,ce,de,_.fov)),it=(t.roundZoom?Math.round:Math.floor)(it),it=Math.max(0,it);const xt=Math.min(it,N);if(Ie.wrap=E.getWrap(v,st,Ie.wrap),Ie.zoom>=xt){if(Ie.zoom<V)continue;const wt=$-Ie.zoom,ft=X[0]-.5-(Ue<<wt),jt=X[1]-.5-(Re<<wt),mr=t.reparseOverscaled?Math.max(Ie.zoom,it):Ie.zoom;Ee.push({tileID:new a.Z(Ie.zoom===N?mr:Ie.zoom,Ie.wrap,Ie.zoom,Ue,Re),distanceSq:a.al([ie[0]-.5-Ue,ie[1]-.5-Re]),tileDistanceToCamera:Math.sqrt(ft*ft+jt*jt)})}else for(let wt=0;wt<4;wt++)Ae.push({zoom:Ie.zoom+1,x:(Ue<<1)+wt%2,y:(Re<<1)+(wt>>1),wrap:Ie.wrap,fullyVisible:Fe})}return Ee.sort(((Ie,Ue)=>Ie.distanceSq-Ue.distanceSq)).map((Ie=>Ie.tileID))}const Dr=a.a2.fromPoints([new a.P(0,0),new a.P(a.$,a.$)]);class Ot extends a.E{constructor(t,u,f){super(),this.id=t,this.dispatcher=f,this.on("data",(y=>this._dataHandler(y))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((y,v,E,C)=>{const P=new(bt(v.type))(y,v,E,C);if(P.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${P.id}`);return P})(t,u,f,this),this._tiles={},this._cache=new J(0,(y=>this._unloadTile(y))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new se,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const u=this._tiles[t];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,u,f){return a._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,u,f)}catch(y){t.state="errored",y.status!==404?this._source.fire(new a.k(y,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new a.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(t),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(gr).map((t=>t.key))}getRenderableIds(t){const u=[];for(const f in this._tiles)this._isIdRenderable(f,t)&&u.push(this._tiles[f]);return t?u.sort(((f,y)=>{const v=f.tileID,E=y.tileID,C=new a.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians),P=new a.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return v.overscaledZ-E.overscaledZ||P.y-C.y||P.x-C.x})).map((f=>f.tileID.key)):u.map((f=>f.tileID)).sort(gr).map((f=>f.key))}hasRenderableParent(t){const u=t.overscaledZ-1;if(u>=this._source.minzoom){const f=this._getLoadedTile(t.scaledTo(u));if(f)return this._isIdRenderable(f.tileID.key)}return!1}_isIdRenderable(t,u=!1){var f;return(f=this._tiles[t])===null||f===void 0?void 0:f.isRenderable(u)}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)t?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(t,u){return a._(this,void 0,void 0,(function*(){const f=this._tiles[t];f&&(f.state!=="loading"&&(f.state=u),yield this._loadTile(f,t,u))}))}_tileLoaded(t,u,f){t.timeAdded=D.now(),f==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(u,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const u=this.getRenderableIds();for(let y=0;y<u.length;y++){const v=u[y];if(t.neighboringTiles&&t.neighboringTiles[v]){const E=this.getTileByID(v);f(t,E),f(E,t)}}function f(y,v){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let E=v.tileID.canonical.x-y.tileID.canonical.x;const C=v.tileID.canonical.y-y.tileID.canonical.y,P=Math.pow(2,y.tileID.canonical.z),V=v.tileID.key;E===0&&C===0||Math.abs(C)>1||(Math.abs(E)>1&&(Math.abs(E+P)===1?E+=P:Math.abs(E-P)===1&&(E-=P)),v.dem&&y.dem&&(y.dem.backfillBorder(v.dem,E,C),y.neighboringTiles&&y.neighboringTiles[V]&&(y.neighboringTiles[V].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,u){const f=Object.values(t),y=this._getLoadedDescendents(f),v={};for(const E of f){const C=y[E.key];if(!C?.length){v[E.key]=E;continue}const P=E.overscaledZ+Ot.maxUnderzooming,V=C.filter((G=>G.tileID.overscaledZ<=P));if(!V.length){v[E.key]=E;continue}const N=Math.min(...V.map((G=>G.tileID.overscaledZ))),$=V.filter((G=>G.tileID.overscaledZ===N)).map((G=>G.tileID));for(const G of $)u[G.key]=G;this._areDescendentsComplete($,N,E.overscaledZ)||(v[E.key]=E)}return v}_getLoadedDescendents(t){var u;const f={};for(const y in this._tiles){const v=this._tiles[y];if(v.hasData())for(const E of t)v.tileID.isChildOf(E)&&(f[u=E.key]||(f[u]=[])).push(v)}return f}_areDescendentsComplete(t,u,f){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===u:Math.pow(4,u-f)===t.length}_getLoadedTile(t){const u=this._tiles[t.key];return u?.hasData()?u:null}updateCacheSize(t){const u=Math.ceil(t.width/this._source.tileSize)+1,f=Math.ceil(t.height/this._source.tileSize)+1,y=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(v)}handleWrapJump(t){const u=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,u){const f={};for(const y in this._tiles){const v=this._tiles[y];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),f[v.tileID.key]=v}this._tiles=f;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(t,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=t,this.terrain=u,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?f=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((P=>new a.Z(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y))):(f=yr(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter((P=>this._source.hasTile(P))))):f=[],this.usedForTerrain&&(f=this._addTerrainIdealTiles(f));const y=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,y&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const v=Ke(t,this._source),E=this._updateRetainedTiles(f,v),C=pi(this._source.type);C&&this._rasterFadeDuration>0&&!u&&this._updateFadingTiles(f,E),C?this._cleanUpRasterTiles(E):this._cleanUpVectorTiles(E)}_cleanUpRasterTiles(t){for(const u in this._tiles)t[u]||this._removeTile(u)}_cleanUpVectorTiles(t){for(const u in this._tiles){const f=this._tiles[u];t[u]?f.clearSymbolFadeHold():f.hasSymbolBuckets?f.holdingForSymbolFade()?f.symbolFadeFinished()&&this._removeTile(u):f.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(u)}}_addTerrainIdealTiles(t){const u=[];for(const f of t)if(f.canonical.z>this._source.minzoom){const y=f.scaledTo(f.canonical.z-1);u.push(y);const v=f.scaledTo(Math.max(this._source.minzoom,Math.min(f.canonical.z,5)));u.push(v)}return t.concat(u)}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,u){var f;const y={},v={},E=Math.max(u-Ot.maxOverzooming,this._source.minzoom);let C={};for(const P of t){const V=this._addTile(P);y[P.key]=P,V.hasData()||(C[P.key]=P)}C=this._retainLoadedChildren(C,y);for(const P in C){const V=C[P];let N=this._tiles[P],$=N?.wasRequested();for(let G=V.overscaledZ-1;G>=E;--G){const X=V.scaledTo(G);if(v[X.key])break;if(v[X.key]=!0,N=this.getTile(X),!N&&$&&(N=this._addTile(X)),N){const ie=N.hasData();if((ie||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||$)&&(y[X.key]=X),$=N.wasRequested(),ie)break}}}return y}_updateFadingTiles(t,u){const f=D.now(),y=a.am(t);for(const v of t){const E=this._tiles[v.key];E.fadingDirection!==we.Departing&&E.fadeOpacity!==0||E.resetFadeLogic(),this._updateFadingAncestor(E,u,f)||this._updateFadingDescendents(E,u,f)||this._updateFadingEdge(E,y,f)||E.resetFadeLogic()}}_updateFadingAncestor(t,u,f){if(!t.hasData())return!1;const{tileID:y,fadingRole:v,fadingDirection:E,fadingParentID:C}=t;if(v===Nt.Base&&E===we.Incoming&&C)return u[C.key]=C,!0;const P=Math.max(y.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let V=y.overscaledZ-1;V>=P;V--){const N=y.scaledTo(V),$=this._getLoadedTile(N);if($)return t.setCrossFadeLogic({fadingRole:Nt.Base,fadingDirection:we.Incoming,fadingParentID:$.tileID,fadeEndTime:f+this._rasterFadeDuration}),$.setCrossFadeLogic({fadingRole:Nt.Parent,fadingDirection:we.Departing,fadeEndTime:f+this._rasterFadeDuration}),u[N.key]=N,!0}return!1}_updateFadingDescendents(t,u,f){if(!t.hasData())return!1;const y=t.tileID.children(this._source.maxzoom);let v=this._updateFadingChildren(t,y,u,f);if(v)return!0;for(const E of y){const C=E.children(this._source.maxzoom);this._updateFadingChildren(t,C,u,f)&&(v=!0)}return v}_updateFadingChildren(t,u,f,y){if(u[0].overscaledZ>=this._source.maxzoom)return!1;let v=!1;for(const E of u){const C=this._getLoadedTile(E);if(!C)continue;const{fadingRole:P,fadingDirection:V,fadingParentID:N}=C;P===Nt.Base&&V===we.Departing&&N||(C.setCrossFadeLogic({fadingRole:Nt.Base,fadingDirection:we.Departing,fadingParentID:t.tileID,fadeEndTime:y+this._rasterFadeDuration}),t.setCrossFadeLogic({fadingRole:Nt.Parent,fadingDirection:we.Incoming,fadeEndTime:y+this._rasterFadeDuration})),f[E.key]=E,v=!0}return v}_updateFadingEdge(t,u,f){const y=t.tileID;return!!t.selfFading||!t.hasData()&&!!u.has(y)&&(t.setSelfFadeLogic(f+this._rasterFadeDuration),!0)}_addTile(t){let u=this._tiles[t.key];if(u)return u;u=this._cache.getAndRemove(t),u&&(u.resetFadeLogic(),this._setTileReloadTimer(t.key,u),u.tileID=t,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,u)));const f=u;return u||(u=new W(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(u,t.key,u.state)),u.uses++,this._tiles[t.key]=u,f||this._source.fire(new a.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(t,u){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const f=u.getExpiryTimeout();f&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),f))}refreshTiles(t){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&t.some((f=>f.equals(this._tiles[u].tileID.canonical)))&&this._reloadTile(u,"expired")}_removeTile(t){const u=this._tiles[t];u&&(u.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,u,f){const y=[],v=this.transform;if(!v)return y;const E=v.getCoveringTilesDetailsProvider().allowWorldCopies(),C=f?v.getCameraQueryGeometry(t):t,P=X=>v.screenPointToMercatorCoordinate(X,this.terrain),V=this.transformBbox(t,P,!E),N=this.transformBbox(C,P,!E),$=this.getIds(),G=a.a2.fromPoints(N);for(let X=0;X<$.length;X++){const ie=this._tiles[$[X]];if(ie.holdingForSymbolFade())continue;const ue=E?[ie.tileID]:[ie.tileID.unwrapTo(-1),ie.tileID.unwrapTo(0)],ce=Math.pow(2,v.zoom-ie.tileID.overscaledZ),de=u*ie.queryPadding*a.$/ie.tileSize/ce;for(const xe of ue){const Ae=G.map((Ee=>xe.getTilePoint(new a.a1(Ee.x,Ee.y))));if(Ae.expandBy(de),Ae.intersects(Dr)){const Ee=V.map((Ue=>xe.getTilePoint(Ue))),Ie=N.map((Ue=>xe.getTilePoint(Ue)));y.push({tile:ie,tileID:E?xe:xe.unwrapTo(0),queryGeometry:Ee,cameraQueryGeometry:Ie,scale:ce})}}}return y}transformBbox(t,u,f){let y=t.map(u);if(f){const v=a.a2.fromPoints(t);v.shrinkBy(.001*Math.min(v.width(),v.height()));const E=v.map(u);a.a2.fromPoints(y).covers(E)||(y=y.map((C=>C.x>.5?new a.a1(C.x-1,C.y,C.z):C)))}return y}getVisibleCoordinates(t){const u=this.getRenderableIds(t).map((f=>this._tiles[f].tileID));return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(pi(this._source.type)&&this._rasterFadeDuration>0){const t=D.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=t)return!0}return!1}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,u,f){this._state.updateState(t=t||"_geojsonTileLayer",u,f)}removeFeatureState(t,u,f){this._state.removeFeatureState(t=t||"_geojsonTileLayer",u,f)}getFeatureState(t,u){return this._state.getState(t=t||"_geojsonTileLayer",u)}setDependencies(t,u,f){const y=this._tiles[t];y&&y.setDependencies(u,f)}reloadTilesForDependencies(t,u){for(const f in this._tiles)this._tiles[f].hasDependency(t,u)&&this._reloadTile(f,"reloading");this._cache.filter((f=>!f.hasDependency(t,u)))}}function gr(_,t){const u=Math.abs(2*_.wrap)-+(_.wrap<0),f=Math.abs(2*t.wrap)-+(t.wrap<0);return _.overscaledZ-t.overscaledZ||f-u||t.canonical.y-_.canonical.y||t.canonical.x-_.canonical.x}function pi(_){return _==="raster"||_==="image"||_==="video"}Ot.maxOverzooming=10,Ot.maxUnderzooming=3;class fi{constructor(t,u){this.reset(t,u)}reset(t,u){this.points=t||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=a.ah(t,0,1);let u=1,f=this._distances[u];const y=t*this.paddedLength+this.padding;for(;f<y&&u<this._distances.length;)f=this._distances[++u];const v=u-1,E=this._distances[v],C=f-E,P=C>0?(y-E)/C:0;return this.points[v].mult(1-P).add(this.points[u].mult(P))}}function ti(_,t){let u=!0;return _==="always"||_!=="never"&&t!=="never"||(u=!1),u}class _i{constructor(t,u,f){const y=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(t/f),this.yCellCount=Math.ceil(u/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=u,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,u,f,y,v){this._forEachCell(u,f,y,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(v)}insertCircle(t,u,f,y){this._forEachCell(u-y,f-y,u+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(u),this.circles.push(f),this.circles.push(y)}_insertBoxCell(t,u,f,y,v,E){this.boxCells[v].push(E)}_insertCircleCell(t,u,f,y,v,E){this.circleCells[v].push(E)}_query(t,u,f,y,v,E,C){if(f<0||t>this.width||y<0||u>this.height)return[];const P=[];if(t<=0&&u<=0&&this.width<=f&&this.height<=y){if(v)return[{key:null,x1:t,y1:u,x2:f,y2:y}];for(let V=0;V<this.boxKeys.length;V++)P.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const N=this.circles[3*V],$=this.circles[3*V+1],G=this.circles[3*V+2];P.push({key:this.circleKeys[V],x1:N-G,y1:$-G,x2:N+G,y2:$+G})}}else this._forEachCell(t,u,f,y,this._queryCell,P,{hitTest:v,overlapMode:E,seenUids:{box:{},circle:{}}},C);return P}query(t,u,f,y){return this._query(t,u,f,y,!1,null)}hitTest(t,u,f,y,v,E){return this._query(t,u,f,y,!0,v,E).length>0}hitTestCircle(t,u,f,y,v){const E=t-f,C=t+f,P=u-f,V=u+f;if(C<0||E>this.width||V<0||P>this.height)return!1;const N=[];return this._forEachCell(E,P,C,V,this._queryCellCircle,N,{hitTest:!0,overlapMode:y,circle:{x:t,y:u,radius:f},seenUids:{box:{},circle:{}}},v),N.length>0}_queryCell(t,u,f,y,v,E,C,P){const{seenUids:V,hitTest:N,overlapMode:$}=C,G=this.boxCells[v];if(G!==null){const ie=this.bboxes;for(const ue of G)if(!V.box[ue]){V.box[ue]=!0;const ce=4*ue,de=this.boxKeys[ue];if(t<=ie[ce+2]&&u<=ie[ce+3]&&f>=ie[ce+0]&&y>=ie[ce+1]&&(!P||P(de))&&(!N||!ti($,de.overlapMode))&&(E.push({key:de,x1:ie[ce],y1:ie[ce+1],x2:ie[ce+2],y2:ie[ce+3]}),N))return!0}}const X=this.circleCells[v];if(X!==null){const ie=this.circles;for(const ue of X)if(!V.circle[ue]){V.circle[ue]=!0;const ce=3*ue,de=this.circleKeys[ue];if(this._circleAndRectCollide(ie[ce],ie[ce+1],ie[ce+2],t,u,f,y)&&(!P||P(de))&&(!N||!ti($,de.overlapMode))){const xe=ie[ce],Ae=ie[ce+1],Ee=ie[ce+2];if(E.push({key:de,x1:xe-Ee,y1:Ae-Ee,x2:xe+Ee,y2:Ae+Ee}),N)return!0}}}return!1}_queryCellCircle(t,u,f,y,v,E,C,P){const{circle:V,seenUids:N,overlapMode:$}=C,G=this.boxCells[v];if(G!==null){const ie=this.bboxes;for(const ue of G)if(!N.box[ue]){N.box[ue]=!0;const ce=4*ue,de=this.boxKeys[ue];if(this._circleAndRectCollide(V.x,V.y,V.radius,ie[ce+0],ie[ce+1],ie[ce+2],ie[ce+3])&&(!P||P(de))&&!ti($,de.overlapMode))return E.push(!0),!0}}const X=this.circleCells[v];if(X!==null){const ie=this.circles;for(const ue of X)if(!N.circle[ue]){N.circle[ue]=!0;const ce=3*ue,de=this.circleKeys[ue];if(this._circlesCollide(ie[ce],ie[ce+1],ie[ce+2],V.x,V.y,V.radius)&&(!P||P(de))&&!ti($,de.overlapMode))return E.push(!0),!0}}}_forEachCell(t,u,f,y,v,E,C,P){const V=this._convertToXCellCoord(t),N=this._convertToYCellCoord(u),$=this._convertToXCellCoord(f),G=this._convertToYCellCoord(y);for(let X=V;X<=$;X++)for(let ie=N;ie<=G;ie++)if(v.call(this,t,u,f,y,this.xCellCount*ie+X,E,C,P))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,u,f,y,v,E){const C=y-t,P=v-u,V=f+E;return V*V>C*C+P*P}_circleAndRectCollide(t,u,f,y,v,E,C){const P=(E-y)/2,V=Math.abs(t-(y+P));if(V>P+f)return!1;const N=(C-v)/2,$=Math.abs(u-(v+N));if($>N+f)return!1;if(V<=P||$<=N)return!0;const G=V-P,X=$-N;return G*G+X*X<=f*f}}function Kr(_,t,u){const f=a.L();if(!_){const{vecSouth:$,vecEast:G}=Mr(t),X=w();X[0]=G[0],X[1]=G[1],X[2]=$[0],X[3]=$[1],y=X,(N=(E=(v=X)[0])*(V=v[3])-(P=v[2])*(C=v[1]))&&(y[0]=V*(N=1/N),y[1]=-C*N,y[2]=-P*N,y[3]=E*N),f[0]=X[0],f[1]=X[1],f[4]=X[2],f[5]=X[3]}var y,v,E,C,P,V,N;return a.N(f,f,[1/u,1/u,1]),f}function oi(_,t,u,f){if(_){const y=a.L();if(!t){const{vecSouth:v,vecEast:E}=Mr(u);y[0]=E[0],y[1]=E[1],y[4]=v[0],y[5]=v[1]}return a.N(y,y,[f,f,1]),y}return u.pixelsToClipSpaceMatrix}function Mr(_){const t=Math.cos(_.rollInRadians),u=Math.sin(_.rollInRadians),f=Math.cos(_.pitchInRadians),y=Math.cos(_.bearingInRadians),v=Math.sin(_.bearingInRadians),E=a.ar();E[0]=-y*f*u-v*t,E[1]=-v*f*u+y*t;const C=a.as(E);C<1e-9?a.at(E):a.au(E,E,1/C);const P=a.ar();P[0]=y*f*t-v*u,P[1]=v*f*t+y*u;const V=a.as(P);return V<1e-9?a.at(P):a.au(P,P,1/V),{vecEast:P,vecSouth:E}}function pt(_,t,u,f){let y;f?(y=[_,t,f(_,t),1],a.aw(y,y,u)):(y=[_,t,0,1],Gn(y,y,u));const v=y[3];return{point:new a.P(y[0]/v,y[1]/v),signedDistanceFromCamera:v,isOccluded:!1}}function Vi(_,t){return .5+_/t*.5}function Di(_,t){return _.x>=-t[0]&&_.x<=t[0]&&_.y>=-t[1]&&_.y<=t[1]}function Ii(_,t,u,f,y,v,E,C,P,V,N,$,G){const X=u?_.textSizeData:_.iconSizeData,ie=a.an(X,t.transform.zoom),ue=[256/t.width*2+1,256/t.height*2+1],ce=u?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;ce.clear();const de=_.lineVertexArray,xe=u?_.text.placedSymbolArray:_.icon.placedSymbolArray,Ae=t.transform.width/t.transform.height;let Ee=!1;for(let Ie=0;Ie<xe.length;Ie++){const Ue=xe.get(Ie);if(Ue.hidden||Ue.writingMode===a.ao.vertical&&!Ee){rn(Ue.numGlyphs,ce);continue}Ee=!1;const Re=new a.P(Ue.anchorX,Ue.anchorY),Fe={getElevation:G,pitchedLabelPlaneMatrix:f,lineVertexArray:de,pitchWithMap:v,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Re,unwrappedTileID:P,width:V,height:N,translation:$},st=dr(Ue.anchorX,Ue.anchorY,Fe);if(!Di(st.point,ue)){rn(Ue.numGlyphs,ce);continue}const Ye=Vi(t.transform.cameraToCenterDistance,st.signedDistanceFromCamera),tt=a.ap(X,ie,Ue),it=v?tt*t.transform.getPitchedTextCorrection(Ue.anchorX,Ue.anchorY,P)/Ye:tt*Ye,xt=_r({projectionContext:Fe,pitchedLabelPlaneMatrixInverse:y,symbol:Ue,fontSize:it,flip:!1,keepUpright:E,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:Ae,rotateToLine:C});Ee=xt.useVertical,(xt.notEnoughRoom||Ee||xt.needsFlipping&&_r({projectionContext:Fe,pitchedLabelPlaneMatrixInverse:y,symbol:Ue,fontSize:it,flip:!0,keepUpright:E,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:Ae,rotateToLine:C}).notEnoughRoom)&&rn(Ue.numGlyphs,ce)}u?_.text.dynamicLayoutVertexBuffer.updateData(ce):_.icon.dynamicLayoutVertexBuffer.updateData(ce)}function at(_,t,u,f,y,v,E,C){const P=v.glyphStartIndex+v.numGlyphs,V=v.lineStartIndex,N=v.lineStartIndex+v.lineLength,$=t.getoffsetX(v.glyphStartIndex),G=t.getoffsetX(P-1),X=Kn(_*$,u,f,y,v.segment,V,N,C,E);if(!X)return null;const ie=Kn(_*G,u,f,y,v.segment,V,N,C,E);return ie?C.projectionCache.anyProjectionOccluded?null:{first:X,last:ie}:null}function At(_,t,u,f){return _===a.ao.horizontal&&Math.abs(u.y-t.y)>Math.abs(u.x-t.x)*f?{useVertical:!0}:(_===a.ao.vertical?t.y<u.y:t.x>u.x)?{needsFlipping:!0}:null}function _r(_){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:u,symbol:f,fontSize:y,flip:v,keepUpright:E,glyphOffsetArray:C,dynamicLayoutVertexArray:P,aspectRatio:V,rotateToLine:N}=_,$=y/24,G=f.lineOffsetX*$,X=f.lineOffsetY*$;let ie;if(f.numGlyphs>1){const ue=f.glyphStartIndex+f.numGlyphs,ce=f.lineStartIndex,de=f.lineStartIndex+f.lineLength,xe=at($,C,G,X,v,f,N,t);if(!xe)return{notEnoughRoom:!0};const Ae=tn(xe.first.point.x,xe.first.point.y,t,u),Ee=tn(xe.last.point.x,xe.last.point.y,t,u);if(E&&!v){const Ie=At(f.writingMode,Ae,Ee,V);if(Ie)return Ie}ie=[xe.first];for(let Ie=f.glyphStartIndex+1;Ie<ue-1;Ie++){const Ue=Kn($*C.getoffsetX(Ie),G,X,v,f.segment,ce,de,t,N);if(!Ue)return{notEnoughRoom:!0};ie.push(Ue)}ie.push(xe.last)}else{if(E&&!v){const ce=gn(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,de=f.lineStartIndex+f.segment+1,xe=new a.P(t.lineVertexArray.getx(de),t.lineVertexArray.gety(de)),Ae=gn(xe.x,xe.y,t),Ee=Ae.signedDistanceFromCamera>0?Ae.point:cr(t.tileAnchorPoint,xe,ce,1,t),Ie=tn(ce.x,ce.y,t,u),Ue=tn(Ee.x,Ee.y,t,u),Re=At(f.writingMode,Ie,Ue,V);if(Re)return Re}const ue=Kn($*C.getoffsetX(f.glyphStartIndex),G,X,v,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,t,N);if(!ue||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ie=[ue]}for(const ue of ie)a.av(P,ue.point,ue.angle);return{}}function cr(_,t,u,f,y){const v=_.add(_.sub(t)._unit()),E=gn(v.x,v.y,y).point,C=u.sub(E);return u.add(C._mult(f/C.mag()))}function Gi(_,t,u){const f=t.projectionCache;if(f.projections[_])return f.projections[_];const y=new a.P(t.lineVertexArray.getx(_),t.lineVertexArray.gety(_)),v=gn(y.x,y.y,t);if(v.signedDistanceFromCamera>0)return f.projections[_]=v.point,f.anyProjectionOccluded=f.anyProjectionOccluded||v.isOccluded,v.point;const E=_-u.direction;return cr(u.distanceFromAnchor===0?t.tileAnchorPoint:new a.P(t.lineVertexArray.getx(E),t.lineVertexArray.gety(E)),y,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,t)}function gn(_,t,u){const f=_+u.translation[0],y=t+u.translation[1];let v;return u.pitchWithMap?(v=pt(f,y,u.pitchedLabelPlaneMatrix,u.getElevation),v.isOccluded=!1):(v=u.transform.projectTileCoordinates(f,y,u.unwrappedTileID,u.getElevation),v.point.x=(.5*v.point.x+.5)*u.width,v.point.y=(.5*-v.point.y+.5)*u.height),v}function tn(_,t,u,f){if(u.pitchWithMap){const y=[_,t,0,1];return a.aw(y,y,f),u.transform.projectTileCoordinates(y[0]/y[3],y[1]/y[3],u.unwrappedTileID,u.getElevation).point}return{x:_/u.width*2-1,y:1-t/u.height*2}}function dr(_,t,u){return u.transform.projectTileCoordinates(_,t,u.unwrappedTileID,u.getElevation)}function ns(_,t,u){return _._unit()._perp()._mult(t*u)}function ss(_,t,u,f,y,v,E,C,P){if(C.projectionCache.offsets[_])return C.projectionCache.offsets[_];const V=u.add(t);if(_+P.direction<f||_+P.direction>=y)return C.projectionCache.offsets[_]=V,V;const N=Gi(_+P.direction,C,P),$=ns(N.sub(u),E,P.direction),G=u.add($),X=N.add($);return C.projectionCache.offsets[_]=a.ax(v,V,G,X)||V,C.projectionCache.offsets[_]}function Kn(_,t,u,f,y,v,E,C,P){const V=f?_-t:_+t;let N=V>0?1:-1,$=0;f&&(N*=-1,$=Math.PI),N<0&&($+=Math.PI);let G,X=N>0?v+y:v+y+1;C.projectionCache.cachedAnchorPoint?G=C.projectionCache.cachedAnchorPoint:(G=gn(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=G);let ie,ue,ce=G,de=G,xe=0,Ae=0;const Ee=Math.abs(V),Ie=[];let Ue;for(;xe+Ae<=Ee;){if(X+=N,X<v||X>=E)return null;xe+=Ae,de=ce,ue=ie;const st={absOffsetX:Ee,direction:N,distanceFromAnchor:xe,previousVertex:de};if(ce=Gi(X,C,st),u===0)Ie.push(de),Ue=ce.sub(de);else{let Ye;const tt=ce.sub(de);Ye=tt.mag()===0?ns(Gi(X+N,C,st).sub(ce),u,N):ns(tt,u,N),ue||(ue=de.add(Ye)),ie=ss(X,Ye,ce,v,E,ue,u,C,st),Ie.push(ue),Ue=ie.sub(ue)}Ae=Ue.mag()}const Re=Ue._mult((Ee-xe)/Ae)._add(ue||de),Fe=$+Math.atan2(ce.y-de.y,ce.x-de.x);return Ie.push(Re),{point:Re,angle:P?Fe:0,path:Ie}}const vs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function rn(_,t){for(let u=0;u<_;u++){const f=t.length;t.resize(f+4),t.float32.set(vs,3*f)}}function Gn(_,t,u){const f=t[0],y=t[1];return _[0]=u[0]*f+u[4]*y+u[12],_[1]=u[1]*f+u[5]*y+u[13],_[3]=u[3]*f+u[7]*y+u[15],_}const hi=100;class Ui{constructor(t,u=new _i(t.width+200,t.height+200,25),f=new _i(t.width+200,t.height+200,25)){this.transform=t,this.grid=u,this.ignoredGrid=f,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+hi,this.screenBottomBoundary=t.height+hi,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,u,f,y,v,E,C,P,V,N,$,G){const X=this.projectAndGetPerspectiveRatio(t.anchorPointX+P[0],t.anchorPointY+P[1],v,N,G),ie=f*X.perspectiveRatio;let ue;if(E||C)ue=this._projectCollisionBox(t,ie,y,v,E,C,P,X,N,$,G);else{const Ue=X.x+($?$.x*ie:0),Re=X.y+($?$.y*ie:0);ue={allPointsOccluded:!1,box:[Ue+t.x1*ie,Re+t.y1*ie,Ue+t.x2*ie,Re+t.y2*ie]}}const[ce,de,xe,Ae]=ue.box,Ee=E?ue.allPointsOccluded:X.isOccluded;let Ie=Ee;return Ie||(Ie=X.perspectiveRatio<this.perspectiveRatioCutoff),Ie||(Ie=!this.isInsideGrid(ce,de,xe,Ae)),Ie||u!=="always"&&this.grid.hitTest(ce,de,xe,Ae,u,V)?{box:[ce,de,xe,Ae],placeable:!1,offscreen:!1,occluded:Ee}:{box:[ce,de,xe,Ae],placeable:!0,offscreen:this.isOffscreen(ce,de,xe,Ae),occluded:Ee}}placeCollisionCircles(t,u,f,y,v,E,C,P,V,N,$,G,X,ie){const ue=[],ce=new a.P(u.anchorX,u.anchorY),de=this.getPerspectiveRatio(ce.x,ce.y,E,ie),xe=(V?v*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,E)/de:v*de)/a.aB,Ae={getElevation:ie,pitchedLabelPlaneMatrix:C,lineVertexArray:f,pitchWithMap:V,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ce,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:X},Ee=at(xe,y,u.lineOffsetX*xe,u.lineOffsetY*xe,!1,u,!1,Ae);let Ie=!1,Ue=!1,Re=!0;if(Ee){const Fe=.5*$*de+G,st=new a.P(-100,-100),Ye=new a.P(this.screenRightBoundary,this.screenBottomBoundary),tt=new fi,it=Ee.first,xt=Ee.last;let wt=[];for(let mr=it.path.length-1;mr>=1;mr--)wt.push(it.path[mr]);for(let mr=1;mr<xt.path.length;mr++)wt.push(xt.path[mr]);const ft=2.5*Fe;if(V){const mr=this.projectPathToScreenSpace(wt,Ae);wt=mr.some((ri=>ri.signedDistanceFromCamera<=0))?[]:mr.map((ri=>ri.point))}let jt=[];if(wt.length>0){const mr=wt[0].clone(),ri=wt[0].clone();for(let ii=1;ii<wt.length;ii++)mr.x=Math.min(mr.x,wt[ii].x),mr.y=Math.min(mr.y,wt[ii].y),ri.x=Math.max(ri.x,wt[ii].x),ri.y=Math.max(ri.y,wt[ii].y);jt=mr.x>=st.x&&ri.x<=Ye.x&&mr.y>=st.y&&ri.y<=Ye.y?[wt]:ri.x<st.x||mr.x>Ye.x||ri.y<st.y||mr.y>Ye.y?[]:a.ay([wt],st.x,st.y,Ye.x,Ye.y)}for(const mr of jt){tt.reset(mr,.25*Fe);let ri=0;ri=tt.length<=.5*Fe?1:Math.ceil(tt.paddedLength/ft)+1;for(let ii=0;ii<ri;ii++){const ui=ii/Math.max(ri-1,1),Ri=tt.lerp(ui),yi=Ri.x+hi,Nr=Ri.y+hi;ue.push(yi,Nr,Fe,0);const wi=yi-Fe,wn=Nr-Fe,Ni=yi+Fe,Fi=Nr+Fe;if(Re=Re&&this.isOffscreen(wi,wn,Ni,Fi),Ue=Ue||this.isInsideGrid(wi,wn,Ni,Fi),t!=="always"&&this.grid.hitTestCircle(yi,Nr,Fe,t,N)&&(Ie=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!P&&Ie||!Ue||de<this.perspectiveRatioCutoff?[]:ue,offscreen:Re,collisionDetected:Ie}}projectPathToScreenSpace(t,u){const f=(function(y,v){const E=a.L();return a.aq(E,v.pitchedLabelPlaneMatrix),y.map((C=>{const P=pt(C.x,C.y,E,v.getElevation),V=v.transform.projectTileCoordinates(P.point.x,P.point.y,v.unwrappedTileID,v.getElevation);return V.point.x=(.5*V.point.x+.5)*v.width,V.point.y=(.5*-V.point.y+.5)*v.height,V}))})(t,u);return(function(y){let v=0,E=0,C=0,P=0;for(let V=0;V<y.length;V++)y[V].isOccluded?(C=V+1,P=0):(P++,P>E&&(E=P,v=C));return y.slice(v,v+E)})(f)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],f=new a.a2;for(const $ of t){const G=new a.P($.x+hi,$.y+hi);f.extend(G),u.push(G)}const{minX:y,minY:v,maxX:E,maxY:C}=f,P=this.grid.query(y,v,E,C).concat(this.ignoredGrid.query(y,v,E,C)),V={},N={};for(const $ of P){const G=$.key;if(V[G.bucketInstanceId]===void 0&&(V[G.bucketInstanceId]={}),V[G.bucketInstanceId][G.featureIndex])continue;const X=[new a.P($.x1,$.y1),new a.P($.x2,$.y1),new a.P($.x2,$.y2),new a.P($.x1,$.y2)];a.az(u,X)&&(V[G.bucketInstanceId][G.featureIndex]=!0,N[G.bucketInstanceId]===void 0&&(N[G.bucketInstanceId]=[]),N[G.bucketInstanceId].push(G.featureIndex))}return N}insertCollisionBox(t,u,f,y,v,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:v,collisionGroupID:E,overlapMode:u},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,u,f,y,v,E){const C=f?this.ignoredGrid:this.grid,P={bucketInstanceId:y,featureIndex:v,collisionGroupID:E,overlapMode:u};for(let V=0;V<t.length;V+=4)C.insertCircle(P,t[V],t[V+1],t[V+2])}projectAndGetPerspectiveRatio(t,u,f,y,v){if(v){let E;y?(E=[t,u,y(t,u),1],a.aw(E,E,v)):(E=[t,u,0,1],Gn(E,E,v));const C=E[3];return{x:(E[0]/C+1)/2*this.transform.width+hi,y:(-E[1]/C+1)/2*this.transform.height+hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}{const E=this.transform.projectTileCoordinates(t,u,f,y);return{x:(E.point.x+1)/2*this.transform.width+hi,y:(1-E.point.y)/2*this.transform.height+hi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(t,u,f,y){const v=this.transform.projectTileCoordinates(t,u,f,y);return .5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5}isOffscreen(t,u,f,y){return f<hi||t>=this.screenRightBoundary||y<hi||u>this.screenBottomBoundary}isInsideGrid(t,u,f,y){return f>=0&&t<this.gridRightBoundary&&y>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const t=a.ag([]);return a.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,u,f,y,v,E,C,P,V,N,$){let G=1,X=0,ie=0,ue=1;const ce=t.anchorPointX+C[0],de=t.anchorPointY+C[1];if(E&&!v){const wt=this.projectAndGetPerspectiveRatio(ce+1,de,y,V,$),ft=wt.x-P.x,jt=Math.atan((wt.y-P.y)/ft)+(ft<0?Math.PI:0),mr=Math.sin(jt),ri=Math.cos(jt);G=ri,X=mr,ie=-mr,ue=ri}else if(!E&&v){const wt=Mr(this.transform);G=wt.vecEast[0],X=wt.vecEast[1],ie=wt.vecSouth[0],ue=wt.vecSouth[1]}let xe=P.x,Ae=P.y,Ee=u;v&&(xe=ce,Ae=de,Ee=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),Ee*=this.transform.getPitchedTextCorrection(ce,de,y),N||(Ee*=a.ah(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),N&&(xe+=G*N.x*Ee+ie*N.y*Ee,Ae+=X*N.x*Ee+ue*N.y*Ee);const Ie=t.x1*Ee,Ue=t.x2*Ee,Re=(Ie+Ue)/2,Fe=t.y1*Ee,st=t.y2*Ee,Ye=(Fe+st)/2,tt=[{offsetX:Ie,offsetY:Fe},{offsetX:Re,offsetY:Fe},{offsetX:Ue,offsetY:Fe},{offsetX:Ue,offsetY:Ye},{offsetX:Ue,offsetY:st},{offsetX:Re,offsetY:st},{offsetX:Ie,offsetY:st},{offsetX:Ie,offsetY:Ye}];let it=[];for(const{offsetX:wt,offsetY:ft}of tt)it.push(new a.P(xe+G*wt+ie*ft,Ae+X*wt+ue*ft));let xt=!1;if(v){const wt=it.map((ft=>this.projectAndGetPerspectiveRatio(ft.x,ft.y,y,V,$)));xt=wt.some((ft=>!ft.isOccluded)),it=wt.map((ft=>new a.P(ft.x,ft.y)))}else xt=!0;return{box:a.aA(it),allPointsOccluded:!xt}}}class Qr{constructor(t,u,f,y){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?u:-u))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class xs{constructor(t,u,f,y,v){this.text=new Qr(t?t.text:null,u,f,v),this.icon=new Qr(t?t.icon:null,u,y,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $n{constructor(t,u,f){this.text=t,this.icon=u,this.skipFade=f}}class oo{constructor(t,u,f,y,v){this.bucketInstanceId=t,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=v}}class ke{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const u=++this.maxGroupID;this.collisionGroups[t]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[t]}}function j(_,t,u,f,y){const{horizontalAlign:v,verticalAlign:E}=a.aH(_);return new a.P(-(v-.5)*t+f[0]*y,-(E-.5)*u+f[1]*y)}class re{constructor(t,u,f,y,v){this.transform=t.clone(),this.terrain=u,this.collisionIndex=new Ui(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new ke(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const u=this.terrain;return u?(f,y)=>u.getElevation(t,f,y):null}getBucketParts(t,u,f,y){const v=f.getBucket(u),E=f.latestFeatureIndex;if(!v||!E||u.id!==v.layerIds[0])return;const C=f.collisionBoxArray,P=v.layers[0].layout,V=v.layers[0].paint,N=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),$=f.tileSize/a.$,G=f.tileID.toUnwrapped(),X=P.get("text-rotation-alignment")==="map",ie=a.aC(f,1,this.transform.zoom),ue=a.aD(this.collisionIndex.transform,f,V.get("text-translate"),V.get("text-translate-anchor")),ce=a.aD(this.collisionIndex.transform,f,V.get("icon-translate"),V.get("icon-translate-anchor")),de=Kr(X,this.transform,ie);this.retainedQueryData[v.bucketInstanceId]=new oo(v.bucketInstanceId,E,v.sourceLayerIndex,v.index,f.tileID);const xe={bucket:v,layout:P,translationText:ue,translationIcon:ce,unwrappedTileID:G,pitchedLabelPlaneMatrix:de,scale:N,textPixelRatio:$,holdingForFade:f.holdingForSymbolFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:a.an(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(y)for(const Ae of v.sortKeyRanges){const{sortKey:Ee,symbolInstanceStart:Ie,symbolInstanceEnd:Ue}=Ae;t.push({sortKey:Ee,symbolInstanceStart:Ie,symbolInstanceEnd:Ue,parameters:xe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:xe})}attemptAnchorPlacement(t,u,f,y,v,E,C,P,V,N,$,G,X,ie,ue,ce,de,xe,Ae,Ee){const Ie=a.aE[t.textAnchor],Ue=[t.textOffset0,t.textOffset1],Re=j(Ie,f,y,Ue,v),Fe=this.collisionIndex.placeCollisionBox(u,G,P,V,N,C,E,ce,$.predicate,Ae,Re,Ee);if((!xe||this.collisionIndex.placeCollisionBox(xe,G,P,V,N,C,E,de,$.predicate,Ae,Re,Ee).placeable)&&Fe.placeable){let st;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(st=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:Ue,width:f,height:y,anchor:Ie,textBoxScale:v,prevAnchor:st},this.markUsedJustification(ie,Ie,X,ue),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,ue,X),this.placedOrientations[X.crossTileID]=ue),{shift:Re,placedGlyphBoxes:Fe}}}placeLayerBucketPart(t,u,f){const{bucket:y,layout:v,translationText:E,translationIcon:C,unwrappedTileID:P,pitchedLabelPlaneMatrix:V,textPixelRatio:N,holdingForFade:$,collisionBoxArray:G,partiallyEvaluatedTextSize:X,collisionGroup:ie}=t.parameters,ue=v.get("text-optional"),ce=v.get("icon-optional"),de=a.aF(v,"text-overlap","text-allow-overlap"),xe=de==="always",Ae=a.aF(v,"icon-overlap","icon-allow-overlap"),Ee=Ae==="always",Ie=v.get("text-rotation-alignment")==="map",Ue=v.get("text-pitch-alignment")==="map",Re=v.get("icon-text-fit")!=="none",Fe=v.get("symbol-z-order")==="viewport-y",st=xe&&(Ee||!y.hasIconData()||ce),Ye=Ee&&(xe||!y.hasTextData()||ue);!y.collisionArrays&&G&&y.deserializeCollisionBoxes(G);const tt=this.retainedQueryData[y.bucketInstanceId].tileID,it=this._getTerrainElevationFunc(tt),xt=this.transform.getFastPathSimpleProjectionMatrix(tt),wt=(ft,jt,mr)=>{var ri,ii;if(u[ft.crossTileID])return;if($)return void(this.placements[ft.crossTileID]=new $n(!1,!1,!1));let ui=!1,Ri=!1,yi=!0,Nr=null,wi={box:null,placeable:!1,offscreen:null,occluded:!1},wn={placeable:!1},Ni=null,Fi=null,Vn=null,ra=0,Ns=0,ia=0;jt.textFeatureIndex?ra=jt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(ra=ft.featureIndex),jt.verticalTextFeatureIndex&&(Ns=jt.verticalTextFeatureIndex);const qa=jt.textBox;if(qa){const as=zi=>{let Xi=a.ao.horizontal;if(y.allowVerticalPlacement&&!zi&&this.prevPlacement){const us=this.prevPlacement.placedOrientations[ft.crossTileID];us&&(this.placedOrientations[ft.crossTileID]=us,Xi=us,this.markUsedOrientation(y,Xi,ft))}return Xi},co=(zi,Xi)=>{if(y.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&jt.verticalTextBox){for(const us of y.writingModes)if(us===a.ao.vertical?(wi=Xi(),wn=wi):wi=zi(),wi&&wi.placeable)break}else wi=zi()},po=ft.textAnchorOffsetStartIndex,ls=ft.textAnchorOffsetEndIndex;if(ls===po){const zi=(Xi,us)=>{const an=this.collisionIndex.placeCollisionBox(Xi,de,N,tt,P,Ue,Ie,E,ie.predicate,it,void 0,xt);return an&&an.placeable&&(this.markUsedOrientation(y,us,ft),this.placedOrientations[ft.crossTileID]=us),an};co((()=>zi(qa,a.ao.horizontal)),(()=>{const Xi=jt.verticalTextBox;return y.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Xi?zi(Xi,a.ao.vertical):{box:null,offscreen:null}})),as(wi&&wi.placeable)}else{let zi=a.aE[(ii=(ri=this.prevPlacement)===null||ri===void 0?void 0:ri.variableOffsets[ft.crossTileID])===null||ii===void 0?void 0:ii.anchor];const Xi=(an,ch,Gu)=>{const Ka=an.x2-an.x1,Po=an.y2-an.y1,Fs=ft.textBoxScale,na=Re&&Ae==="never"?ch:null;let sa=null,dh=de==="never"?1:2,ph="never";zi&&dh++;for(let oa=0;oa<dh;oa++){for(let fh=po;fh<ls;fh++){const hh=y.textAnchorOffsets.get(fh);if(zi&&hh.textAnchor!==zi)continue;const $u=this.attemptAnchorPlacement(hh,an,Ka,Po,Fs,Ie,Ue,N,tt,P,ie,ph,ft,y,Gu,E,C,na,it);if($u&&(sa=$u.placedGlyphBoxes,sa&&sa.placeable))return ui=!0,Nr=$u.shift,sa}zi?zi=null:ph=de}return f&&!sa&&(sa={box:this.collisionIndex.placeCollisionBox(qa,"always",N,tt,P,Ue,Ie,E,ie.predicate,it,void 0,xt).box,offscreen:!1,placeable:!1,occluded:!1}),sa};co((()=>Xi(qa,jt.iconBox,a.ao.horizontal)),(()=>{const an=jt.verticalTextBox;return y.allowVerticalPlacement&&(!wi||!wi.placeable)&&ft.numVerticalGlyphVertices>0&&an?Xi(an,jt.verticalIconBox,a.ao.vertical):{box:null,occluded:!0,offscreen:null}})),wi&&(ui=wi.placeable,yi=wi.offscreen);const us=as(wi&&wi.placeable);if(!ui&&this.prevPlacement){const an=this.prevPlacement.variableOffsets[ft.crossTileID];an&&(this.variableOffsets[ft.crossTileID]=an,this.markUsedJustification(y,an.anchor,ft,us))}}}if(Ni=wi,ui=Ni&&Ni.placeable,yi=Ni&&Ni.offscreen,ft.useRuntimeCollisionCircles&&ft.centerJustifiedTextSymbolIndex>=0){const as=y.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),co=a.ap(y.textSizeData,X,as),po=v.get("text-padding");Fi=this.collisionIndex.placeCollisionCircles(de,as,y.lineVertexArray,y.glyphOffsetArray,co,P,V,f,Ue,ie.predicate,ft.collisionCircleDiameter,po,E,it),Fi.circles.length&&Fi.collisionDetected&&!f&&a.w("Collisions detected, but collision boxes are not shown"),ui=xe||Fi.circles.length>0&&!Fi.collisionDetected,yi=yi&&Fi.offscreen}if(jt.iconFeatureIndex&&(ia=jt.iconFeatureIndex),jt.iconBox){const as=co=>this.collisionIndex.placeCollisionBox(co,Ae,N,tt,P,Ue,Ie,C,ie.predicate,it,Re&&Nr?Nr:void 0,xt);wn&&wn.placeable&&jt.verticalIconBox?(Vn=as(jt.verticalIconBox),Ri=Vn.placeable):(Vn=as(jt.iconBox),Ri=Vn.placeable),yi=yi&&Vn.offscreen}const Ld=ue||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,zl=ce||ft.numIconVertices===0;Ld||zl?zl?Ld||(Ri=Ri&&ui):ui=Ri&&ui:Ri=ui=Ri&&ui;const ko=Ri&&Vn.placeable;if(ui&&Ni.placeable&&this.collisionIndex.insertCollisionBox(Ni.box,de,v.get("text-ignore-placement"),y.bucketInstanceId,wn&&wn.placeable&&Ns?Ns:ra,ie.ID),ko&&this.collisionIndex.insertCollisionBox(Vn.box,Ae,v.get("icon-ignore-placement"),y.bucketInstanceId,ia,ie.ID),Fi&&ui&&this.collisionIndex.insertCollisionCircles(Fi.circles,de,v.get("text-ignore-placement"),y.bucketInstanceId,ra,ie.ID),f&&this.storeCollisionData(y.bucketInstanceId,mr,jt,Ni,Vn,Fi),ft.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ft.crossTileID]=new $n((ui||st)&&!Ni?.occluded,(Ri||Ye)&&!Vn?.occluded,yi||y.justReloaded),u[ft.crossTileID]=!0};if(Fe){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ft=y.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let jt=ft.length-1;jt>=0;--jt){const mr=ft[jt];wt(y.symbolInstances.get(mr),y.collisionArrays[mr],mr)}}else for(let ft=t.symbolInstanceStart;ft<t.symbolInstanceEnd;ft++)wt(y.symbolInstances.get(ft),y.collisionArrays[ft],ft);y.justReloaded=!1}storeCollisionData(t,u,f,y,v,E){if(f.textBox||f.iconBox){let C,P;this.collisionBoxArrays.has(t)?C=this.collisionBoxArrays.get(t):(C=new Map,this.collisionBoxArrays.set(t,C)),C.has(u)?P=C.get(u):(P={text:null,icon:null},C.set(u,P)),f.textBox&&(P.text=y.box),f.iconBox&&(P.icon=v.box)}if(E){let C=this.collisionCircleArrays[t];C===void 0&&(C=this.collisionCircleArrays[t]=[]);for(let P=0;P<E.circles.length;P+=4)C.push(E.circles[P+0]-hi),C.push(E.circles[P+1]-hi),C.push(E.circles[P+2]),C.push(E.collisionDetected?1:0)}}markUsedJustification(t,u,f,y){let v;v=y===a.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[a.aG(u)];const E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const C of E)C>=0&&(t.text.placedSymbolArray.get(C).crossTileID=v>=0&&C!==v?0:f.crossTileID)}markUsedOrientation(t,u,f){const y=u===a.ao.horizontal||u===a.ao.horizontalOnly?u:0,v=u===a.ao.vertical?u:0,E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const C of E)t.text.placedSymbolArray.get(C).placedOrientation=y;f.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const y=u?u.symbolFadeChange(t):1,v=u?u.opacities:{},E=u?u.variableOffsets:{},C=u?u.placedOrientations:{};for(const P in this.placements){const V=this.placements[P],N=v[P];N?(this.opacities[P]=new xs(N,y,V.text,V.icon),f=f||V.text!==N.text.placed||V.icon!==N.icon.placed):(this.opacities[P]=new xs(null,y,V.text,V.icon,V.skipFade),f=f||V.text||V.icon)}for(const P in v){const V=v[P];if(!this.opacities[P]){const N=new xs(V,y,!1,!1);N.isHidden()||(this.opacities[P]=N,f=f||V.text.placed||V.icon.placed)}}for(const P in E)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=E[P]);for(const P in C)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=C[P]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:t)}updateLayerOpacities(t,u){const f={};for(const y of u){const v=y.getBucket(t);v&&y.latestFeatureIndex&&t.id===v.layerIds[0]&&this.updateBucketOpacities(v,y.tileID,f,y.collisionBoxArray)}}updateBucketOpacities(t,u,f,y){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const v=t.layers[0],E=v.layout,C=new xs(null,0,!1,!1,!0),P=E.get("text-allow-overlap"),V=E.get("icon-allow-overlap"),N=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=E.get("text-rotation-alignment")==="map",G=E.get("text-pitch-alignment")==="map",X=E.get("icon-text-fit")!=="none",ie=new xs(null,0,P&&(V||!t.hasIconData()||E.get("icon-optional")),V&&(P||!t.hasTextData()||E.get("text-optional")),!0);!t.collisionArrays&&y&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(y);const ue=(de,xe,Ae)=>{for(let Ee=0;Ee<xe/4;Ee++)de.opacityVertexArray.emplaceBack(Ae);de.hasVisibleVertices=de.hasVisibleVertices||Ae!==Mn},ce=this.collisionBoxArrays.get(t.bucketInstanceId);for(let de=0;de<t.symbolInstances.length;de++){const xe=t.symbolInstances.get(de),{numHorizontalGlyphVertices:Ae,numVerticalGlyphVertices:Ee,crossTileID:Ie}=xe;let Ue=this.opacities[Ie];f[Ie]?Ue=C:Ue||(Ue=ie,this.opacities[Ie]=Ue),f[Ie]=!0;const Re=xe.numIconVertices>0,Fe=this.placedOrientations[xe.crossTileID],st=Fe===a.ao.vertical,Ye=Fe===a.ao.horizontal||Fe===a.ao.horizontalOnly;if(Ae>0||Ee>0){const it=ji(Ue.text);ue(t.text,Ae,st?Mn:it),ue(t.text,Ee,Ye?Mn:it);const xt=Ue.text.isHidden();[xe.rightJustifiedTextSymbolIndex,xe.centerJustifiedTextSymbolIndex,xe.leftJustifiedTextSymbolIndex].forEach((jt=>{jt>=0&&(t.text.placedSymbolArray.get(jt).hidden=xt||st?1:0)})),xe.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(xe.verticalPlacedTextSymbolIndex).hidden=xt||Ye?1:0);const wt=this.variableOffsets[xe.crossTileID];wt&&this.markUsedJustification(t,wt.anchor,xe,Fe);const ft=this.placedOrientations[xe.crossTileID];ft&&(this.markUsedJustification(t,"left",xe,ft),this.markUsedOrientation(t,ft,xe))}if(Re){const it=ji(Ue.icon),xt=!(X&&xe.verticalPlacedIconSymbolIndex&&st);xe.placedIconSymbolIndex>=0&&(ue(t.icon,xe.numIconVertices,xt?it:Mn),t.icon.placedSymbolArray.get(xe.placedIconSymbolIndex).hidden=Ue.icon.isHidden()),xe.verticalPlacedIconSymbolIndex>=0&&(ue(t.icon,xe.numVerticalIconVertices,xt?Mn:it),t.icon.placedSymbolArray.get(xe.verticalPlacedIconSymbolIndex).hidden=Ue.icon.isHidden())}const tt=ce&&ce.has(de)?ce.get(de):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const it=t.collisionArrays[de];if(it){let xt=new a.P(0,0);if(it.textBox||it.verticalTextBox){let wt=!0;if(N){const ft=this.variableOffsets[Ie];ft?(xt=j(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textBoxScale),$&&xt._rotate(G?-this.transform.bearingInRadians:this.transform.bearingInRadians)):wt=!1}if(it.textBox||it.verticalTextBox){let ft;it.textBox&&(ft=st),it.verticalTextBox&&(ft=Ye),oe(t.textCollisionBox.collisionVertexArray,Ue.text.placed,!wt||ft,tt.text,xt.x,xt.y)}}if(it.iconBox||it.verticalIconBox){const wt=!!(!Ye&&it.verticalIconBox);let ft;it.iconBox&&(ft=wt),it.verticalIconBox&&(ft=!wt),oe(t.iconCollisionBox.collisionVertexArray,Ue.icon.placed,ft,tt.icon,X?xt.x:0,X?xt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>t}setStale(){this.stale=!0}}function oe(_,t,u,f,y,v){f&&f.length!==0||(f=[0,0,0,0]);const E=f[0]-hi,C=f[1]-hi,P=f[2]-hi,V=f[3]-hi;_.emplaceBack(t?1:0,u?1:0,y||0,v||0,E,C),_.emplaceBack(t?1:0,u?1:0,y||0,v||0,P,C),_.emplaceBack(t?1:0,u?1:0,y||0,v||0,P,V),_.emplaceBack(t?1:0,u?1:0,y||0,v||0,E,V)}const De=Math.pow(2,25),Me=Math.pow(2,24),Et=Math.pow(2,17),ht=Math.pow(2,16),$t=Math.pow(2,9),Yt=Math.pow(2,8),wr=Math.pow(2,1);function ji(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const t=_.placed?1:0,u=Math.floor(127*_.opacity);return u*De+t*Me+u*Et+t*ht+u*$t+t*Yt+u*wr+t}const Mn=0;class Bt{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,u,f,y,v){const E=this._bucketParts;for(;this._currentTileIndex<t.length;)if(u.getBucketParts(E,y,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort(((C,P)=>C.sortKey-P.sortKey)));this._currentPartIndex<E.length;)if(u.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,v())return!0;return!1}}class L{constructor(t,u,f,y,v,E,C,P){this.placement=new re(t,u,E,C,P),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(t,u,f){const y=D.now(),v=()=>!this._forceFullPlacement&&D.now()-y>2;for(;this._currentPlacementIndex>=0;){const E=u[t[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=C)&&(!E.maxzoom||E.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Bt(E)),this._inProgressLayer.continuePlacement(f[E.source],this.placement,this._showCollisionBoxes,E,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const M=512/a.$/2;class Ve{constructor(t,u,f){this.tileID=t,this.bucketInstanceId=f,this._symbolsByKey={};const y=new Map;for(let v=0;v<u.length;v++){const E=u.get(v),C=E.key,P=y.get(C);P?P.push(E):y.set(C,[E])}for(const[v,E]of y){const C={positions:E.map((P=>({x:Math.floor(P.anchorX*M),y:Math.floor(P.anchorY*M)}))),crossTileIDs:E.map((P=>P.crossTileID))};if(C.positions.length>128){const P=new a.aI(C.positions.length,16,Uint16Array);for(const{x:V,y:N}of C.positions)P.add(V,N);P.finish(),delete C.positions,C.index=P}this._symbolsByKey[v]=C}}getScaledCoordinates(t,u){const{x:f,y,z:v}=this.tileID.canonical,{x:E,y:C,z:P}=u.canonical,V=M/Math.pow(2,P-v),N=(C*a.$+t.anchorY)*V,$=y*a.$*M;return{x:Math.floor((E*a.$+t.anchorX)*V-f*a.$*M),y:Math.floor(N-$)}}findMatches(t,u,f){const y=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let v=0;v<t.length;v++){const E=t.get(v);if(E.crossTileID)continue;const C=this._symbolsByKey[E.key];if(!C)continue;const P=this.getScaledCoordinates(E,u);if(C.index){const V=C.index.range(P.x-y,P.y-y,P.x+y,P.y+y).sort();for(const N of V){const $=C.crossTileIDs[N];if(!f[$]){f[$]=!0,E.crossTileID=$;break}}}else if(C.positions)for(let V=0;V<C.positions.length;V++){const N=C.positions[V],$=C.crossTileIDs[V];if(Math.abs(N.x-P.x)<=y&&Math.abs(N.y-P.y)<=y&&!f[$]){f[$]=!0,E.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class ut{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class vr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const u=Math.round((t-this.lng)/360);if(u!==0)for(const f in this.indexes){const y=this.indexes[f],v={};for(const E in y){const C=y[E];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),v[C.tileID.key]=C}this.indexes[f]=v}this.lng=t}addBucket(t,u,f){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let v=0;v<u.symbolInstances.length;v++)u.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const y=this.usedCrossTileIDs[t.overscaledZ];for(const v in this.indexes){const E=this.indexes[v];if(Number(v)>t.overscaledZ)for(const C in E){const P=E[C];P.tileID.isChildOf(t)&&P.findMatches(u.symbolInstances,t,y)}else{const C=E[t.scaledTo(Number(v)).key];C&&C.findMatches(u.symbolInstances,t,y)}}for(let v=0;v<u.symbolInstances.length;v++){const E=u.symbolInstances.get(v);E.crossTileID||(E.crossTileID=f.generate(),y[E.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ve(t,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(t,u){for(const f of u.getCrossTileIDsLists())for(const y of f)delete this.usedCrossTileIDs[t][y]}removeStaleBuckets(t){let u=!1;for(const f in this.indexes){const y=this.indexes[f];for(const v in y)t[y[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[v]),delete y[v],u=!0)}return u}}class Ho{constructor(){this.layerIndexes={},this.crossTileIDs=new ut,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,u,f){let y=this.layerIndexes[t.id];y===void 0&&(y=this.layerIndexes[t.id]=new vr);let v=!1;const E={};y.handleWrapJump(f);for(const C of u){const P=C.getBucket(t);P&&t.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(C.tileID,P,this.crossTileIDs)&&(v=!0),E[P.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(v=!0),v}pruneUnusedLayers(t){const u={};t.forEach((f=>{u[f]=!0}));for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}var bu="void main() {fragColor=vec4(1.0);}";const _n={prelude:Ir(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ir("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ir("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ir(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ir(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ir(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ir(bu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ir(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ir(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ir("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ir("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Ir(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Ir("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ir(bu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ir(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ir(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ir(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ir(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ir(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ir(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ir(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ir(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ir(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ir(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ir(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ir(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:Ir(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:Ir(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ir(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ir(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ir(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ir("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ir("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ir("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ir("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ir(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ir("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ir(_,t){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=t.match(/in ([\w]+) ([\w]+)/g),y=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=v?v.concat(y):y,C={};return{fragmentSource:_=_.replace(u,((P,V,N,$,G)=>(C[G]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${G}
in ${N} ${$} ${G};
#else
uniform ${N} ${$} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${N} ${$} ${G} = u_${G};
#endif
`))),vertexSource:t=t.replace(u,((P,V,N,$,G)=>{const X=$==="float"?"vec2":"vec4",ie=G.match(/color/)?"color":X;return C[G]?V==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${N} ${X} a_${G};
out ${N} ${$} ${G};
#else
uniform ${N} ${$} u_${G};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${N} ${$} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${ie}(a_${G}, u_${G}_t);
#else
    ${N} ${$} ${G} = u_${G};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${N} ${X} a_${G};
#else
uniform ${N} ${$} u_${G};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${N} ${$} ${G} = a_${G};
#else
    ${N} ${$} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${N} ${$} ${G} = unpack_mix_${ie}(a_${G}, u_${G}_t);
#else
    ${N} ${$} ${G} = u_${G};
#endif
`})),staticAttributes:f,staticUniforms:E}}class Xo{constructor(t,u,f){this.vertexBuffer=t,this.indexBuffer=u,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var bn=a.aJ([{name:"a_pos",type:"Int16",components:2}]);const ao="#define PROJECTION_MERCATOR",Tr="mercator";class Ca{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Tr}get shaderDefine(){return ao}get shaderPreludeCode(){return _n.projectionMercator}get vertexShaderPreludeCode(){return _n.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,u,f,y,v){if(this._cachedMesh)return this._cachedMesh;const E=new a.aL;E.emplaceBack(0,0),E.emplaceBack(a.$,0),E.emplaceBack(0,a.$),E.emplaceBack(a.$,a.$);const C=t.createVertexBuffer(E,bn.members),P=a.aM.simpleSegment(0,0,4,2),V=new a.aN;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3);const N=t.createIndexBuffer(V);return this._cachedMesh=new Xo(C,N,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class $e{constructor(t=0,u=0,f=0,y=0){if(isNaN(t)||t<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=u,this.left=f,this.right=y}interpolate(t,u,f){return u.top!=null&&t.top!=null&&(this.top=a.C.number(t.top,u.top,f)),u.bottom!=null&&t.bottom!=null&&(this.bottom=a.C.number(t.bottom,u.bottom,f)),u.left!=null&&t.left!=null&&(this.left=a.C.number(t.left,u.left,f)),u.right!=null&&t.right!=null&&(this.right=a.C.number(t.right,u.right,f)),this}getCenter(t,u){const f=a.ah((this.left+t-this.right)/2,0,t),y=a.ah((this.top+u-this.bottom)/2,0,u);return new a.P(f,y)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new $e(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function hl(_,t){if(!_.renderWorldCopies||_.lngRange)return;const u=t.lng-_.center.lng;t.lng+=u>180?-360:u<-180?360:0}function Zn(_){return Math.max(0,Math.floor(_))}class vn{constructor(t,u,f,y,v,E){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=v??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Zn(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new $e,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,u,f){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Zn(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new $e(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!f&&t.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const u=a.aO(t,-180,180)*Math.PI/180;var f,y,v,E,C,P,V,N,$;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=w(),f=this._rotationMatrix,v=-this._bearingInRadians,E=(y=this._rotationMatrix)[0],C=y[1],P=y[2],V=y[3],N=Math.sin(v),$=Math.cos(v),f[0]=E*$+P*N,f[1]=C*$+V*N,f[2]=E*-N+P*$,f[3]=C*-N+V*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const u=a.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const u=t/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aP(this._fovInRadians)}setFov(t){t=a.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=a.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const u=this.getConstrained(this._center,t).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=a.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,u){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,u,f){this._unmodified=!1,this._edgeInsets.interpolate(t,u,f),this._constrain(),this._calcMatrices()}resize(t,u,f=!0){this._width=t,this._height=u,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new br([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-a.ai,a.ai])}getConstrained(t,u){return this._callbacks.getConstrained(t,u)}getCameraQueryGeometry(t,u){if(u.length===1)return[u[0],t];{const{minX:f,minY:y,maxX:v,maxY:E}=a.a2.fromPoints(u).extend(t);return[new a.P(f,y),new a.P(v,y),new a.P(v,E),new a.P(f,E),new a.P(f,y)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(f),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=a.ag(new Float64Array(16));a.N(t,t,[this._width/2,-this._height/2,1]),a.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=a.ag(new Float64Array(16)),a.N(t,t,[1,-1,1]),a.M(t,t,[-1,-1,0]),a.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,u,f,y){const v=f!==void 0?f:this.bearing,E=y=y!==void 0?y:this.pitch,C=a.a1.fromLngLat(t,u),P=-Math.cos(a.ae(E)),V=Math.sin(a.ae(E)),N=V*Math.sin(a.ae(v)),$=-V*Math.cos(a.ae(v));let G=this.elevation;const X=u-G;let ie;P*X>=0||Math.abs(P)<.1?(ie=1e4,G=u+ie*P):ie=-X/P;let ue,ce,de=a.aQ(1,C.y),xe=0;do{if(xe+=1,xe>10)break;ce=ie/de,ue=new a.a1(C.x+N*ce,C.y+$*ce),de=1/ue.meterInMercatorCoordinateUnits()}while(Math.abs(ie-ce*de)>1e-12);return{center:ue.toLngLat(),elevation:G,zoom:a.ak(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const u=a.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/u,y=a.a1.fromLngLat(this.center,this.elevation),v=Qe(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=t;const E=this.calculateCenterFromCameraLngLatAlt(v.toLngLat(),a.aQ(v.z,y.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=a.aj(1,this.center.lat)*this.worldSize;return Qe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const u=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/u,t.canonical.y/u,1/u/a.$,1/u/a.$]}}class nn{constructor(t,u){this.min=t,this.max=u,this.center=a.aR([],a.aS([],this.min,this.max),.5)}quadrant(t){const u=[t%2==0,t<2],f=a.aT(this.min),y=a.aT(this.max);for(let v=0;v<u.length;v++)f[v]=u[v]?this.min[v]:this.center[v],y[v]=u[v]?this.center[v]:this.max[v];return y[2]=this.max[2],new nn(f,y)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let u=!0;for(let f=0;f<t.planes.length;f++){const y=this.intersectsPlane(t.planes[f]);if(y===0)return 0;y===1&&(u=!1)}return u?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let u=t[3],f=t[3];for(let y=0;y<3;y++)t[y]>0?(u+=t[y]*this.min[y],f+=t[y]*this.max[y]):(f+=t[y]*this.min[y],u+=t[y]*this.max[y]);return u>=0?2:f<0?0:1}}class xn{distanceToTile2d(t,u,f,y){const v=y.distanceX([t,u]),E=y.distanceY([t,u]);return Math.hypot(v,E)}getWrap(t,u,f){return f}getTileBoundingVolume(t,u,f,y){var v,E;let C=0,P=0;if(y?.terrain){const N=new a.Z(t.z,u,t.z,t.x,t.y),$=y.terrain.getMinMaxElevation(N);C=(v=$.minElevation)!==null&&v!==void 0?v:Math.min(0,f),P=(E=$.maxElevation)!==null&&E!==void 0?E:Math.max(0,f)}const V=1<<t.z;return new nn([u+t.x/V,t.y/V,C],[u+(t.x+1)/V,(t.y+1)/V,P])}allowVariableZoom(t,u){const f=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,y=a.ah(78.5-f/2,0,60);return!!u.terrain||t.pitch>y}allowWorldCopies(){return!0}prepareNextFrame(){}}class bi{constructor(t,u,f){this.points=t,this.planes=u,this.aabb=f}static fromInvProjectionMatrix(t,u=1,f=0,y,v){const E=v?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],C=Math.pow(2,f),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((G=>(function(X,ie,ue,ce){const de=a.aw([],X,ie),xe=1/de[3]/ue*ce;return a.aY(de,de,[xe,xe,1/de[3],xe])})(G,t,u,C)));y&&(function(G,X,ie,ue){const ce=ue?4:0,de=ue?0:4;let xe=0;const Ae=[],Ee=[];for(let Re=0;Re<4;Re++){const Fe=a.aU([],G[Re+de],G[Re+ce]),st=a.aZ(Fe);a.aR(Fe,Fe,1/st),Ae.push(st),Ee.push(Fe)}for(let Re=0;Re<4;Re++){const Fe=a.a_(G[Re+ce],Ee[Re],ie);xe=Fe!==null&&Fe>=0?Math.max(xe,Fe):Math.max(xe,Ae[Re])}const Ie=(function(Re,Fe){const st=a.aU([],Re[Fe[0]],Re[Fe[1]]),Ye=a.aU([],Re[Fe[2]],Re[Fe[1]]),tt=[0,0,0,0];return a.aV(tt,a.aW([],st,Ye)),tt[3]=-a.aX(tt,Re[Fe[0]]),tt})(G,X),Ue=(function(Re,Fe){const st=a.a$(Re),Ye=a.b0([],Re,1/st),tt=a.aU([],Fe,a.aR([],Ye,a.aX(Fe,Ye))),it=a.a$(tt);if(it>0){const xt=Math.sqrt(1-Ye[3]*Ye[3]),wt=a.aR([],Ye,-Ye[3]),ft=a.aS([],wt,a.aR([],tt,xt/it));return a.b1(Fe,ft)}return null})(ie,Ie);if(Ue!==null){const Re=Ue/a.aX(Ee[0],Ie);xe=Math.min(xe,Re)}for(let Re=0;Re<4;Re++){const Fe=Math.min(xe,Ae[Re]);G[Re+de]=[G[Re+ce][0]+Ee[Re][0]*Fe,G[Re+ce][1]+Ee[Re][1]*Fe,G[Re+ce][2]+Ee[Re][2]*Fe,1]}})(P,E[0],y,v);const V=E.map((G=>{const X=a.aU([],P[G[0]],P[G[1]]),ie=a.aU([],P[G[2]],P[G[1]]),ue=a.aV([],a.aW([],X,ie)),ce=-a.aX(ue,P[G[1]]);return ue.concat(ce)})),N=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const G of P)for(let X=0;X<3;X++)N[X]=Math.min(N[X],G[X]),$[X]=Math.max($[X],G[X]);return new bi(P,V,new nn(N,$))}}class ml{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,u,f){return this._helper.interpolatePadding(t,u,f)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,u,f=!0){this._helper.resize(t,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,u){this._helper.overrideNearFarZ(t,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,u){}constructor(t,u,f,y,v){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new vn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,C)=>this.getConstrained(E,C)},t,u,f,y,v),this._coveringTilesDetailsProvider=new xn}clone(){const t=new ml;return t.apply(this),t}apply(t,u,f){this._helper.apply(t,u,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const u=[new a.b2(0,t)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new a.P(0,0)),y=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),v=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),C=Math.floor(Math.min(f.x,y.x,v.x,E.x)),P=Math.floor(Math.max(f.x,y.x,v.x,E.x)),V=1;for(let N=C-V;N<=P+V;N++)N!==0&&u.push(new a.b2(N,t))}return u}getCameraFrustum(){return bi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const u=this.screenPointToLocation(this.centerPoint,t),f=t?t.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(t,u){const f=a.aj(this.elevation,this.center.lat),y=this.screenPointToMercatorCoordinateAtZ(u,f),v=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),E=a.a1.fromLngLat(t),C=new a.a1(E.x-(y.x-v.x),E.y-(y.y-v.y));this.setCenter(C?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,u){return u?this.coordinatePoint(a.a1.fromLngLat(t),u.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a1.fromLngLat(t))}screenPointToLocation(t,u){var f;return(f=this.screenPointToMercatorCoordinate(t,u))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(t,u){if(u){const f=u.pointCoordinate(t);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,u){const f=u||0,y=[t.x,t.y,0,1],v=[t.x,t.y,1,1];a.aw(y,y,this._pixelMatrixInverse),a.aw(v,v,this._pixelMatrixInverse);const E=y[3],C=v[3],P=y[1]/E,V=v[1]/C,N=y[2]/E,$=v[2]/C,G=N===$?0:(f-N)/($-N);return new a.a1(a.C.number(y[0]/E,v[0]/C,G)/this.worldSize,a.C.number(P,V,G)/this.worldSize,f)}coordinatePoint(t,u=0,f=this._pixelMatrix){const y=[t.x*this.worldSize,t.y*this.worldSize,u,1];return a.aw(y,y,f),new a.P(y[0]/y[3],y[1]/y[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ge(this));return new br().extend(this.screenPointToLocation(new a.P(0,t))).extend(this.screenPointToLocation(new a.P(this._helper._width,t))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(t,u){return u?u.pointCoordinate(t)!=null:t.y>this.height/2-Ge(this)}calculatePosMatrix(t,u=!1,f){var y;const v=(y=t.key)!==null&&y!==void 0?y:a.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),E=u?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(v)){const V=E.get(v);return f?V.f32:V.f64}const C=Ne(t,this.worldSize);a.O(C,u?this._alignedProjMatrix:this._viewProjMatrix,C);const P={f64:C,f32:new Float32Array(C)};return E.set(v,P),f?P.f32:P.f64}calculateFogMatrix(t){const u=t.key,f=this._fogMatrixCacheF32;if(f.has(u))return f.get(u);const y=Ne(t,this.worldSize);return a.O(y,this._fogMatrix,y),f.set(u,new Float32Array(y)),f.get(u)}getConstrained(t,u){u=a.ah(+u,this.minZoom,this.maxZoom);const f={center:new a.S(t.lng,t.lat),zoom:u};let y=this._helper._lngRange;if(!this._helper._renderWorldCopies&&y===null){const Ae=179.9999999999;y=[-Ae,Ae]}const v=this.tileSize*a.af(f.zoom);let E=0,C=v,P=0,V=v,N=0,$=0;const{x:G,y:X}=this.size;if(this._helper._latRange){const Ae=this._helper._latRange;E=a.U(Ae[1])*v,C=a.U(Ae[0])*v,C-E<X&&(N=X/(C-E))}y&&(P=a.aO(a.V(y[0])*v,0,v),V=a.aO(a.V(y[1])*v,0,v),V<P&&(V+=v),V-P<G&&($=G/(V-P)));const{x:ie,y:ue}=Se(v,t);let ce,de;const xe=Math.max($||0,N||0);if(xe){const Ae=new a.P($?(V+P)/2:ie,N?(C+E)/2:ue);return f.center=je(v,Ae).wrap(),f.zoom+=a.ak(xe),f}if(this._helper._latRange){const Ae=X/2;ue-Ae<E&&(de=E+Ae),ue+Ae>C&&(de=C-Ae)}if(y){const Ae=(P+V)/2;let Ee=ie;this._helper._renderWorldCopies&&(Ee=a.aO(ie,Ae-v/2,Ae+v/2));const Ie=G/2;Ee-Ie<P&&(ce=P+Ie),Ee+Ie>V&&(ce=V-Ie)}if(ce!==void 0||de!==void 0){const Ae=new a.P(ce??ie,de??ue);f.center=je(v,Ae).wrap()}return f}calculateCenterFromCameraLngLatAlt(t,u,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(t,u,f,y)}_calculateNearFarZIfNeeded(t,u,f){if(!this._helper.autoCalculateNearFarZ)return;const y=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),v=t-y*this._helper._pixelPerMeter/Math.cos(u),E=y<0?v:t,C=Math.PI/2+this.pitchInRadians,P=a.ae(this.fov)*(Math.abs(Math.cos(a.ae(this.roll)))*this.height+Math.abs(Math.sin(a.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),V=Math.sin(P)*E/Math.sin(a.ah(Math.PI-C-P,.01,Math.PI-.01)),N=Ge(this),$=Math.atan(N/this._helper.cameraToCenterDistance),G=a.ae(.75),X=$>G?2*$*(.5+f.y/(2*N)):G,ie=Math.sin(X)*E/Math.sin(a.ah(Math.PI-C-X,.01,Math.PI-.01)),ue=Math.min(V,ie);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*ue+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,u=Se(this.worldSize,this.center),f=u.x,y=u.y;this._helper._pixelPerMeter=a.aj(1,this.center.lat)*this.worldSize;const v=a.ae(Math.min(this.pitch,ve)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(v));let C;this._calculateNearFarZIfNeeded(E,v,t),C=new Float64Array(16),a.b4(C,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.aq(this._invProjMatrix,C),C[8]=2*-t.x/this._helper._width,C[9]=2*t.y/this._helper._height,this._projectionMatrix=a.b5(C),a.N(C,C,[1,-1,1]),a.M(C,C,[0,0,-this._helper.cameraToCenterDistance]),a.b6(C,C,-this.rollInRadians),a.b7(C,C,this.pitchInRadians),a.b6(C,C,-this.bearingInRadians),a.M(C,C,[-f,-y,0]),this._mercatorMatrix=a.N([],C,[this.worldSize,this.worldSize,this.worldSize]),a.N(C,C,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C),a.M(C,C,[0,0,-this.elevation]),this._viewProjMatrix=C,this._invViewProjMatrix=a.aq([],C);const P=[0,0,-1,1];a.aw(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),a.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,a.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.M(this._fogMatrix,this._fogMatrix,[-f,-y,0]),a.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C);const V=this._helper._width%2/2,N=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),G=Math.sin(-this.bearingInRadians),X=f-Math.round(f)+$*V+G*N,ie=y-Math.round(y)+$*N+G*V,ue=new Float64Array(C);if(a.M(ue,ue,[X>.5?X-1:X,ie>.5?ie-1:ie,0]),this._alignedProjMatrix=ue,C=a.aq(new Float64Array(16),this._pixelMatrix),!C)throw new Error("failed to invert matrix");this._pixelMatrixInverse=C,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new a.P(0,0)),u=[t.x*this.worldSize,t.y*this.worldSize,0,1];return a.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=a.aj(1,this.center.lat)*this.worldSize;return Qe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,u){const f=a.a1.fromLngLat(t),y=[f.x*this.worldSize,f.y*this.worldSize,u,1];return a.aw(y,y,this._viewProjMatrix),y[2]/y[3]}getProjectionData(t){const{overscaledTileID:u,aligned:f,applyTerrainMatrix:y}=t,v=this._helper.getMercatorTileCoordinates(u),E=u?this.calculatePosMatrix(u,f,!0):null;let C;return C=u&&u.terrainRttPosMatrix32f&&y?u.terrainRttPosMatrix32f:E||a.b8(),{mainMatrix:C,tileMercatorCoords:v,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,u,f){return 1}transformLightDirection(t){return a.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,u,f,y){const v=this.calculatePosMatrix(f);let E;y?(E=[t,u,y(t,u),1],a.aw(E,E,v)):(E=[t,u,0,1],Gn(E,E,v));const C=E[3];return{point:new a.P(E[0]/C,E[1]/C),signedDistanceFromCamera:C,isOccluded:!1}}populateCache(t){for(const u of t)this.calculatePosMatrix(u)}getMatrixForModel(t,u){const f=a.a1.fromLngLat(t,u),y=f.meterInMercatorCoordinateUnits(),v=a.b9();return a.M(v,v,[f.x,f.y,f.z]),a.b6(v,v,Math.PI),a.b7(v,v,Math.PI/2),a.N(v,v,[-y,y,y]),v}getProjectionDataForCustomLayer(t=!0){const u=new a.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:t}),y=Ne(u,this.worldSize);a.O(y,this._viewProjMatrix,y),f.tileMercatorCoords=[0,0,1,1];const v=[a.$,a.$,this.worldSize/this._helper.pixelsPerMeter],E=a.ba();return a.N(E,y,v),f.fallbackMatrix=E,f.mainMatrix=E,f}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function zn(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function os(_){if(_.useSlerp)if(_.k<1){const t=a.bb(_.startEulerAngles.roll,_.startEulerAngles.pitch,_.startEulerAngles.bearing),u=a.bb(_.endEulerAngles.roll,_.endEulerAngles.pitch,_.endEulerAngles.bearing),f=new Float64Array(4);a.bc(f,t,u,_.k);const y=a.bd(f);_.tr.setRoll(y.roll),_.tr.setPitch(y.pitch),_.tr.setBearing(y.bearing)}else _.tr.setRoll(_.endEulerAngles.roll),_.tr.setPitch(_.endEulerAngles.pitch),_.tr.setBearing(_.endEulerAngles.bearing);else _.tr.setRoll(a.C.number(_.startEulerAngles.roll,_.endEulerAngles.roll,_.k)),_.tr.setPitch(a.C.number(_.startEulerAngles.pitch,_.endEulerAngles.pitch,_.k)),_.tr.setBearing(a.C.number(_.startEulerAngles.bearing,_.endEulerAngles.bearing,_.k))}function Hn(_,t,u,f,y){const v=y.padding,E=Se(y.worldSize,u.getNorthWest()),C=Se(y.worldSize,u.getNorthEast()),P=Se(y.worldSize,u.getSouthEast()),V=Se(y.worldSize,u.getSouthWest()),N=a.ae(-f),$=E.rotate(N),G=C.rotate(N),X=P.rotate(N),ie=V.rotate(N),ue=new a.P(Math.max($.x,G.x,ie.x,X.x),Math.max($.y,G.y,ie.y,X.y)),ce=new a.P(Math.min($.x,G.x,ie.x,X.x),Math.min($.y,G.y,ie.y,X.y)),de=ue.sub(ce),xe=(y.width-(v.left+v.right+t.left+t.right))/de.x,Ae=(y.height-(v.top+v.bottom+t.top+t.bottom))/de.y;if(Ae<0||xe<0)return void zn();const Ee=Math.min(a.ak(y.scale*Math.min(xe,Ae)),_.maxZoom),Ie=a.P.convert(_.offset),Ue=new a.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(a.ae(f)),Re=Ie.add(Ue).mult(y.scale/a.af(Ee));return{center:je(y.worldSize,E.add(P).div(2).sub(Re)),zoom:Ee,bearing:f}}class vu{get useGlobeControls(){return!1}handlePanInertia(t,u){const f=t.mag(),y=Math.abs(Ge(u));return{easingOffset:t.mult(Math.min(.75*y/f,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(t,u){t.bearingDelta&&u.setBearing(u.bearing+t.bearingDelta),t.pitchDelta&&u.setPitch(u.pitch+t.pitchDelta),t.rollDelta&&u.setRoll(u.roll+t.rollDelta),t.zoomDelta&&u.setZoom(u.zoom+t.zoomDelta)}handleMapControlsPan(t,u,f){t.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(f,t.around)}cameraForBoxAndBearing(t,u,f,y,v){return Hn(t,u,f,y,v)}handleJumpToCenterZoom(t,u){t.zoom!==(u.zoom!==void 0?+u.zoom:t.zoom)&&t.setZoom(+u.zoom),u.center!==void 0&&t.setCenter(a.S.convert(u.center))}handleEaseTo(t,u){const f=t.zoom,y=t.padding,v={roll:t.roll,pitch:t.pitch,bearing:t.bearing},E={roll:u.roll===void 0?t.roll:u.roll,pitch:u.pitch===void 0?t.pitch:u.pitch,bearing:u.bearing===void 0?t.bearing:u.bearing},C=u.zoom!==void 0,P=!t.isPaddingEqual(u.padding);let V=!1;const N=C?+u.zoom:t.zoom;let $=t.centerPoint.add(u.offsetAsPoint);const G=t.screenPointToLocation($),{center:X,zoom:ie}=t.getConstrained(a.S.convert(u.center||G),N??f);hl(t,X);const ue=Se(t.worldSize,G),ce=Se(t.worldSize,X).sub(ue),de=a.af(ie-f);return V=ie!==f,{easeFunc:xe=>{if(V&&t.setZoom(a.C.number(f,ie,xe)),a.be(v,E)||os({startEulerAngles:v,endEulerAngles:E,tr:t,k:xe,useSlerp:v.roll!=E.roll}),P&&(t.interpolatePadding(y,u.padding,xe),$=t.centerPoint.add(u.offsetAsPoint)),u.around)t.setLocationAtPoint(u.around,u.aroundPoint);else{const Ae=a.af(t.zoom-f),Ee=ie>f?Math.min(2,de):Math.max(.5,de),Ie=Math.pow(Ee,1-xe),Ue=je(t.worldSize,ue.add(ce.mult(xe*Ie)).mult(Ae));t.setLocationAtPoint(t.renderWorldCopies?Ue.wrap():Ue,$)}},isZooming:V,elevationCenter:X}}handleFlyTo(t,u){const f=u.zoom!==void 0,y=t.zoom,v=t.getConstrained(a.S.convert(u.center||u.locationAtOffset),f?+u.zoom:y),E=v.center,C=v.zoom;hl(t,E);const P=Se(t.worldSize,u.locationAtOffset),V=Se(t.worldSize,E).sub(P),N=V.mag(),$=a.af(C-y);let G;if(u.minZoom!==void 0){const X=Math.min(+u.minZoom,y,C),ie=t.getConstrained(E,X).zoom;G=a.af(ie-y)}return{easeFunc:(X,ie,ue,ce)=>{t.setZoom(X===1?C:y+a.ak(ie));const de=X===1?E:je(t.worldSize,P.add(V.mult(ue)).mult(ie));t.setLocationAtPoint(t.renderWorldCopies?de.wrap():de,ce)},scaleOfZoom:$,targetCenter:E,scaleOfMinZoom:G,pixelPathLength:N}}}class li{constructor(t,u,f){this.blendFunction=t,this.blendColor=u,this.mask=f}}li.Replace=[1,0],li.disabled=new li(li.Replace,a.bf.transparent,[!1,!1,!1,!1]),li.unblended=new li(li.Replace,a.bf.transparent,[!0,!0,!0,!0]),li.alphaBlended=new li([1,771],a.bf.transparent,[!0,!0,!0,!0]);const Ci=2305;class Vr{constructor(t,u,f){this.enable=t,this.mode=u,this.frontFace=f}}Vr.disabled=new Vr(!1,1029,Ci),Vr.backCCW=new Vr(!0,1029,Ci),Vr.frontCCW=new Vr(!0,1028,Ci);class hr{constructor(t,u,f){this.func=t,this.mask=u,this.range=f}}hr.ReadOnly=!1,hr.ReadWrite=!0,hr.disabled=new hr(519,hr.ReadOnly,[0,1]);const yl=7680;class Er{constructor(t,u,f,y,v,E){this.test=t,this.ref=u,this.mask=f,this.fail=y,this.depthFail=v,this.pass=E}}Er.disabled=new Er({func:519,mask:0},0,0,yl,yl,yl);const Kc=new WeakMap;function Cn(_){var t;if(Kc.has(_))return Kc.get(_);{const u=(t=_.getParameter(_.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Kc.set(_,u),u}}class Sf{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const u=t.context,f=u.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const y=new a.aL;y.emplaceBack(-1,-1),y.emplaceBack(2,-1),y.emplaceBack(-1,2);const v=new a.aN;v.emplaceBack(0,1,2),this._fullscreenTriangle=new Xo(u.createVertexBuffer(y,bn.members),u.createIndexBuffer(v),a.aM.simpleSegment(0,0,y.length,v.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(f.TEXTURE1);const E=f.createTexture();f.bindTexture(f.TEXTURE_2D,E),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),Cn(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,u){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,u=t.gl;t.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,u){const f=this._cachedRenderContext.context,y=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:a.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,y.TRIANGLES,hr.disabled,Er.disabled,li.unblended,Vr.disabled,((v,E)=>({u_input:v,u_output_expected:E}))(t,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Cn(y)){y.bindBuffer(y.PIXEL_PACK_BUFFER,this._pbo),y.readBuffer(y.COLOR_ATTACHMENT0),y.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),y.bindBuffer(y.PIXEL_PACK_BUFFER,null);const v=y.fenceSync(y.SYNC_GPU_COMMANDS_COMPLETE,0);y.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:v}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Cn(t)){const u=t.clientWaitSync(this._readbackQueue.sync,0,0);if(u===t.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Sf._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let u=0;return u+=t[0]/256,u+=t[1]/65536,u+=t[2]/16777216,t[3]<127&&(u=-u),u/128}}const xu=a.$/128;function wu(_,t){const u=_.granularity!==void 0?Math.max(_.granularity,1):1,f=u+(_.generateBorders?2:0),y=u+(_.extendToNorthPole||_.generateBorders?1:0)+(_.extendToSouthPole||_.generateBorders?1:0),v=f+1,E=y+1,C=_.generateBorders?-1:0,P=_.generateBorders||_.extendToNorthPole?-1:0,V=u+(_.generateBorders?1:0),N=u+(_.generateBorders||_.extendToSouthPole?1:0),$=v*E,G=f*y*6,X=v*E>65536;if(X&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ie=X||t==="32bit",ue=new Int16Array(2*$);let ce=0;for(let Ae=P;Ae<=N;Ae++)for(let Ee=C;Ee<=V;Ee++){let Ie=Ee/u*a.$;Ee===-1&&(Ie=-xu),Ee===u+1&&(Ie=a.$+xu);let Ue=Ae/u*a.$;Ae===-1&&(Ue=_.extendToNorthPole?a.bh:-xu),Ae===u+1&&(Ue=_.extendToSouthPole?a.bi:a.$+xu),ue[ce++]=Ie,ue[ce++]=Ue}const de=ie?new Uint32Array(G):new Uint16Array(G);let xe=0;for(let Ae=0;Ae<y;Ae++)for(let Ee=0;Ee<f;Ee++){const Ie=Ee+1+Ae*v,Ue=Ee+(Ae+1)*v,Re=Ee+1+(Ae+1)*v;de[xe++]=Ee+Ae*v,de[xe++]=Ue,de[xe++]=Ie,de[xe++]=Ie,de[xe++]=Ue,de[xe++]=Re}return{vertices:ue.buffer.slice(0),indices:de.buffer.slice(0),uses32bitIndices:ie}}const gl=new a.aK({fill:new a.bj(128,2),line:new a.bj(512,0),tile:new a.bj(128,32),stencil:new a.bj(128,1),circle:3});class Eu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return _n.projectionGlobe}get vertexShaderPreludeCode(){return _n.projectionMercator.vertexSource}get subdivisionGranularity(){return gl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Sf(t));const u=a.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,y=this._errorMeasurement.updateErrorLoop(u,f),v=D.now();y!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=y,this._errorMeasurementLastChangeTime=v);const E=Math.min(Math.max((v-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bl(E))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,u,f,y,v){const E=(v==="stencil"?gl.stencil:gl.tile).getGranularityForZoomLevel(u.z);return this._getMesh(t,{granularity:E,generateBorders:f,extendToNorthPole:u.y===0&&y,extendToSouthPole:u.y===(1<<u.z)-1&&y})}_getMesh(t,u){const f=this._getMeshKey(u);if(f in this._tileMeshCache)return this._tileMeshCache[f];const y=(function(v,E){const C=wu(E,"16bit"),P=a.aL.deserialize({arrayBuffer:C.vertices,length:C.vertices.byteLength/2/2}),V=a.aN.deserialize({arrayBuffer:C.indices,length:C.indices.byteLength/2/3});return new Xo(v.createVertexBuffer(P,bn.members),v.createIndexBuffer(V),a.aM.simpleSegment(0,0,P.length,V.length))})(t,u);return this._tileMeshCache[f]=y,y}recalculate(t){}hasTransition(){const t=D.now();let u=!1;return u=u||(t-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Tf=new a.r({type:new a.D(a.v.projection.type)});class Gc extends a.E{constructor(t){super(),this._transitionable=new a.t(Tf,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0)),this._mercatorProjection=new Ca,this._verticalPerspectiveProjection=new Eu}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof a.bm){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,u,f,y,v){return this.currentProjection.getMeshFromTileID(t,u,f,y,v)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Au(_){const t=ka(_.worldSize,_.center.lat);return 2*Math.PI*t}function lo(_,t,u,f,y){const v=1/(1<<y),E=t/a.$*v+f*v,C=a.bo((_/a.$*v+u*v)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,V=Math.cos(P),N=new Float64Array(3);return N[0]=Math.sin(C)*V,N[1]=Math.sin(P),N[2]=Math.cos(C)*V,N}function sn(_){return(function(t,u){const f=Math.cos(u),y=new Float64Array(3);return y[0]=Math.sin(t)*f,y[1]=Math.sin(u),y[2]=Math.cos(t)*f,y})(_.lng*Math.PI/180,_.lat*Math.PI/180)}function ka(_,t){return _/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Ru(_){const t=Math.asin(_[1])/Math.PI*180,u=Math.sqrt(_[0]*_[0]+_[2]*_[2]);if(u>1e-6){const f=_[0]/u,y=Math.acos(_[2]/u),v=(f>0?y:-y)/Math.PI*180;return new a.S(a.aO(v,-180,180),t)}return new a.S(0,t)}function Wo(_){return Math.cos(_*Math.PI/180)}function on(_,t){const u=Wo(_),f=Wo(t);return a.ak(f/u)}function $c(_,t){const u=_.rotate(t.bearingInRadians),f=t.zoom+on(t.center.lat,0),y=a.bk(1/Wo(t.center.lat),1/Wo(Math.min(Math.abs(t.center.lat),60)),a.bn(f,7,3,0,1)),v=360/Au({worldSize:t.worldSize,center:{lat:t.center.lat}});return new a.S(t.center.lng-u.x*v*y,a.ah(t.center.lat+u.y*v,-a.ai,a.ai))}function Zc(_){const t=.5*_,u=Math.sin(t),f=Math.cos(t);return Math.log(u+f)-Math.log(f-u)}function iy(_,t,u,f){const y=_.lat+u*f;if(Math.abs(u)>1){const v=(Math.sign(_.lat+u)!==Math.sign(_.lat)?-Math.abs(_.lat):Math.abs(_.lat))*Math.PI/180,E=Math.abs(_.lat+u)*Math.PI/180,C=Zc(v+f*(E-v)),P=Zc(v),V=Zc(E);return new a.S(_.lng+t*((C-P)/(V-P)),y)}return new a.S(_.lng+t*f,y)}class g0{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,u,f,y){const v=`${t.z}_${t.x}_${t.y}_${y?.terrain?"t":""}`,E=this._cache.get(v);if(E)return E;const C=this._cachePrevious.get(v);if(C)return this._cache.set(v,C),C;const P=this._boundingVolumeFactory(t,u,f,y);return this._cache.set(v,P),this._hadAnyChanges=!0,P}}class Hi{constructor(t,u,f,y){this.min=f,this.max=y,this.points=t,this.planes=u}static fromAabb(t,u){const f=[];for(let y=0;y<8;y++)f.push([1&~y?t[0]:u[0],(y>>1&1)==1?u[1]:t[1],(y>>2&1)==1?u[2]:t[2]]);return new Hi(f,[[-1,0,0,u[0]],[1,0,0,-t[0]],[0,-1,0,u[1]],[0,1,0,-t[1]],[0,0,-1,u[2]],[0,0,1,-t[2]]],t,u)}static fromCenterSizeAngles(t,u,f){const y=a.br([],f[0],f[1],f[2]),v=a.bs([],[u[0],0,0],y),E=a.bs([],[0,u[1],0],y),C=a.bs([],[0,0,u[2]],y),P=[...t],V=[...t];for(let $=0;$<8;$++)for(let G=0;G<3;G++){const X=t[G]+v[G]*(1&~$?-1:1)+E[G]*(($>>1&1)==1?1:-1)+C[G]*(($>>2&1)==1?1:-1);P[G]=Math.min(P[G],X),V[G]=Math.max(V[G],X)}const N=[];for(let $=0;$<8;$++){const G=[...t];a.aS(G,G,a.aR([],v,1&~$?-1:1)),a.aS(G,G,a.aR([],E,($>>1&1)==1?1:-1)),a.aS(G,G,a.aR([],C,($>>2&1)==1?1:-1)),N.push(G)}return new Hi(N,[[...v,-a.aX(v,N[0])],[...E,-a.aX(E,N[0])],[...C,-a.aX(C,N[0])],[-v[0],-v[1],-v[2],-a.aX(v,N[7])],[-E[0],-E[1],-E[2],-a.aX(E,N[7])],[-C[0],-C[1],-C[2],-a.aX(C,N[7])]],P,V)}intersectsFrustum(t){let u=!0;const f=this.points.length,y=this.planes.length,v=t.planes.length,E=t.points.length;for(let C=0;C<v;C++){const P=t.planes[C];let V=0;for(let N=0;N<f;N++){const $=this.points[N];P[0]*$[0]+P[1]*$[1]+P[2]*$[2]+P[3]>=0&&V++}if(V===0)return 0;V<f&&(u=!1)}if(u)return 2;for(let C=0;C<y;C++){const P=this.planes[C];let V=0;for(let N=0;N<E;N++){const $=t.points[N];P[0]*$[0]+P[1]*$[1]+P[2]*$[2]+P[3]>=0&&V++}if(V===0)return 0}return 1}intersectsPlane(t){const u=this.points.length;let f=0;for(let y=0;y<u;y++){const v=this.points[y];t[0]*v[0]+t[1]*v[1]+t[2]*v[2]+t[3]>=0&&f++}return f===u?2:f===0?0:1}}function _l(_,t,u){const f=_-t;return f<0?-f:Math.max(0,f-u)}function ws(_,t,u,f,y){const v=_-u;let E;return E=v<0?Math.min(-v,1+v-y):v>1?Math.min(Math.max(v-y,0),1-v):0,Math.max(E,_l(t,f,y))}class Hc{constructor(){this._boundingVolumeCache=new g0(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,u,f,y){const v=1<<f.z,E=1/v,C=f.x/v,P=f.y/v;let V=2;return V=Math.min(V,ws(t,u,C,P,E)),V=Math.min(V,ws(t,u,C+.5,-P-E,E)),V=Math.min(V,ws(t,u,C+.5,2-P-E,E)),V}getWrap(t,u,f){const y=1<<u.z,v=1/y,E=u.x/y,C=_l(t.x,E,v),P=_l(t.x,E-1,v),V=_l(t.x,E+1,v),N=Math.min(C,P,V);return N===V?1:N===P?-1:0}allowVariableZoom(t,u){return Ke(t,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,u,f,y){return this._boundingVolumeCache.getTileBoundingVolume(t,u,f,y)}_computeTileBoundingVolume(t,u,f,y){var v,E;let C=0,P=0;if(y?.terrain){const V=new a.Z(t.z,u,t.z,t.x,t.y),N=y.terrain.getMinMaxElevation(V);C=(v=N.minElevation)!==null&&v!==void 0?v:Math.min(0,f),P=(E=N.maxElevation)!==null&&E!==void 0?E:Math.max(0,f)}if(C/=a.bu,P/=a.bu,C+=1,P+=1,t.z<=0)return Hi.fromAabb([-P,-P,-P],[P,P,P]);if(t.z===1)return Hi.fromAabb([t.x===0?-P:0,t.y===0?0:-P,-P],[t.x===0?0:P,t.y===0?P:0,P]);{const V=[lo(0,0,t.x,t.y,t.z),lo(a.$,0,t.x,t.y,t.z),lo(a.$,a.$,t.x,t.y,t.z),lo(0,a.$,t.x,t.y,t.z)],N=[];for(const tt of V)N.push(a.aR([],tt,P));if(P!==C)for(const tt of V)N.push(a.aR([],tt,C));t.y===0&&N.push([0,1,0]),t.y===(1<<t.z)-1&&N.push([0,-1,0]);const $=[1,1,1],G=[-1,-1,-1];for(const tt of N)for(let it=0;it<3;it++)$[it]=Math.min($[it],tt[it]),G[it]=Math.max(G[it],tt[it]);const X=lo(a.$/2,a.$/2,t.x,t.y,t.z),ie=a.aW([],[0,1,0],X);a.aV(ie,ie);const ue=a.aW([],X,ie);a.aV(ue,ue);const ce=a.aW([],V[2],V[1]);a.aV(ce,ce);const de=a.aW([],V[0],V[3]);a.aV(de,de),N.push(a.aR([],X,P)),t.y>=(1<<t.z)/2&&N.push(a.aR([],lo(a.$/2,0,t.x,t.y,t.z),P)),t.y<(1<<t.z)/2&&N.push(a.aR([],lo(a.$/2,a.$,t.x,t.y,t.z),P));const xe=Cf(X,N),Ae=Cf(ue,N),Ee=[-X[0],-X[1],-X[2],xe.max],Ie=[X[0],X[1],X[2],-xe.min],Ue=[-ue[0],-ue[1],-ue[2],Ae.max],Re=[ue[0],ue[1],ue[2],-Ae.min],Fe=[...ce,0],st=[...de,0],Ye=[];return t.y===0?Ye.push(a.bt(st,Fe,Ee),a.bt(st,Fe,Ie)):Ye.push(a.bt(Ue,Fe,Ee),a.bt(Ue,Fe,Ie),a.bt(Ue,st,Ee),a.bt(Ue,st,Ie)),t.y===(1<<t.z)-1?Ye.push(a.bt(st,Fe,Ee),a.bt(st,Fe,Ie)):Ye.push(a.bt(Re,Fe,Ee),a.bt(Re,Fe,Ie),a.bt(Re,st,Ee),a.bt(Re,st,Ie)),new Hi(Ye,[Ee,Ie,Ue,Re,Fe,st],$,G)}}}function Cf(_,t){let u=1/0,f=-1/0;for(const y of t){const v=a.aX(_,y);u=Math.min(u,v),f=Math.max(f,v)}return{min:u,max:f}}class Su{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,u,f){return this._helper.interpolatePadding(t,u,f)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,u){this._helper.resize(t,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,u){this._helper.overrideNearFarZ(t,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=a.bv(),this._projectionMatrix=a.b9(),this._globeViewProjMatrix32f=a.b8(),this._globeViewProjMatrixNoCorrection=a.b9(),this._globeViewProjMatrixNoCorrectionInverted=a.b9(),this._globeProjMatrixInverted=a.b9(),this._cameraPosition=a.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new vn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,u)=>this.getConstrained(t,u)}),this._coveringTilesDetailsProvider=new Hc}clone(){const t=new Su;return t.apply(this),t}apply(t,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=a.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:u,applyGlobeMatrix:f}=t,y=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:y,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const u=this.pitchInRadians,f=this.cameraToCenterDistance/t,y=Math.sin(u)*f,v=Math.cos(u)*f+1,E=1/Math.sqrt(y*y+v*v)*1;let C=-y,P=v;const V=Math.sqrt(C*C+P*P);C/=V,P/=V;const N=[0,C,P];a.bw(N,N,[0,0,0],-this.bearingInRadians),a.bx(N,N,[0,0,0],-1*this.center.lat*Math.PI/180),a.by(N,N,[0,0,0],this.center.lng*Math.PI/180);const $=1/a.aZ(N);return a.aR(N,N,$),[...N,-E*$]}isLocationOccluded(t){return!this.isSurfacePointVisible(sn(t))}transformLightDirection(t){const u=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,y=Math.cos(f),v=[Math.sin(u)*y,Math.sin(f),Math.cos(u)*y],E=[v[2],0,-v[0]],C=[0,0,0];a.aW(C,E,v),a.aV(E,E),a.aV(C,C);const P=[0,0,0];return a.aV(P,[E[0]*t[0]+C[0]*t[1]+v[0]*t[2],E[1]*t[0]+C[1]*t[1]+v[1]*t[2],E[2]*t[0]+C[2]*t[1]+v[2]*t[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,u,f){const y=(function(C,P,V){const N=1/(1<<V.z);return new a.a1(C/a.$*N+V.x*N,P/a.$*N+V.y*N)})(t,u,f.canonical),v=(E=y.y,[a.bo(y.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(v[1])}projectTileCoordinates(t,u,f,y){const v=f.canonical,E=lo(t,u,v.x,v.y,v.z),C=1+(y?y(t,u):0)/a.bu,P=[E[0]*C,E[1]*C,E[2]*C,1];a.aw(P,P,this._globeViewProjMatrixNoCorrection);const V=this._cachedClippingPlane,N=V[0]*E[0]+V[1]*E[1]+V[2]*E[2]+V[3]<0;return{point:new a.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:N}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=ka(this.worldSize,this.center.lat),u=a.ba(),f=a.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),a.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const y=this.centerOffset;u[8]=2*-y.x/this._helper._width,u[9]=2*y.y/this._helper._height,this._projectionMatrix=a.b5(u),this._globeProjMatrixInverted=a.ba(),a.aq(this._globeProjMatrixInverted,u),a.M(u,u,[0,0,-this.cameraToCenterDistance]),a.b6(u,u,this.rollInRadians),a.b7(u,u,-this.pitchInRadians),a.b6(u,u,this.bearingInRadians),a.M(u,u,[0,0,-t]);const v=a.bp();v[0]=t,v[1]=t,v[2]=t,a.b7(f,u,this.center.lat*Math.PI/180),a.bz(f,f,-this.center.lng*Math.PI/180),a.N(f,f,v),this._globeViewProjMatrixNoCorrection=f,a.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bz(u,u,-this.center.lng*Math.PI/180),a.N(u,u,v),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=a.ba(),a.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const E=a.bp();this._cameraPosition=a.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,a.bw(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),a.bx(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),a.bw(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),a.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bx(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),a.by(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const C=a.b5(this._globeViewProjMatrixNoCorrectionInverted);a.N(C,C,[1,1,-1]),this._cachedFrustum=bi.fromInvProjectionMatrix(C,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){a.w("calculateFogMatrix is not supported on globe projection.");const u=a.ba();return a.ag(u),u}getVisibleUnwrappedCoordinates(t){return[new a.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=sn(t);a.aR(f,f,1+u/a.bu);const y=a.bv();return a.aw(y,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),y[2]/y[3]}populateCache(t){}getBounds(){const t=.5*this.width,u=.5*this.height,f=[new a.P(0,0),new a.P(t,0),new a.P(this.width,0),new a.P(this.width,u),new a.P(this.width,this.height),new a.P(t,this.height),new a.P(0,this.height),new a.P(0,u)],y=[];for(const $ of f)y.push(this.unprojectScreenPoint($));let v=0,E=0,C=0,P=0;const V=this.center;for(const $ of y){const G=a.bA(V.lng,$.lng),X=a.bA(V.lat,$.lat);G<E&&(E=G),G>v&&(v=G),X<P&&(P=X),X>C&&(C=X)}const N=[V.lng+E,V.lat+P,V.lng+v,V.lat+C];return this.isSurfacePointOnScreen([0,1,0])&&(N[3]=90,N[0]=-180,N[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(N[1]=-90,N[0]=-180,N[2]=180),new br(N)}getConstrained(t,u){const f=a.ah(t.lat,-a.ai,a.ai),y=a.ah(+u,this.minZoom+on(0,f),this.maxZoom);return{center:new a.S(t.lng,f),zoom:y}}calculateCenterFromCameraLngLatAlt(t,u,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(t,u,f,y)}setLocationAtPoint(t,u){const f=sn(this.unprojectScreenPoint(u)),y=sn(t),v=a.bp();a.bB(v);const E=a.bp();a.by(E,f,v,-this.center.lng*Math.PI/180),a.bx(E,E,v,this.center.lat*Math.PI/180);const C=y[0]*y[0]+y[2]*y[2],P=E[0]*E[0];if(C<P)return;const V=Math.sqrt(C-P),N=-V,$=a.bC(y[0],y[2],E[0],V),G=a.bC(y[0],y[2],E[0],N),X=a.bp();a.by(X,y,v,-$);const ie=a.bC(X[1],X[2],E[1],E[2]),ue=a.bp();a.by(ue,y,v,-G);const ce=a.bC(ue[1],ue[2],E[1],E[2]),de=.5*Math.PI,xe=ie>=-de&&ie<=de,Ae=ce>=-de&&ce<=de;let Ee,Ie;if(xe&&Ae){const st=this.center.lng*Math.PI/180,Ye=this.center.lat*Math.PI/180;a.bD($,st)+a.bD(ie,Ye)<a.bD(G,st)+a.bD(ce,Ye)?(Ee=$,Ie=ie):(Ee=G,Ie=ce)}else if(xe)Ee=$,Ie=ie;else{if(!Ae)return;Ee=G,Ie=ce}const Ue=Ee/Math.PI*180,Re=Ie/Math.PI*180,Fe=this.center.lat;this.setCenter(new a.S(Ue,a.ah(Re,-90,90))),this.setZoom(this.zoom+on(Fe,this.center.lat))}locationToScreenPoint(t,u){const f=sn(t);if(u){const y=u.getElevationForLngLatZoom(t,this._helper._tileZoom);a.aR(f,f,1+y/a.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(t){const u=a.bv();return a.aw(u,[...t,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new a.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,u){if(u){const f=u.pointCoordinate(t);if(f)return f}return a.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,u){var f;return(f=this.screenPointToMercatorCoordinate(t,u))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(t,u){const f=this._cameraPosition,y=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(f,y)}getRayDirectionFromPixel(t){const u=a.bv();u[0]=t.x/this.width*2-1,u[1]=-1*(t.y/this.height*2-1),u[2]=1,u[3]=1,a.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const f=a.bp();f[0]=u[0]-this._cameraPosition[0],f[1]=u[1]-this._cameraPosition[1],f[2]=u[2]-this._cameraPosition[2];const y=a.bp();return a.aV(y,f),y}isSurfacePointVisible(t){const u=this._cachedClippingPlane;return u[0]*t[0]+u[1]*t[1]+u[2]*t[2]+u[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const u=a.bv();return a.aw(u,[...t,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(t,u){const f=a.aX(t,u),y=a.bp(),v=a.bp();a.aR(v,u,f),a.aU(y,t,v);const E=1-a.aX(y,y);if(E<0)return null;const C=a.aX(t,t)-1,P=-f+(f<0?1:-1)*Math.sqrt(E),V=C/P,N=P;return{tMin:Math.min(V,N),tMax:Math.max(V,N)}}unprojectScreenPoint(t){const u=this._cameraPosition,f=this.getRayDirectionFromPixel(t),y=this.rayPlanetIntersection(u,f);if(y){const N=a.bp();a.aS(N,u,[f[0]*y.tMin,f[1]*y.tMin,f[2]*y.tMin]);const $=a.bp();return a.aV($,N),Ru($)}const v=this._cachedClippingPlane,E=v[0]*f[0]+v[1]*f[1]+v[2]*f[2],C=-a.b1(v,u)/E,P=a.bp();if(C>0)a.aS(P,u,[f[0]*C,f[1]*C,f[2]*C]);else{const N=a.bp();a.aS(N,u,[2*f[0],2*f[1],2*f[2]]);const $=a.b1(this._cachedClippingPlane,N);a.aU(P,N,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const V=(function(N){const $=a.bp();return $[0]=N[0]*-N[3],$[1]=N[1]*-N[3],$[2]=N[2]*-N[3],{center:$,radius:Math.sqrt(1-N[3]*N[3])}})(v);return Ru((function(N,$,G){const X=a.bp();a.aU(X,G,N);const ie=a.bp();return a.bq(ie,N,X,$/a.a$(X)),ie})(V.center,V.radius,P))}getMatrixForModel(t,u){const f=a.S.convert(t),y=1/a.bu,v=a.b9();return a.bz(v,v,f.lng/180*Math.PI),a.b7(v,v,-f.lat/180*Math.PI),a.M(v,v,[0,0,1+u/a.bu]),a.b7(v,v,.5*Math.PI),a.N(v,v,[y,y,y]),v}getProjectionDataForCustomLayer(t=!0){const u=this.getProjectionData({overscaledTileID:new a.Z(0,0,0,0,0),applyGlobeMatrix:t});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(t){}}class So{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,u,f){return this._helper.interpolatePadding(t,u,f)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,u,f=!0){this._helper.resize(t,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,u){this._helper.overrideNearFarZ(t,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,u){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new vn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,u)=>this.getConstrained(t,u)}),this._globeness=1,this._mercatorTransform=new ml,this._verticalPerspectiveTransform=new Su}clone(){const t=new So;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const u=this._mercatorTransform.getProjectionData(t),f=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:u.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return a.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,u,f){const y=this._mercatorTransform.getPitchedTextCorrection(t,u,f),v=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,u,f);return a.bk(y,v,this._globeness)}projectTileCoordinates(t,u,f,y){return this.currentTransform.projectTileCoordinates(t,u,f,y)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,u){return this.currentTransform.lngLatToCameraDepth(t,u)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,u){return this.currentTransform.getConstrained(t,u)}calculateCenterFromCameraLngLatAlt(t,u,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(t,u,f,y)}setLocationAtPoint(t,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,u){return this.currentTransform.locationToScreenPoint(t,u)}screenPointToMercatorCoordinate(t,u){return this.currentTransform.screenPointToMercatorCoordinate(t,u)}screenPointToLocation(t,u){return this.currentTransform.screenPointToLocation(t,u)}isPointOnMapSurface(t,u){return this.currentTransform.isPointOnMapSurface(t,u)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,u){return this.currentTransform.getMatrixForModel(t,u)}getProjectionDataForCustomLayer(t=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return u;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return f.fallbackMatrix=u.mainMatrix,f}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Os{get useGlobeControls(){return!0}handlePanInertia(t,u){const f=$c(t,u);return Math.abs(f.lng-u.center.lng)>180&&(f.lng=u.center.lng+179.5*Math.sign(f.lng-u.center.lng)),{easingCenter:f,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,u){const f=t.around,y=u.screenPointToLocation(f);t.bearingDelta&&u.setBearing(u.bearing+t.bearingDelta),t.pitchDelta&&u.setPitch(u.pitch+t.pitchDelta),t.rollDelta&&u.setRoll(u.roll+t.rollDelta);const v=u.zoom;t.zoomDelta&&u.setZoom(u.zoom+t.zoomDelta);const E=u.zoom-v;if(E===0)return;const C=a.bA(u.center.lng,y.lng),P=C/(Math.abs(C/180)+1),V=a.bA(u.center.lat,y.lat),N=u.getRayDirectionFromPixel(f),$=u.cameraPosition,G=-1*a.aX($,N),X=a.bp();a.aS(X,$,[N[0]*G,N[1]*G,N[2]*G]);const ie=a.aZ(X)-1,ue=Math.exp(.5*-Math.max(ie-.3,0)),ce=ka(u.worldSize,u.center.lat)/Math.min(u.width,u.height),de=a.bn(ce,.9,.5,1,.25),xe=(1-a.af(-E))*Math.min(ue,de),Ae=u.center.lat,Ee=u.zoom,Ie=new a.S(u.center.lng+P*xe,a.ah(u.center.lat+V*xe,-a.ai,a.ai));u.setLocationAtPoint(y,f);const Ue=u.center,Re=a.bn(Math.abs(C),45,85,0,1),Fe=a.bn(ce,.75,.35,0,1),st=Math.pow(Math.max(Re,Fe),.25),Ye=a.bA(Ue.lng,Ie.lng),tt=a.bA(Ue.lat,Ie.lat);u.setCenter(new a.S(Ue.lng+Ye*st,Ue.lat+tt*st).wrap()),u.setZoom(Ee+on(Ae,u.center.lat))}handleMapControlsPan(t,u,f){if(!t.panDelta)return;const y=u.center.lat,v=u.zoom;u.setCenter($c(t.panDelta,u).wrap()),u.setZoom(v+on(y,u.center.lat))}cameraForBoxAndBearing(t,u,f,y,v){const E=Hn(t,u,f,y,v),C=u.left/v.width*2-1,P=(v.width-u.right)/v.width*2-1,V=u.top/v.height*-2+1,N=(v.height-u.bottom)/v.height*-2+1,$=a.bA(f.getWest(),f.getEast())<0,G=$?f.getEast():f.getWest(),X=$?f.getWest():f.getEast(),ie=Math.max(f.getNorth(),f.getSouth()),ue=Math.min(f.getNorth(),f.getSouth()),ce=G+.5*a.bA(G,X),de=ie+.5*a.bA(ie,ue),xe=v.clone();xe.setCenter(E.center),xe.setBearing(E.bearing),xe.setPitch(0),xe.setRoll(0),xe.setZoom(E.zoom);const Ae=xe.modelViewProjectionMatrix,Ee=[sn(f.getNorthWest()),sn(f.getNorthEast()),sn(f.getSouthWest()),sn(f.getSouthEast()),sn(new a.S(X,de)),sn(new a.S(G,de)),sn(new a.S(ce,ie)),sn(new a.S(ce,ue))],Ie=sn(E.center);let Ue=Number.POSITIVE_INFINITY;for(const Re of Ee)C<0&&(Ue=Os.getLesserNonNegativeNonNull(Ue,Os.solveVectorScale(Re,Ie,Ae,"x",C))),P>0&&(Ue=Os.getLesserNonNegativeNonNull(Ue,Os.solveVectorScale(Re,Ie,Ae,"x",P))),V>0&&(Ue=Os.getLesserNonNegativeNonNull(Ue,Os.solveVectorScale(Re,Ie,Ae,"y",V))),N<0&&(Ue=Os.getLesserNonNegativeNonNull(Ue,Os.solveVectorScale(Re,Ie,Ae,"y",N)));if(Number.isFinite(Ue)&&Ue!==0)return E.zoom=xe.zoom+a.ak(Ue),E;zn()}handleJumpToCenterZoom(t,u){const f=t.center.lat,y=t.getConstrained(u.center?a.S.convert(u.center):t.center,t.zoom).center;t.setCenter(y.wrap());const v=u.zoom!==void 0?+u.zoom:t.zoom+on(f,y.lat);t.zoom!==v&&t.setZoom(v)}handleEaseTo(t,u){const f=t.zoom,y=t.center,v=t.padding,E={roll:t.roll,pitch:t.pitch,bearing:t.bearing},C={roll:u.roll===void 0?t.roll:u.roll,pitch:u.pitch===void 0?t.pitch:u.pitch,bearing:u.bearing===void 0?t.bearing:u.bearing},P=u.zoom!==void 0,V=!t.isPaddingEqual(u.padding);let N=!1;const $=u.center?a.S.convert(u.center):y,G=t.getConstrained($,f).center;hl(t,G);const X=t.clone();X.setCenter(G),X.setZoom(P?+u.zoom:f+on(y.lat,$.lat)),X.setBearing(u.bearing);const ie=new a.P(a.ah(t.centerPoint.x+u.offsetAsPoint.x,0,t.width),a.ah(t.centerPoint.y+u.offsetAsPoint.y,0,t.height));X.setLocationAtPoint(G,ie);const ue=(u.offset&&u.offsetAsPoint.mag())>0?X.center:G,ce=P?+u.zoom:f+on(y.lat,ue.lat),de=f+on(y.lat,0),xe=ce+on(ue.lat,0),Ae=a.bA(y.lng,ue.lng),Ee=a.bA(y.lat,ue.lat),Ie=a.af(xe-de);return N=ce!==f,{easeFunc:Ue=>{if(a.be(E,C)||os({startEulerAngles:E,endEulerAngles:C,tr:t,k:Ue,useSlerp:E.roll!=C.roll}),V&&t.interpolatePadding(v,u.padding,Ue),u.around)a.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(u.around,u.aroundPoint);else{const Re=xe>de?Math.min(2,Ie):Math.max(.5,Ie),Fe=Math.pow(Re,1-Ue),st=iy(y,Ae,Ee,Ue*Fe);t.setCenter(st.wrap())}if(N){const Re=a.C.number(de,xe,Ue)+on(0,t.center.lat);t.setZoom(Re)}},isZooming:N,elevationCenter:ue}}handleFlyTo(t,u){const f=u.zoom!==void 0,y=t.center,v=t.zoom,E=t.padding,C=!t.isPaddingEqual(u.padding),P=t.getConstrained(a.S.convert(u.center||u.locationAtOffset),v).center,V=f?+u.zoom:t.zoom+on(t.center.lat,P.lat),N=t.clone();N.setCenter(P),N.setZoom(V),N.setBearing(u.bearing);const $=new a.P(a.ah(t.centerPoint.x+u.offsetAsPoint.x,0,t.width),a.ah(t.centerPoint.y+u.offsetAsPoint.y,0,t.height));N.setLocationAtPoint(P,$);const G=N.center;hl(t,G);const X=(function(Ee,Ie,Ue){const Re=sn(Ie),Fe=sn(Ue),st=a.aX(Re,Fe),Ye=Math.acos(st),tt=Au(Ee);return Ye/(2*Math.PI)*tt})(t,y,G),ie=v+on(y.lat,0),ue=V+on(G.lat,0),ce=a.af(ue-ie);let de;if(typeof u.minZoom=="number"){const Ee=+u.minZoom+on(G.lat,0),Ie=Math.min(Ee,ie,ue)+on(0,G.lat),Ue=t.getConstrained(G,Ie).zoom+on(G.lat,0);de=a.af(Ue-ie)}const xe=a.bA(y.lng,G.lng),Ae=a.bA(y.lat,G.lat);return{easeFunc:(Ee,Ie,Ue,Re)=>{const Fe=iy(y,xe,Ae,Ue);C&&t.interpolatePadding(E,u.padding,Ee);const st=Ee===1?G:Fe;t.setCenter(st.wrap());const Ye=ie+a.ak(Ie);t.setZoom(Ee===1?V:Ye+on(0,st.lat))},scaleOfZoom:ce,targetCenter:G,scaleOfMinZoom:de,pixelPathLength:X}}static solveVectorScale(t,u,f,y,v){const E=y==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],C=[f[3],f[7],f[11],f[15]],P=t[0]*E[0]+t[1]*E[1]+t[2]*E[2],V=t[0]*C[0]+t[1]*C[1]+t[2]*C[2],N=u[0]*E[0]+u[1]*E[1]+u[2]*E[2],$=u[0]*C[0]+u[1]*C[1]+u[2]*C[2];return N+v*V===P+v*$||C[3]*(P-N)+E[3]*($-V)+P*$==N*V?null:(N+E[3]-v*$-v*C[3])/(N-P-v*$+v*V)}static getLesserNonNegativeNonNull(t,u){return u!==null&&u>=0&&u<t?u:t}}class ny{constructor(t){this._globe=t,this._mercatorCameraHelper=new vu,this._verticalPerspectiveCameraHelper=new Os}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,u){return this.currentHelper.handlePanInertia(t,u)}handleMapControlsRollPitchBearingZoom(t,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,u)}handleMapControlsPan(t,u,f){this.currentHelper.handleMapControlsPan(t,u,f)}cameraForBoxAndBearing(t,u,f,y,v){return this.currentHelper.cameraForBoxAndBearing(t,u,f,y,v)}handleJumpToCenterZoom(t,u){this.currentHelper.handleJumpToCenterZoom(t,u)}handleEaseTo(t,u){return this.currentHelper.handleEaseTo(t,u)}handleFlyTo(t,u){return this.currentHelper.handleFlyTo(t,u)}}const Xc=(_,t)=>a.y(_,t&&t.filter((u=>u.identifier!=="source.canvas"))),_0=a.bE();class kf extends a.E{constructor(t,u={}){var f,y;super(),this._rtlPluginLoaded=()=>{for(const E in this.sourceCaches){const C=this.sourceCaches[E].getSource().type;C!=="vector"&&C!=="geojson"||this.sourceCaches[E].reload()}},this.map=t,this.dispatcher=new tr(Tt(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((E,C)=>this.getGlyphs(E,C))),this.dispatcher.registerMessageHandler("GI",((E,C)=>this.getImages(E,C))),this.dispatcher.registerMessageHandler("GDA",((E,C)=>this.getDashes(E,C))),this.imageManager=new dt,this.imageManager.setEventedParent(this);const v=((f=t._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((y=document.documentElement)===null||y===void 0?void 0:y.lang)||void 0;this.glyphManager=new te(t._requestManager,u.localIdeographFontFamily,v),this.lineAtlas=new lt(256,512),this.crossTileSymbolIndex=new Ho,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bG()),vt().on(gi,this._rtlPluginLoaded),this.on("data",(E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const C=this.sourceCaches[E.sourceId];if(!C)return;const P=C.getSource();if(P&&P.vectorLayerIds)for(const V in this._layers){const N=this._layers[V];N.source===P.id&&this._validateLayer(N)}}))}setGlobalStateProperty(t,u){var f,y,v;this._checkLoaded();const E=u===null?(v=(y=(f=this.stylesheet.state)===null||f===void 0?void 0:f[t])===null||y===void 0?void 0:y.default)!==null&&v!==void 0?v:null:u;if(a.bH(E,this._globalState[t]))return this;this._globalState[t]=E,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const u=[];for(const f in t)!a.bH(this._globalState[f],t[f].default)&&(u.push(f),this._globalState[f]=t[f].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(t){if(t.length===0)return;const u=new Set,f={};for(const y of t){f[y]=this._globalState[y];for(const v in this._layers){const E=this._layers[v],C=E.getLayoutAffectingGlobalStateRefs(),P=E.getPaintAffectingGlobalStateRefs();if(C.has(y)&&u.add(E.source),P.has(y))for(const{name:V,value:N}of P.get(y))this._updatePaintProperty(E,V,N)}}this.dispatcher.broadcast("UGS",f);for(const y in this.sourceCaches)u.has(y)&&(this._reloadSource(y),this._changed=!0)}loadURL(t,u={},f){this.fire(new a.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const y=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const v=this._loadStyleRequest;a.j(y,this._loadStyleRequest).then((E=>{this._loadStyleRequest=null,this._load(E.data,u,f)})).catch((E=>{this._loadStyleRequest=null,E&&!v.signal.aborted&&this.fire(new a.k(E))}))}loadJSON(t,u={},f){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,D.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(t,u,f)})).catch((()=>{}))}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(_0,{validate:!1})}_load(t,u,f){var y,v;let E=u.transformStyle?u.transformStyle(f,t):t;if(!u.validate||!Xc(this,a.z(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const C in E.sources)this.addSource(C,E.sources[C],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new ye(this.stylesheet.light),this._setProjectionInternal(((y=this.stylesheet.projection)===null||y===void 0?void 0:y.type)||"mercator"),this.sky=new gt(this.stylesheet.sky),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){var t,u,f;const y=a.bI(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",y),this._order=y.map((v=>v.id)),this._layers={},this._serializedLayers=null;for(const v of y){const E=a.bJ(v,this._globalState);if(E.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=E,a.bK(E)&&this.sourceCaches[E.source]){const C=(f=(u=v.paint)===null||u===void 0?void 0:u["raster-fade-duration"])!==null&&f!==void 0?f:E.paint.get("raster-fade-duration");this.sourceCaches[E.source].setRasterFadeDuration(C)}}}_loadSprite(t,u=!1,f=void 0){let y;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(v,E,C,P){return a._(this,void 0,void 0,(function*(){const V=pe(v),N=C>1?"@2x":"",$={},G={};for(const{id:X,url:ie}of V){const ue=E.transformRequest(_e(ie,N,".json"),"SpriteJSON");$[X]=a.j(ue,P);const ce=E.transformRequest(_e(ie,N,".png"),"SpriteImage");G[X]=Q.getImage(ce,P)}return yield Promise.all([...Object.values($),...Object.values(G)]),(function(X,ie){return a._(this,void 0,void 0,(function*(){const ue={};for(const ce in X){ue[ce]={};const de=D.getImageCanvasContext((yield ie[ce]).data),xe=(yield X[ce]).data;for(const Ae in xe){const{width:Ee,height:Ie,x:Ue,y:Re,sdf:Fe,pixelRatio:st,stretchX:Ye,stretchY:tt,content:it,textFitWidth:xt,textFitHeight:wt}=xe[Ae];ue[ce][Ae]={data:null,pixelRatio:st,sdf:Fe,stretchX:Ye,stretchY:tt,content:it,textFitWidth:xt,textFitHeight:wt,spriteData:{width:Ee,height:Ie,x:Ue,y:Re,context:de}}}}return ue}))})($,G)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((v=>{if(this._spriteRequest=null,v)for(const E in v){this._spritesImagesIds[E]=[];const C=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter((P=>!(P in v))):[];for(const P of C)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in v[E]){const V=E==="default"?P:`${E}:${P}`;this._spritesImagesIds[E].push(V),V in this.imageManager.images?this.imageManager.updateImage(V,v[E][P],!1):this.imageManager.addImage(V,v[E][P]),u&&(this._changedImages[V]=!0)}}})).catch((v=>{this._spriteRequest=null,y=v,this.fire(new a.k(y))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),f&&f(y)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(t){const u=this.sourceCaches[t.source];if(!u)return;const f=t.sourceLayer;if(!f)return;const y=u.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new a.k(new Error(`Source layer "${f}" does not exist on source "${y.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,u=!1){const f=this._serializedAllLayers();if(!t||t.length===0)return Object.values(u?a.bL(f):f);const y=[];for(const v of t)if(f[v]){const E=u?a.bL(f[v]):f[v];y.push(E)}return y}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const y=this._layers[f];y.type!=="custom"&&(t[f]=y.serialize())}return t}hasTransitions(){var t,u,f;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const y in this.sourceCaches)if(this.sourceCaches[y].hasTransition())return!0;for(const y in this._layers)if(this._layers[y].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const u=this._changed;if(u){const y=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(y.length||v.length)&&this._updateWorkerLayers(y,v);for(const E in this._updatedSources){const C=this._updatedSources[E];if(C==="reload")this._reloadSource(E);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const f={};for(const y in this.sourceCaches){const v=this.sourceCaches[y];f[y]=v.used,v.used=!1}for(const y of this._order){const v=this._layers[y];v.recalculate(t,this._availableImages),!v.isHidden(t.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const y in f){const v=this.sourceCaches[y];!!f[y]!=!!v.used&&v.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,u&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,u={}){var f;this._checkLoaded();const y=this.serialize();if(t=u.transformStyle?u.transformStyle(y,t):t,((f=u.validate)===null||f===void 0||f)&&Xc(this,a.z(t)))return!1;(t=a.bL(t)).layers=a.bI(t.layers);const v=a.bM(y,t),E=this._getOperationsToPerform(v);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const C of E.operations)C();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const u=[],f=[];for(const y of t)switch(y.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push((()=>this.addLayer.apply(this,y.args)));break;case"removeLayer":u.push((()=>this.removeLayer.apply(this,y.args)));break;case"setPaintProperty":u.push((()=>this.setPaintProperty.apply(this,y.args)));break;case"setLayoutProperty":u.push((()=>this.setLayoutProperty.apply(this,y.args)));break;case"setFilter":u.push((()=>this.setFilter.apply(this,y.args)));break;case"addSource":u.push((()=>this.addSource.apply(this,y.args)));break;case"removeSource":u.push((()=>this.removeSource.apply(this,y.args)));break;case"setLayerZoomRange":u.push((()=>this.setLayerZoomRange.apply(this,y.args)));break;case"setLight":u.push((()=>this.setLight.apply(this,y.args)));break;case"setGeoJSONSourceData":u.push((()=>this.setGeoJSONSourceData.apply(this,y.args)));break;case"setGlyphs":u.push((()=>this.setGlyphs.apply(this,y.args)));break;case"setSprite":u.push((()=>this.setSprite.apply(this,y.args)));break;case"setTerrain":u.push((()=>this.map.setTerrain.apply(this,y.args)));break;case"setSky":u.push((()=>this.setSky.apply(this,y.args)));break;case"setProjection":this.setProjection.apply(this,y.args);break;case"setGlobalState":u.push((()=>this.setGlobalState.apply(this,y.args)));break;case"setTransition":u.push((()=>{}));break;default:f.push(y.command)}return{operations:u,unimplemented:f}}addImage(t,u){if(this.getImage(t))return this.fire(new a.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,u),this._afterImageUpdated(t)}updateImage(t,u){this.imageManager.updateImage(t,u)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new a.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,u,f={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.z.source,`sources.${t}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const y=this.sourceCaches[t]=new Ot(t,u,this.dispatcher);y.style=this,y.setEventedParent(this,(()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:t}))),y.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===t)return this.fire(new a.k(new Error(`Source "${t}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],u.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,u){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const f=this.sourceCaches[t].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,u,f={}){this._checkLoaded();const y=t.id;if(this.getLayer(y))return void this.fire(new a.k(new Error(`Layer "${y}" already exists on this map.`)));let v;if(t.type==="custom"){if(Xc(this,a.bN(t)))return;v=a.bJ(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(y,t.source),t=a.bL(t),t=a.e(t,{source:y})),this._validate(a.z.layer,`layers.${y}`,t,{arrayIndex:-1},f))return;v=a.bJ(t,this._globalState),this._validateLayer(v),v.setEventedParent(this,{layer:{id:y}})}const E=u?this._order.indexOf(u):this._order.length;if(u&&E===-1)this.fire(new a.k(new Error(`Cannot add layer "${y}" before non-existing layer "${u}".`)));else{if(this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=v,this._removedLayers[y]&&v.source&&v.type!=="custom"){const C=this._removedLayers[y];delete this._removedLayers[y],C.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(t,u){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new a.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===u)return;const f=this._order.indexOf(t);this._order.splice(f,1);const y=u?this._order.indexOf(u):this._order.length;u&&y===-1?this.fire(new a.k(new Error(`Cannot move layer "${t}" before non-existing layer "${u}".`))):(this._order.splice(y,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const u=this._layers[t];if(!u)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${t}".`)));u.setEventedParent(null);const f=this._order.indexOf(t);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=u,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],u.onRemove&&u.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,u,f){this._checkLoaded();const y=this.getLayer(t);y?y.minzoom===u&&y.maxzoom===f||(u!=null&&(y.minzoom=u),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,u,f={}){this._checkLoaded();const y=this.getLayer(t);if(y){if(!a.bH(y.filter,u))return u==null?(y.setFilter(void 0),void this._updateLayer(y)):void(this._validate(a.z.filter,`layers.${y.id}.filter`,u,null,f)||(y.setFilter(a.bL(u)),this._updateLayer(y)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return a.bL(this.getLayer(t).filter)}setLayoutProperty(t,u,f,y={}){this._checkLoaded();const v=this.getLayer(t);v?a.bH(v.getLayoutProperty(u),f)||(v.setLayoutProperty(u,f,y),this._updateLayer(v)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,u){const f=this.getLayer(t);if(f)return f.getLayoutProperty(u);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,u,f,y={}){this._checkLoaded();const v=this.getLayer(t);v?a.bH(v.getPaintProperty(u),f)||this._updatePaintProperty(v,u,f,y):this.fire(new a.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,u,f,y={}){t.setPaintProperty(u,f,y)&&this._updateLayer(t),a.bK(t)&&u==="raster-fade-duration"&&this.sourceCaches[t.source].setRasterFadeDuration(f),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,u){return this.getLayer(t).getPaintProperty(u)}setFeatureState(t,u){this._checkLoaded();const f=t.source,y=t.sourceLayer,v=this.sourceCaches[f];if(v===void 0)return void this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)));const E=v.getSource().type;E==="geojson"&&y?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||y?(t.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),v.setFeatureState(y,t.id,u)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,u){this._checkLoaded();const f=t.source,y=this.sourceCaches[f];if(y===void 0)return void this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)));const v=y.getSource().type,E=v==="vector"?t.sourceLayer:void 0;v!=="vector"||E?u&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(E,t.id,u):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const u=t.source,f=t.sourceLayer,y=this.sourceCaches[u];if(y!==void 0)return y.getSource().type!=="vector"||f?(t.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,t.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=a.bO(this.sourceCaches,(v=>v.serialize())),u=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,y=this.stylesheet;return a.bP({version:y.version,name:y.name,metadata:y.metadata,light:y.light,sky:y.sky,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,projection:y.projection,sources:t,layers:u,terrain:f},(v=>v!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const u=E=>this._layers[E].type==="fill-extrusion",f={},y=[];for(let E=this._order.length-1;E>=0;E--){const C=this._order[E];if(u(C)){f[C]=E;for(const P of t){const V=P[C];if(V)for(const N of V)y.push(N)}}}y.sort(((E,C)=>C.intersectionZ-E.intersectionZ));const v=[];for(let E=this._order.length-1;E>=0;E--){const C=this._order[E];if(u(C))for(let P=y.length-1;P>=0;P--){const V=y[P].feature;if(f[V.layer.id]<E)break;v.push(V),y.pop()}else for(const P of t){const V=P[C];if(V)for(const N of V)v.push(N.feature)}}return v}queryRenderedFeatures(t,u,f){u&&u.filter&&this._validate(a.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const y={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const V of u.layers){const N=this._layers[V];if(!N)return this.fire(new a.k(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];y[N.source]=!0}}const v=[];u.availableImages=this._availableImages;const E=this._serializedAllLayers(),C=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,P=Object.assign(Object.assign({},u),{layers:C,globalState:this._globalState});for(const V in this.sourceCaches)u.layers&&!y[V]||v.push(kr(this.sourceCaches[V],this._layers,E,t,P,f,this.map.terrain?(N,$,G)=>this.map.terrain.getElevation(N,$,G):void 0));return this.placement&&v.push((function(V,N,$,G,X,ie,ue){const ce={},de=ie.queryRenderedSymbols(G),xe=[];for(const Ae of Object.keys(de).map(Number))xe.push(ue[Ae]);xe.sort(Sr);for(const Ae of xe){const Ee=Ae.featureIndex.lookupSymbolFeatures(de[Ae.bucketInstanceId],N,Ae.bucketIndex,Ae.sourceLayerIndex,{filterSpec:X.filter,globalState:X.globalState},X.layers,X.availableImages,V);for(const Ie in Ee){const Ue=ce[Ie]=ce[Ie]||[],Re=Ee[Ie];Re.sort(((Fe,st)=>{const Ye=Ae.featureSortOrder;if(Ye){const tt=Ye.indexOf(Fe.featureIndex);return Ye.indexOf(st.featureIndex)-tt}return st.featureIndex-Fe.featureIndex}));for(const Fe of Re)Ue.push(Fe)}}return(function(Ae,Ee,Ie){for(const Ue in Ae)for(const Re of Ae[Ue])$r(Re,Ie[Ee[Ue].source]);return Ae})(ce,V,$)})(this._layers,E,this.sourceCaches,t,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(t,u){u?.filter&&this._validate(a.z.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[t];return f?(function(y,v){const E=y.getRenderableIds().map((V=>y.getTileByID(V))),C=[],P={};for(let V=0;V<E.length;V++){const N=E[V],$=N.tileID.canonical.key;P[$]||(P[$]=!0,N.querySourceFeatures(C,v))}return C})(f,u?Object.assign(Object.assign({},u),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,u={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const E in t)if(!a.bH(t[E],f[E])){y=!0;break}if(!y)return;const v={now:D.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,u),this.light.updateTransitions(v)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,u={}){this._checkLoaded();const f=this.getSky();let y=!1;if(!t&&!f)return;if(t&&!f)y=!0;else if(!t&&f)y=!0;else for(const E in t)if(!a.bH(t[E],f[E])){y=!0;break}if(!y)return;const v={now:D.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,u),this.sky.updateTransitions(v)}_setProjectionInternal(t){const u=(function(f){if(Array.isArray(f)){const y=new Gc({type:f});return{projection:y,transform:new So,cameraHelper:new ny(y)}}switch(f){case"mercator":return{projection:new Ca,transform:new ml,cameraHelper:new vu};case"globe":{const y=new Gc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:y,transform:new So,cameraHelper:new ny(y)}}case"vertical-perspective":return{projection:new Eu,transform:new Su,cameraHelper:new Os};default:return a.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Ca,transform:new ml,cameraHelper:new vu}}})(t);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(t,u,f,y,v={}){return(!v||v.validate!==!1)&&Xc(this,t.call(a.z,a.e({key:u,style:this.serialize(),value:f,styleSpec:a.v},y)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),vt().off(gi,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const u in this.sourceCaches)this.sourceCaches[u].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,u,f,y,v=!1){let E=!1,C=!1;const P={};for(const V of this._order){const N=this._layers[V];if(N.type!=="symbol")continue;if(!P[N.source]){const G=this.sourceCaches[N.source];P[N.source]=G.getRenderableIds(!0).map((X=>G.getTileByID(X))).sort(((X,ie)=>ie.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(ie.tileID)?-1:1)))}const $=this.crossTileSymbolIndex.addLayer(N,P[N.source],t.center.lng);E=E||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(D.now(),t.zoom))&&(this.pauseablePlacement=new L(t,this.map.terrain,this._order,v,u,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(D.now()),C=!0),E&&this.pauseablePlacement.placement.setStale()),C||E)for(const V of this._order){const N=this._layers[V];N.type==="symbol"&&this.placement.updateLayerOpacities(N,P[N.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(D.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,u){return a._(this,void 0,void 0,(function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const y=this.sourceCaches[u.source];return y&&y.setDependencies(u.tileID.key,u.type,u.icons),f}))}getGlyphs(t,u){return a._(this,void 0,void 0,(function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),y=this.sourceCaches[u.source];return y&&y.setDependencies(u.tileID.key,u.type,[""]),f}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,u={}){this._checkLoaded(),t&&this._validate(a.z.glyphs,"glyphs",t,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,u){return a._(this,void 0,void 0,(function*(){const f={};for(const[y,v]of Object.entries(u.dashes))f[y]=this.lineAtlas.getDash(v.dasharray,v.round);return f}))}addSprite(t,u,f={},y){this._checkLoaded();const v=[{id:t,url:u}],E=[...pe(this.stylesheet.sprite),...v];this._validate(a.z.sprite,"sprite",E,null,f)||(this.stylesheet.sprite=E,this._loadSprite(v,!0,y))}removeSprite(t){this._checkLoaded();const u=pe(this.stylesheet.sprite);if(u.find((f=>f.id===t))){if(this._spritesImagesIds[t])for(const f of this._spritesImagesIds[t])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex((f=>f.id===t)),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return pe(this.stylesheet.sprite)}setSprite(t,u={},f){this._checkLoaded(),t&&this._validate(a.z.sprite,"sprite",t,null,u)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,f):(this._unloadSprite(),f&&f(null)))}}var b0=a.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Wc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,u,f,y,v,E,C,P,V){this.context=t;let N=this.boundPaintVertexBuffers.length!==y.length;for(let $=0;!N&&$<y.length;$++)this.boundPaintVertexBuffers[$]!==y[$]&&(N=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||N||this.boundIndexBuffer!==v||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==V?this.freshBind(u,f,y,v,E,C,P,V):(t.bindVertexArray.set(this.vao),C&&C.bind(),v&&v.dynamicDraw&&v.bind(),P&&P.bind(),V&&V.bind())}freshBind(t,u,f,y,v,E,C,P){const V=t.numAttributes,N=this.context,$=N.gl;this.vao&&this.destroy(),this.vao=N.createVertexArray(),N.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=P,u.enableAttributes($,t);for(const G of f)G.enableAttributes($,t);E&&E.enableAttributes($,t),C&&C.enableAttributes($,t),P&&P.enableAttributes($,t),u.bind(),u.setVertexAttribPointers($,t,v);for(const G of f)G.bind(),G.setVertexAttribPointers($,t,v);E&&(E.bind(),E.setVertexAttribPointers($,t,v)),y&&y.bind(),C&&(C.bind(),C.setVertexAttribPointers($,t,v)),P&&(P.bind(),P.setVertexAttribPointers($,t,v)),N.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Pf=(_,t,u,f,y)=>({u_texture:0,u_ele_delta:_,u_fog_matrix:t,u_fog_color:u?u.properties.get("fog-color"):a.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:y?0:u?u.calculateFogBlendOpacity(f):0,u_horizon_color:u?u.properties.get("horizon-color"):a.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:y?1:0}),Yc={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function bl(_){const t=[];for(let u=0;u<_.length;u++){if(_[u]===null)continue;const f=_[u].split(" ");t.push(f.pop())}return t}class Lf{constructor(t,u,f,y,v,E,C,P,V=[]){const N=t.gl;this.program=N.createProgram();const $=bl(u.staticAttributes),G=f?f.getBinderAttributes():[],X=$.concat(G),ie=_n.prelude.staticUniforms?bl(_n.prelude.staticUniforms):[],ue=C.staticUniforms?bl(C.staticUniforms):[],ce=u.staticUniforms?bl(u.staticUniforms):[],de=f?f.getBinderUniforms():[],xe=ie.concat(ue).concat(ce).concat(de),Ae=[];for(const Ye of xe)Ae.indexOf(Ye)<0&&Ae.push(Ye);const Ee=f?f.defines():[];Cn(N)&&Ee.unshift("#version 300 es"),v&&Ee.push("#define OVERDRAW_INSPECTOR;"),E&&Ee.push("#define TERRAIN3D;"),P&&Ee.push(P),V&&Ee.push(...V);let Ie=Ee.concat(_n.prelude.fragmentSource,C.fragmentSource,u.fragmentSource).join(`
`),Ue=Ee.concat(_n.prelude.vertexSource,C.vertexSource,u.vertexSource).join(`
`);Cn(N)||(Ie=(function(Ye){return Ye.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Ie),Ue=(function(Ye){return Ye.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Ue));const Re=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Re,Ie),N.compileShader(Re),!N.getShaderParameter(Re,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(Re)}`);N.attachShader(this.program,Re);const Fe=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Fe,Ue),N.compileShader(Fe),!N.getShaderParameter(Fe,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(Fe)}`);N.attachShader(this.program,Fe),this.attributes={};const st={};this.numAttributes=X.length;for(let Ye=0;Ye<this.numAttributes;Ye++)X[Ye]&&(N.bindAttribLocation(this.program,Ye,X[Ye]),this.attributes[X[Ye]]=Ye);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(Fe),N.deleteShader(Re);for(let Ye=0;Ye<Ae.length;Ye++){const tt=Ae[Ye];if(tt&&!st[tt]){const it=N.getUniformLocation(this.program,tt);it&&(st[tt]=it)}}this.fixedUniforms=y(t,st),this.terrainUniforms=((Ye,tt)=>({u_depth:new a.bQ(Ye,tt.u_depth),u_terrain:new a.bQ(Ye,tt.u_terrain),u_terrain_dim:new a.bg(Ye,tt.u_terrain_dim),u_terrain_matrix:new a.bS(Ye,tt.u_terrain_matrix),u_terrain_unpack:new a.bT(Ye,tt.u_terrain_unpack),u_terrain_exaggeration:new a.bg(Ye,tt.u_terrain_exaggeration)}))(t,st),this.projectionUniforms=((Ye,tt)=>({u_projection_matrix:new a.bS(Ye,tt.u_projection_matrix),u_projection_tile_mercator_coords:new a.bT(Ye,tt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bT(Ye,tt.u_projection_clipping_plane),u_projection_transition:new a.bg(Ye,tt.u_projection_transition),u_projection_fallback_matrix:new a.bS(Ye,tt.u_projection_fallback_matrix)}))(t,st),this.binderUniforms=f?f.getUniforms(t,st):[]}draw(t,u,f,y,v,E,C,P,V,N,$,G,X,ie,ue,ce,de,xe,Ae){const Ee=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(f),t.setStencilMode(y),t.setColorMode(v),t.setCullFace(E),P){t.activeTexture.set(Ee.TEXTURE2),Ee.bindTexture(Ee.TEXTURE_2D,P.depthTexture),t.activeTexture.set(Ee.TEXTURE3),Ee.bindTexture(Ee.TEXTURE_2D,P.texture);for(const Ue in this.terrainUniforms)this.terrainUniforms[Ue].set(P[Ue])}if(V)for(const Ue in V)this.projectionUniforms[Yc[Ue]].set(V[Ue]);if(C)for(const Ue in this.fixedUniforms)this.fixedUniforms[Ue].set(C[Ue]);ce&&ce.setUniforms(t,this.binderUniforms,ie,{zoom:ue});let Ie=0;switch(u){case Ee.LINES:Ie=2;break;case Ee.TRIANGLES:Ie=3;break;case Ee.LINE_STRIP:Ie=1}for(const Ue of X.get()){const Re=Ue.vaos||(Ue.vaos={});(Re[N]||(Re[N]=new Wc)).bind(t,this,$,ce?ce.getPaintVertexBuffers():[],G,Ue.vertexOffset,de,xe,Ae),Ee.drawElements(u,Ue.primitiveLength*Ie,Ee.UNSIGNED_SHORT,Ue.primitiveOffset*Ie*2)}}}function Vs(_,t,u){const f=1/a.aC(u,1,t.transform.tileZoom),y=Math.pow(2,u.tileID.overscaledZ),v=u.tileSize*Math.pow(2,t.transform.tileZoom)/y,E=v*(u.tileID.canonical.x+u.tileID.wrap*y),C=v*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[E>>16,C>>16],u_pixel_coord_lower:[65535&E,65535&C]}}const sy=(_,t,u,f)=>{const y=_.style.light,v=y.properties.get("position"),E=[v.x,v.y,v.z],C=a.bW();y.properties.get("anchor")==="viewport"&&a.bX(C,_.transform.bearingInRadians),a.bY(E,E,C);const P=_.transform.transformLightDirection(E),V=y.properties.get("color");return{u_lightpos:E,u_lightpos_globe:P,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+t,u_opacity:u,u_fill_translate:f}},Df=(_,t,u,f,y,v,E)=>a.e(sy(_,t,u,f),Vs(v,_,E),{u_height_factor:-Math.pow(2,y.overscaledZ)/E.tileSize/8}),vl=(_,t,u,f)=>a.e(Vs(t,_,u),{u_fill_translate:f}),Tu=(_,t)=>({u_world:_,u_fill_translate:t}),v0=(_,t,u,f,y)=>a.e(vl(_,t,u,y),{u_world:f}),Jc=(_,t,u,f,y)=>{const v=_.transform;let E,C,P=0;if(u.paint.get("circle-pitch-alignment")==="map"){const V=a.aC(t,1,v.zoom);E=!0,C=[V,V],P=V/(a.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*y}else E=!1,C=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:C,u_globe_extrude_scale:P,u_translate:f}},x0=_=>({u_pixel_extrude_scale:[1/_.width,1/_.height]}),xl=_=>({u_viewport_size:[_.width,_.height]}),oy=(_,t=1)=>({u_color:_,u_overlay:0,u_overlay_scale:t}),If=(_,t,u,f)=>{const y=a.aC(_,1,t)/(a.$*Math.pow(2,_.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:a.aC(_,1,t),u_intensity:u,u_globe_extrude_scale:y}},ay=(_,t,u,f)=>{const y=a.L();a.bZ(y,0,_.width,_.height,0,0,1);const v=_.context.gl;return{u_matrix:y,u_world:[v.drawingBufferWidth,v.drawingBufferHeight],u_image:u,u_color_ramp:f,u_opacity:t.paint.get("heatmap-opacity")}},ly=(_,t,u)=>{const f=u.paint.get("hillshade-accent-color");let y;switch(u.paint.get("hillshade-method")){case"basic":y=4;break;case"combined":y=1;break;case"igor":y=2;break;case"multidirectional":y=3;break;default:y=0}const v=u.getIlluminationProperties();for(let E=0;E<v.directionRadians.length;E++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(v.directionRadians[E]+=_.transform.bearingInRadians);return{u_image:0,u_latrange:uy(0,t.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:v.altitudeRadians,u_azimuths:v.directionRadians,u_accent:f,u_method:y,u_highlights:v.highlightColor,u_shadows:v.shadowColor}},Bf=(_,t)=>{const u=t.stride,f=a.L();return a.bZ(f,0,a.$,-a.$,0,0,1),a.M(f,f,[0,-a.$,0]),{u_matrix:f,u_image:1,u_dimension:[u,u],u_zoom:_.overscaledZ,u_unpack:t.getUnpackVector()}};function uy(_,t){const u=Math.pow(2,t.canonical.z),f=t.canonical.y;return[new a.a1(0,f/u).toLngLat().lat,new a.a1(0,(f+1)/u).toLngLat().lat]}const cy=(_,t,u=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:_.paint.get("color-relief-opacity")}),Cu=(_,t,u,f)=>{const y=_.transform;return{u_translation:hy(_,t,u),u_ratio:f/a.aC(t,1,y.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},dy=(_,t,u,f,y)=>a.e(Cu(_,t,u,f),{u_image:0,u_image_height:y}),Pa=(_,t,u,f,y)=>{const v=_.transform,E=La(t,v);return{u_translation:hy(_,t,u),u_texsize:t.imageAtlasTexture.size,u_ratio:f/a.aC(t,1,v.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[E,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},py=(_,t,u,f,y)=>{const v=La(t,_.transform);return a.e(Cu(_,t,u,f),{u_tileratio:v,u_crossfade_from:y.fromScale,u_crossfade_to:y.toScale,u_image:0,u_mix:y.t,u_lineatlas_width:_.lineAtlas.width,u_lineatlas_height:_.lineAtlas.height})},fy=(_,t,u,f,y,v)=>{const E=La(t,_.transform);return a.e(Cu(_,t,u,f),{u_image:0,u_image_height:v,u_tileratio:E,u_crossfade_from:y.fromScale,u_crossfade_to:y.toScale,u_image_dash:1,u_mix:y.t,u_lineatlas_width:_.lineAtlas.width,u_lineatlas_height:_.lineAtlas.height})};function La(_,t){return 1/a.aC(_,1,t.tileZoom)}function hy(_,t,u){return a.aD(_.transform,t,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Qc=(_,t,u,f,y)=>{return{u_tl_parent:_,u_scale_parent:t,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(E=f.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(v=f.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:w0(f.paint.get("raster-hue-rotate")),u_coords_top:[y[0].x,y[0].y,y[1].x,y[1].y],u_coords_bottom:[y[3].x,y[3].y,y[2].x,y[2].y]};var v,E};function w0(_){_*=Math.PI/180;const t=Math.sin(_),u=Math.cos(_);return[(2*u+1)/3,(-Math.sqrt(3)*t-u+1)/3,(Math.sqrt(3)*t-u+1)/3]}const my=(_,t,u,f,y,v,E,C,P,V,N,$,G)=>{const X=E.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:X.width/X.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:C,u_coord_matrix:P,u_is_text:+N,u_pitch_with_map:+f,u_is_along_line:y,u_is_variable_anchor:v,u_texsize:$,u_texture:0,u_translation:V,u_pitched_scale:G}},Mf=(_,t,u,f,y,v,E,C,P,V,N,$,G,X)=>{const ie=E.transform;return a.e(my(_,t,u,f,y,v,E,C,P,V,N,$,X),{u_gamma_scale:f?Math.cos(ie.pitch*Math.PI/180)*ie.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},yy=(_,t,u,f,y,v,E,C,P,V,N,$,G)=>a.e(Mf(_,t,u,f,y,v,E,C,P,V,!0,N,0,G),{u_texsize_icon:$,u_texture_icon:1}),gy=(_,t)=>({u_opacity:_,u_color:t}),zf=(_,t,u,f,y)=>a.e((function(v,E,C,P){const V=C.imageManager.getPattern(v.from.toString()),N=C.imageManager.getPattern(v.to.toString()),{width:$,height:G}=C.imageManager.getPixelSize(),X=Math.pow(2,P.tileID.overscaledZ),ie=P.tileSize*Math.pow(2,C.transform.tileZoom)/X,ue=ie*(P.tileID.canonical.x+P.tileID.wrap*X),ce=ie*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[$,G],u_mix:E.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/a.aC(P,1,C.transform.tileZoom),u_pixel_coord_upper:[ue>>16,ce>>16],u_pixel_coord_lower:[65535&ue,65535&ce]}})(u,y,t,f),{u_opacity:_}),Of=(_,t)=>{},ed={fillExtrusion:(_,t)=>({u_lightpos:new a.bU(_,t.u_lightpos),u_lightpos_globe:new a.bU(_,t.u_lightpos_globe),u_lightintensity:new a.bg(_,t.u_lightintensity),u_lightcolor:new a.bU(_,t.u_lightcolor),u_vertical_gradient:new a.bg(_,t.u_vertical_gradient),u_opacity:new a.bg(_,t.u_opacity),u_fill_translate:new a.bV(_,t.u_fill_translate)}),fillExtrusionPattern:(_,t)=>({u_lightpos:new a.bU(_,t.u_lightpos),u_lightpos_globe:new a.bU(_,t.u_lightpos_globe),u_lightintensity:new a.bg(_,t.u_lightintensity),u_lightcolor:new a.bU(_,t.u_lightcolor),u_vertical_gradient:new a.bg(_,t.u_vertical_gradient),u_height_factor:new a.bg(_,t.u_height_factor),u_opacity:new a.bg(_,t.u_opacity),u_fill_translate:new a.bV(_,t.u_fill_translate),u_image:new a.bQ(_,t.u_image),u_texsize:new a.bV(_,t.u_texsize),u_pixel_coord_upper:new a.bV(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(_,t.u_pixel_coord_lower),u_scale:new a.bU(_,t.u_scale),u_fade:new a.bg(_,t.u_fade)}),fill:(_,t)=>({u_fill_translate:new a.bV(_,t.u_fill_translate)}),fillPattern:(_,t)=>({u_image:new a.bQ(_,t.u_image),u_texsize:new a.bV(_,t.u_texsize),u_pixel_coord_upper:new a.bV(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(_,t.u_pixel_coord_lower),u_scale:new a.bU(_,t.u_scale),u_fade:new a.bg(_,t.u_fade),u_fill_translate:new a.bV(_,t.u_fill_translate)}),fillOutline:(_,t)=>({u_world:new a.bV(_,t.u_world),u_fill_translate:new a.bV(_,t.u_fill_translate)}),fillOutlinePattern:(_,t)=>({u_world:new a.bV(_,t.u_world),u_image:new a.bQ(_,t.u_image),u_texsize:new a.bV(_,t.u_texsize),u_pixel_coord_upper:new a.bV(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(_,t.u_pixel_coord_lower),u_scale:new a.bU(_,t.u_scale),u_fade:new a.bg(_,t.u_fade),u_fill_translate:new a.bV(_,t.u_fill_translate)}),circle:(_,t)=>({u_camera_to_center_distance:new a.bg(_,t.u_camera_to_center_distance),u_scale_with_map:new a.bQ(_,t.u_scale_with_map),u_pitch_with_map:new a.bQ(_,t.u_pitch_with_map),u_extrude_scale:new a.bV(_,t.u_extrude_scale),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_globe_extrude_scale:new a.bg(_,t.u_globe_extrude_scale),u_translate:new a.bV(_,t.u_translate)}),collisionBox:(_,t)=>({u_pixel_extrude_scale:new a.bV(_,t.u_pixel_extrude_scale)}),collisionCircle:(_,t)=>({u_viewport_size:new a.bV(_,t.u_viewport_size)}),debug:(_,t)=>({u_color:new a.bR(_,t.u_color),u_overlay:new a.bQ(_,t.u_overlay),u_overlay_scale:new a.bg(_,t.u_overlay_scale)}),depth:Of,clippingMask:Of,heatmap:(_,t)=>({u_extrude_scale:new a.bg(_,t.u_extrude_scale),u_intensity:new a.bg(_,t.u_intensity),u_globe_extrude_scale:new a.bg(_,t.u_globe_extrude_scale)}),heatmapTexture:(_,t)=>({u_matrix:new a.bS(_,t.u_matrix),u_world:new a.bV(_,t.u_world),u_image:new a.bQ(_,t.u_image),u_color_ramp:new a.bQ(_,t.u_color_ramp),u_opacity:new a.bg(_,t.u_opacity)}),hillshade:(_,t)=>({u_image:new a.bQ(_,t.u_image),u_latrange:new a.bV(_,t.u_latrange),u_exaggeration:new a.bg(_,t.u_exaggeration),u_altitudes:new a.b$(_,t.u_altitudes),u_azimuths:new a.b$(_,t.u_azimuths),u_accent:new a.bR(_,t.u_accent),u_method:new a.bQ(_,t.u_method),u_shadows:new a.b_(_,t.u_shadows),u_highlights:new a.b_(_,t.u_highlights)}),hillshadePrepare:(_,t)=>({u_matrix:new a.bS(_,t.u_matrix),u_image:new a.bQ(_,t.u_image),u_dimension:new a.bV(_,t.u_dimension),u_zoom:new a.bg(_,t.u_zoom),u_unpack:new a.bT(_,t.u_unpack)}),colorRelief:(_,t)=>({u_image:new a.bQ(_,t.u_image),u_unpack:new a.bT(_,t.u_unpack),u_dimension:new a.bV(_,t.u_dimension),u_elevation_stops:new a.bQ(_,t.u_elevation_stops),u_color_stops:new a.bQ(_,t.u_color_stops),u_color_ramp_size:new a.bQ(_,t.u_color_ramp_size),u_opacity:new a.bg(_,t.u_opacity)}),line:(_,t)=>({u_translation:new a.bV(_,t.u_translation),u_ratio:new a.bg(_,t.u_ratio),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_units_to_pixels:new a.bV(_,t.u_units_to_pixels)}),lineGradient:(_,t)=>({u_translation:new a.bV(_,t.u_translation),u_ratio:new a.bg(_,t.u_ratio),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_units_to_pixels:new a.bV(_,t.u_units_to_pixels),u_image:new a.bQ(_,t.u_image),u_image_height:new a.bg(_,t.u_image_height)}),linePattern:(_,t)=>({u_translation:new a.bV(_,t.u_translation),u_texsize:new a.bV(_,t.u_texsize),u_ratio:new a.bg(_,t.u_ratio),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_image:new a.bQ(_,t.u_image),u_units_to_pixels:new a.bV(_,t.u_units_to_pixels),u_scale:new a.bU(_,t.u_scale),u_fade:new a.bg(_,t.u_fade)}),lineSDF:(_,t)=>({u_translation:new a.bV(_,t.u_translation),u_ratio:new a.bg(_,t.u_ratio),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_units_to_pixels:new a.bV(_,t.u_units_to_pixels),u_image:new a.bQ(_,t.u_image),u_mix:new a.bg(_,t.u_mix),u_tileratio:new a.bg(_,t.u_tileratio),u_crossfade_from:new a.bg(_,t.u_crossfade_from),u_crossfade_to:new a.bg(_,t.u_crossfade_to),u_lineatlas_width:new a.bg(_,t.u_lineatlas_width),u_lineatlas_height:new a.bg(_,t.u_lineatlas_height)}),lineGradientSDF:(_,t)=>({u_translation:new a.bV(_,t.u_translation),u_ratio:new a.bg(_,t.u_ratio),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_units_to_pixels:new a.bV(_,t.u_units_to_pixels),u_image:new a.bQ(_,t.u_image),u_image_height:new a.bg(_,t.u_image_height),u_tileratio:new a.bg(_,t.u_tileratio),u_crossfade_from:new a.bg(_,t.u_crossfade_from),u_crossfade_to:new a.bg(_,t.u_crossfade_to),u_image_dash:new a.bQ(_,t.u_image_dash),u_mix:new a.bg(_,t.u_mix),u_lineatlas_width:new a.bg(_,t.u_lineatlas_width),u_lineatlas_height:new a.bg(_,t.u_lineatlas_height)}),raster:(_,t)=>({u_tl_parent:new a.bV(_,t.u_tl_parent),u_scale_parent:new a.bg(_,t.u_scale_parent),u_buffer_scale:new a.bg(_,t.u_buffer_scale),u_fade_t:new a.bg(_,t.u_fade_t),u_opacity:new a.bg(_,t.u_opacity),u_image0:new a.bQ(_,t.u_image0),u_image1:new a.bQ(_,t.u_image1),u_brightness_low:new a.bg(_,t.u_brightness_low),u_brightness_high:new a.bg(_,t.u_brightness_high),u_saturation_factor:new a.bg(_,t.u_saturation_factor),u_contrast_factor:new a.bg(_,t.u_contrast_factor),u_spin_weights:new a.bU(_,t.u_spin_weights),u_coords_top:new a.bT(_,t.u_coords_top),u_coords_bottom:new a.bT(_,t.u_coords_bottom)}),symbolIcon:(_,t)=>({u_is_size_zoom_constant:new a.bQ(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bQ(_,t.u_is_size_feature_constant),u_size_t:new a.bg(_,t.u_size_t),u_size:new a.bg(_,t.u_size),u_camera_to_center_distance:new a.bg(_,t.u_camera_to_center_distance),u_pitch:new a.bg(_,t.u_pitch),u_rotate_symbol:new a.bQ(_,t.u_rotate_symbol),u_aspect_ratio:new a.bg(_,t.u_aspect_ratio),u_fade_change:new a.bg(_,t.u_fade_change),u_label_plane_matrix:new a.bS(_,t.u_label_plane_matrix),u_coord_matrix:new a.bS(_,t.u_coord_matrix),u_is_text:new a.bQ(_,t.u_is_text),u_pitch_with_map:new a.bQ(_,t.u_pitch_with_map),u_is_along_line:new a.bQ(_,t.u_is_along_line),u_is_variable_anchor:new a.bQ(_,t.u_is_variable_anchor),u_texsize:new a.bV(_,t.u_texsize),u_texture:new a.bQ(_,t.u_texture),u_translation:new a.bV(_,t.u_translation),u_pitched_scale:new a.bg(_,t.u_pitched_scale)}),symbolSDF:(_,t)=>({u_is_size_zoom_constant:new a.bQ(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bQ(_,t.u_is_size_feature_constant),u_size_t:new a.bg(_,t.u_size_t),u_size:new a.bg(_,t.u_size),u_camera_to_center_distance:new a.bg(_,t.u_camera_to_center_distance),u_pitch:new a.bg(_,t.u_pitch),u_rotate_symbol:new a.bQ(_,t.u_rotate_symbol),u_aspect_ratio:new a.bg(_,t.u_aspect_ratio),u_fade_change:new a.bg(_,t.u_fade_change),u_label_plane_matrix:new a.bS(_,t.u_label_plane_matrix),u_coord_matrix:new a.bS(_,t.u_coord_matrix),u_is_text:new a.bQ(_,t.u_is_text),u_pitch_with_map:new a.bQ(_,t.u_pitch_with_map),u_is_along_line:new a.bQ(_,t.u_is_along_line),u_is_variable_anchor:new a.bQ(_,t.u_is_variable_anchor),u_texsize:new a.bV(_,t.u_texsize),u_texture:new a.bQ(_,t.u_texture),u_gamma_scale:new a.bg(_,t.u_gamma_scale),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_is_halo:new a.bQ(_,t.u_is_halo),u_translation:new a.bV(_,t.u_translation),u_pitched_scale:new a.bg(_,t.u_pitched_scale)}),symbolTextAndIcon:(_,t)=>({u_is_size_zoom_constant:new a.bQ(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bQ(_,t.u_is_size_feature_constant),u_size_t:new a.bg(_,t.u_size_t),u_size:new a.bg(_,t.u_size),u_camera_to_center_distance:new a.bg(_,t.u_camera_to_center_distance),u_pitch:new a.bg(_,t.u_pitch),u_rotate_symbol:new a.bQ(_,t.u_rotate_symbol),u_aspect_ratio:new a.bg(_,t.u_aspect_ratio),u_fade_change:new a.bg(_,t.u_fade_change),u_label_plane_matrix:new a.bS(_,t.u_label_plane_matrix),u_coord_matrix:new a.bS(_,t.u_coord_matrix),u_is_text:new a.bQ(_,t.u_is_text),u_pitch_with_map:new a.bQ(_,t.u_pitch_with_map),u_is_along_line:new a.bQ(_,t.u_is_along_line),u_is_variable_anchor:new a.bQ(_,t.u_is_variable_anchor),u_texsize:new a.bV(_,t.u_texsize),u_texsize_icon:new a.bV(_,t.u_texsize_icon),u_texture:new a.bQ(_,t.u_texture),u_texture_icon:new a.bQ(_,t.u_texture_icon),u_gamma_scale:new a.bg(_,t.u_gamma_scale),u_device_pixel_ratio:new a.bg(_,t.u_device_pixel_ratio),u_is_halo:new a.bQ(_,t.u_is_halo),u_translation:new a.bV(_,t.u_translation),u_pitched_scale:new a.bg(_,t.u_pitched_scale)}),background:(_,t)=>({u_opacity:new a.bg(_,t.u_opacity),u_color:new a.bR(_,t.u_color)}),backgroundPattern:(_,t)=>({u_opacity:new a.bg(_,t.u_opacity),u_image:new a.bQ(_,t.u_image),u_pattern_tl_a:new a.bV(_,t.u_pattern_tl_a),u_pattern_br_a:new a.bV(_,t.u_pattern_br_a),u_pattern_tl_b:new a.bV(_,t.u_pattern_tl_b),u_pattern_br_b:new a.bV(_,t.u_pattern_br_b),u_texsize:new a.bV(_,t.u_texsize),u_mix:new a.bg(_,t.u_mix),u_pattern_size_a:new a.bV(_,t.u_pattern_size_a),u_pattern_size_b:new a.bV(_,t.u_pattern_size_b),u_scale_a:new a.bg(_,t.u_scale_a),u_scale_b:new a.bg(_,t.u_scale_b),u_pixel_coord_upper:new a.bV(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(_,t.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bg(_,t.u_tile_units_to_pixels)}),terrain:(_,t)=>({u_texture:new a.bQ(_,t.u_texture),u_ele_delta:new a.bg(_,t.u_ele_delta),u_fog_matrix:new a.bS(_,t.u_fog_matrix),u_fog_color:new a.bR(_,t.u_fog_color),u_fog_ground_blend:new a.bg(_,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bg(_,t.u_fog_ground_blend_opacity),u_horizon_color:new a.bR(_,t.u_horizon_color),u_horizon_fog_blend:new a.bg(_,t.u_horizon_fog_blend),u_is_globe_mode:new a.bg(_,t.u_is_globe_mode)}),terrainDepth:(_,t)=>({u_ele_delta:new a.bg(_,t.u_ele_delta)}),terrainCoords:(_,t)=>({u_texture:new a.bQ(_,t.u_texture),u_terrain_coords_id:new a.bg(_,t.u_terrain_coords_id),u_ele_delta:new a.bg(_,t.u_ele_delta)}),projectionErrorMeasurement:(_,t)=>({u_input:new a.bg(_,t.u_input),u_output_expected:new a.bg(_,t.u_output_expected)}),atmosphere:(_,t)=>({u_sun_pos:new a.bU(_,t.u_sun_pos),u_atmosphere_blend:new a.bg(_,t.u_atmosphere_blend),u_globe_position:new a.bU(_,t.u_globe_position),u_globe_radius:new a.bg(_,t.u_globe_radius),u_inv_proj_matrix:new a.bS(_,t.u_inv_proj_matrix)}),sky:(_,t)=>({u_sky_color:new a.bR(_,t.u_sky_color),u_horizon_color:new a.bR(_,t.u_horizon_color),u_horizon:new a.bV(_,t.u_horizon),u_horizon_normal:new a.bV(_,t.u_horizon_normal),u_sky_horizon_blend:new a.bg(_,t.u_sky_horizon_blend),u_sky_blend:new a.bg(_,t.u_sky_blend)})};class To{constructor(t,u,f){this.context=t;const y=t.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Vf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Uf{constructor(t,u,f,y){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=y,this.context=t;const v=t.gl;this.buffer=v.createBuffer(),t.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,u){for(let f=0;f<this.attributes.length;f++){const y=u.attributes[this.attributes[f].name];y!==void 0&&t.enableVertexAttribArray(y)}}setVertexAttribPointers(t,u,f){for(let y=0;y<this.attributes.length;y++){const v=this.attributes[y],E=u.attributes[v.name];E!==void 0&&t.vertexAttribPointer(E,v.components,t[Vf[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Wr{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class _y extends Wr{getDefault(){return a.bf.transparent}set(t){const u=this.current;(t.r!==u.r||t.g!==u.g||t.b!==u.b||t.a!==u.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class jf extends Wr{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Da extends Wr{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Nf extends Wr{getDefault(){return[!0,!0,!0,!0]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||t[3]!==u[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class E0 extends Wr{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class A0 extends Wr{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class R0 extends Wr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const u=this.current;(t.func!==u.func||t.ref!==u.ref||t.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class S0 extends Wr{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class by extends Wr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=t,this.dirty=!1}}class T0 extends Wr{getDefault(){return[0,1]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class vy extends Wr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=t,this.dirty=!1}}class td extends Wr{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class rd extends Wr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.BLEND):u.disable(u.BLEND),this.current=t,this.dirty=!1}}class id extends Wr{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ff extends Wr{getDefault(){return a.bf.transparent}set(t){const u=this.current;(t.r!==u.r||t.g!==u.g||t.b!==u.b||t.a!==u.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ia extends Wr{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class ku extends Wr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=t,this.dirty=!1}}class wl extends Wr{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Es extends Wr{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class xy extends Wr{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class wy extends Wr{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class qf extends Wr{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||t[3]!==u[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ba extends Wr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class nd extends Wr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class sd extends Wr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Pu extends Wr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class od extends Wr{getDefault(){return null}set(t){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ey extends Wr{getDefault(){return null}set(t){var u;if(t===this.current&&!this.dirty)return;const f=this.gl;Cn(f)?f.bindVertexArray(t):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class El extends Wr{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Al extends Wr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Ay extends Wr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Lu extends Wr{constructor(t,u){super(t),this.context=t,this.parent=u}getDefault(){return null}}class zr extends Lu{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class ad extends Lu{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class C0 extends Lu{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Kf="Framebuffer is not complete";class Du{constructor(t,u,f,y,v){this.context=t,this.width=u,this.height=f;const E=t.gl,C=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new zr(t,C),y)this.depthAttachment=v?new C0(t,C):new ad(t,C);else if(v)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(Kf)}destroy(){const t=this.context.gl,u=this.colorAttachment.get();if(u&&t.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&t.deleteRenderbuffer(f)}t.deleteFramebuffer(this.framebuffer)}}class k0{constructor(t){var u,f;if(this.gl=t,this.clearColor=new _y(this),this.clearDepth=new jf(this),this.clearStencil=new Da(this),this.colorMask=new Nf(this),this.depthMask=new E0(this),this.stencilMask=new A0(this),this.stencilFunc=new R0(this),this.stencilOp=new S0(this),this.stencilTest=new by(this),this.depthRange=new T0(this),this.depthTest=new vy(this),this.depthFunc=new td(this),this.blend=new rd(this),this.blendFunc=new id(this),this.blendColor=new Ff(this),this.blendEquation=new Ia(this),this.cullFace=new ku(this),this.cullFaceSide=new wl(this),this.frontFace=new Es(this),this.program=new xy(this),this.activeTexture=new wy(this),this.viewport=new qf(this),this.bindFramebuffer=new Ba(this),this.bindRenderbuffer=new nd(this),this.bindTexture=new sd(this),this.bindVertexBuffer=new Pu(this),this.bindElementBuffer=new od(this),this.bindVertexArray=new Ey(this),this.pixelStoreUnpack=new El(this),this.pixelStoreUnpackPremultiplyAlpha=new Al(this),this.pixelStoreUnpackFlipY=new Ay(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Cn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const y=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=t.RGBA16F)!==null&&u!==void 0?u:y?.RGBA16F_EXT,this.RGB16F=(f=t.RGB16F)!==null&&f!==void 0?f:y?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const y=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=y?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,u){return new To(this,t,u)}createVertexBuffer(t,u,f){return new Uf(this,t,u,f)}createRenderbuffer(t,u,f){const y=this.gl,v=y.createRenderbuffer();return this.bindRenderbuffer.set(v),y.renderbufferStorage(y.RENDERBUFFER,t,u,f),this.bindRenderbuffer.set(null),v}createFramebuffer(t,u,f,y){return new Du(this,t,u,f,y)}clear({color:t,depth:u,stencil:f}){const y=this.gl;let v=0;t&&(v|=y.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(v|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(v|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),y.clear(v)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){a.bH(t.blendFunction,li.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Cn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var u;return Cn(this.gl)?this.gl.deleteVertexArray(t):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let ld;function Gf(_,t,u,f,y){const v=_.context,E=_.transform,C=v.gl,P=_.useProgram("collisionBox"),V=[];let N=0,$=0;for(let de=0;de<f.length;de++){const xe=f[de],Ae=t.getTile(xe).getBucket(u);if(!Ae)continue;const Ee=y?Ae.textCollisionBox:Ae.iconCollisionBox,Ie=Ae.collisionCircleArray;Ie.length>0&&(V.push({circleArray:Ie,circleOffset:$,coord:xe}),N+=Ie.length/4,$=N),Ee&&P.draw(v,C.LINES,hr.disabled,Er.disabled,_.colorModeForRenderPass(),Vr.disabled,x0(_.transform),_.style.map.terrain&&_.style.map.terrain.getTerrainData(xe),E.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,null,_.transform.zoom,null,null,Ee.collisionVertexBuffer)}if(!y||!V.length)return;const G=_.useProgram("collisionCircle"),X=new a.c0;X.resize(4*N),X._trim();let ie=0;for(const de of V)for(let xe=0;xe<de.circleArray.length/4;xe++){const Ae=4*xe,Ee=de.circleArray[Ae+0],Ie=de.circleArray[Ae+1],Ue=de.circleArray[Ae+2],Re=de.circleArray[Ae+3];X.emplace(ie++,Ee,Ie,Ue,Re,0),X.emplace(ie++,Ee,Ie,Ue,Re,1),X.emplace(ie++,Ee,Ie,Ue,Re,2),X.emplace(ie++,Ee,Ie,Ue,Re,3)}(!ld||ld.length<2*N)&&(ld=(function(de){const xe=2*de,Ae=new a.c2;Ae.resize(xe),Ae._trim();for(let Ee=0;Ee<xe;Ee++){const Ie=6*Ee;Ae.uint16[Ie+0]=4*Ee+0,Ae.uint16[Ie+1]=4*Ee+1,Ae.uint16[Ie+2]=4*Ee+2,Ae.uint16[Ie+3]=4*Ee+2,Ae.uint16[Ie+4]=4*Ee+3,Ae.uint16[Ie+5]=4*Ee+0}return Ae})(N));const ue=v.createIndexBuffer(ld,!0),ce=v.createVertexBuffer(X,a.c1.members,!0);for(const de of V){const xe=xl(_.transform);G.draw(v,C.TRIANGLES,hr.disabled,Er.disabled,_.colorModeForRenderPass(),Vr.disabled,xe,_.style.map.terrain&&_.style.map.terrain.getTerrainData(de.coord),null,u.id,ce,ue,a.aM.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,_.transform.zoom,null,null,null)}ce.destroy(),ue.destroy()}const P0=a.ag(new Float32Array(16));function $f(_,t,u,f,y,v){const{horizontalAlign:E,verticalAlign:C}=a.aH(_);return new a.P((-(E-.5)*t/y+f[0])*v,(-(C-.5)*u/y+f[1])*v)}function ud(_,t,u,f,y,v){const E=t.tileAnchorPoint.add(new a.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let C=f.mult(v);u||(C=C.rotate(-y));const P=E.add(C);return pt(P.x,P.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(u){const C=gn(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(_),P=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return _.add(f.rotate(P))}return _.add(f)}function cd(_,t,u,f,y,v,E,C,P,V,N,$){const G=_.text.placedSymbolArray,X=_.text.dynamicLayoutVertexArray,ie=_.icon.dynamicLayoutVertexArray,ue={};X.clear();for(let ce=0;ce<G.length;ce++){const de=G.get(ce),xe=de.hidden||!de.crossTileID||_.allowVerticalPlacement&&!de.placedOrientation?null:f[de.crossTileID];if(xe){const Ae=new a.P(de.anchorX,de.anchorY),Ee={getElevation:$,width:y.width,height:y.height,pitchedLabelPlaneMatrix:v,pitchWithMap:u,transform:y,tileAnchorPoint:Ae,translation:V,unwrappedTileID:N},Ie=u?dr(Ae.x,Ae.y,Ee):gn(Ae.x,Ae.y,Ee),Ue=Vi(y.cameraToCenterDistance,Ie.signedDistanceFromCamera);let Re=a.ap(_.textSizeData,C,de)*Ue/a.aB;u&&(Re*=_.tilePixelRatio/E);const{width:Fe,height:st,anchor:Ye,textOffset:tt,textBoxScale:it}=xe,xt=$f(Ye,Fe,st,tt,it,Re),wt=y.getPitchedTextCorrection(Ae.x+V[0],Ae.y+V[1],N),ft=ud(Ie.point,Ee,t,xt,-y.bearingInRadians,wt),jt=_.allowVerticalPlacement&&de.placedOrientation===a.ao.vertical?Math.PI/2:0;for(let mr=0;mr<de.numGlyphs;mr++)a.av(X,ft,jt);P&&de.associatedIconIndex>=0&&(ue[de.associatedIconIndex]={shiftedAnchor:ft,angle:jt})}else rn(de.numGlyphs,X)}if(P){ie.clear();const ce=_.icon.placedSymbolArray;for(let de=0;de<ce.length;de++){const xe=ce.get(de);if(xe.hidden)rn(xe.numGlyphs,ie);else{const Ae=ue[de];if(Ae)for(let Ee=0;Ee<xe.numGlyphs;Ee++)a.av(ie,Ae.shiftedAnchor,Ae.angle);else rn(xe.numGlyphs,ie)}}_.icon.dynamicLayoutVertexBuffer.updateData(ie)}_.text.dynamicLayoutVertexBuffer.updateData(X)}function dd(_,t,u){return u.iconsInText&&t?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function pd(_,t,u,f,y,v,E,C,P,V,N,$,G){const X=_.context,ie=X.gl,ue=_.transform,ce=C==="map",de=P==="map",xe=C!=="viewport"&&u.layout.get("symbol-placement")!=="point",Ae=ce&&!de&&!xe,Ee=!u.layout.get("symbol-sort-key").isConstant();let Ie=!1;const Ue=_.getDepthModeForSublayer(0,hr.ReadOnly),Re=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Fe=[],st=ue.getCircleRadiusCorrection();for(const Ye of f){const tt=t.getTile(Ye),it=tt.getBucket(u);if(!it)continue;const xt=y?it.text:it.icon;if(!xt||!xt.segments.get().length||!xt.hasVisibleVertices)continue;const wt=xt.programConfigurations.get(u.id),ft=y||it.sdfIcons,jt=y?it.textSizeData:it.iconSizeData,mr=de||ue.pitch!==0,ri=_.useProgram(dd(ft,y,it),wt),ii=a.an(jt,ue.zoom),ui=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ye);let Ri,yi,Nr,wi,wn=[0,0],Ni=null;if(y)yi=tt.glyphAtlasTexture,Nr=ie.LINEAR,Ri=tt.glyphAtlasTexture.size,it.iconsInText&&(wn=tt.imageAtlasTexture.size,Ni=tt.imageAtlasTexture,wi=mr||_.options.rotating||_.options.zooming||jt.kind==="composite"||jt.kind==="camera"?ie.LINEAR:ie.NEAREST);else{const zi=u.layout.get("icon-size").constantOr(0)!==1||it.iconsNeedLinear;yi=tt.imageAtlasTexture,Nr=ft||_.options.rotating||_.options.zooming||zi||mr?ie.LINEAR:ie.NEAREST,Ri=tt.imageAtlasTexture.size}const Fi=a.aC(tt,1,_.transform.zoom),Vn=Kr(ce,_.transform,Fi),ra=a.L();a.aq(ra,Vn);const Ns=oi(de,ce,_.transform,Fi),ia=a.aD(ue,tt,v,E),qa=ue.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),Ld=Re&&it.hasTextData(),zl=u.layout.get("icon-text-fit")!=="none"&&Ld&&it.hasIconData();if(xe){const zi=_.style.map.terrain?(us,an)=>_.style.map.terrain.getElevation(Ye,us,an):null,Xi=u.layout.get("text-rotation-alignment")==="map";Ii(it,_,y,Vn,ra,de,V,Xi,Ye.toUnwrapped(),ue.width,ue.height,ia,zi)}const ko=y&&Re||zl,as=xe||ko?P0:de?Vn:_.transform.clipSpaceToPixelsMatrix,co=ft&&u.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let po;po=ft?it.iconsInText?yy(jt.kind,ii,Ae,de,xe,ko,_,as,Ns,ia,Ri,wn,st):Mf(jt.kind,ii,Ae,de,xe,ko,_,as,Ns,ia,y,Ri,0,st):my(jt.kind,ii,Ae,de,xe,ko,_,as,Ns,ia,y,Ri,st);const ls={program:ri,buffers:xt,uniformValues:po,projectionData:qa,atlasTexture:yi,atlasTextureIcon:Ni,atlasInterpolation:Nr,atlasInterpolationIcon:wi,isSDF:ft,hasHalo:co};if(Ee&&it.canOverlap){Ie=!0;const zi=xt.segments.get();for(const Xi of zi)Fe.push({segments:new a.aM([Xi]),sortKey:Xi.sortKey,state:ls,terrainData:ui})}else Fe.push({segments:xt.segments,sortKey:0,state:ls,terrainData:ui})}Ie&&Fe.sort(((Ye,tt)=>Ye.sortKey-tt.sortKey));for(const Ye of Fe){const tt=Ye.state;if(X.activeTexture.set(ie.TEXTURE0),tt.atlasTexture.bind(tt.atlasInterpolation,ie.CLAMP_TO_EDGE),tt.atlasTextureIcon&&(X.activeTexture.set(ie.TEXTURE1),tt.atlasTextureIcon&&tt.atlasTextureIcon.bind(tt.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),tt.isSDF){const it=tt.uniformValues;tt.hasHalo&&(it.u_is_halo=1,Zf(tt.buffers,Ye.segments,u,_,tt.program,Ue,N,$,it,tt.projectionData,Ye.terrainData)),it.u_is_halo=0}Zf(tt.buffers,Ye.segments,u,_,tt.program,Ue,N,$,tt.uniformValues,tt.projectionData,Ye.terrainData)}}function Zf(_,t,u,f,y,v,E,C,P,V,N){const $=f.context;y.draw($,$.gl.TRIANGLES,v,E,C,Vr.backCCW,P,N,V,u.id,_.layoutVertexBuffer,_.indexBuffer,t,u.paint,f.transform.zoom,_.programConfigurations.get(u.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function fd(_,t,u,f,y){const v=_.context,E=v.gl,C=Er.disabled,P=new li([E.ONE,E.ONE],a.bf.transparent,[!0,!0,!0,!0]),V=t.getBucket(u);if(!V)return;const N=f.key;let $=u.heatmapFbos.get(N);$||($=Iu(v,t.tileSize,t.tileSize),u.heatmapFbos.set(N,$)),v.bindFramebuffer.set($.framebuffer),v.viewport.set([0,0,t.tileSize,t.tileSize]),v.clear({color:a.bf.transparent});const G=V.programConfigurations.get(u.id),X=_.useProgram("heatmap",G,!y),ie=_.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ue=_.style.map.terrain.getTerrainData(f);X.draw(v,E.TRIANGLES,hr.disabled,C,P,Vr.disabled,If(t,_.transform.zoom,u.paint.get("heatmap-intensity"),1),ue,ie,u.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,u.paint,_.transform.zoom,G)}function hd(_,t,u,f,y){const v=_.context,E=v.gl,C=_.transform;v.setColorMode(_.colorModeForRenderPass());const P=Ma(v,t),V=u.key,N=t.heatmapFbos.get(V);if(!N)return;v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,N.colorAttachment.get()),v.activeTexture.set(E.TEXTURE1),P.bind(E.LINEAR,E.CLAMP_TO_EDGE);const $=C.getProjectionData({overscaledTileID:u,applyTerrainMatrix:y,applyGlobeMatrix:!f});_.useProgram("heatmapTexture").draw(v,E.TRIANGLES,hr.disabled,Er.disabled,_.colorModeForRenderPass(),Vr.disabled,ay(_,t,0,1),null,$,t.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,t.paint,C.zoom),N.destroy(),t.heatmapFbos.delete(V)}function Iu(_,t,u){var f,y;const v=_.gl,E=v.createTexture();v.bindTexture(v.TEXTURE_2D,E),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.LINEAR);const C=(f=_.HALF_FLOAT)!==null&&f!==void 0?f:v.UNSIGNED_BYTE,P=(y=_.RGBA16F)!==null&&y!==void 0?y:v.RGBA;v.texImage2D(v.TEXTURE_2D,0,P,t,u,0,v.RGBA,C,null);const V=_.createFramebuffer(t,u,!1,!1);return V.colorAttachment.set(E),V}function Ma(_,t){return t.colorRampTexture||(t.colorRampTexture=new a.T(_,t.colorRamp,_.gl.RGBA)),t.colorRampTexture}function md(_,t,u,f,y,v,E,C){let P=256;if(y.stepInterpolant){const V=t.getSource().maxzoom,N=E.canonical.z===V?Math.ceil(1<<_.transform.maxZoom-E.canonical.z):1;P=a.ah(a.c4(v.maxLineLength/a.$*1024*N),256,u.maxTextureSize)}return C.gradient=a.c5({expression:y.gradientExpression(),evaluationKey:"lineProgress",resolution:P,image:C.gradient||void 0,clips:v.lineClipsArray}),C.texture?C.texture.update(C.gradient):C.texture=new a.T(u,C.gradient,f.RGBA),C.version=y.gradientVersion,C.texture}function L0(_,t,u,f,y){_.activeTexture.set(t.TEXTURE0),u.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),f.updatePaintBuffers(y)}function Bu(_,t,u,f,y,v){(y||_.lineAtlas.dirty)&&(t.activeTexture.set(u.TEXTURE0),_.lineAtlas.bind(t)),f.updatePaintBuffers(v)}function D0(_,t,u,f,y,v,E){const C=v.gradients[y.id];let P=C.texture;y.gradientVersion!==C.version&&(P=md(_,t,u,f,y,v,E,C)),u.activeTexture.set(f.TEXTURE0),P.bind(y.stepInterpolant?f.NEAREST:f.LINEAR,f.CLAMP_TO_EDGE)}function Ry(_,t,u,f,y,v,E,C,P){const V=v.gradients[y.id];let N=V.texture;y.gradientVersion!==V.version&&(N=md(_,t,u,f,y,v,E,V)),u.activeTexture.set(f.TEXTURE0),N.bind(y.stepInterpolant?f.NEAREST:f.LINEAR,f.CLAMP_TO_EDGE),u.activeTexture.set(f.TEXTURE1),_.lineAtlas.bind(u),C.updatePaintBuffers(P)}function Mu(_,t,u,f,y){if(!u||!f||!f.imageAtlas)return;const v=f.imageAtlas.patternPositions;let E=v[u.to.toString()],C=v[u.from.toString()];if(!E&&C&&(E=C),!C&&E&&(C=E),!E||!C){const P=y.getPaintProperty(t);E=v[P],C=v[P]}E&&C&&_.setConstantPatternPositions(E,C)}function yd(_,t,u,f,y,v,E,C){const P=_.context.gl,V="fill-pattern",N=u.paint.get(V),$=N&&N.constantOr(1),G=u.getCrossfadeParameters();let X,ie,ue,ce,de;const xe=_.transform,Ae=u.paint.get("fill-translate"),Ee=u.paint.get("fill-translate-anchor");E?(ie=$&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=P.LINES):(ie=$?"fillPattern":"fill",X=P.TRIANGLES);const Ie=N.constantOr(null);for(const Ue of f){const Re=t.getTile(Ue);if($&&!Re.patternsLoaded())continue;const Fe=Re.getBucket(u);if(!Fe)continue;const st=Fe.programConfigurations.get(u.id),Ye=_.useProgram(ie,st),tt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ue);$&&(_.context.activeTexture.set(P.TEXTURE0),Re.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),st.updatePaintBuffers(G)),Mu(st,V,Ie,Re,u);const it=xe.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),xt=a.aD(xe,Re,Ae,Ee);if(E){ce=Fe.indexBuffer2,de=Fe.segments2;const ft=[P.drawingBufferWidth,P.drawingBufferHeight];ue=ie==="fillOutlinePattern"&&$?v0(_,G,Re,ft,xt):Tu(ft,xt)}else ce=Fe.indexBuffer,de=Fe.segments,ue=$?vl(_,G,Re,xt):{u_fill_translate:xt};const wt=_.stencilModeForClipping(Ue);Ye.draw(_.context,X,y,wt,v,Vr.backCCW,ue,tt,it,u.id,Fe.layoutVertexBuffer,ce,de,u.paint,_.transform.zoom,st)}}function gd(_,t,u,f,y,v,E,C){const P=_.context,V=P.gl,N="fill-extrusion-pattern",$=u.paint.get(N),G=$.constantOr(1),X=u.getCrossfadeParameters(),ie=u.paint.get("fill-extrusion-opacity"),ue=$.constantOr(null),ce=_.transform;for(const de of f){const xe=t.getTile(de),Ae=xe.getBucket(u);if(!Ae)continue;const Ee=_.style.map.terrain&&_.style.map.terrain.getTerrainData(de),Ie=Ae.programConfigurations.get(u.id),Ue=_.useProgram(G?"fillExtrusionPattern":"fillExtrusion",Ie);G&&(_.context.activeTexture.set(V.TEXTURE0),xe.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ie.updatePaintBuffers(X));const Re=ce.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!C,applyTerrainMatrix:!0});Mu(Ie,N,ue,xe,u);const Fe=a.aD(ce,xe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),st=u.paint.get("fill-extrusion-vertical-gradient"),Ye=G?Df(_,st,ie,Fe,de,X,xe):sy(_,st,ie,Fe);Ue.draw(P,P.gl.TRIANGLES,y,v,E,Vr.backCCW,Ye,Ee,Re,u.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,u.paint,_.transform.zoom,Ie,_.style.map.terrain&&Ae.centroidVertexBuffer)}}function _d(_,t,u,f,y,v,E,C,P){var V;const N=_.style.projection,$=_.context,G=_.transform,X=$.gl,ie=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],ue=_.useProgram("hillshade",null,!1,ie),ce=!_.options.moving;for(const de of f){const xe=t.getTile(de),Ae=xe.fbo;if(!Ae)continue;const Ee=N.getMeshFromTileID($,de.canonical,C,!0,"raster"),Ie=(V=_.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(de);$.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Ae.colorAttachment.get());const Ue=G.getProjectionData({overscaledTileID:de,aligned:ce,applyGlobeMatrix:!P,applyTerrainMatrix:!0});ue.draw($,X.TRIANGLES,v,y[de.overscaledZ],E,Vr.backCCW,ly(_,xe,u),Ie,Ue,u.id,Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)}}function Rl(_,t,u,f,y,v,E,C,P){var V;const N=_.style.projection,$=_.context,G=_.transform,X=$.gl,ie=_.useProgram("colorRelief"),ue=!_.options.moving;let ce=!0,de=0;for(const xe of f){const Ae=t.getTile(xe),Ee=Ae.dem;if(ce){const Ye=X.getParameter(X.MAX_TEXTURE_SIZE),{elevationTexture:tt,colorTexture:it}=u.getColorRampTextures($,Ye,Ee.getUnpackVector());$.activeTexture.set(X.TEXTURE1),tt.bind(X.NEAREST,X.CLAMP_TO_EDGE),$.activeTexture.set(X.TEXTURE4),it.bind(X.LINEAR,X.CLAMP_TO_EDGE),ce=!1,de=tt.size[0]}if(!Ee||!Ee.data)continue;const Ie=Ee.stride,Ue=Ee.getPixels();if($.activeTexture.set(X.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),Ae.demTexture=Ae.demTexture||_.getTileTexture(Ie),Ae.demTexture){const Ye=Ae.demTexture;Ye.update(Ue,{premultiply:!1}),Ye.bind(X.LINEAR,X.CLAMP_TO_EDGE)}else Ae.demTexture=new a.T($,Ue,X.RGBA,{premultiply:!1}),Ae.demTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const Re=N.getMeshFromTileID($,xe.canonical,C,!0,"raster"),Fe=(V=_.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(xe),st=G.getProjectionData({overscaledTileID:xe,aligned:ue,applyGlobeMatrix:!P,applyTerrainMatrix:!0});ie.draw($,X.TRIANGLES,v,y[xe.overscaledZ],E,Vr.backCCW,cy(u,Ae.dem,de),Fe,st,u.id,Re.vertexBuffer,Re.indexBuffer,Re.segments)}}const zu=[new a.P(0,0),new a.P(a.$,0),new a.P(a.$,a.$),new a.P(0,a.$)];function bd(_,t,u,f,y,v,E,C,P=!1,V=!1){const N=f[f.length-1].overscaledZ,$=_.context,G=$.gl,X=_.useProgram("raster"),ie=_.transform,ue=_.style.projection,ce=_.colorModeForRenderPass(),de=!_.options.moving,xe=u.paint.get("raster-opacity"),Ae=u.paint.get("raster-resampling"),Ee=u.paint.get("raster-fade-duration"),Ie=!!_.style.map.terrain;for(const Ue of f){const Re=_.getDepthModeForSublayer(Ue.overscaledZ-N,xe===1?hr.ReadWrite:hr.ReadOnly,G.LESS),Fe=t.getTile(Ue),st=Ae==="nearest"?G.NEAREST:G.LINEAR;$.activeTexture.set(G.TEXTURE0),Fe.texture.bind(st,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(G.TEXTURE1);const{parentTile:Ye,parentScaleBy:tt,parentTopLeft:it,fadeValues:xt}=Sy(Fe,t,Ee,Ie);Fe.fadeOpacity=xt.tileOpacity,Ye?(Ye.fadeOpacity=xt.parentTileOpacity,Ye.texture.bind(st,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST)):Fe.texture.bind(st,G.CLAMP_TO_EDGE,G.LINEAR_MIPMAP_NEAREST),Fe.texture.useMipmap&&$.extTextureFilterAnisotropic&&_.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const wt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ue),ft=ie.getProjectionData({overscaledTileID:Ue,aligned:de,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),jt=Qc(it,tt,xt.fadeMix,u,C),mr=ue.getMeshFromTileID($,Ue.canonical,v,E,"raster");X.draw($,G.TRIANGLES,Re,y?y[Ue.overscaledZ]:Er.disabled,ce,P?Vr.frontCCW:Vr.backCCW,jt,wt,ft,u.id,mr.vertexBuffer,mr.indexBuffer,mr.segments)}}function Sy(_,t,u,f){const y={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(u===0||f)return y;if(_.fadingParentID){const v=t._getLoadedTile(_.fadingParentID);if(!v)return y;const E=Math.pow(2,v.tileID.overscaledZ-_.tileID.overscaledZ),C=[_.tileID.canonical.x*E%1,_.tileID.canonical.y*E%1],P=(function(V,N,$){const G=D.now(),X=(G-N.timeAdded)/$,ie=V.fadingDirection===we.Incoming,ue=a.ah((G-V.timeAdded)/$,0,1),ce=a.ah(1-X,0,1),de=ie?ue:ce;return{tileOpacity:de,parentTileOpacity:ie?ce:ue,fadeMix:{opacity:1,mix:1-de}}})(_,v,u);return{parentTile:v,parentScaleBy:E,parentTopLeft:C,fadeValues:P}}if(_.selfFading){const v=(function(E,C){const P=D.now(),V=a.ah((P-E.timeAdded)/C,0,1);return{tileOpacity:V,fadeMix:{opacity:V,mix:0}}})(_,u);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:v}}return y}const Bi=new a.bf(1,0,0,1),za=new a.bf(0,1,0,1),As=new a.bf(0,0,1,1),Hf=new a.bf(1,0,1,1),vd=new a.bf(0,1,1,1);function Xf(_,t,u,f){Sl(_,0,t+u/2,_.transform.width,u,f)}function Oa(_,t,u,f){Sl(_,t-u/2,0,u,_.transform.height,f)}function Sl(_,t,u,f,y,v){const E=_.context,C=E.gl;C.enable(C.SCISSOR_TEST),C.scissor(t*_.pixelRatio,u*_.pixelRatio,f*_.pixelRatio,y*_.pixelRatio),E.clear({color:v}),C.disable(C.SCISSOR_TEST)}function Ou(_,t,u){const f=_.context,y=f.gl,v=_.useProgram("debug"),E=hr.disabled,C=Er.disabled,P=_.colorModeForRenderPass(),V="$debug",N=_.style.map.terrain&&_.style.map.terrain.getTerrainData(u);f.activeTexture.set(y.TEXTURE0);const $=t.getTileByID(u.key).latestRawTileData,G=Math.floor(($&&$.byteLength||0)/1024),X=t.getTile(u).tileSize,ie=512/Math.min(X,512)*(u.overscaledZ/_.transform.zoom)*.5;let ue=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ue+=` => ${u.overscaledZ}`),(function(de,xe){de.initDebugOverlayCanvas();const Ae=de.debugOverlayCanvas,Ee=de.context.gl,Ie=de.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,Ae.width,Ae.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(xe,5,5),Ie.strokeText(xe,5,5),de.debugOverlayTexture.update(Ae),de.debugOverlayTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE)})(_,`${ue} ${G}kB`);const ce=_.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});v.draw(f,y.TRIANGLES,E,C,li.alphaBlended,Vr.disabled,oy(a.bf.transparent,ie),null,ce,V,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),v.draw(f,y.LINE_STRIP,E,C,P,Vr.disabled,oy(a.bf.red),N,ce,V,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function xd(_,t,u,f){const{isRenderingGlobe:y}=f,v=_.context,E=v.gl,C=_.transform,P=_.colorModeForRenderPass(),V=_.getDepthModeFor3D(),N=_.useProgram("terrain");v.bindFramebuffer.set(null),v.viewport.set([0,0,_.width,_.height]);for(const $ of u){const G=t.getTerrainMesh($.tileID),X=_.renderToTexture.getTexture($),ie=t.getTerrainData($.tileID);v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,X.texture);const ue=t.getMeshFrameDelta(C.zoom),ce=C.calculateFogMatrix($.tileID.toUnwrapped()),de=Pf(ue,ce,_.style.sky,C.pitch,y),xe=C.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(v,E.TRIANGLES,V,Er.disabled,P,Vr.backCCW,de,ie,xe,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}}function Wf(_,t){if(!t.mesh){const u=new a.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const f=new a.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),t.mesh=new Xo(_.createVertexBuffer(u,bn.members),_.createIndexBuffer(f),a.aM.simpleSegment(0,0,u.length,f.length))}return t.mesh}class Ty{constructor(t,u){this.context=new k0(t),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ot.maxUnderzooming+Ot.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ho}resize(t,u,f){if(this.width=Math.floor(t*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const t=this.context,u=new a.aL;u.emplaceBack(0,0),u.emplaceBack(a.$,0),u.emplaceBack(0,a.$),u.emplaceBack(a.$,a.$),this.tileExtentBuffer=t.createVertexBuffer(u,bn.members),this.tileExtentSegments=a.aM.simpleSegment(0,0,4,2);const f=new a.aL;f.emplaceBack(0,0),f.emplaceBack(a.$,0),f.emplaceBack(0,a.$),f.emplaceBack(a.$,a.$),this.debugBuffer=t.createVertexBuffer(f,bn.members),this.debugSegments=a.aM.simpleSegment(0,0,4,5);const y=new a.c7;y.emplaceBack(0,0,0,0),y.emplaceBack(a.$,0,a.$,0),y.emplaceBack(0,a.$,0,a.$),y.emplaceBack(a.$,a.$,a.$,a.$),this.rasterBoundsBuffer=t.createVertexBuffer(y,b0.members),this.rasterBoundsSegments=a.aM.simpleSegment(0,0,4,2);const v=new a.aL;v.emplaceBack(0,0),v.emplaceBack(a.$,0),v.emplaceBack(0,a.$),v.emplaceBack(a.$,a.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(v,bn.members),this.rasterBoundsSegmentsPosOnly=a.aM.simpleSegment(0,0,4,5);const E=new a.aL;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(E,bn.members),this.viewportSegments=a.aM.simpleSegment(0,0,4,2);const C=new a.c8;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(C);const P=new a.aN;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(P);const V=this.context.gl;this.stencilClearMode=new Er({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.tileExtentMesh=new Xo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,u=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=a.L();a.bZ(f,0,this.width,this.height,0,0,1),a.N(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const y={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(t,u.TRIANGLES,hr.disabled,this.stencilClearMode,li.disabled,Vr.disabled,null,null,y,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,u,f){if(this.currentStencilSource===t.source||!t.isTileClipped()||!u||!u.length)return;this.currentStencilSource=t.source,this.nextStencilID+u.length>256&&this.clearStencil();const y=this.context;y.setColorMode(li.disabled),y.setDepthMode(hr.disabled);const v={};for(const E of u)v[E.key]=this.nextStencilID++;this._renderTileMasks(v,u,f,!0),this._renderTileMasks(v,u,f,!1),this._tileClippingMaskIDs=v}_renderTileMasks(t,u,f,y){const v=this.context,E=v.gl,C=this.style.projection,P=this.transform,V=this.useProgram("clippingMask");for(const N of u){const $=t[N.key],G=this.style.map.terrain&&this.style.map.terrain.getTerrainData(N),X=C.getMeshFromTileID(this.context,N.canonical,y,!0,"stencil"),ie=P.getProjectionData({overscaledTileID:N,applyGlobeMatrix:!f,applyTerrainMatrix:!0});V.draw(v,E.TRIANGLES,hr.disabled,new Er({func:E.ALWAYS,mask:0},$,255,E.KEEP,E.KEEP,E.REPLACE),li.disabled,f?Vr.disabled:Vr.backCCW,null,G,ie,"$clipping",X.vertexBuffer,X.indexBuffer,X.segments)}}_renderTilesDepthBuffer(){const t=this.context,u=t.gl,f=this.style.projection,y=this.transform,v=this.useProgram("depth"),E=this.getDepthModeFor3D(),C=yr(y,{tileSize:y.tileSize});for(const P of C){const V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),N=f.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),$=y.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});v.draw(t,u.TRIANGLES,E,Er.disabled,li.disabled,Vr.backCCW,null,V,$,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,u=this.context.gl;return new Er({func:u.NOTEQUAL,mask:255},t,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(t){const u=this.context.gl;return new Er({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const u=this.context.gl,f=t.sort(((E,C)=>C.overscaledZ-E.overscaledZ)),y=f[f.length-1].overscaledZ,v=f[0].overscaledZ-y+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const E={};for(let C=0;C<v;C++)E[C+y]=new Er({func:u.GEQUAL,mask:255},C+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=v,[E,f]}return[{[y]:Er.disabled},f]}stencilConfigForOverlapTwoPass(t){const u=this.context.gl,f=t.sort(((E,C)=>C.overscaledZ-E.overscaledZ)),y=f[f.length-1].overscaledZ,v=f[0].overscaledZ-y+1;if(this.clearStencil(),v>1){const E={},C={};for(let P=0;P<v;P++)E[P+y]=new Er({func:u.GREATER,mask:255},v+1+P,255,u.KEEP,u.KEEP,u.REPLACE),C[P+y]=new Er({func:u.GREATER,mask:255},1+P,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*v+1,[E,C,f]}return this.nextStencilID=3,[{[y]:new Er({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[y]:new Er({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},f]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new li([t.CONSTANT_COLOR,t.ONE],new a.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?li.unblended:li.alphaBlended}getDepthModeForSublayer(t,u,f){if(!this.opaquePassEnabledForLayer())return hr.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new hr(f||this.context.gl.LEQUAL,u,[y,y])}getDepthModeFor3D(){return new hr(this.context.gl.LEQUAL,hr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,u){var f,y;this.style=t,this.options=u,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(D.now()),this.imageManager.beginFrame();const v=this.style._order,E=this.style.sourceCaches,C={},P={},V={},N={isRenderingToTexture:!1,isRenderingGlobe:((f=t.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const G in E){const X=E[G];X.used&&X.prepare(this.context),C[G]=X.getVisibleCoordinates(!1),P[G]=C[G].slice().reverse(),V[G]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<v.length;G++)if(this.style._layers[v[G]].is3D()){this.opaquePassCutoff=G;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const G of v){const X=this.style._layers[G];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const ie=P[X.source];(X.type==="custom"||ie.length)&&this.renderLayer(this,E[X.source],X,ie,N)}if((y=this.style.projection)===null||y===void 0||y.updateGPUdependent({context:this.context,useProgram:G=>this.useProgram(G)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?a.bf.black:a.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(G,X){const ie=G.context,ue=ie.gl,ce=((Ue,Re,Fe)=>{const st=Math.cos(Re.rollInRadians),Ye=Math.sin(Re.rollInRadians),tt=Ge(Re),it=Re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ue.properties.get("sky-color"),u_horizon_color:Ue.properties.get("horizon-color"),u_horizon:[(Re.width/2-tt*Ye)*Fe,(Re.height/2+tt*st)*Fe],u_horizon_normal:[-Ye,st],u_sky_horizon_blend:Ue.properties.get("sky-horizon-blend")*Re.height/2*Fe,u_sky_blend:it}})(X,G.style.map.transform,G.pixelRatio),de=new hr(ue.LEQUAL,hr.ReadWrite,[0,1]),xe=Er.disabled,Ae=G.colorModeForRenderPass(),Ee=G.useProgram("sky"),Ie=Wf(ie,X);Ee.draw(ie,ue.TRIANGLES,de,xe,Ae,Vr.disabled,ce,null,void 0,"sky",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)})(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[v[this.currentLayer]],X=E[G.source],ie=C[G.source];this._renderTileClippingMasks(G,ie,!1),this.renderLayer(this,X,G,ie,N)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const G=this.style._layers[v[this.currentLayer]],X=E[G.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(G,N))continue;this.opaquePassEnabledForLayer()||$||($=!0,N.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ie=(G.type==="symbol"?V:P)[G.source];this._renderTileClippingMasks(G,C[G.source],!!this.renderToTexture),this.renderLayer(this,X,G,ie,N)}if(N.isRenderingGlobe&&(function(G,X,ie){const ue=G.context,ce=ue.gl,de=G.useProgram("atmosphere"),xe=new hr(ce.LEQUAL,hr.ReadOnly,[0,1]),Ae=G.transform,Ee=(function(it,xt){const wt=it.properties.get("position"),ft=[-wt.x,-wt.y,-wt.z],jt=a.ag(new Float64Array(16));return it.properties.get("anchor")==="map"&&(a.b6(jt,jt,xt.rollInRadians),a.b7(jt,jt,-xt.pitchInRadians),a.b6(jt,jt,xt.bearingInRadians),a.b7(jt,jt,xt.center.lat*Math.PI/180),a.bz(jt,jt,-xt.center.lng*Math.PI/180)),a.c6(ft,ft,jt),ft})(ie,G.transform),Ie=Ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ue=X.properties.get("atmosphere-blend")*Ie.projectionTransition;if(Ue===0)return;const Re=ka(Ae.worldSize,Ae.center.lat),Fe=Ae.inverseProjectionMatrix,st=new Float64Array(4);st[3]=1,a.aw(st,st,Ae.modelViewProjectionMatrix),st[0]/=st[3],st[1]/=st[3],st[2]/=st[3],st[3]=1,a.aw(st,st,Fe),st[0]/=st[3],st[1]/=st[3],st[2]/=st[3],st[3]=1;const Ye=((it,xt,wt,ft,jt)=>({u_sun_pos:it,u_atmosphere_blend:xt,u_globe_position:wt,u_globe_radius:ft,u_inv_proj_matrix:jt}))(Ee,Ue,[st[0],st[1],st[2]],Re,Fe),tt=Wf(ue,X);de.draw(ue,ce.TRIANGLES,xe,Er.disabled,li.alphaBlended,Vr.disabled,Ye,null,null,"atmosphere",tt.vertexBuffer,tt.indexBuffer,tt.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const G=(function(X,ie){let ue=null;const ce=Object.values(X._layers).flatMap((Ee=>Ee.source&&!Ee.isHidden(ie)?[X.sourceCaches[Ee.source]]:[])),de=ce.filter((Ee=>Ee.getSource().type==="vector")),xe=ce.filter((Ee=>Ee.getSource().type!=="vector")),Ae=Ee=>{(!ue||ue.getSource().maxzoom<Ee.getSource().maxzoom)&&(ue=Ee)};return de.forEach((Ee=>Ae(Ee))),ue||xe.forEach((Ee=>Ae(Ee))),ue})(this.style,this.transform.zoom);G&&(function(X,ie,ue){for(let ce=0;ce<ue.length;ce++)Ou(X,ie,ue[ce])})(this,G,G.getVisibleCoordinates())}this.options.showPadding&&(function(G){const X=G.transform.padding;Xf(G,G.transform.height-(X.top||0),3,Bi),Xf(G,X.bottom||0,3,za),Oa(G,X.left||0,3,As),Oa(G,G.transform.width-(X.right||0),3,Hf);const ie=G.transform.centerPoint;(function(ue,ce,de,xe){Sl(ue,ce-1,de-10,2,20,xe),Sl(ue,ce-10,de-1,20,2,xe)})(G,ie.x,G.transform.height-ie.y,vd)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let y=this.terrainFacilitator.dirty;y||(y=t?!a.c9(u,f):!a.ca(u,f)),y||(y=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),y&&(a.cb(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(v,E){const C=v.context,P=C.gl,V=v.transform,N=li.unblended,$=new hr(P.LEQUAL,hr.ReadWrite,[0,1]),G=E.sourceCache.getRenderableTiles(),X=v.useProgram("terrainDepth");C.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),C.clear({color:a.bf.transparent,depth:1});for(const ie of G){const ue=E.getTerrainMesh(ie.tileID),ce=E.getTerrainData(ie.tileID),de=V.getProjectionData({overscaledTileID:ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),xe={u_ele_delta:E.getMeshFrameDelta(V.zoom)};X.draw(C,P.TRIANGLES,$,Er.disabled,N,Vr.backCCW,xe,ce,de,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,v.width,v.height])})(this,this.style.map.terrain),(function(v,E){const C=v.context,P=C.gl,V=v.transform,N=li.unblended,$=new hr(P.LEQUAL,hr.ReadWrite,[0,1]),G=E.getCoordsTexture(),X=E.sourceCache.getRenderableTiles(),ie=v.useProgram("terrainCoords");C.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),C.clear({color:a.bf.transparent,depth:1}),E.coordsIndex=[];for(const ue of X){const ce=E.getTerrainMesh(ue.tileID),de=E.getTerrainData(ue.tileID);C.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,G.texture);const xe={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(V.zoom)},Ae=V.getProjectionData({overscaledTileID:ue.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ie.draw(C,P.TRIANGLES,$,Er.disabled,N,Vr.backCCW,xe,de,Ae,"terrain",ce.vertexBuffer,ce.indexBuffer,ce.segments),E.coordsIndex.push(ue.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,v.width,v.height])})(this,this.style.map.terrain))}renderLayer(t,u,f,y,v){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(y||[]).length)&&(this.id=f.id,a.cc(f)?(function(E,C,P,V,N,$){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:G}=$,X=Er.disabled,ie=E.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ue,ce,de,xe,Ae,Ee,Ie,Ue,Re){const Fe=ce.transform,st=ce.style.map.terrain,Ye=Ae==="map",tt=Ee==="map";for(const it of ue){const xt=xe.getTile(it),wt=xt.getBucket(de);if(!wt||!wt.text||!wt.text.segments.get().length)continue;const ft=a.an(wt.textSizeData,Fe.zoom),jt=a.aC(xt,1,ce.transform.zoom),mr=Kr(Ye,ce.transform,jt),ri=de.layout.get("icon-text-fit")!=="none"&&wt.hasIconData();if(ft){const ii=Math.pow(2,Fe.zoom-xt.tileID.overscaledZ),ui=st?(Ri,yi)=>st.getElevation(it,Ri,yi):null;cd(wt,Ye,tt,Re,Fe,mr,ii,ft,ri,a.aD(Fe,xt,Ie,Ue),it.toUnwrapped(),ui)}}})(V,E,P,C,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),N),P.paint.get("icon-opacity").constantOr(1)!==0&&pd(E,C,P,V,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),X,ie,G),P.paint.get("text-opacity").constantOr(1)!==0&&pd(E,C,P,V,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),X,ie,G),C.map.showCollisionBoxes&&(Gf(E,C,P,V,!0),Gf(E,C,P,V,!1))})(t,u,f,y,this.style.placement.variableOffsets,v):a.cd(f)?(function(E,C,P,V,N){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=N,G=P.paint.get("circle-opacity"),X=P.paint.get("circle-stroke-width"),ie=P.paint.get("circle-stroke-opacity"),ue=!P.layout.get("circle-sort-key").isConstant();if(G.constantOr(1)===0&&(X.constantOr(1)===0||ie.constantOr(1)===0))return;const ce=E.context,de=ce.gl,xe=E.transform,Ae=E.getDepthModeForSublayer(0,hr.ReadOnly),Ee=Er.disabled,Ie=E.colorModeForRenderPass(),Ue=[],Re=xe.getCircleRadiusCorrection();for(let Fe=0;Fe<V.length;Fe++){const st=V[Fe],Ye=C.getTile(st),tt=Ye.getBucket(P);if(!tt)continue;const it=P.paint.get("circle-translate"),xt=P.paint.get("circle-translate-anchor"),wt=a.aD(xe,Ye,it,xt),ft=tt.programConfigurations.get(P.id),jt=E.useProgram("circle",ft),mr=tt.layoutVertexBuffer,ri=tt.indexBuffer,ii=E.style.map.terrain&&E.style.map.terrain.getTerrainData(st),ui={programConfiguration:ft,program:jt,layoutVertexBuffer:mr,indexBuffer:ri,uniformValues:Jc(E,Ye,P,wt,Re),terrainData:ii,projectionData:xe.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(ue){const Ri=tt.segments.get();for(const yi of Ri)Ue.push({segments:new a.aM([yi]),sortKey:yi.sortKey,state:ui})}else Ue.push({segments:tt.segments,sortKey:0,state:ui})}ue&&Ue.sort(((Fe,st)=>Fe.sortKey-st.sortKey));for(const Fe of Ue){const{programConfiguration:st,program:Ye,layoutVertexBuffer:tt,indexBuffer:it,uniformValues:xt,terrainData:wt,projectionData:ft}=Fe.state;Ye.draw(ce,de.TRIANGLES,Ae,Ee,Ie,Vr.backCCW,xt,wt,ft,P.id,tt,it,Fe.segments,P.paint,E.transform.zoom,st)}})(t,u,f,y,v):a.ce(f)?(function(E,C,P,V,N){if(P.paint.get("heatmap-opacity")===0)return;const $=E.context,{isRenderingToTexture:G,isRenderingGlobe:X}=N;if(E.style.map.terrain){for(const ie of V){const ue=C.getTile(ie);C.hasRenderableParent(ie)||(E.renderPass==="offscreen"?fd(E,ue,P,ie,X):E.renderPass==="translucent"&&hd(E,P,ie,G,X))}$.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?(function(ie,ue,ce,de){const xe=ie.context,Ae=xe.gl,Ee=ie.transform,Ie=Er.disabled,Ue=new li([Ae.ONE,Ae.ONE],a.bf.transparent,[!0,!0,!0,!0]);(function(Re,Fe,st){const Ye=Re.gl;Re.activeTexture.set(Ye.TEXTURE1),Re.viewport.set([0,0,Fe.width/4,Fe.height/4]);let tt=st.heatmapFbos.get(a.c3);tt?(Ye.bindTexture(Ye.TEXTURE_2D,tt.colorAttachment.get()),Re.bindFramebuffer.set(tt.framebuffer)):(tt=Iu(Re,Fe.width/4,Fe.height/4),st.heatmapFbos.set(a.c3,tt))})(xe,ie,ce),xe.clear({color:a.bf.transparent});for(let Re=0;Re<de.length;Re++){const Fe=de[Re];if(ue.hasRenderableParent(Fe))continue;const st=ue.getTile(Fe),Ye=st.getBucket(ce);if(!Ye)continue;const tt=Ye.programConfigurations.get(ce.id),it=ie.useProgram("heatmap",tt),xt=Ee.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),wt=Ee.getCircleRadiusCorrection();it.draw(xe,Ae.TRIANGLES,hr.disabled,Ie,Ue,Vr.backCCW,If(st,Ee.zoom,ce.paint.get("heatmap-intensity"),wt),null,xt,ce.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,ce.paint,Ee.zoom,tt)}xe.viewport.set([0,0,ie.width,ie.height])})(E,C,P,V):E.renderPass==="translucent"&&(function(ie,ue){const ce=ie.context,de=ce.gl;ce.setColorMode(ie.colorModeForRenderPass());const xe=ue.heatmapFbos.get(a.c3);xe&&(ce.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,xe.colorAttachment.get()),ce.activeTexture.set(de.TEXTURE1),Ma(ce,ue).bind(de.LINEAR,de.CLAMP_TO_EDGE),ie.useProgram("heatmapTexture").draw(ce,de.TRIANGLES,hr.disabled,Er.disabled,ie.colorModeForRenderPass(),Vr.disabled,ay(ie,ue,0,1),null,null,ue.id,ie.viewportBuffer,ie.quadTriangleIndexBuffer,ie.viewportSegments,ue.paint,ie.transform.zoom))})(E,P)})(t,u,f,y,v):a.cf(f)?(function(E,C,P,V,N){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=N,G=P.paint.get("line-opacity"),X=P.paint.get("line-width");if(G.constantOr(1)===0||X.constantOr(1)===0)return;const ie=E.getDepthModeForSublayer(0,hr.ReadOnly),ue=E.colorModeForRenderPass(),ce=P.paint.get("line-dasharray"),de=ce.constantOr(1),xe=P.paint.get("line-pattern"),Ae=xe.constantOr(1),Ee=P.paint.get("line-gradient"),Ie=P.getCrossfadeParameters();let Ue;Ue=Ae?"linePattern":de&&Ee?"lineGradientSDF":de?"lineSDF":Ee?"lineGradient":"line";const Re=E.context,Fe=Re.gl,st=E.transform;let Ye=!0;for(const tt of V){const it=C.getTile(tt);if(Ae&&!it.patternsLoaded())continue;const xt=it.getBucket(P);if(!xt)continue;const wt=xt.programConfigurations.get(P.id),ft=E.context.program.get(),jt=E.useProgram(Ue,wt),mr=Ye||jt.program!==ft,ri=E.style.map.terrain&&E.style.map.terrain.getTerrainData(tt),ii=xe.constantOr(null),ui=ce&&ce.constantOr(null);if(ii&&it.imageAtlas){const wn=it.imageAtlas,Ni=wn.patternPositions[ii.to.toString()],Fi=wn.patternPositions[ii.from.toString()];Ni&&Fi&&wt.setConstantPatternPositions(Ni,Fi)}else if(ui){const wn=P.layout.get("line-cap")==="round",Ni=E.lineAtlas.getDash(ui.to,wn),Fi=E.lineAtlas.getDash(ui.from,wn);wt.setConstantDashPositions(Ni,Fi)}const Ri=st.getProjectionData({overscaledTileID:tt,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),yi=st.getPixelScale();let Nr;Ae?(Nr=Pa(E,it,P,yi,Ie),L0(Re,Fe,it,wt,Ie)):de&&Ee?(Nr=fy(E,it,P,yi,Ie,xt.lineClipsArray.length),Ry(E,C,Re,Fe,P,xt,tt,wt,Ie)):de?(Nr=py(E,it,P,yi,Ie),Bu(E,Re,Fe,wt,mr,Ie)):Ee?(Nr=dy(E,it,P,yi,xt.lineClipsArray.length),D0(E,C,Re,Fe,P,xt,tt)):Nr=Cu(E,it,P,yi);const wi=E.stencilModeForClipping(tt);jt.draw(Re,Fe.TRIANGLES,ie,wi,ue,Vr.disabled,Nr,ri,Ri,P.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,P.paint,E.transform.zoom,wt,xt.layoutVertexBuffer2),Ye=!1}})(t,u,f,y,v):a.cg(f)?(function(E,C,P,V,N){const $=P.paint.get("fill-color"),G=P.paint.get("fill-opacity");if(G.constantOr(1)===0)return;const{isRenderingToTexture:X}=N,ie=E.colorModeForRenderPass(),ue=P.paint.get("fill-pattern"),ce=E.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&$.constantOr(a.bf.transparent).a===1&&G.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===ce){const de=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?hr.ReadWrite:hr.ReadOnly);yd(E,C,P,V,de,ie,!1,X)}if(E.renderPass==="translucent"&&P.paint.get("fill-antialias")){const de=E.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,hr.ReadOnly);yd(E,C,P,V,de,ie,!0,X)}})(t,u,f,y,v):a.ch(f)?(function(E,C,P,V,N){const $=P.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:G}=N;if(E.renderPass==="translucent"){const X=new hr(E.context.gl.LEQUAL,hr.ReadWrite,E.depthRangeFor3D);if($!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))gd(E,C,P,V,X,Er.disabled,li.disabled,G),gd(E,C,P,V,X,E.stencilModeFor3D(),E.colorModeForRenderPass(),G);else{const ie=E.colorModeForRenderPass();gd(E,C,P,V,X,Er.disabled,ie,G)}}})(t,u,f,y,v):a.ci(f)?(function(E,C,P,V,N){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=N,G=E.context,X=E.style.projection.useSubdivision,ie=E.getDepthModeForSublayer(0,hr.ReadOnly),ue=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(ce,de,xe,Ae,Ee,Ie,Ue){const Re=ce.context,Fe=Re.gl;for(const st of xe){const Ye=de.getTile(st),tt=Ye.dem;if(!tt||!tt.data||!Ye.needsHillshadePrepare)continue;const it=tt.dim,xt=tt.stride,wt=tt.getPixels();if(Re.activeTexture.set(Fe.TEXTURE1),Re.pixelStoreUnpackPremultiplyAlpha.set(!1),Ye.demTexture=Ye.demTexture||ce.getTileTexture(xt),Ye.demTexture){const jt=Ye.demTexture;jt.update(wt,{premultiply:!1}),jt.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE)}else Ye.demTexture=new a.T(Re,wt,Fe.RGBA,{premultiply:!1}),Ye.demTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE);Re.activeTexture.set(Fe.TEXTURE0);let ft=Ye.fbo;if(!ft){const jt=new a.T(Re,{width:it,height:it,data:null},Fe.RGBA);jt.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),ft=Ye.fbo=Re.createFramebuffer(it,it,!0,!1),ft.colorAttachment.set(jt.texture)}Re.bindFramebuffer.set(ft.framebuffer),Re.viewport.set([0,0,it,it]),ce.useProgram("hillshadePrepare").draw(Re,Fe.TRIANGLES,Ee,Ie,Ue,Vr.disabled,Bf(Ye.tileID,tt),null,null,Ae.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),Ye.needsHillshadePrepare=!1}})(E,C,V,P,ie,Er.disabled,ue),G.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(X){const[ce,de,xe]=E.stencilConfigForOverlapTwoPass(V);_d(E,C,P,xe,ce,ie,ue,!1,$),_d(E,C,P,xe,de,ie,ue,!0,$)}else{const[ce,de]=E.getStencilConfigForOverlapAndUpdateStencilID(V);_d(E,C,P,de,ce,ie,ue,!1,$)}})(t,u,f,y,v):a.cj(f)?(function(E,C,P,V,N){if(E.renderPass!=="translucent"||!V.length)return;const{isRenderingToTexture:$}=N,G=E.style.projection.useSubdivision,X=E.getDepthModeForSublayer(0,hr.ReadOnly),ie=E.colorModeForRenderPass();if(G){const[ue,ce,de]=E.stencilConfigForOverlapTwoPass(V);Rl(E,C,P,de,ue,X,ie,!1,$),Rl(E,C,P,de,ce,X,ie,!0,$)}else{const[ue,ce]=E.getStencilConfigForOverlapAndUpdateStencilID(V);Rl(E,C,P,ce,ue,X,ie,!1,$)}})(t,u,f,y,v):a.bK(f)?(function(E,C,P,V,N){if(E.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!V.length)return;const{isRenderingToTexture:$}=N,G=C.getSource(),X=E.style.projection.useSubdivision;if(G instanceof er)bd(E,C,P,V,null,!1,!1,G.tileCoords,G.flippedWindingOrder,$);else if(X){const[ie,ue,ce]=E.stencilConfigForOverlapTwoPass(V);bd(E,C,P,ce,ie,!1,!0,zu,!1,$),bd(E,C,P,ce,ue,!0,!0,zu,!1,$)}else{const[ie,ue]=E.getStencilConfigForOverlapAndUpdateStencilID(V);bd(E,C,P,ue,ie,!1,!0,zu,!1,$)}})(t,u,f,y,v):a.ck(f)?(function(E,C,P,V,N){const $=P.paint.get("background-color"),G=P.paint.get("background-opacity");if(G===0)return;const{isRenderingToTexture:X}=N,ie=E.context,ue=ie.gl,ce=E.style.projection,de=E.transform,xe=de.tileSize,Ae=P.paint.get("background-pattern");if(E.isPatternMissing(Ae))return;const Ee=!Ae&&$.a===1&&G===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==Ee)return;const Ie=Er.disabled,Ue=E.getDepthModeForSublayer(0,Ee==="opaque"?hr.ReadWrite:hr.ReadOnly),Re=E.colorModeForRenderPass(),Fe=E.useProgram(Ae?"backgroundPattern":"background"),st=V||yr(de,{tileSize:xe,terrain:E.style.map.terrain});Ae&&(ie.activeTexture.set(ue.TEXTURE0),E.imageManager.bind(E.context));const Ye=P.getCrossfadeParameters();for(const tt of st){const it=de.getProjectionData({overscaledTileID:tt,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),xt=Ae?zf(G,E,Ae,{tileID:tt,tileSize:xe},Ye):gy(G,$),wt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(tt),ft=ce.getMeshFromTileID(ie,tt.canonical,!1,!0,"raster");Fe.draw(ie,ue.TRIANGLES,Ue,Ie,Re,Vr.backCCW,xt,wt,it,P.id,ft.vertexBuffer,ft.indexBuffer,ft.segments)}})(t,0,f,y,v):a.cl(f)&&(function(E,C,P,V){const{isRenderingGlobe:N}=V,$=E.context,G=P.implementation,X=E.style.projection,ie=E.transform,ue=ie.getProjectionDataForCustomLayer(N),ce={farZ:ie.farZ,nearZ:ie.nearZ,fov:ie.fov*Math.PI/180,modelViewProjectionMatrix:ie.modelViewProjectionMatrix,projectionMatrix:ie.projectionMatrix,shaderData:{variantName:X.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${X.shaderPreludeCode.vertexSource}`,define:X.shaderDefine},defaultProjectionData:ue},de=G.renderingMode?G.renderingMode:"2d";if(E.renderPass==="offscreen"){const xe=G.prerender;xe&&(E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),xe.call(G,$.gl,ce),$.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),$.setStencilMode(Er.disabled);const xe=de==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,hr.ReadOnly);$.setDepthMode(xe),G.render($.gl,ce),$.setDirty(),E.setBaseState(),$.bindFramebuffer.set(null)}})(t,0,f,v))}saveTileTexture(t){const u=this._tileTextures[t.size[0]];u?u.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const u=this._tileTextures[t];return u&&u.length>0?u.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const u=this.imageManager.getPattern(t.from.toString()),f=this.imageManager.getPattern(t.to.toString());return!u||!f}useProgram(t,u,f=!1,y=[]){this.cache=this.cache||{};const v=!!this.style.map.terrain,E=this.style.projection,C=f?_n.projectionMercator:E.shaderPreludeCode,P=f?ao:E.shaderDefine,V=t+(u?u.cacheKey:"")+`/${f?Tr:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(v?"/terrain":"")+(y?`/${y.join("/")}`:"");return this.cache[V]||(this.cache[V]=new Lf(this.context,_n[t],u,ed[t],this._showOverdrawInspector,v,C,P,y)),this.cache[V]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:u}=this.context.gl;return this.width!==t||this.height!==u}}function Yf(_,t){let u,f=!1,y=null,v=null;const E=()=>{y=null,f&&(_.apply(v,u),y=setTimeout(E,t),f=!1)};return(...C)=>(f=!0,v=this,u=C,y||E(),y)}class Jf{constructor(t){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map((y=>y.split("="))).forEach((y=>{y[0]===this._hashName&&(f=y)})),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const f=u.join("/");let y=f;y.split("&").length>0&&(y=y.split("&")[0]),this._hashName&&(y=`${this._hashName}=${f}`);let v=window.location.hash.replace(y,"");v.startsWith("#&")?v=v.slice(0,1)+v.slice(2):v==="#"&&(v="");let E=window.location.href.replace(/(#.+)?$/,v);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Yf(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,y),E=Math.round(u.lng*v)/v,C=Math.round(u.lat*v)/v,P=this._map.getBearing(),V=this._map.getPitch();let N="";if(N+=t?`/${E}/${C}/${f}`:`${f}/${C}/${E}`,(P||V)&&(N+="/"+Math.round(10*P)/10),V&&(N+=`/${Math.round(V)}`),this._hashName){const $=this._hashName;let G=!1;const X=window.location.hash.slice(1).split("&").map((ie=>{const ue=ie.split("=")[0];return ue===$?(G=!0,`${ue}=${N}`):ie})).filter((ie=>ie));return G||X.push(`${$}=${N}`),`#${X.join("&")}`}return`#${N}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new a.S(+t[2],+t[1])}catch{return!1}const u=+t[0],f=+(t[3]||0),y=+(t[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&f>=-180&&f<=180&&y>=this._map.getMinPitch()&&y<=this._map.getMaxPitch()}}const Tl={linearity:.3,easing:a.cm(0,0,.3,1)},Va=a.e({deceleration:2500,maxSpeed:1400},Tl),Cy=a.e({deceleration:20,maxSpeed:1400},Tl),ky=a.e({deceleration:1e3,maxSpeed:360},Tl),Py=a.e({deceleration:1e3,maxSpeed:90},Tl),Ly=a.e({deceleration:1e3,maxSpeed:360},Tl);class Dy{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:D.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,u=D.now();for(;t.length>0&&u-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)u.zoom+=v.zoomDelta||0,u.bearing+=v.bearingDelta||0,u.pitch+=v.pitchDelta||0,u.roll+=v.rollDelta||0,v.panDelta&&u.pan._add(v.panDelta),v.around&&(u.around=v.around),v.pinchAround&&(u.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(u.pan.mag()){const v=kl(u.pan.mag(),f,a.e({},Va,t||{})),E=u.pan.mult(v.amount/u.pan.mag()),C=this._map.cameraHelper.handlePanInertia(E,this._map.transform);y.center=C.easingCenter,y.offset=C.easingOffset,Cl(y,v)}if(u.zoom){const v=kl(u.zoom,f,Cy);y.zoom=this._map.transform.zoom+v.amount,Cl(y,v)}if(u.bearing){const v=kl(u.bearing,f,ky);y.bearing=this._map.transform.bearing+a.ah(v.amount,-179,179),Cl(y,v)}if(u.pitch){const v=kl(u.pitch,f,Py);y.pitch=this._map.transform.pitch+v.amount,Cl(y,v)}if(u.roll){const v=kl(u.roll,f,Ly);y.roll=this._map.transform.roll+a.ah(v.amount,-179,179),Cl(y,v)}if(y.zoom||y.bearing){const v=u.pinchAround===void 0?u.around:u.pinchAround;y.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),a.e(y,{noMoveStart:!0})}}function Cl(_,t){(!_.duration||_.duration<t.duration)&&(_.duration=t.duration,_.easing=t.easing)}function kl(_,t,u){const{maxSpeed:f,linearity:y,deceleration:v}=u,E=a.ah(_*y/(t/1e3),-f,f),C=Math.abs(E)/(v*y);return{easing:u.easing,duration:1e3*C,amount:E*(C/2)}}class Xn extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,f,y={}){f=f instanceof MouseEvent?f:new MouseEvent(t,f);const v=k.mousePos(u.getCanvas(),f),E=u.unproject(v);super(t,a.e({point:v,lngLat:E,originalEvent:f},y)),this._defaultPrevented=!1,this.target=u}}class Yo extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,f){const y=t==="touchend"?f.changedTouches:f.touches,v=k.touchPos(u.getCanvasContainer(),y),E=v.map((P=>u.unproject(P))),C=v.reduce(((P,V,N,$)=>P.add(V.div($.length))),new a.P(0,0));super(t,{points:v,point:C,lngLats:E,lngLat:u.unproject(C),originalEvent:f}),this._defaultPrevented=!1}}class Qf extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,f){super(t,{originalEvent:f}),this._defaultPrevented=!1}}class Rs{constructor(t,u){this._map=t,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Qf(t.type,this._map,t))}mousedown(t,u){return this._mousedownPos=u,this._firePreventable(new Xn(t.type,this._map,t))}mouseup(t){this._map.fire(new Xn(t.type,this._map,t))}click(t,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Xn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Xn(t.type,this._map,t))}mouseover(t){this._map.fire(new Xn(t.type,this._map,t))}mouseout(t){this._map.fire(new Xn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Yo(t.type,this._map,t))}touchmove(t){this._map.fire(new Yo(t.type,this._map,t))}touchend(t){this._map.fire(new Yo(t.type,this._map,t))}touchcancel(t){this._map.fire(new Yo(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Us{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Xn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Xn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Xn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pl{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(a.P.convert(t),this._map.terrain)}}class Ss{constructor(t,u){this._map=t,this._tr=new Pl(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,u){this.isEnabled()&&t.shiftKey&&t.button===0&&(k.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(t,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=f,this._box||(this._box=k.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const v=Math.min(y.x,f.x),E=Math.max(y.x,f.x),C=Math.min(y.y,f.y),P=Math.max(y.y,f.y);k.setTransform(this._box,`translate(${v}px,${C}px)`),this._box.style.width=E-v+"px",this._box.style.height=P-C+"px"}mouseupWindow(t,u){if(!this._active||t.button!==0)return;const f=this._startPos,y=u;if(this.reset(),k.suppressClick(),f.x!==y.x||f.y!==y.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:t})),{cameraAnimation:v=>v.fitScreenCoordinates(f,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,u){return this._map.fire(new a.l(t,{originalEvent:u}))}}function Jo(_,t){if(_.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${t.length}`);const u={};for(let f=0;f<_.length;f++)u[_[f].identifier]=t[f];return u}class I0{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),f.length===this.numTouches&&(this.centroid=(function(y){const v=new a.P(0,0);for(const E of y)v._add(E);return v.div(y.length)})(u),this.touches=Jo(f,u)))}touchmove(t,u,f){if(this.aborted||!this.centroid)return;const y=Jo(f,u);for(const v in this.touches){const E=y[v];(!E||E.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(t,u,f){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class eh{constructor(t){this.singleTap=new I0(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,u,f){this.singleTap.touchstart(t,u,f)}touchmove(t,u,f){this.singleTap.touchmove(t,u,f)}touchend(t,u,f){const y=this.singleTap.touchend(t,u,f);if(y){const v=t.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(v&&E||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class B0{constructor(t){this._tr=new Pl(t),this._zoomIn=new eh({numTouches:1,numTaps:2}),this._zoomOut=new eh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,u,f){this._zoomIn.touchstart(t,u,f),this._zoomOut.touchstart(t,u,f)}touchmove(t,u,f){this._zoomIn.touchmove(t,u,f),this._zoomOut.touchmove(t,u,f)}touchend(t,u,f){const y=this._zoomIn.touchend(t,u,f),v=this._zoomOut.touchend(t,u,f),E=this._tr;return y?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(y)},{originalEvent:t})}):v?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(v)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const u=this._moveFunction(...t);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(t,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const y=Array.isArray(u)?u[0]:u;return!this._moved&&y.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(f,y))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&k.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Iy=0,Uu=2,Co={[Iy]:1,[Uu]:2};class It{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const u=k.mouseButton(t);this._eventButton=u}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(u,f){const y=Co[f];return u.buttons===void 0||(u.buttons&y)!==y})(t,this._eventButton)}isValidEndEvent(t){return k.mouseButton(t)===this._eventButton}}class By{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class th{constructor(t=new It({checkCorrectEvent:()=>!0}),u=new By){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(t,u,f){return t instanceof MouseEvent?u(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?f(t):void 0}startMove(t){this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.startMove(u)),(u=>this.oneFingerTouchMoveStateManager.startMove(u)))}endMove(t){this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.endMove(u)),(u=>this.oneFingerTouchMoveStateManager.endMove(u)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.isValidStartEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.isValidMoveEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.isValidEndEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u)))}}const ju=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=t=>{t.preventDefault()}};class Nu{constructor(t,u){this._clickTolerance=t.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,u,f){return this._calculateTransform(t,u,f)}touchmove(t,u,f){if(this._active){if(!this._shouldBePrevented(f.length))return t.preventDefault(),this._calculateTransform(t,u,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,u,f){this._calculateTransform(t,u,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,u,f){f.length>0&&(this._active=!0);const y=Jo(f,u),v=new a.P(0,0),E=new a.P(0,0);let C=0;for(const V in y){const N=y[V],$=this._touches[V];$&&(v._add(N),E._add(N.sub($)),C++,y[V]=N)}if(this._touches=y,this._shouldBePrevented(C)||!E.mag())return;const P=E.div(C);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(C),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ua{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(t,u,f){if(!this._firstTwoTouches)return;t.preventDefault();const[y,v]=this._firstTwoTouches,E=Ll(f,u,y),C=Ll(f,u,v);if(!E||!C)return;const P=this._aroundCenter?null:E.add(C).div(2);return this._move([E,C],P,t)}touchend(t,u,f){if(!this._firstTwoTouches)return;const[y,v]=this._firstTwoTouches,E=Ll(f,u,y),C=Ll(f,u,v);E&&C||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ll(_,t,u){for(let f=0;f<_.length;f++)if(_[f].identifier===u)return t[f]}function Or(_,t){return Math.log(_/t)/Math.LN2}class wd extends Ua{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,u){const f=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Or(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Or(this._distance,f),pinchAround:u}}}function My(_,t){return 180*_.angleWith(t)/Math.PI}class Ed extends Ua{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,u,f){const y=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:My(this._vector,y),pinchAround:u}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const u=25/(Math.PI*this._minDiameter)*360,f=My(t,this._startVector);return Math.abs(f)<u}}function rh(_){return Math.abs(_.y)>Math.abs(_.x)}class zy extends Ua{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,u,f){super.touchstart(t,u,f),this._currentTouchCount=f.length}_start(t){this._lastPoints=t,rh(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const y=t[0].sub(this._lastPoints[0]),v=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,v,f.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(y.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(t,u,f){if(this._valid!==void 0)return this._valid;const y=t.mag()>=2,v=u.mag()>=2;if(!y&&!v)return;if(!y||!v)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=t.y>0==u.y>0;return rh(t)&&rh(u)&&E}}const Oy={panStep:100,bearingStep:15,pitchStep:10};class Ad{constructor(t){this._tr=new Pl(t);const u=Oy;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let u=0,f=0,y=0,v=0,E=0;switch(t.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:t.shiftKey?f=-1:(t.preventDefault(),v=-1);break;case 39:t.shiftKey?f=1:(t.preventDefault(),v=1);break;case 38:t.shiftKey?y=1:(t.preventDefault(),E=-1);break;case 40:t.shiftKey?y=-1:(t.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:C=>{const P=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Vy,zoom:u?Math.round(P.zoom)+u*(t.shiftKey?2:1):P.zoom,bearing:P.bearing+f*this._bearingStep,pitch:P.pitch+y*this._pitchStep,offset:[-v*this._panStep,-E*this._panStep],center:P.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vy(_){return _*(2-_)}const Uy=4.000244140625,jy=1/450;class Ny{constructor(t,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=t,this._tr=new Pl(t),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=jy}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let u=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const f=D.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%Uy==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(y*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),t.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=t,this._delta-=u,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=k.mousePos(this._map.getCanvas(),t),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(a.S.convert(f.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const C=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=C),typeof this._targetZoom=="number"&&(this._targetZoom+=C)}if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Uy?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&P!==0&&(P=1/P);const V=typeof this._targetZoom!="number"?t.scale:a.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),a.ak(V*P)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,f=this._startZoom,y=this._easing;let v,E=!1;if(this._type==="wheel"&&f&&y){const C=D.now()-this._lastWheelEventTime,P=Math.min((C+5)/200,1),V=y(P);v=a.C.number(f,u,V),P<1?this._frameId||(this._frameId=!0):E=!0}else v=u,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=v,{noInertia:!0,needsRenderFrame:!E,zoomDelta:v-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let u=a.co;if(this._prevEase){const f=this._prevEase,y=(D.now()-f.start)/f.duration,v=f.easing(y+.01)-f.easing(y),E=.27/Math.sqrt(v*v+1e-4)*.01,C=Math.sqrt(.0729-E*E);u=a.cm(E,C,.25,1)}return this._prevEase={start:D.now(),duration:t,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Fy{constructor(t,u){this._clickZoom=t,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Qo{constructor(t){this._tr=new Pl(t),this.reset()}reset(){this._active=!1}dblclick(t,u){return t.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mi{constructor(){this._tap=new eh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,u,f){if(!this._swipePoint)if(this._tapTime){const y=u[0],v=t.timeStamp-this._tapTime<500,E=this._tapPoint.dist(y)<30;v&&E?f.length>0&&(this._swipePoint=y,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(t,u,f)}touchmove(t,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=u[0],v=y.y-this._swipePoint.y;return this._swipePoint=y,t.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(t,u,f)}touchend(t,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const y=this._tap.touchend(t,u,f);y&&(this._tapTime=t.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qy{constructor(t,u,f){this._el=t,this._mousePan=u,this._touchPan=f}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fu{constructor(t,u,f,y){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=u,this._mousePitch=f,this._mouseRoll=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Rd{constructor(t,u,f,y){this._el=t,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ih{constructor(t,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=k.create("div","maplibregl-cooperative-gesture-screen",t);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),y=document.createElement("div");y.className="maplibregl-desktop-message",y.textContent=u,this._container.appendChild(y);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=f,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(k.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,u){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:t,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const qu=_=>_.zoom||_.drag||_.roll||_.pitch||_.rotate;class Ky extends a.l{}function nh(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta||_.rollDelta}class uo{constructor(t,u){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,v)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=y.type==="renderFrame"?void 0:y,C={needsRenderFrame:!1},P={},V={};for(const{handlerName:G,handler:X,allowed:ie}of this._handlers){if(!X.isEnabled())continue;let ue;if(this._blockedByActive(V,ie,G))X.reset();else if(X[v||y.type]){if(a.cp(y,v||y.type)){const ce=k.mousePos(this._map.getCanvas(),y);ue=X[v||y.type](y,ce)}else if(a.cq(y,v||y.type)){const ce=this._getMapTouches(y.touches),de=k.touchPos(this._map.getCanvas(),ce);ue=X[v||y.type](y,de,ce)}else a.cr(v||y.type)||(ue=X[v||y.type](y));this.mergeHandlerResult(C,P,ue,G,E),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()}(ue||X.isActive())&&(V[G]=X)}const N={};for(const G in this._previousActiveHandlers)V[G]||(N[G]=E);this._previousActiveHandlers=V,(Object.keys(N).length||nh(C))&&(this._changes.push([C,P,N]),this._triggerRenderFrame()),(Object.keys(V).length||nh(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=C;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Dy(t),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,v,E]of this._listeners)k.addEventListener(y,v,y===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[t,u,f]of this._listeners)k.removeEventListener(t,u,t===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(t){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new Rs(u,t));const y=u.boxZoom=new Ss(u,t);this._add("boxZoom",y),t.interactive&&t.boxZoom&&y.enable();const v=u.cooperativeGestures=new ih(u,t.cooperativeGestures);this._add("cooperativeGestures",v),t.cooperativeGestures&&v.enable();const E=new B0(u),C=new Qo(u);u.doubleClickZoom=new Fy(C,E),this._add("tapZoom",E),this._add("clickZoom",C),t.interactive&&t.doubleClickZoom&&u.doubleClickZoom.enable();const P=new mi;this._add("tapDragZoom",P);const V=u.touchPitch=new zy(u);this._add("touchPitch",V),t.interactive&&t.touchPitch&&u.touchPitch.enable(t.touchPitch);const N=()=>u.project(u.getCenter()),$=(function({enable:Ee,clickTolerance:Ie,aroundCenter:Ue=!0,minPixelCenterThreshold:Re=100,rotateDegreesPerPixelMoved:Fe=.8},st){const Ye=new It({checkCorrectEvent:tt=>k.mouseButton(tt)===0&&tt.ctrlKey||k.mouseButton(tt)===2&&!tt.ctrlKey});return new Vu({clickTolerance:Ie,move:(tt,it)=>{const xt=st();if(Ue&&Math.abs(xt.y-tt.y)>Re)return{bearingDelta:a.cn(new a.P(tt.x,it.y),it,xt)};let wt=(it.x-tt.x)*Fe;return Ue&&it.y<xt.y&&(wt=-wt),{bearingDelta:wt}},moveStateManager:Ye,enable:Ee,assignEvents:ju})})(t,N),G=(function({enable:Ee,clickTolerance:Ie,pitchDegreesPerPixelMoved:Ue=-.5}){const Re=new It({checkCorrectEvent:Fe=>k.mouseButton(Fe)===0&&Fe.ctrlKey||k.mouseButton(Fe)===2});return new Vu({clickTolerance:Ie,move:(Fe,st)=>({pitchDelta:(st.y-Fe.y)*Ue}),moveStateManager:Re,enable:Ee,assignEvents:ju})})(t),X=(function({enable:Ee,clickTolerance:Ie,rollDegreesPerPixelMoved:Ue=.3},Re){const Fe=new It({checkCorrectEvent:st=>k.mouseButton(st)===2&&st.ctrlKey});return new Vu({clickTolerance:Ie,move:(st,Ye)=>{const tt=Re();let it=(Ye.x-st.x)*Ue;return Ye.y<tt.y&&(it=-it),{rollDelta:it}},moveStateManager:Fe,enable:Ee,assignEvents:ju})})(t,N);u.dragRotate=new Fu(t,$,G,X),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",G,["mouseRotate","mouseRoll"]),this._add("mouseRoll",X,["mousePitch"]),t.interactive&&t.dragRotate&&u.dragRotate.enable();const ie=(function({enable:Ee,clickTolerance:Ie}){const Ue=new It({checkCorrectEvent:Re=>k.mouseButton(Re)===0&&!Re.ctrlKey});return new Vu({clickTolerance:Ie,move:(Re,Fe)=>({around:Fe,panDelta:Fe.sub(Re)}),activateOnStart:!0,moveStateManager:Ue,enable:Ee,assignEvents:ju})})(t),ue=new Nu(t,u);u.dragPan=new qy(f,ie,ue),this._add("mousePan",ie),this._add("touchPan",ue,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&u.dragPan.enable(t.dragPan);const ce=new Ed,de=new wd;u.touchZoomRotate=new Rd(f,de,ce,P),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&u.touchZoomRotate.enable(t.touchZoomRotate);const xe=u.scrollZoom=new Ny(u,(()=>this._triggerRenderFrame()));this._add("scrollZoom",xe,["mousePan"]),t.interactive&&t.scrollZoom&&u.scrollZoom.enable(t.scrollZoom);const Ae=u.keyboard=new Ad(u);this._add("keyboard",Ae),t.interactive&&t.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Us(u))}_add(t,u,f){this._handlers.push({handlerName:t,handler:u,allowed:f}),this._handlersById[t]=u}stop(t){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qu(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,u,f){for(const y in t)if(y!==f&&(!u||u.indexOf(y)<0))return!0;return!1}_getMapTouches(t){const u=[];for(const f of t)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(t,u,f,y,v){if(!f)return;a.e(t,f);const E={handlerName:y,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(u.zoom=E),f.panDelta!==void 0&&(u.drag=E),f.rollDelta!==void 0&&(u.roll=E),f.pitchDelta!==void 0&&(u.pitch=E),f.bearingDelta!==void 0&&(u.rotate=E)}_applyChanges(){const t={},u={},f={};for(const[y,v,E]of this._changes)y.panDelta&&(t.panDelta=(t.panDelta||new a.P(0,0))._add(y.panDelta)),y.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+y.pitchDelta),y.rollDelta&&(t.rollDelta=(t.rollDelta||0)+y.rollDelta),y.around!==void 0&&(t.around=y.around),y.pinchAround!==void 0&&(t.pinchAround=y.pinchAround),y.noInertia&&(t.noInertia=y.noInertia),a.e(u,v),a.e(f,E);this._updateMapTransform(t,u,f),this._changes=[]}_updateMapTransform(t,u,f){const y=this._map,v=y._getTransformForUpdate(),E=y.terrain;if(!(nh(t)||E&&this._terrainMovement))return this._fireEvents(u,f,!0);y._stop(!0);let{panDelta:C,zoomDelta:P,bearingDelta:V,pitchDelta:N,rollDelta:$,around:G,pinchAround:X}=t;X!==void 0&&(G=X),G=G||y.transform.centerPoint,E&&!v.isPointOnMapSurface(G)&&(G=v.centerPoint);const ie={panDelta:C,zoomDelta:P,rollDelta:$,pitchDelta:N,bearingDelta:V,around:G};this._map.cameraHelper.useGlobeControls&&!v.isPointOnMapSurface(G)&&(G=v.centerPoint);const ue=G.distSqr(v.centerPoint)<.01?v.center:v.screenPointToLocation(C?G.sub(C):G);this._handleMapControls({terrain:E,tr:v,deltasForHelper:ie,preZoomAroundLoc:ue,combinedEventsInProgress:u,panDelta:C}),y._applyUpdatedTransform(v),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(u,f,!0)}_handleMapControls({terrain:t,tr:u,deltasForHelper:f,preZoomAroundLoc:y,combinedEventsInProgress:v,panDelta:E}){const C=this._map.cameraHelper;if(C.handleMapControlsRollPitchBearingZoom(f,u),t)return C.useGlobeControls?(this._terrainMovement||!v.drag&&!v.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void C.handleMapControlsPan(f,u,y)):this._terrainMovement||!v.drag&&!v.zoom?void(v.drag&&this._terrainMovement&&E?u.setCenter(u.screenPointToLocation(u.centerPoint.sub(E))):C.handleMapControlsPan(f,u,y)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void C.handleMapControlsPan(f,u,y));C.handleMapControlsPan(f,u,y)}_fireEvents(t,u,f){const y=qu(this._eventsInProgress),v=qu(t),E={};for(const $ in t){const{originalEvent:G}=t[$];this._eventsInProgress[$]||(E[`${$}start`]=G),this._eventsInProgress[$]=t[$]}!y&&v&&this._fireEvent("movestart",v.originalEvent);for(const $ in E)this._fireEvent($,E[$]);v&&this._fireEvent("move",v.originalEvent);for(const $ in t){const{originalEvent:G}=t[$];this._fireEvent($,G)}const C={};let P;for(const $ in this._eventsInProgress){const{handlerName:G,originalEvent:X}=this._eventsInProgress[$];this._handlersById[G].isActive()||(delete this._eventsInProgress[$],P=u[G]||X,C[`${$}end`]=P)}for(const $ in C)this._fireEvent($,C[$]);const V=qu(this._eventsInProgress),N=(y||v)&&!V;if(N&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(f&&N){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),G=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!$||!$.essential&&D.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:P})),G(this._map.getBearing())&&this._map.resetNorth()):(G($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(t,u){this._map.fire(new a.l(t,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Ky("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Sd extends a.E{constructor(t,u,f){super(),this._renderFrameCallback=()=>{const y=Math.min((D.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=f.bearingSnap,this.cameraHelper=u,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,u){t.apply(this.transform),this.transform=t,this.cameraHelper=u}getCenter(){return new a.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,u){return this.jumpTo({center:t},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,u){return this.jumpTo({elevation:t},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,u,f){return t=a.P.convert(t).mult(-1),this.panTo(this.transform.center,a.e({offset:t},u),f)}panTo(t,u,f){return this.easeTo(a.e({center:t},u),f)}getZoom(){return this.transform.zoom}setZoom(t,u){return this.jumpTo({zoom:t},u),this}zoomTo(t,u,f){return this.easeTo(a.e({zoom:t},u),f)}zoomIn(t,u){return this.zoomTo(this.getZoom()+1,t,u),this}zoomOut(t,u){return this.zoomTo(this.getZoom()-1,t,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,u){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new a.l("movestart",u)).fire(new a.l("move",u)).fire(new a.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(t,u){return this.jumpTo({bearing:t},u),this}getPadding(){return this.transform.padding}setPadding(t,u){return this.jumpTo({padding:t},u),this}rotateTo(t,u,f){return this.easeTo(a.e({bearing:t},u),f)}resetNorth(t,u){return this.rotateTo(0,a.e({duration:1e3},t),u),this}resetNorthPitch(t,u){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},t),u),this}snapToNorth(t,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,u):this}getPitch(){return this.transform.pitch}setPitch(t,u){return this.jumpTo({pitch:t},u),this}getRoll(){return this.transform.roll}setRoll(t,u){return this.jumpTo({roll:t},u),this}cameraForBounds(t,u){t=br.convert(t).adjustAntiMeridian();const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),f,u)}_cameraForBoxAndBearing(t,u,f,y){const v={top:0,bottom:0,right:0,left:0};if(typeof(y=a.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const V=y.padding;y.padding={top:V,bottom:V,right:V,left:V}}const E=a.e(v,y.padding);y.padding=E;const C=this.transform,P=new br(t,u);return this.cameraHelper.cameraForBoxAndBearing(y,E,P,f,C)}fitBounds(t,u,f){return this._fitInternal(this.cameraForBounds(t,u),u,f)}fitScreenCoordinates(t,u,f,y,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(t)),this.transform.screenPointToLocation(a.P.convert(u)),f,y),y,v)}_fitInternal(t,u,f){return t?(delete(u=a.e(t,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(t,u){this.stop();const f=this._getTransformForUpdate();let y=!1,v=!1,E=!1;const C=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,t);const P=f.zoom!==C;return"elevation"in t&&f.elevation!==+t.elevation&&f.setElevation(+t.elevation),"bearing"in t&&f.bearing!==+t.bearing&&(y=!0,f.setBearing(+t.bearing)),"pitch"in t&&f.pitch!==+t.pitch&&(v=!0,f.setPitch(+t.pitch)),"roll"in t&&f.roll!==+t.roll&&(E=!0,f.setRoll(+t.roll)),t.padding==null||f.isPaddingEqual(t.padding)||f.setPadding(t.padding),this._applyUpdatedTransform(f),this.fire(new a.l("movestart",u)).fire(new a.l("move",u)),P&&this.fire(new a.l("zoomstart",u)).fire(new a.l("zoom",u)).fire(new a.l("zoomend",u)),y&&this.fire(new a.l("rotatestart",u)).fire(new a.l("rotate",u)).fire(new a.l("rotateend",u)),v&&this.fire(new a.l("pitchstart",u)).fire(new a.l("pitch",u)).fire(new a.l("pitchend",u)),E&&this.fire(new a.l("rollstart",u)).fire(new a.l("roll",u)).fire(new a.l("rollend",u)),this.fire(new a.l("moveend",u))}calculateCameraOptionsFromTo(t,u,f,y=0){const v=a.a1.fromLngLat(t,u),E=a.a1.fromLngLat(f,y),C=E.x-v.x,P=E.y-v.y,V=E.z-v.z,N=Math.hypot(C,P,V);if(N===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(C,P),G=a.ak(this.transform.cameraToCenterDistance/N/this.transform.tileSize),X=180*Math.atan2(C,-P)/Math.PI;let ie=180*Math.acos($/N)/Math.PI;return ie=V<0?90-ie:90+ie,{center:E.toLngLat(),elevation:y,zoom:G,pitch:ie,bearing:X}}calculateCameraOptionsFromCameraLngLatAltRotation(t,u,f,y,v){const E=this.transform.calculateCenterFromCameraLngLatAlt(t,u,f,y);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:f,pitch:y,roll:v}}easeTo(t,u){this._stop(!1,t.easeId),((t=a.e({offset:[0,0],duration:500,easing:a.co},t)).animate===!1||!t.essential&&D.prefersReducedMotion)&&(t.duration=0);const f=this._getTransformForUpdate(),y=this.getBearing(),v=f.pitch,E=f.roll,C="bearing"in t?this._normalizeBearing(t.bearing,y):y,P="pitch"in t?+t.pitch:v,V="roll"in t?this._normalizeBearing(t.roll,E):E,N="padding"in t?t.padding:f.padding,$=a.P.convert(t.offset);let G,X;t.around&&(G=a.S.convert(t.around),X=f.locationToScreenPoint(G));const ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ue=this.cameraHelper.handleEaseTo(f,{bearing:C,pitch:P,roll:V,padding:N,around:G,aroundPoint:X,offsetAsPoint:$,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||y!==C,this._pitching=this._pitching||P!==v,this._rolling=this._rolling||V!==E,this._padding=!f.isPaddingEqual(N),this._zooming=this._zooming||ue.isZooming,this._easeId=t.easeId,this._prepareEase(u,t.noMoveStart,ie),this.terrain&&this._prepareElevation(ue.elevationCenter),this._ease((ce=>{ue.easeFunc(ce),this.terrain&&!t.freezeElevation&&this._updateElevation(ce),this._applyUpdatedTransform(f),this._fireMoveEvents(u)}),(ce=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ce)}),t),this}_prepareEase(t,u,f={}){this._moving=!0,u||f.moving||this.fire(new a.l("movestart",t)),this._zooming&&!f.zooming&&this.fire(new a.l("zoomstart",t)),this._rotating&&!f.rotating&&this.fire(new a.l("rotatestart",t)),this._pitching&&!f.pitching&&this.fire(new a.l("pitchstart",t)),this._rolling&&!f.rolling&&this.fire(new a.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(f-(u-(f*t+this._elevationStart))/(1-t)),this._elevationTarget=u}this.transform.setElevation(a.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const u=t.getCameraLngLat(),f=t.getCameraAltitude(),y=this.terrain?this.terrain.getElevationForLngLatZoom(u,t.zoom):0;if(f<y){const v=this.calculateCameraOptionsFromTo(u,y,t.center,t.elevation);return{pitch:v.pitch,zoom:v.zoom}}return{}}_applyUpdatedTransform(t){const u=[];if(u.push((y=>this._elevateCameraIfInsideTerrain(y))),this.transformCameraUpdate&&u.push((y=>this.transformCameraUpdate(y))),!u.length)return;const f=t.clone();for(const y of u){const v=f.clone(),{center:E,zoom:C,roll:P,pitch:V,bearing:N,elevation:$}=y(v);E&&v.setCenter(E),$!==void 0&&v.setElevation($),C!==void 0&&v.setZoom(C),P!==void 0&&v.setRoll(P),V!==void 0&&v.setPitch(V),N!==void 0&&v.setBearing(N),f.apply(v)}this.transform.apply(f)}_fireMoveEvents(t){this.fire(new a.l("move",t)),this._zooming&&this.fire(new a.l("zoom",t)),this._rotating&&this.fire(new a.l("rotate",t)),this._pitching&&this.fire(new a.l("pitch",t)),this._rolling&&this.fire(new a.l("roll",t))}_afterEase(t,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,y=this._rotating,v=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new a.l("zoomend",t)),y&&this.fire(new a.l("rotateend",t)),v&&this.fire(new a.l("pitchend",t)),E&&this.fire(new a.l("rollend",t)),this.fire(new a.l("moveend",t))}flyTo(t,u){if(!t.essential&&D.prefersReducedMotion){const it=a.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(it,u)}this.stop(),t=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.co},t);const f=this._getTransformForUpdate(),y=f.bearing,v=f.pitch,E=f.roll,C=f.padding,P="bearing"in t?this._normalizeBearing(t.bearing,y):y,V="pitch"in t?+t.pitch:v,N="roll"in t?this._normalizeBearing(t.roll,E):E,$="padding"in t?t.padding:f.padding,G=a.P.convert(t.offset);let X=f.centerPoint.add(G);const ie=f.screenPointToLocation(X),ue=this.cameraHelper.handleFlyTo(f,{bearing:P,pitch:V,roll:N,padding:$,locationAtOffset:ie,offsetAsPoint:G,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ce=t.curve;const de=Math.max(f.width,f.height),xe=de/ue.scaleOfZoom,Ae=ue.pixelPathLength;typeof ue.scaleOfMinZoom=="number"&&(ce=Math.sqrt(de/ue.scaleOfMinZoom/Ae*2));const Ee=ce*ce;function Ie(it){const xt=(xe*xe-de*de+(it?-1:1)*Ee*Ee*Ae*Ae)/(2*(it?xe:de)*Ee*Ae);return Math.log(Math.sqrt(xt*xt+1)-xt)}function Ue(it){return(Math.exp(it)-Math.exp(-it))/2}function Re(it){return(Math.exp(it)+Math.exp(-it))/2}const Fe=Ie(!1);let st=function(it){return Re(Fe)/Re(Fe+ce*it)},Ye=function(it){return de*((Re(Fe)*(Ue(xt=Fe+ce*it)/Re(xt))-Ue(Fe))/Ee)/Ae;var xt},tt=(Ie(!0)-Fe)/ce;if(Math.abs(Ae)<2e-6||!isFinite(tt)){if(Math.abs(de-xe)<1e-6)return this.easeTo(t,u);const it=xe<de?-1:1;tt=Math.abs(Math.log(xe/de))/ce,Ye=()=>0,st=xt=>Math.exp(it*ce*xt)}return t.duration="duration"in t?+t.duration:1e3*tt/("screenSpeed"in t?+t.screenSpeed/ce:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=y!==P,this._pitching=V!==v,this._rolling=N!==E,this._padding=!f.isPaddingEqual($),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(ue.targetCenter),this._ease((it=>{const xt=it*tt,wt=1/st(xt),ft=Ye(xt);this._rotating&&f.setBearing(a.C.number(y,P,it)),this._pitching&&f.setPitch(a.C.number(v,V,it)),this._rolling&&f.setRoll(a.C.number(E,N,it)),this._padding&&(f.interpolatePadding(C,$,it),X=f.centerPoint.add(G)),ue.easeFunc(it,wt,ft,X),this.terrain&&!t.freezeElevation&&this._updateElevation(it),this._applyUpdatedTransform(f),this._fireMoveEvents(u)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(u)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,u)}return t||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(t,u,f){f.animate===!1||f.duration===0?(t(1),u()):(this._easeStart=D.now(),this._easeOptions=f,this._onEaseFrame=t,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,u){t=a.aO(t,-180,180);const f=Math.abs(t-u);return Math.abs(t-360-u)<f&&(t-=360),Math.abs(t+360-u)<f&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(a.S.convert(t),this.transform.tileZoom):null}}const Kt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class rr{constructor(t=Kt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,u){const f=this._map._getUIString(`AttributionControl.${u}`);t.title=f,t.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((y=>typeof y!="string"?"":y))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const u=this._map.style.sourceCaches;for(const y in u){const v=u[y];if(v.used||v.usedForTerrain){const E=v.getSource();E.attribution&&t.indexOf(E.attribution)<0&&t.push(E.attribution)}}t=t.filter((y=>String(y).trim())),t.sort(((y,v)=>y.length-v.length)),t=t.filter(((y,v)=>{for(let E=v+1;E<t.length;E++)if(t[E].indexOf(y)>=0)return!1;return!0}));const f=t.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,t.length?(this._innerContainer.innerHTML=k.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Dl{constructor(t={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl");const u=k.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Gy{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const u=++this._id;return this._queue.push({callback:t,id:u,cancelled:!1}),u}remove(t){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const y of f)if(y.id===t)return void(y.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Td=a.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class On extends a.E{constructor(t){super(),this._lastTilesetChange=D.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,u){this.sourceCache.update(t,u),this._renderableTilesKeys=[];const f={};for(const y of yr(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.terrainRttPosMatrix32f=new Float64Array(16),a.bZ(y.terrainRttPosMatrix32f,0,a.$,a.$,0,0,1),this._tiles[y.key]=new W(y,this.tileSize),this._lastTilesetChange=D.now());for(const y in this._tiles)f[y]||delete this._tiles[y]}freeRtt(t){for(const u in this._tiles){const f=this._tiles[u];(!t||f.tileID.equals(t)||f.tileID.isChildOf(t)||t.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,u){return u?this._getTerrainCoordsForTileRanges(t,u):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const u={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID,v=t.clone(),E=a.ba();if(y.canonical.equals(t.canonical))a.bZ(E,0,a.$,a.$,0,0,1);else if(y.canonical.isChildOf(t.canonical)){const C=y.canonical.z-t.canonical.z,P=y.canonical.x-(y.canonical.x>>C<<C),V=y.canonical.y-(y.canonical.y>>C<<C),N=a.$>>C;a.bZ(E,0,N,N,0,0,1),a.M(E,E,[-P*N,-V*N,0])}else{if(!t.canonical.isChildOf(y.canonical))continue;{const C=t.canonical.z-y.canonical.z,P=t.canonical.x-(t.canonical.x>>C<<C),V=t.canonical.y-(t.canonical.y>>C<<C),N=a.$>>C;a.bZ(E,0,a.$,a.$,0,0,1),a.M(E,E,[P*N,V*N,0]),a.N(E,E,[1/2**C,1/2**C,0])}}v.terrainRttPosMatrix32f=new Float32Array(E),u[f]=v}return u}_getTerrainCoordsForTileRanges(t,u){const f={};for(const y of this._renderableTilesKeys){const v=this._tiles[y].tileID;if(!this._isWithinTileRanges(v,u))continue;const E=t.clone(),C=a.ba();if(v.canonical.z===t.canonical.z){const P=t.canonical.x-v.canonical.x,V=t.canonical.y-v.canonical.y;a.bZ(C,0,a.$,a.$,0,0,1),a.M(C,C,[P*a.$,V*a.$,0])}else if(v.canonical.z>t.canonical.z){const P=v.canonical.z-t.canonical.z,V=v.canonical.x-(v.canonical.x>>P<<P),N=v.canonical.y-(v.canonical.y>>P<<P),$=t.canonical.x-(v.canonical.x>>P),G=t.canonical.y-(v.canonical.y>>P),X=a.$>>P;a.bZ(C,0,X,X,0,0,1),a.M(C,C,[-V*X+$*a.$,-N*X+G*a.$,0])}else{const P=t.canonical.z-v.canonical.z,V=t.canonical.x-(t.canonical.x>>P<<P),N=t.canonical.y-(t.canonical.y>>P<<P),$=(t.canonical.x>>P)-v.canonical.x,G=(t.canonical.y>>P)-v.canonical.y,X=a.$<<P;a.bZ(C,0,X,X,0,0,1),a.M(C,C,[V*a.$+$*X,N*a.$+G*X,0])}E.terrainRttPosMatrix32f=new Float32Array(C),f[y]=E}return f}getSourceTile(t,u){const f=this.sourceCache._source;let y=t.overscaledZ-this.deltaZoom;if(y>f.maxzoom&&(y=f.maxzoom),y<f.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(y).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!v||!v.dem)&&u)for(;y>=f.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(t.scaledTo(y--).key);return v}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,u){return u[t.canonical.z]&&t.canonical.x>=u[t.canonical.z].minTileX&&t.canonical.x<=u[t.canonical.z].maxTileX&&t.canonical.y>=u[t.canonical.z].minTileY&&t.canonical.y<=u[t.canonical.z].maxTileY}}class $y{constructor(t,u,f){this._meshCache={},this.painter=t,this.sourceCache=new On(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,u,f,y=a.$){var v;if(!(u>=0&&u<y&&f>=0&&f<y))return 0;const E=this.getTerrainData(t),C=(v=E.tile)===null||v===void 0?void 0:v.dem;if(!C)return 0;const P=a.cs([],[u/y*a.$,f/y*a.$],E.u_terrain_matrix),V=[P[0]*C.dim,P[1]*C.dim],N=Math.floor(V[0]),$=Math.floor(V[1]),G=V[0]-N,X=V[1]-$;return C.get(N,$)*(1-G)*(1-X)+C.get(N+1,$)*G*(1-X)+C.get(N,$+1)*(1-G)*X+C.get(N+1,$+1)*G*X}getElevationForLngLatZoom(t,u){if(!a.ct(u,t.wrap()))return 0;const{tileID:f,mercatorX:y,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(t,u);return this.getElevation(f,y%a.$,v%a.$,a.$)}getElevation(t,u,f,y=a.$){return this.getDEMElevation(t,u,f,y)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const y=this.painter.context,v=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(y,v,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(y,new a.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ag([])}const u=this.sourceCache.getSourceTile(t,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const y=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new a.T(y,u.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),u.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+t.key;if(f&&!this._demMatrixCache[f]){const y=this.sourceCache.sourceCache._source.maxzoom;let v=t.canonical.z-u.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=y?v=t.canonical.z-y:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=t.canonical.x-(t.canonical.x>>v<<v),C=t.canonical.y-(t.canonical.y>>v<<v),P=a.cu(new Float64Array(16),[1/(a.$<<v),1/(a.$<<v),0]);a.M(P,P,[E*a.$,C*a.$,0]),this._demMatrixCache[t.key]={matrix:P,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(t){const u=this.painter,f=u.width/devicePixelRatio,y=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(u.context,{width:f,height:y,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(u.context,{width:f,height:y,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,y,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,y))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,E=0;v<this._coordsTextureSize;v++)for(let C=0;C<this._coordsTextureSize;C++,E+=4)u[E+0]=255&C,u[E+1]=255&v,u[E+2]=C>>8<<4|v>>8,u[E+3]=0;const f=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),y=new a.T(t,f,t.gl.RGBA,{premultiply:!1});return y.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,y=f.gl,v=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(v,C-E-1,1,1,y.RGBA,y.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const P=u[0]+(u[2]>>4<<8),V=u[1]+((15&u[2])<<8),N=this.coordsIndex[255-u[3]],$=N&&this.sourceCache.getTileByID(N);if(!$)return null;const G=this._coordsTextureSize,X=(1<<$.tileID.canonical.z)*G;return new a.a1(($.tileID.canonical.x*G+P)/X+$.tileID.wrap,($.tileID.canonical.y*G+V)/X,this.getElevation($.tileID,P,V,G))}depthAtPoint(t){const u=new Uint8Array(4),f=this.painter.context,y=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),y.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(t){var u;const f=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,y=f&&t.canonical.y===0,v=f&&t.canonical.y===(1<<t.canonical.z)-1,E=`m_${y?"n":""}_${v?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const C=this.painter.context,P=new a.cv,V=new a.aN,N=this.meshSize,$=a.$/N,G=N*N;for(let Re=0;Re<=N;Re++)for(let Fe=0;Fe<=N;Fe++)P.emplaceBack(Fe*$,Re*$,0);for(let Re=0;Re<G;Re+=N+1)for(let Fe=0;Fe<N;Fe++)V.emplaceBack(Fe+Re,N+Fe+Re+1,N+Fe+Re+2),V.emplaceBack(Fe+Re,N+Fe+Re+2,Fe+Re+1);const X=P.length,ie=X+(N+1),ue=(N+1)*N,ce=y?a.bh:0,de=y?0:1,xe=v?a.bi:a.$,Ae=v?0:1;for(let Re=0;Re<=N;Re++)P.emplaceBack(Re*$,ce,de);for(let Re=0;Re<=N;Re++)P.emplaceBack(Re*$,xe,Ae);for(let Re=0;Re<N;Re++)V.emplaceBack(ue+Re,ie+Re,ie+Re+1),V.emplaceBack(ue+Re,ie+Re+1,ue+Re+1),V.emplaceBack(0+Re,X+Re+1,X+Re),V.emplaceBack(0+Re,0+Re+1,X+Re+1);const Ee=P.length,Ie=Ee+2*(N+1);for(const Re of[0,1])for(let Fe=0;Fe<=N;Fe++)for(const st of[0,1])P.emplaceBack(Re*a.$,Fe*$,st);for(let Re=0;Re<2*N;Re+=2)V.emplaceBack(Ee+Re,Ee+Re+1,Ee+Re+3),V.emplaceBack(Ee+Re,Ee+Re+3,Ee+Re+2),V.emplaceBack(Ie+Re,Ie+Re+3,Ie+Re+1),V.emplaceBack(Ie+Re,Ie+Re+2,Ie+Re+3);const Ue=new Xo(C.createVertexBuffer(P,Td.members),C.createIndexBuffer(V),a.aM.simpleSegment(0,0,P.length,V.length));return this._meshCache[E]=Ue,Ue}getMeshFrameDelta(t){return 2*Math.PI*a.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,u){var f;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(t,u);return(f=this.getMinMaxElevation(y).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(t){const u=this.getTerrainData(t).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(t,u){const f=a.a1.fromLngLat(t.wrap()),y=(1<<u)*a.$,v=f.x*y,E=f.y*y,C=Math.floor(v/a.$),P=Math.floor(E/a.$);return{tileID:new a.Z(u,0,u,C,P),mercatorX:v,mercatorY:E}}}class js{constructor(t,u,f){this._context=t,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:t,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((u=>t.id!==u)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const ja={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class M0{constructor(t,u){this.painter=t,this.terrain=u,this.pool=new js(t.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((f=>!t._layers[f].isHidden(u))),this._coordsAscending={};for(const f in t.sourceCaches){this._coordsAscending[f]={};const y=t.sourceCaches[f].getVisibleCoordinates(),v=t.sourceCaches[f].getSource(),E=v instanceof er?v.terrainTileRanges:null;for(const C of y){const P=this.terrain.sourceCache.getTerrainCoords(C,E);for(const V in P)this._coordsAscending[f][V]||(this._coordsAscending[f][V]=[]),this._coordsAscending[f][V].push(P[V])}}this._coordsAscendingStr={};for(const f of t._order){const y=t._layers[f],v=y.source;if(ja[y.type]&&!this._coordsAscendingStr[v]){this._coordsAscendingStr[v]={};for(const E in this._coordsAscending[v])this._coordsAscendingStr[v][E]=this._coordsAscending[v][E].map((C=>C.key)).sort().join()}}for(const f of this._renderableTiles)for(const y in this._coordsAscendingStr){const v=this._coordsAscendingStr[y][f.tileID.key];v&&v!==f.rttCoords[y]&&(f.rtt=[])}}renderLayer(t,u){if(t.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),y=t.type,v=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(ja[y]&&(this._prevType&&ja[this._prevType]||this._stacks.push([]),this._prevType=y,this._stacks[this._stacks.length-1].push(t.id),!E))return!0;if(ja[this._prevType]||ja[y]&&E){this._prevType=y;const C=this._stacks.length-1,P=this._stacks[C]||[];for(const V of this._renderableTiles){if(this.pool.isFull()&&(xd(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[C]){const $=this.pool.getObjectForId(V.rtt[C].id);if($.stamp===V.rtt[C].stamp){this.pool.useObject($);continue}}const N=this.pool.getOrCreateFreeObject();this.pool.useObject(N),this.pool.stampObject(N),V.rtt[C]={id:N.id,stamp:N.stamp},v.context.bindFramebuffer.set(N.fbo.framebuffer),v.context.clear({color:a.bf.transparent,stencil:0}),v.currentStencilSource=void 0;for(let $=0;$<P.length;$++){const G=v.style._layers[P[$]],X=G.source?this._coordsAscending[G.source][V.tileID.key]:[V.tileID];v.context.viewport.set([0,0,N.fbo.width,N.fbo.height]),v._renderTileClippingMasks(G,X,!0),v.renderLayer(v,v.style.sourceCaches[G.source],G,X,f),G.source&&(V.rttCoords[G.source]=this._coordsAscendingStr[G.source][V.tileID.key])}}return xd(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),ja[y]}return!1}}const z0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},O0=g,Il={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Kt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ai={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Mi{constructor(t,u,f=!1){this.mousedown=v=>{this.startMove(v,k.mousePos(this.element,v)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=v=>{this.move(v,k.mousePos(this.element,v))},this.mouseup=v=>{this._rotatePitchHandler.dragEnd(v),this.offTemp()},this.touchstart=v=>{v.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,v.targetTouches)[0],this.startMove(v,this._startPos),k.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.addEventListener(window,"touchend",this.touchend))},this.touchmove=v=>{v.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,v.targetTouches)[0],this.move(v,this._lastPos))},this.touchend=v=>{v.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const y=new th;this._rotatePitchHandler=new Vu({clickTolerance:3,move:(v,E)=>{const C=u.getBoundingClientRect(),P=new a.P((C.bottom-C.top)/2,(C.right-C.left)/2);return{bearingDelta:a.cn(new a.P(v.x,E.y),E,P),pitchDelta:f?-.5*(E.y-v.y):void 0}},moveStateManager:y,enable:!0,assignEvents:()=>{}}),this.map=t,k.addEventListener(u,"mousedown",this.mousedown),k.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(u,"touchcancel",this.reset)}startMove(t,u){this._rotatePitchHandler.dragStart(t,u),k.disableDrag()}move(t,u){const f=this.map,{bearingDelta:y,pitchDelta:v}=this._rotatePitchHandler.dragMove(t,u)||{};y&&f.setBearing(f.getBearing()+y),v&&f.setPitch(f.getPitch()+v)}off(){const t=this.element;k.removeEventListener(t,"mousedown",this.mousedown),k.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend),k.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend)}}let ea;function Bl(_,t,u,f=!1){if(f||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return _?.wrap();const y=new a.S(_.lng,_.lat);if(_=new a.S(_.lng,_.lat),t){const v=new a.S(_.lng-360,_.lat),E=new a.S(_.lng+360,_.lat),C=u.locationToScreenPoint(_).distSqr(t);u.locationToScreenPoint(v).distSqr(t)<C?_=v:u.locationToScreenPoint(E).distSqr(t)<C&&(_=E)}for(;Math.abs(_.lng-u.center.lng)>180;){const v=u.locationToScreenPoint(_);if(v.x>=0&&v.y>=0&&v.x<=u.width&&v.y<=u.height)break;_.lng>u.center.lng?_.lng-=360:_.lng+=360}return _.lng!==y.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(_))?_:y}const Ml={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Cd(_,t,u){const f=_.classList;for(const y in Ml)f.remove(`maplibregl-${u}-anchor-${y}`);f.add(`maplibregl-${u}-anchor-${t}`)}class Ku extends a.E{constructor(t){if(super(),this._onKeyPress=u=>{const f=u.code,y=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=Bl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${Ml[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${y}`),D.frameAsync(new AbortController).then((()=>{this._updateOpacity(u&&u.type==="moveend")})).catch((()=>{}))},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=a.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div");const u=k.createNS("http://www.w3.org/2000/svg","svg"),f=41,y=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${y}px`),u.setAttributeNS(null,"viewBox",`0 0 ${y} ${f}`);const v=k.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const E=k.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const C=k.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of P){const xe=k.createNS("http://www.w3.org/2000/svg","ellipse");xe.setAttributeNS(null,"opacity","0.04"),xe.setAttributeNS(null,"cx","10.5"),xe.setAttributeNS(null,"cy","5.80029008"),xe.setAttributeNS(null,"rx",de.rx),xe.setAttributeNS(null,"ry",de.ry),C.appendChild(xe)}const V=k.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const N=k.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(N);const $=k.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const G=k.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(G);const X=k.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const ie=k.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=k.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const ce=k.createNS("http://www.w3.org/2000/svg","circle");ce.setAttributeNS(null,"fill","#FFFFFF"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962"),ie.appendChild(ue),ie.appendChild(ce),E.appendChild(C),E.appendChild(V),E.appendChild($),E.appendChild(X),E.appendChild(ie),u.appendChild(E),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(u),this._offset=a.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(u=>{u.preventDefault()})),this._element.addEventListener("mousedown",(u=>{u.preventDefault()})),Cd(this._element,this._anchor,"marker"),t&&t.className)for(const u of t.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=a.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const y=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var u,f;const y=(u=this._map)===null||u===void 0?void 0:u.terrain,v=this._map.transform.isLocationOccluded(this._lngLat);if(!y||v){const X=v?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==X&&(this._element.style.opacity=X))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const E=this._map,C=E.terrain.depthAtPoint(this._pos),P=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,P)-C<.006)return void(this._element.style.opacity=this._opacity);const V=-this._offset.y/E.transform.pixelsPerMeter,N=Math.sin(E.getPitch()*Math.PI/180)*V,$=E.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),G=E.transform.lngLatToCameraDepth(this._lngLat,P+N)-$>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&G&&this._popup.remove(),this._element.style.opacity=G?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=a.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,u){return(this._opacity===void 0||t===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const sh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ta=0,Na=!1;const oh={maxWidth:100,unit:"metric"};function kd(_,t,u){const f=u&&u.maxWidth||100,y=_._container.clientHeight/2,v=_._container.clientWidth/2,E=_.unproject([v-f/2,y]),C=_.unproject([v+f/2,y]),P=Math.round(_.project(C).x-_.project(E).x),V=Math.min(f,P,_._container.clientWidth),N=E.distanceTo(C);if(u&&u.unit==="imperial"){const $=3.2808*N;$>5280?Fa(t,V,$/5280,_._getUIString("ScaleControl.Miles")):Fa(t,V,$,_._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Fa(t,V,N/1852,_._getUIString("ScaleControl.NauticalMiles")):N>=1e3?Fa(t,V,N/1e3,_._getUIString("ScaleControl.Kilometers")):Fa(t,V,N,_._getUIString("ScaleControl.Meters"))}function Fa(_,t,u,f){const y=(function(v){const E=Math.pow(10,`${Math.floor(v)}`.length-1);let C=v/E;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:(function(P){const V=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*V)/V})(C),E*C})(u);_.style.width=t*(y/u)+"px",_.innerHTML=`${y}&nbsp;${f}`}const ah={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},lh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pd(_){if(_){if(typeof _=="number"){const t=Math.round(Math.abs(_)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,_),"top-left":new a.P(t,t),"top-right":new a.P(-t,t),bottom:new a.P(0,-_),"bottom-left":new a.P(t,-t),"bottom-right":new a.P(-t,-t),left:new a.P(_,0),right:new a.P(-_,0)}}if(_ instanceof a.P||Array.isArray(_)){const t=a.P.convert(_);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:a.P.convert(_.center||[0,0]),top:a.P.convert(_.top||[0,0]),"top-left":a.P.convert(_["top-left"]||[0,0]),"top-right":a.P.convert(_["top-right"]||[0,0]),bottom:a.P.convert(_.bottom||[0,0]),"bottom-left":a.P.convert(_["bottom-left"]||[0,0]),"bottom-right":a.P.convert(_["bottom-right"]||[0,0]),left:a.P.convert(_.left||[0,0]),right:a.P.convert(_.right||[0,0])}}return Pd(new a.P(0,0))}const uh=g;e.AJAXError=a.cz,e.Event=a.l,e.Evented=a.E,e.LngLat=a.S,e.MercatorCoordinate=a.a1,e.Point=a.P,e.addProtocol=a.cA,e.config=a.a,e.removeProtocol=a.cB,e.AttributionControl=rr,e.BoxZoomHandler=Ss,e.CanvasSource=Lr,e.CooperativeGesturesHandler=ih,e.DoubleClickZoomHandler=Fy,e.DragPanHandler=qy,e.DragRotateHandler=Fu,e.EdgeInsets=$e,e.FullscreenControl=class extends a.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var t;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=u?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=Ct,e.GeolocateControl=class extends a.E{constructor(_){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const u=new a.S(t.coords.longitude,t.coords.latitude),f=t.coords.accuracy,y=this._map.getBearing(),v=a.e({bearing:y},this.options.fitBoundsOptions),E=br.fromLngLat(u,f);this._map.fitBounds(E,v,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const u=new a.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Na)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ku({element:this._dotElement}),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ku({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(u=>{const f=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))}))}},this.options=a.e({},sh,_)}onAdd(_){return this._map=_,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return a._(this,arguments,void 0,(function*(t=!1){if(ea!==void 0&&!t)return ea;if(window.navigator.permissions===void 0)return ea=!!window.navigator.geolocation,ea;try{ea=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ea=!!window.navigator.geolocation}return ea}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ta=0,Na=!1}_isOutOfMapMaxBounds(_){const t=this._map.getMaxBounds(),u=_.coords;return t&&(u.longitude<t.getWest()||u.longitude>t.getEast()||u.latitude<t.getSouth()||u.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const _=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&_))return;const t=this._map.project(_),u=this._map.unproject([t.x+100,t.y]),f=_.distanceTo(u)/100,y=2*this._accuracy/f;this._circleElement.style.width=`${y.toFixed(2)}px`,this._circleElement.style.height=`${y.toFixed(2)}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ta--,Na=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ta++,ta>1?(_={maximumAge:6e5,timeout:0},Na=!0):(_=this.options.positionOptions,Na=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.GlobeControl=class{constructor(){this._toggleProjection=()=>{var _;const t=(_=this._map.getProjection())===null||_===void 0?void 0:_.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var _;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((_=this._map.getProjection())===null||_===void 0?void 0:_.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(_){return this._map=_,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=k.create("button","maplibregl-ctrl-globe",this._container),k.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},e.Hash=Jf,e.ImageSource=er,e.KeyboardHandler=Ad,e.LngLatBounds=br,e.LogoControl=Dl,e.Map=class extends Sd{constructor(_){var t,u;a.cw.mark(a.cx.create);const f=Object.assign(Object.assign(Object.assign({},Il),_),{canvasContextAttributes:Object.assign(Object.assign({},Il.canvasContextAttributes),_.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const y=new ml,v=new vu;if(f.minZoom!==void 0&&y.setMinZoom(f.minZoom),f.maxZoom!==void 0&&y.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&y.setMinPitch(f.minPitch),f.maxPitch!==void 0&&y.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&y.setRenderWorldCopies(f.renderWorldCopies),super(y,v,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Gy,this._controls=[],this._mapId=a.a7(),this._contextLost=C=>{C.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:C}))},this._contextRestored=C=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:C}))},this._onMapScroll=C=>{if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},z0),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Q.addThrottleControl((()=>this.isMoving())),this._requestManager=new Te(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let C=!1;const P=Yf((V=>{this._trackResize&&!this._removed&&(this.resize(V),this.redraw())}),50);this._resizeObserver=new ResizeObserver((V=>{C?P(V):C=!0})),this._resizeObserver.observe(this._container)}this.handlers=new uo(this,f),this._hash=f.hash&&new Jf(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,a.e({},f.fitBoundsOptions,{duration:0}))));const E=typeof f.style=="string"||((u=(t=f.style)===null||t===void 0?void 0:t.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new rr(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Dl,f.logoPosition),this.on("style.load",(()=>{if(E||this._resizeTransform(),this.transform.unmodified){const C=a.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(C)}})),this.on("data",(C=>{this._update(C.dataType==="style"),this.fire(new a.l(`${C.dataType}data`,C))})),this.on("dataloading",(C=>{this.fire(new a.l(`${C.dataType}dataloading`,C))})),this.on("dataabort",(C=>{this.fire(new a.l("sourcedataabort",C))}))}_getMapId(){return this._mapId}setGlobalStateProperty(_,t){return this.style.setGlobalStateProperty(_,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(_,t){if(t===void 0&&(t=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=_.onAdd(this);this._controls.push(_);const f=this._controlPositions[t];return t.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(_);return t>-1&&this._controls.splice(t,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}coveringTiles(_){return yr(this.transform,_)}calculateCameraOptionsFromTo(_,t,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,t,u,f)}resize(_,t=!0){const[u,f]=this._containerDimensions(),y=this._getClampedPixelRatio(u,f);if(this._resizeCanvas(u,f,y),this.painter.resize(u,f,y),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const C=this._getClampedPixelRatio(u,f);this._resizeCanvas(u,f,C),this.painter.resize(u,f,C)}this._resizeTransform(t);const v=!this._moving;return v&&(this.stop(),this.fire(new a.l("movestart",_)).fire(new a.l("move",_))),this.fire(new a.l("resize",_)),v&&this.fire(new a.l("moveend",_)),this}_resizeTransform(_=!0){var t;const[u,f]=this._containerDimensions();this.transform.resize(u,f,_),(t=this._requestedCameraState)===null||t===void 0||t.resize(u,f,_)}_getClampedPixelRatio(_,t){const{0:u,1:f}=this._maxCanvasSize,y=this.getPixelRatio(),v=_*y,E=t*y;return Math.min(v>u?u/v:1,E>f?f/E:1)*y}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(br.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.setMinZoom(_),this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.setMaxZoom(_),this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.setMinPitch(_),this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(_>=this.transform.minPitch)return this.transform.setMaxPitch(_),this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.setRenderWorldCopies(_),this._update()}project(_){return this.transform.locationToScreenPoint(a.S.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.screenPointToLocation(a.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,t,u){if(_==="mouseenter"||_==="mouseover"){let f=!1;return{layers:t,listener:u,delegates:{mousemove:v=>{const E=t.filter((P=>this.getLayer(P))),C=E.length!==0?this.queryRenderedFeatures(v.point,{layers:E}):[];C.length?f||(f=!0,u.call(this,new Xn(_,this,v.originalEvent,{features:C}))):f=!1},mouseout:()=>{f=!1}}}}if(_==="mouseleave"||_==="mouseout"){let f=!1;return{layers:t,listener:u,delegates:{mousemove:E=>{const C=t.filter((P=>this.getLayer(P)));(C.length!==0?this.queryRenderedFeatures(E.point,{layers:C}):[]).length?f=!0:f&&(f=!1,u.call(this,new Xn(_,this,E.originalEvent)))},mouseout:E=>{f&&(f=!1,u.call(this,new Xn(_,this,E.originalEvent)))}}}}{const f=y=>{const v=t.filter((C=>this.getLayer(C))),E=v.length!==0?this.queryRenderedFeatures(y.point,{layers:v}):[];E.length&&(y.features=E,u.call(this,y),delete y.features)};return{layers:t,listener:u,delegates:{[_]:f}}}}_saveDelegatedListener(_,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(t)}_removeDelegatedListener(_,t,u){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const f=this._delegatedListeners[_];for(let y=0;y<f.length;y++){const v=f[y];if(v.listener===u&&v.layers.length===t.length&&v.layers.every((E=>t.includes(E)))){for(const E in v.delegates)this.off(E,v.delegates[E]);return void f.splice(y,1)}}}on(_,t,u){if(u===void 0)return super.on(_,t);const f=typeof t=="string"?[t]:t,y=this._createDelegatedListener(_,f,u);this._saveDelegatedListener(_,y);for(const v in y.delegates)this.on(v,y.delegates[v]);return{unsubscribe:()=>{this._removeDelegatedListener(_,f,u)}}}once(_,t,u){if(u===void 0)return super.once(_,t);const f=typeof t=="string"?[t]:t,y=this._createDelegatedListener(_,f,u);for(const v in y.delegates){const E=y.delegates[v];y.delegates[v]=(...C)=>{this._removeDelegatedListener(_,f,u),E(...C)}}this._saveDelegatedListener(_,y);for(const v in y.delegates)this.once(v,y.delegates[v]);return this}off(_,t,u){return u===void 0?super.off(_,t):(this._removeDelegatedListener(_,typeof t=="string"?[t]:t,u),this)}queryRenderedFeatures(_,t){if(!this.style)return[];let u;const f=_ instanceof a.P||Array.isArray(_),y=f?_:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(f?{}:_)||{},y instanceof a.P||typeof y[0]=="number")u=[a.P.convert(y)];else{const v=a.P.convert(y[0]),E=a.P.convert(y[1]);u=[v,new a.P(E.x,v.y),E,new a.P(v.x,E.y),v]}return this.style.queryRenderedFeatures(u,t,this.transform)}querySourceFeatures(_,t){return this.style.querySourceFeatures(_,t)}setStyle(_,t){return(t=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(_,t))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const t=this._locale[_];if(t==null)throw new Error(`Missing UI string '${_}'`);return t}_updateStyle(_,t){var u,f;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(_,t)));const y=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new kf(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,t,y):this.style.loadJSON(_,t,y),this):((f=(u=this.style)===null||u===void 0?void 0:u.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new kf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,t){if(typeof _=="string"){const u=this._requestManager.transformRequest(_,"Style");a.j(u,new AbortController).then((f=>{this._updateDiff(f.data,t)})).catch((f=>{f&&this.fire(new a.k(f))}))}else typeof _=="object"&&this._updateDiff(_,t)}_updateDiff(_,t){try{this.style.setState(_,t)&&this._update(!0)}catch(u){a.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(_,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(_,t){return this._lazyInitEmptyStyle(),this.style.addSource(_,t),this._update(!0)}isSourceLoaded(_){const t=this.style&&this.style.sourceCaches[_];if(t!==void 0)return t.loaded();this.fire(new a.k(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const t=this.style.sourceCaches[_.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&t.reload();for(const u in this.style._layers){const f=this.style._layers[u];f.type==="hillshade"&&f.source===_.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===_.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new $y(this.painter,t,_),this.painter.renderToTexture=new M0(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var f;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==_.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=u.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:_})),this}getTerrain(){var _,t;return(t=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const t in _){const u=_[t]._tiles;for(const f in u){const y=u[f];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}setSourceTileLodParams(_,t,u){if(u){const f=this.getSource(u);if(!f)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);f.calculateTileZoom=Mt(Math.max(1,_),Math.max(1,t))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Mt(Math.max(1,_),Math.max(1,t));return this._update(!0),this}refreshTiles(_,t){const u=this.style.sourceCaches[_];if(!u)throw new Error(`There is no source cache with ID "${_}", cannot refresh tile`);t===void 0?u.reload(!0):u.refreshTiles(t.map((f=>new a.a4(f.z,f.x,f.y))))}addImage(_,t,u={}){const{pixelRatio:f=1,sdf:y=!1,stretchX:v,stretchY:E,content:C,textFitWidth:P,textFitHeight:V}=u;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||a.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:$,data:G}=t,X=t;return this.style.addImage(_,{data:new a.R({width:N,height:$},new Uint8Array(G)),pixelRatio:f,stretchX:v,stretchY:E,content:C,textFitWidth:P,textFitHeight:V,sdf:y,version:0,userImage:X}),X.onAdd&&X.onAdd(this,_),this}}{const{width:N,height:$,data:G}=D.getImageData(t);this.style.addImage(_,{data:new a.R({width:N,height:$},G),pixelRatio:f,stretchX:v,stretchY:E,content:C,textFitWidth:P,textFitHeight:V,sdf:y,version:0})}}updateImage(_,t){const u=this.style.getImage(_);if(!u)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=t instanceof HTMLImageElement||a.b(t)?D.getImageData(t):t,{width:y,height:v,data:E}=f;if(y===void 0||v===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==u.data.width||v!==u.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(t instanceof HTMLImageElement||a.b(t));return u.data.replace(E,C),this.style.updateImage(_,u),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return Q.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,t){return this._lazyInitEmptyStyle(),this.style.addLayer(_,t),this._update(!0)}moveLayer(_,t){return this.style.moveLayer(_,t),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,t,u){return this.style.setLayerZoomRange(_,t,u),this._update(!0)}setFilter(_,t,u={}){return this.style.setFilter(_,t,u),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,t,u,f={}){return this.style.setPaintProperty(_,t,u,f),this._update(!0)}getPaintProperty(_,t){return this.style.getPaintProperty(_,t)}setLayoutProperty(_,t,u,f={}){return this.style.setLayoutProperty(_,t,u,f),this._update(!0)}getLayoutProperty(_,t){return this.style.getLayoutProperty(_,t)}setGlyphs(_,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,t,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,t,u,(f=>{f||this._update(!0)})),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,t,(u=>{u||this._update(!0)})),this}setLight(_,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(_,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,t){return this.style.setFeatureState(_,t),this._update()}removeFeatureState(_,t){return this.style.removeFeatureState(_,t),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,t=0;return this._container&&(_=this._container.clientWidth||400,t=this._container.clientHeight||300),[_,t]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const t=this._canvasContainer=k.create("div","maplibregl-canvas-container",_);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const y=this._controlContainer=k.create("div","maplibregl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((E=>{v[E]=k.create("div",`maplibregl-ctrl-${E} `,y)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,t,u){this._canvas.width=Math.floor(u*_),this._canvas.height=Math.floor(u*t),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const _=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(f=>{t={requestedAttributes:_},f&&(t.statusMessage=f.statusMessage,t.type=f.type)}),{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,_):this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_),!u){const f="Failed to initialize WebGL";throw t?(t.message=f,new Error(JSON.stringify(t))):new Error(f)}this.painter=new Ty(u,this.transform),B.testSupport(u)}migrateProjection(_,t){super.migrateProjection(_,t),this.painter.transform=_,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){var t,u,f,y,v;const E=this._idleTriggered?this._fadeDuration:0,C=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,G=D.now();this.style.zoomHistory.update($,G);const X=new a.F($,{now:G,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ie=X.crossFadingFactor();ie===1&&ie===this._crossFadingFactor||(P=!0,this._crossFadingFactor=ie),this.style.update(X)}const V=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==C;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((y=this.style.projection)===null||y===void 0?void 0:y.transitionState,(v=this.style.projection)===null||v===void 0?void 0:v.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||V)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,V),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cw.mark(a.cx.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const N=this._sourcesDirty||this._styleDirty||this._placementDirty;return N||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,a.cw.mark(a.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Q.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cw.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,D.frame(this._frameRequest,(_=>{a.cw.frame(_),this._frameRequest=null;try{this._render(_)}catch(t){if(!a.cy(t)&&!(function(u){return u.message===Kf})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return O0}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(_){return this._lazyInitEmptyStyle(),this.style.setProjection(_),this._update(!0)}},e.MapMouseEvent=Xn,e.MapTouchEvent=Yo,e.MapWheelEvent=Qf,e.Marker=Ku,e.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const t=this._map.getZoom(),u=t===this._map.getMaxZoom(),f=t===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);t.title=f,t.setAttribute("aria-label",f)},this.options=a.e({},Ai,_),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),k.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),k.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=k.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mi(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,t){const u=k.create("button",_,this._container);return u.type="button",u.addEventListener("click",t),u}},e.Popup=class extends a.E{constructor(_){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=k.create("div","maplibregl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Bl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const u=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const y=Pd(this.options.offset);if(!f){const E=this._container.offsetWidth,C=this._container.offsetHeight;let P;P=u.y+y.bottom.y<C?["top"]:u.y>this._map.transform.height-C?["bottom"]:[],u.x<E/2?P.push("left"):u.x>this._map.transform.width-E/2&&P.push("right"),f=P.length===0?"bottom":P.join("-")}let v=u.add(y[f]);this.options.subpixelPositioning||(v=v.round()),k.setTransform(this._container,`${Ml[f]} translate(${v.x}px,${v.y}px)`),Cd(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(ah),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=a.S.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const t=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=_;f=u.firstChild,f;)t.appendChild(f);return this.setDOMContent(t)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(lh);_&&_.focus()}},e.RasterDEMTileSource=Pr,e.RasterTileSource=Vt,e.ScaleControl=class{constructor(_){this._onMove=()=>{kd(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,kd(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},oh),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=Ny,e.Style=kf,e.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=zy,e.TwoFingersTouchRotateHandler=Ed,e.TwoFingersTouchZoomHandler=wd,e.TwoFingersTouchZoomRotateHandler=Rd,e.VectorTileSource=Xr,e.VideoSource=or,e.addSourceType=(_,t)=>a._(void 0,void 0,void 0,(function*(){if(bt(_))throw new Error(`A source type called "${_}" already exists.`);((u,f)=>{Jr[u]=f})(_,t)})),e.clearPrewarmedResources=function(){const _=Le;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(be),Le=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.createTileMesh=wu,e.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return vt().getRTLTextPluginStatus()},e.getVersion=function(){return uh},e.getWorkerCount=function(){return Ft.workerCount},e.getWorkerUrl=function(){return a.a.WORKER_URL},e.importScriptInWorkers=function(_){return qr().broadcast("IS",_)},e.prewarm=function(){Tt().acquire(be)},e.setMaxParallelImageRequests=function(_){a.a.MAX_PARALLEL_IMAGE_REQUESTS=_},e.setRTLTextPlugin=function(_,t){return vt().setRTLTextPlugin(_,t)},e.setWorkerCount=function(_){Ft.workerCount=_},e.setWorkerUrl=function(_){a.a.WORKER_URL=_}}));var m=s;return m}))})(xv)),xv.exports}var dj=cj();const to=wB(dj);function pj(r){return Object.fromEntries(Object.entries(r).filter(([i,s])=>s!=null))}nw(["click"]);function fj(r,i){mn(i,!0);const s=Hr(wf),c=Hr(()=>Pe(s).map),d=Hr(()=>Pe(s).loaded);let m=St(i,"position",3,"top-left"),e=St(i,"container",3,void 0),a=Ar(void 0),g=Hr(()=>typeof e()=="string"?document.querySelector(e())??void 0:e());xi(()=>{Pe(c)&&!Pe(a)&&(Pe(g)?Xt(a,new to.FullscreenControl({container:Pe(g)}),!0):Xt(a,new to.FullscreenControl,!0),Pe(c).addControl(Pe(a),m()))}),Bc(()=>{Pe(d)&&Pe(a)&&Pe(c)?.removeControl(Pe(a))}),yn()}function hj(r,i){mn(i,!0);const s=Hr(wf),c=Hr(()=>Pe(s).map),d=Hr(()=>Pe(s).loaded);let m=St(i,"position",3,"top-left"),e=St(i,"positionOptions",3,void 0),a=St(i,"fitBoundsOptions",3,void 0),g=St(i,"trackUserLocation",3,!1),w=St(i,"showAccuracyCircle",3,!0),R=St(i,"showUserLocation",3,!0),S=St(i,"control",15);xi(()=>{Pe(c)&&!S()&&(S(new to.GeolocateControl({positionOptions:e(),fitBoundsOptions:a(),trackUserLocation:g(),showAccuracyCircle:w(),showUserLocation:R()})),Pe(c).addControl(S(),m()))}),Bc(()=>{Pe(d)&&S()&&Pe(c)?.removeControl(S())}),yn()}function mj(r){let i=r.getCenter(),s=Math.round(r.getZoom()*100)/100,c=Math.ceil((s*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,c),m=Math.round(i.lat*d)/d,e=Math.round(i.lng*d)/d,a=`${s}/${m}/${e}`,g=r.getBearing(),w=r.getPitch();return(g||w)&&(a+=`/${Math.round(g*10)/10}`),w&&(a+=`/${Math.round(w)}`),`#${a}`}function yj(r){const i=r.replace("#","").split("/").map(parseFloat);return i.some(isNaN)?[]:i}var Bh=vw;function vw(r,i){return r===i||r!==r&&i!==i?!0:typeof r!=typeof i||{}.toString.call(r)!={}.toString.call(i)||r!==Object(r)||!r?!1:Array.isArray(r)?XA(r,i):{}.toString.call(r)=="[object Set]"?XA(Array.from(r),Array.from(i)):{}.toString.call(r)=="[object Object]"?_j(r,i):gj(r,i)}function gj(r,i){return r.toString()===i.toString()}function XA(r,i){var s=r.length;if(s!=i.length)return!1;for(var c=0;c<s;c++)if(!vw(r[c],i[c]))return!1;return!0}function _j(r,i){var s=Object.keys(r),c=s.length;if(c!=Object.keys(i).length)return!1;for(var d=0;d<c;d++){var m=s[d];if(!(i.hasOwnProperty(m)&&vw(r[m],i[m])))return!1}return!0}const{LngLatBounds:bj,LngLat:vj}=to;function mg(r,i){return Math.abs(r-i)<1e-6}function xj(r,i){let s=bj.convert(r);if(!i)return{equal:!1,bounds:s};let c=s.getNorthEast(),d=i.getNorthEast();if(!mg(c.lat,d.lat)||!mg(c.wrap().lng,d.wrap().lng))return{equal:!1,bounds:s};let m=s.getSouthWest(),e=i.getSouthWest();return!mg(m.lat,e.lat)||!mg(m.wrap().lng,e.wrap().lng)?{equal:!1,bounds:s}:{equal:!0,bounds:s}}function wj(r,i){const s=r.getSouthWest(),c=r.getNorthEast();if(Array.isArray(i)){if(i.length===4)return[s.lng,s.lat,c.lng,c.lat];if(i.length===2)return i[0]instanceof vj?[s,c]:[[s.lng,s.lat],[c.lng,c.lat]]}return r}function Ej(r,i){mn(i,!0);const s=Hr(wf),c=Hr(()=>Pe(s).map),d=Hr(()=>Pe(s).loaded);let m=St(i,"position",3,"top-left"),e=St(i,"showCompass",3,!0),a=St(i,"showZoom",3,!0),g=St(i,"visualizePitch",3,!1),w=Ar(void 0);xi(()=>{Pe(c)&&!Pe(w)&&(Xt(w,new to.NavigationControl({showCompass:e(),showZoom:a(),visualizePitch:g()}),!0),Pe(c).addControl(Pe(w),m()))}),Bc(()=>{Pe(d)&&Pe(w)&&Pe(c)?.removeControl(Pe(w))}),yn()}function Aj(r,i){mn(i,!0);const s=Hr(wf),c=Hr(()=>Pe(s).map),d=Hr(()=>Pe(s).loaded);let m=St(i,"position",3,"bottom-left"),e=St(i,"maxWidth",3,void 0),a=St(i,"unit",3,"metric"),g=Ar(void 0);xi(()=>{Pe(c)&&!Pe(g)&&(Xt(g,new to.ScaleControl({maxWidth:e(),unit:a()}),!0),Pe(c).addControl(Pe(g),m()))}),Bc(()=>{Pe(d)&&Pe(g)&&Pe(c)?.removeControl(Pe(g))}),yn()}var Rj=Bn("<!> <!> <!> <!>",1),Sj=Bn("<!> <!>",1),Tj=Bn('<div data-testid="map-container"><!></div>');function Cj(r,i){mn(i,!0);let s=St(i,"map",15,void 0),c=St(i,"mapContainer",15,void 0),d=St(i,"class",3,void 0),m=St(i,"diffStyleUpdates",3,!1),e=St(i,"center",15,void 0),a=St(i,"zoom",15,void 0),g=St(i,"pitch",15,0),w=St(i,"bearing",15,0),R=St(i,"bearingSnap",3,7),S=St(i,"bounds",15,void 0),D=St(i,"fitBoundsOptions",19,()=>({})),k=St(i,"hash",3,!1),B=St(i,"projection",3,void 0),F=St(i,"updateHash",3,Ct=>{window.history.replaceState(window.history.state,"",Ct)}),K=St(i,"loaded",15,!1),U=St(i,"minZoom",3,0),ee=St(i,"maxZoom",3,22),le=St(i,"minPitch",3,0),Q=St(i,"maxPitch",3,60),Te=St(i,"renderWorldCopies",3,void 0),pe=St(i,"dragPan",3,void 0),_e=St(i,"dragRotate",3,void 0),Xe=St(i,"pitchWithRotate",3,void 0),dt=St(i,"antialias",3,void 0),He=St(i,"zoomOnDoubleClick",3,!0),et=St(i,"locale",3,void 0),rt=St(i,"interactive",3,!0),te=St(i,"attributionControl",3,void 0),Be=St(i,"cooperativeGestures",3,!1),fe=St(i,"preserveDrawingBuffer",3,!1),ye=St(i,"maxBounds",3,void 0),nt=St(i,"images",19,()=>[]),gt=St(i,"standardControls",3,!1),lt=St(i,"filterLayers",3,void 0),be=St(i,"transformRequest",3,void 0),Ft=Hr(()=>typeof gt()=="boolean"?void 0:gt());const Ut=sj();gB(new Uv(void 0));let Le=Ar(il(new Set));async function ur(Ct,er=!1){if(s()&&!(!s()?.loaded()&&!er))if("url"in Ct){Pe(Le).add(Ct.id);try{let or=await s().loadImage(Ct.url);s().addImage(Ct.id,or.data,Ct.options),Ut.loadedImages.add(Ct.id)}catch(or){i.onerror?i.onerror({error:or}):console.error(or)}finally{Pe(Le).delete(Ct.id)}}else s().addImage(Ct.id,Ct.data,Ct.options),Ut.loadedImages.add(Ct.id)}xi(()=>{if(K()&&s()?.loaded())for(let Ct of nt())!Ut.loadedImages.has(Ct.id)&&!Pe(Le).has(Ct.id)&&!s().hasImage(Ct.id)&&ur(Ct)});let Tt=Hr(()=>nt().every(Ct=>Ut.loadedImages.has(Ct.id))),tr=Ar(void 0),qr=Ar(void 0),lr=Ar(void 0),kr=Ar(void 0);function Sr(Ct){i.onerror?i.onerror(Ct):Ct.error.name!=="AbortError"&&console.error(Ct.error)}function $r(Ct){return br(),s(Ut.map=new to.Map(pj({container:Ct,style:i.style,locale:et(),center:e(),zoom:a(),pitch:g(),bearing:w(),bearingSnap:R(),minZoom:U(),maxZoom:ee(),minPitch:le(),maxPitch:Q(),renderWorldCopies:Te(),dragPan:pe(),dragRotate:_e(),pitchWithRotate:Xe(),antialias:dt(),interactive:rt(),preserveDrawingBuffer:fe(),maxBounds:ye(),bounds:S(),attributionControl:te(),transformRequest:be(),cooperativeGestures:Be()}))),s().on("load",er=>{er.target.getContainer().setAttribute("data-testid","map"),er.target.getCanvas().setAttribute("data-testid","map-canvas"),i.onload&&i.onload(s()),Ut.loaded=!0,K(!0)}),s().on("error",Sr),i.onmovestart&&s().on("movestart",i.onmovestart),s().on("moveend",er=>{if(e(er.target.getCenter()),a(er.target.getZoom()),g(er.target.getPitch()),w(er.target.getBearing()),S(wj(er.target.getBounds(),S())),i.onmoveend?.(er),k()){let or=new URL(window.location.href.replace(/(#.+)?$/,mj(er.target)));F()(or)}}),i.onclick&&s().on("click",i.onclick),i.ondblclick&&s().on("dblclick",i.ondblclick),i.oncontextmenu&&s().on("contextmenu",i.oncontextmenu),i.onmousemove&&s().on("mousemove",i.onmousemove),i.onzoomstart&&s().on("zoomstart",i.onzoomstart),i.onzoom&&s().on("zoom",i.onzoom),i.onzoomend&&s().on("zoomend",i.onzoomend),i.onpitch&&s().on("pitch",i.onpitch),i.onrotate&&s().on("rotate",i.onrotate),i.onwheel&&s().on("wheel",i.onwheel),i.ondata&&s().on("data",i.ondata),i.onidle&&s().on("idle",i.onidle),s().on("style.load",er=>{if(s()){B()&&s().setProjection(B()),Ut.loaded=!0,K(!0);const or=s().getStyle();if(Xt(tr,or.layers.map(Lr=>Lr.id),!0),Xt(qr,Object.keys(or.sources),!0),Pe(kr))for(const[Lr,Jr]of Object.entries(Pe(kr)))s().addSource(Lr,Jr);if(Pe(lr))for(const Lr of Pe(lr))s().addLayer(Lr);for(const Lr of nt())ur(Lr,!0);i.onstyleload?.(er)}}),s().on("styledata",er=>{if(s()&&lt()){const or=s().getStyle().layers;if(or)for(let Lr of or)lt()(Lr)||s().setLayoutProperty(Lr.id,"visibility","none")}i.onstyledata?.(er)}),{destroy(){K(!1),Ut.loaded=!1,s()?.remove()}}}let sr=Ar(il(i.style));xi(()=>{if(s()&&!Bh(i.style,Pe(sr))){const Ct=s().getStyle();if(Pe(tr)&&Xt(lr,Ct.layers.filter(er=>!Pe(tr).includes(er.id)),!0),Pe(qr)){const er=Object.keys(Ct.sources).filter(or=>!Pe(qr).includes(or));Xt(kr,{},!0);for(const or of er)Pe(kr)[or]=Ct.sources[or]}Xt(sr,i.style,!0),s().setStyle(i.style,{diff:m()}),Ut.loadedImages.clear(),Xt(Le,new Set,!0)}}),xi(()=>{if(s()){let Ct={};e()!=null&&!Bh(e(),s().getCenter())&&(Ct.center=e()),a()!=null&&!Bh(a(),s().getZoom())&&(Ct.zoom=a()),w()!=null&&!Bh(w(),s().getBearing())&&(Ct.bearing=w()),g()!=null&&!Bh(g(),s().getPitch())&&(Ct.pitch=g()),Object.keys(Ct).length&&s().easeTo(Ct)}}),xi(()=>{B()&&K()&&s()?.setProjection(B())}),xi(()=>{if(S()){const{equal:Ct,bounds:er}=xj(S(),s()?.getBounds());Ct||s()?.fitBounds(er,D())}}),xi(()=>{He()?s()?.doubleClickZoom.enable():s()?.doubleClickZoom.disable()});function br(){if(k()){let Ct=yj(window.location.hash);Ct.length>=3&&(a(Ct[0]),e([Ct[2],Ct[1]])),Ct.length==5&&(w(Ct[3]),g(Ct[4]))}}var nr=Tj();Dc("hashchange",m1,br);let Xr;var Vt=ei(nr);{var Pr=Ct=>{var er=Sj(),or=Fr(er);{var Lr=bt=>{var gi=Rj(),Oi=Fr(gi);Ej(Oi,{get position(){return Pe(Ft)}});var Oe=Ji(Oi,2);{let we=Hr(()=>({...D(),maxZoom:12}));hj(Oe,{get position(){return Pe(Ft)},get fitBoundsOptions(){return Pe(we)}})}var vt=Ji(Oe,2);fj(vt,{get position(){return Pe(Ft)}});var Nt=Ji(vt,2);Aj(Nt,{get position(){return Pe(Ft)}}),fr(bt,gi)};Qi(or,bt=>{gt()&&bt(Lr)})}var Jr=Ji(or,2);hf(Jr,()=>i.children??xa,()=>({map:s(),loaded:K(),loadedImages:Ut.loadedImages,allImagesLoaded:Pe(Tt)})),fr(Ct,er)};Qi(Vt,Ct=>{s()&&Ct(Pr)})}Zr(nr),Cm(nr,Ct=>c(Ct),()=>c()),x1(nr,Ct=>$r?.(Ct)),no(Ct=>Xr=jI(nr,1,UI(d()),"svelte-xbukvd",Xr,Ct),[()=>({"expand-map":!d()})]),fr(r,nr),yn()}function kj(r,i){r.key===" "&&(r.preventDefault(),r.stopPropagation(),i("click"))}var Pj=(r,i)=>{r.stopPropagation(),i("click")},Lj=(r,i)=>{r.stopPropagation(),i("dblclick")},Dj=(r,i)=>{r.stopPropagation(),r.preventDefault(),i("contextmenu")},Ij=(r,i)=>i("mousemove"),Bj=Bn("<div><!></div>");function Mj(r,i){mn(i,!0);let s=St(i,"marker",15,void 0),c=St(i,"lngLat",15),d=St(i,"class",3,void 0),m=St(i,"interactive",3,!0),e=St(i,"asButton",3,!1),a=St(i,"draggable",3,!1),g=St(i,"feature",3,void 0),w=St(i,"offset",3,void 0),R=St(i,"zIndex",3,void 0),S=St(i,"rotation",3,0),D=St(i,"opacity",3,1),k=GI(i,["$$slots","$$events","$$legacy","marker","lngLat","class","interactive","asButton","draggable","feature","offset","zIndex","rotation","opacity","anchor","children"]);const B=Hr(wf),F=Hr(()=>Pe(B).map),K=Hr(()=>Pe(B).markerClickManager),{layerEvent:U,marker:ee}=oj(),le=et=>{const rt=()=>_e("dragstart"),te=()=>{pe(),_e("drag")},Be=()=>{pe(),_e("dragend")};return xi(()=>{!Pe(F)||ee.value||(ee.value=new to.Marker({element:et,rotation:S(),draggable:a(),offset:w(),anchor:i.anchor,opacity:D().toString()}).setLngLat(c()).addTo(Pe(F)),s(ee.value),a()&&(ee.value.on("dragstart",rt),ee.value.on("drag",te),ee.value.on("dragend",Be)))}),{destroy:()=>{console.log("removing marker",ee.value),a()&&(ee.value?.off("dragstart",rt),ee.value?.off("drag",te),ee.value?.off("dragend",Be)),s(void 0),ee.value?.remove()}}};function Q(et,rt){const te=et.className;function Be(fe){fe?et.className=`${te} ${fe}`:et.className=te}return Be(rt),{update:Be}}let Te=new Uv(c());rj(Te),xi(()=>{ee.value?.setLngLat(c()),Te.value=c()}),xi(()=>{w()&&ee.value?.setOffset(w())}),xi(()=>{ee.value?.setRotation(S())}),xi(()=>{ee.value?.setOpacity(D().toString())});function pe(){let et=ee.value?.getLngLat();et&&(Array.isArray(c())?c([et.lng,et.lat]):c()&&"lon"in c()?c({lon:et.lng,lat:et.lat}):c(et))}function _e(et){if(!m())return;let rt=ee.value?.getLngLat();if(!rt)return;const te=[rt.lng,rt.lat];let Be={map:Pe(F),marker:ee.value,lngLat:te,features:[{type:"Feature",properties:g()?.properties??{},geometry:{type:"Point",coordinates:te}}]};(et==="click"||et==="contextmenu")&&Pe(K).handleClick(Be),U.value={...Be,layerType:"marker",type:et};const fe=k["on"+et];fe?.(Be)}var Xe=Bj();Xe.__click=[Pj,_e],Xe.__dblclick=[Lj,_e],Xe.__contextmenu=[Dj,_e],Xe.__mousemove=[Ij,_e],Xe.__keydown=[kj,_e];let dt;var He=ei(Xe);hf(He,()=>i.children??xa,()=>({marker:ee.value})),Zr(Xe),x1(Xe,et=>le?.(et)),x1(Xe,(et,rt)=>Q?.(et,rt),d),no(et=>{Ra(Xe,"tabindex",e()?0:void 0),Ra(Xe,"role",e()?"button":void 0),dt=NI(Xe,"",dt,et)},[()=>({"z-index":R()})]),Dc("mouseenter",Xe,()=>{_e("mouseenter")}),Dc("mouseleave",Xe,()=>{_e("mouseleave")}),fr(r,Xe),yn()}nw(["click","dblclick","contextmenu","mousemove","keydown"]);var zj=Bn('<div class="sv-popup"><!></div>');function Oj(r,i){mn(i,!0);let s=St(i,"closeButton",3,void 0),c=St(i,"closeOnClickOutside",3,!0),d=St(i,"closeOnClickInside",3,!1),m=St(i,"closeOnMove",3,!1),e=St(i,"openOn",3,"click"),a=St(i,"openIfTopMost",3,!0),g=St(i,"focusAfterOpen",3,!0),w=St(i,"anchor",3,void 0),R=St(i,"offset",3,void 0),S=St(i,"popupClass",3,void 0),D=St(i,"maxWidth",3,void 0),k=St(i,"lngLat",15,void 0),B=St(i,"html",3,void 0),F=St(i,"open",15,!1),K=St(i,"onopen",3,void 0),U=St(i,"onclose",3,void 0),ee=St(i,"onhover",3,void 0),le=ij();const Q=Hr(wf),Te=Hr(()=>Pe(Q).map),pe=Hr(()=>Pe(Q).eventTopMost),_e=Hr(()=>Pe(Q).markerClickManager),Xe=Hr(()=>Pe(Q).loaded),dt=JU(),He=tj(),et=ej(),rt=["click","dblclick","contextmenu"];let te=Ar(void 0),Be=Ar(!1),fe=Ar(void 0);function ye(){if(!Pe(te))return;let Vt=Pe(te).getElement();!Vt||Vt===Pe(fe)||(Xt(fe,Vt,!0),e()==="hover"&&(Pe(fe).style.pointerEvents="none"),Pe(fe).addEventListener("mouseenter",()=>{Xt(Be,!0)},{passive:!0}),Pe(fe).addEventListener("mouseleave",()=>{Xt(Be,!1)},{passive:!0}),Pe(fe).addEventListener("click",()=>{d()&&F(!1)},{passive:!0}))}xi(()=>{Pe(Te)&&(Pe(Te).on("click",lr),Pe(Te).on("contextmenu",lr),Pe(_e).add(kr),typeof et?.value=="string"&&(Pe(Te).on("click",et.value,Ut),Pe(Te).on("dblclick",et.value,Ut),Pe(Te).on("contextmenu",et.value,Ut),Pe(Te).on("mousemove",et.value,qr),Pe(Te).on("mouseleave",et.value,tr),Pe(Te).on("touchstart",et.value,ur),Pe(Te).on("touchend",et.value,Tt)))}),Bc(()=>{Pe(Xe)&&Pe(Te)&&(Pe(te)?.remove(),Pe(Te).off("click",lr),Pe(Te).off("contextmenu",lr),Pe(_e).remove(kr),et?.value instanceof to.Marker?et.value.getPopup()===Pe(te)&&et.value.setPopup(void 0):typeof et?.value=="string"&&(Pe(Te).off("click",et.value,Ut),Pe(Te).off("dblclick",et.value,Ut),Pe(Te).off("contextmenu",et.value,Ut),Pe(Te).off("mousemove",et.value,qr),Pe(Te).off("mouseleave",et.value,tr),Pe(Te).off("touchstart",et.value,ur),Pe(Te).off("touchend",et.value,Tt)))});function nt(){if(i.canOpen&&!i.canOpen(Pe(lt))){F(!1);return}F(!0)}function gt(Vt){return a()?!("marker"in Vt)&&!aj(Vt)&&Pe(pe)(Vt)!==dt?.value:!1}let lt=Ar(void 0),be=Ar("normal");function Ft(Vt){"layerType"in Vt&&Vt.layerType==="deckgl"?(k(Vt.coordinate),Xt(lt,Vt.object?[Vt.object]:void 0,!0)):(k(Vt.lngLat),Xt(lt,Vt.features??[],!0))}function Ut(Vt){Vt.type!==e()||gt(Vt)||(Ft(Vt),setTimeout(nt))}let Le;function ur(Vt){Le=Vt.point}function Tt(Vt){if(!Le||e()!=="hover")return;let Pr=Le.dist(Vt.point);Le=void 0,Pr<3&&(k(Vt.lngLat),Xt(lt,Vt.features??[],!0),Pe(te)?.isOpen()?Xt(be,"justOpened"):(Xt(be,"opening"),nt()))}function tr(Vt){e()!=="hover"||Le||Pe(be)!=="normal"||(F(!1),Xt(lt,void 0))}function qr(Vt){if(!(e()!=="hover"||Le||Pe(be)!=="normal")){if(gt(Vt)){F(!1),Xt(lt,void 0);return}Xt(lt,Vt.features??[],!0),k(Vt.lngLat),nt()}}function lr(Vt){if(Pe(be)==="justOpened"){Xt(be,"normal");return}if(!c())return;let Pr=[Pe(fe),et?.value instanceof to.Marker?et.value?.getElement():void 0];F()&&Pe(te)?.isOpen()&&!Pr.some(Ct=>Ct?.contains(Vt.originalEvent.target))&&(Vt.type==="contextmenu"&&e()==="contextmenu"||Vt.type!=="contextmenu")&&F(!1)}function kr(Vt){c()&&F()&&Pe(te)?.isOpen()&&Vt.marker!==et?.value&&F(!1)}Bc(()=>{Pe(Xe)&&Pe(te)?.isOpen()&&Pe(te).remove()});let Sr=Ar(void 0),$r=Hr(()=>s()??(!c()&&!d()));xi(()=>{if(!Pe(te)){let Vt=S()?`${S()} sv-maplibregl-popup`:"sv-maplibregl-popup";Xt(te,new to.Popup({closeButton:Pe($r),closeOnClick:!1,closeOnMove:m(),focusAfterOpen:g(),maxWidth:D(),className:Vt,anchor:w(),offset:R()}),!0),Xt(fe,Pe(te).getElement(),!0),Pe(te).on("open",()=>{nt(),F()&&(ye(),K()?.(Pe(te)))}),Pe(te).on("close",()=>{F(!1),U()?.(Pe(te))}),ee()&&Pe(te).on("hover",()=>{ee()?.(Pe(te))})}}),xi(()=>{Pe(te)&&et?.value instanceof to.Marker&&(e()==="click"?et.value.setPopup(Pe(te)):et.value.getPopup()===Pe(te)&&et.value.setPopup(void 0))}),xi(()=>{rt.includes(e())&&He.value?.type===e()&&(Ut(He.value),He.value=void 0)});let sr=Hr(()=>e()==="hover"&&(He.value?.type==="mousemove"||He.value?.type==="mouseenter"));xi(()=>{e()==="hover"&&He&&(Pe(sr)&&He.value&&Ft(He.value),Pe(sr)||Pe(Be)?nt():F(!1))}),xi(()=>{Pe(Sr)?Pe(te)?.setDOMContent(Pe(Sr)):B()&&Pe(te)?.setHTML(B())}),xi(()=>{let Vt=k()??le?.value??void 0;Vt&&Pe(te)?.setLngLat(Vt)}),xi(()=>{if(Pe(Te)&&Pe(te)){let Vt=Pe(te).isOpen();F()&&!Vt?(Pe(te).addTo(Pe(Te)),Pe(be)==="opening"&&Xt(be,"justOpened")):!F()&&Vt&&Pe(te).remove()}});var br=ai(),nr=Fr(br);{var Xr=Vt=>{var Pr=zj(),Ct=ei(Pr);{var er=or=>{var Lr=ai(),Jr=Fr(Lr);hf(Jr,()=>i.children??xa,()=>({features:Pe(lt),data:Pe(lt)?.[0]??void 0,map:Pe(Te),close:()=>F(!1),isOpen:F()})),fr(or,Lr)};Qi(Ct,or=>{(Pe(lt)?.length||et?.value instanceof to.Marker||!et&&F())&&or(er)})}Zr(Pr),Cm(Pr,or=>Xt(Sr,or),()=>Pe(Sr)),fr(Vt,Pr)};Qi(nr,Vt=>{i.children&&Vt(Xr)})}fr(r,br),yn()}var Jm=Uint8Array,RB=Uint16Array,Vj=Int32Array,Uj=new Jm([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),jj=new Jm([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),SB=function(r,i){for(var s=new RB(31),c=0;c<31;++c)s[c]=i+=1<<r[c-1];for(var d=new Vj(s[30]),c=1;c<30;++c)for(var m=s[c];m<s[c+1];++m)d[m]=m-s[c]<<5|c;return{b:s,r:d}},TB=SB(Uj,2),Nj=TB.b,Fj=TB.r;Nj[28]=258,Fj[258]=28;SB(jj,0);var qj=new RB(32768);for(ci=0;ci<32768;++ci)Za=(ci&43690)>>1|(ci&21845)<<1,Za=(Za&52428)>>2|(Za&13107)<<2,Za=(Za&61680)>>4|(Za&3855)<<4,qj[ci]=((Za&65280)>>8|(Za&255)<<8)>>1;var Za,ci,l0=new Jm(288);for(ci=0;ci<144;++ci)l0[ci]=8;var ci;for(ci=144;ci<256;++ci)l0[ci]=9;var ci;for(ci=256;ci<280;++ci)l0[ci]=7;var ci;for(ci=280;ci<288;++ci)l0[ci]=8;var ci,Kj=new Jm(32);for(ci=0;ci<32;++ci)Kj[ci]=5;var ci,Gj=new Jm(0),$j=typeof TextDecoder<"u"&&new TextDecoder,Zj=0;try{$j.decode(Gj,{stream:!0}),Zj=1}catch{}/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Hj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Xj=JO("<svg><!><!></svg>");function Wj(r,i){const s=A1(i,["children","$$slots","$$events","$$legacy"]),c=A1(s,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);mn(i,!1);let d=St(i,"name",8,void 0),m=St(i,"color",8,"currentColor"),e=St(i,"size",8,24),a=St(i,"strokeWidth",8,2),g=St(i,"absoluteStrokeWidth",8,!1),w=St(i,"iconNode",24,()=>[]);const R=(...B)=>B.filter((F,K,U)=>!!F&&U.indexOf(F)===K).join(" ");xf();var S=Xj();sf(S,(B,F)=>({...Hj,...c,width:e(),height:e(),stroke:m(),"stroke-width":B,class:F}),[()=>(eo(g()),eo(a()),eo(e()),is(()=>g()?Number(a())*24/Number(e()):a())),()=>(eo(d()),eo(s),is(()=>R("lucide-icon","lucide",d()?`lucide-${d()}`:"",s.class)))]);var D=ei(S);Cc(D,1,w,Tc,(B,F)=>{var K=Hr(()=>U3(Pe(F),2));let U=()=>Pe(K)[0],ee=()=>Pe(K)[1];var le=ai(),Q=Fr(le);Rm(Q,U,!0,(Te,pe)=>{sf(Te,()=>({...ee()}))}),fr(B,le)});var k=Ji(D);zI(k,i,"default",{}),Zr(S),fr(r,S),yn()}function Yj(r,i){const s=A1(i,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"M10 2v2"}],["path",{d:"M14 2v2"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1"}],["path",{d:"M6 2v2"}]];Wj(r,R1({name:"coffee"},()=>s,{get iconNode(){return c},children:(d,m)=>{var e=ai(),a=Fr(e);zI(a,i,"default",{}),fr(d,e)},$$slots:{default:!0}}))}const CB=r=>{let i=Ar(il(r));return{get current(){return Pe(i)},set current(s){Xt(i,s,!0)}}},kB="components",Jj=()=>hu(kB),Qj=r=>mu(kB,r),eN="ast",tN=r=>mu(eN,r);var rN=Object.create,xw=Object.defineProperty,iN=Object.getOwnPropertyDescriptor,PB=Object.getOwnPropertyNames,nN=Object.getPrototypeOf,sN=Object.prototype.hasOwnProperty,oN=(r,i)=>function(){return i||(0,r[PB(r)[0]])((i={exports:{}}).exports,i),i.exports},aN=(r,i)=>{for(var s in i)xw(r,s,{get:i[s],enumerable:!0})},lN=(r,i,s,c)=>{if(i&&typeof i=="object"||typeof i=="function")for(let d of PB(i))!sN.call(r,d)&&d!==s&&xw(r,d,{get:()=>i[d],enumerable:!(c=iN(i,d))||c.enumerable});return r},uN=(r,i,s)=>(s=r!=null?rN(nN(r)):{},lN(xw(s,"default",{value:r,enumerable:!0}),r)),cN=oN({"node_modules/.pnpm/extend@3.0.2/node_modules/extend/index.js"(r,i){var s=Object.prototype.hasOwnProperty,c=Object.prototype.toString,d=Object.defineProperty,m=Object.getOwnPropertyDescriptor,e=function(S){return typeof Array.isArray=="function"?Array.isArray(S):c.call(S)==="[object Array]"},a=function(S){if(!S||c.call(S)!=="[object Object]")return!1;var D=s.call(S,"constructor"),k=S.constructor&&S.constructor.prototype&&s.call(S.constructor.prototype,"isPrototypeOf");if(S.constructor&&!D&&!k)return!1;var B;for(B in S);return typeof B>"u"||s.call(S,B)},g=function(S,D){d&&D.name==="__proto__"?d(S,D.name,{enumerable:!0,configurable:!0,value:D.newValue,writable:!0}):S[D.name]=D.newValue},w=function(S,D){if(D==="__proto__")if(s.call(S,D)){if(m)return m(S,D).value}else return;return S[D]};i.exports=function R(){var S,D,k,B,F,K,U=arguments[0],ee=1,le=arguments.length,Q=!1;for(typeof U=="boolean"&&(Q=U,U=arguments[1]||{},ee=2),(U==null||typeof U!="object"&&typeof U!="function")&&(U={});ee<le;++ee)if(S=arguments[ee],S!=null)for(D in S)k=w(U,D),B=w(S,D),U!==B&&(Q&&B&&(a(B)||(F=e(B)))?(F?(F=!1,K=k&&e(k)?k:[]):K=k&&a(k)?k:{},g(U,{name:D,newValue:R(Q,K,B)})):typeof B<"u"&&g(U,{name:D,newValue:B}));return U}}}),dN={};function pN(r,i){const s=dN,c=typeof s.includeImageAlt=="boolean"?s.includeImageAlt:!0,d=typeof s.includeHtml=="boolean"?s.includeHtml:!0;return LB(r,c,d)}function LB(r,i,s){if(fN(r)){if("value"in r)return r.type==="html"&&!s?"":r.value;if(i&&"alt"in r&&r.alt)return r.alt;if("children"in r)return WA(r.children,i,s)}return Array.isArray(r)?WA(r,i,s):""}function WA(r,i,s){const c=[];let d=-1;for(;++d<r.length;)c[d]=LB(r[d],i,s);return c.join("")}function fN(r){return!!(r&&typeof r=="object")}var YA={AElig:"Æ",AMP:"&",Aacute:"Á",Abreve:"Ă",Acirc:"Â",Acy:"А",Afr:"𝔄",Agrave:"À",Alpha:"Α",Amacr:"Ā",And:"⩓",Aogon:"Ą",Aopf:"𝔸",ApplyFunction:"⁡",Aring:"Å",Ascr:"𝒜",Assign:"≔",Atilde:"Ã",Auml:"Ä",Backslash:"∖",Barv:"⫧",Barwed:"⌆",Bcy:"Б",Because:"∵",Bernoullis:"ℬ",Beta:"Β",Bfr:"𝔅",Bopf:"𝔹",Breve:"˘",Bscr:"ℬ",Bumpeq:"≎",CHcy:"Ч",COPY:"©",Cacute:"Ć",Cap:"⋒",CapitalDifferentialD:"ⅅ",Cayleys:"ℭ",Ccaron:"Č",Ccedil:"Ç",Ccirc:"Ĉ",Cconint:"∰",Cdot:"Ċ",Cedilla:"¸",CenterDot:"·",Cfr:"ℭ",Chi:"Χ",CircleDot:"⊙",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",Colon:"∷",Colone:"⩴",Congruent:"≡",Conint:"∯",ContourIntegral:"∮",Copf:"ℂ",Coproduct:"∐",CounterClockwiseContourIntegral:"∳",Cross:"⨯",Cscr:"𝒞",Cup:"⋓",CupCap:"≍",DD:"ⅅ",DDotrahd:"⤑",DJcy:"Ђ",DScy:"Ѕ",DZcy:"Џ",Dagger:"‡",Darr:"↡",Dashv:"⫤",Dcaron:"Ď",Dcy:"Д",Del:"∇",Delta:"Δ",Dfr:"𝔇",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",Diamond:"⋄",DifferentialD:"ⅆ",Dopf:"𝔻",Dot:"¨",DotDot:"⃜",DotEqual:"≐",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",Downarrow:"⇓",Dscr:"𝒟",Dstrok:"Đ",ENG:"Ŋ",ETH:"Ð",Eacute:"É",Ecaron:"Ě",Ecirc:"Ê",Ecy:"Э",Edot:"Ė",Efr:"𝔈",Egrave:"È",Element:"∈",Emacr:"Ē",EmptySmallSquare:"◻",EmptyVerySmallSquare:"▫",Eogon:"Ę",Eopf:"𝔼",Epsilon:"Ε",Equal:"⩵",EqualTilde:"≂",Equilibrium:"⇌",Escr:"ℰ",Esim:"⩳",Eta:"Η",Euml:"Ë",Exists:"∃",ExponentialE:"ⅇ",Fcy:"Ф",Ffr:"𝔉",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",Fopf:"𝔽",ForAll:"∀",Fouriertrf:"ℱ",Fscr:"ℱ",GJcy:"Ѓ",GT:">",Gamma:"Γ",Gammad:"Ϝ",Gbreve:"Ğ",Gcedil:"Ģ",Gcirc:"Ĝ",Gcy:"Г",Gdot:"Ġ",Gfr:"𝔊",Gg:"⋙",Gopf:"𝔾",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",Gt:"≫",HARDcy:"Ъ",Hacek:"ˇ",Hat:"^",Hcirc:"Ĥ",Hfr:"ℌ",HilbertSpace:"ℋ",Hopf:"ℍ",HorizontalLine:"─",Hscr:"ℋ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",IEcy:"Е",IJlig:"Ĳ",IOcy:"Ё",Iacute:"Í",Icirc:"Î",Icy:"И",Idot:"İ",Ifr:"ℑ",Igrave:"Ì",Im:"ℑ",Imacr:"Ī",ImaginaryI:"ⅈ",Implies:"⇒",Int:"∬",Integral:"∫",Intersection:"⋂",InvisibleComma:"⁣",InvisibleTimes:"⁢",Iogon:"Į",Iopf:"𝕀",Iota:"Ι",Iscr:"ℐ",Itilde:"Ĩ",Iukcy:"І",Iuml:"Ï",Jcirc:"Ĵ",Jcy:"Й",Jfr:"𝔍",Jopf:"𝕁",Jscr:"𝒥",Jsercy:"Ј",Jukcy:"Є",KHcy:"Х",KJcy:"Ќ",Kappa:"Κ",Kcedil:"Ķ",Kcy:"К",Kfr:"𝔎",Kopf:"𝕂",Kscr:"𝒦",LJcy:"Љ",LT:"<",Lacute:"Ĺ",Lambda:"Λ",Lang:"⟪",Laplacetrf:"ℒ",Larr:"↞",Lcaron:"Ľ",Lcedil:"Ļ",Lcy:"Л",LeftAngleBracket:"⟨",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",LeftRightArrow:"↔",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",Leftarrow:"⇐",Leftrightarrow:"⇔",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",LessLess:"⪡",LessSlantEqual:"⩽",LessTilde:"≲",Lfr:"𝔏",Ll:"⋘",Lleftarrow:"⇚",Lmidot:"Ŀ",LongLeftArrow:"⟵",LongLeftRightArrow:"⟷",LongRightArrow:"⟶",Longleftarrow:"⟸",Longleftrightarrow:"⟺",Longrightarrow:"⟹",Lopf:"𝕃",LowerLeftArrow:"↙",LowerRightArrow:"↘",Lscr:"ℒ",Lsh:"↰",Lstrok:"Ł",Lt:"≪",Map:"⤅",Mcy:"М",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",MinusPlus:"∓",Mopf:"𝕄",Mscr:"ℳ",Mu:"Μ",NJcy:"Њ",Nacute:"Ń",Ncaron:"Ň",Ncedil:"Ņ",Ncy:"Н",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,Nfr:"𝔑",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",Nscr:"𝒩",Ntilde:"Ñ",Nu:"Ν",OElig:"Œ",Oacute:"Ó",Ocirc:"Ô",Ocy:"О",Odblac:"Ő",Ofr:"𝔒",Ograve:"Ò",Omacr:"Ō",Omega:"Ω",Omicron:"Ο",Oopf:"𝕆",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",Or:"⩔",Oscr:"𝒪",Oslash:"Ø",Otilde:"Õ",Otimes:"⨷",Ouml:"Ö",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",PartialD:"∂",Pcy:"П",Pfr:"𝔓",Phi:"Φ",Pi:"Π",PlusMinus:"±",Poincareplane:"ℌ",Popf:"ℙ",Pr:"⪻",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",Prime:"″",Product:"∏",Proportion:"∷",Proportional:"∝",Pscr:"𝒫",Psi:"Ψ",QUOT:'"',Qfr:"𝔔",Qopf:"ℚ",Qscr:"𝒬",RBarr:"⤐",REG:"®",Racute:"Ŕ",Rang:"⟫",Rarr:"↠",Rarrtl:"⤖",Rcaron:"Ř",Rcedil:"Ŗ",Rcy:"Р",Re:"ℜ",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",Rfr:"ℜ",Rho:"Ρ",RightAngleBracket:"⟩",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",Rightarrow:"⇒",Ropf:"ℝ",RoundImplies:"⥰",Rrightarrow:"⇛",Rscr:"ℛ",Rsh:"↱",RuleDelayed:"⧴",SHCHcy:"Щ",SHcy:"Ш",SOFTcy:"Ь",Sacute:"Ś",Sc:"⪼",Scaron:"Š",Scedil:"Ş",Scirc:"Ŝ",Scy:"С",Sfr:"𝔖",ShortDownArrow:"↓",ShortLeftArrow:"←",ShortRightArrow:"→",ShortUpArrow:"↑",Sigma:"Σ",SmallCircle:"∘",Sopf:"𝕊",Sqrt:"√",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",Sscr:"𝒮",Star:"⋆",Sub:"⋐",Subset:"⋐",SubsetEqual:"⊆",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",SuchThat:"∋",Sum:"∑",Sup:"⋑",Superset:"⊃",SupersetEqual:"⊇",Supset:"⋑",THORN:"Þ",TRADE:"™",TSHcy:"Ћ",TScy:"Ц",Tab:"	",Tau:"Τ",Tcaron:"Ť",Tcedil:"Ţ",Tcy:"Т",Tfr:"𝔗",Therefore:"∴",Theta:"Θ",ThickSpace:"  ",ThinSpace:" ",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",Topf:"𝕋",TripleDot:"⃛",Tscr:"𝒯",Tstrok:"Ŧ",Uacute:"Ú",Uarr:"↟",Uarrocir:"⥉",Ubrcy:"Ў",Ubreve:"Ŭ",Ucirc:"Û",Ucy:"У",Udblac:"Ű",Ufr:"𝔘",Ugrave:"Ù",Umacr:"Ū",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",Uopf:"𝕌",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",UpEquilibrium:"⥮",UpTee:"⊥",UpTeeArrow:"↥",Uparrow:"⇑",Updownarrow:"⇕",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",Upsilon:"Υ",Uring:"Ů",Uscr:"𝒰",Utilde:"Ũ",Uuml:"Ü",VDash:"⊫",Vbar:"⫫",Vcy:"В",Vdash:"⊩",Vdashl:"⫦",Vee:"⋁",Verbar:"‖",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",Vopf:"𝕍",Vscr:"𝒱",Vvdash:"⊪",Wcirc:"Ŵ",Wedge:"⋀",Wfr:"𝔚",Wopf:"𝕎",Wscr:"𝒲",Xfr:"𝔛",Xi:"Ξ",Xopf:"𝕏",Xscr:"𝒳",YAcy:"Я",YIcy:"Ї",YUcy:"Ю",Yacute:"Ý",Ycirc:"Ŷ",Ycy:"Ы",Yfr:"𝔜",Yopf:"𝕐",Yscr:"𝒴",Yuml:"Ÿ",ZHcy:"Ж",Zacute:"Ź",Zcaron:"Ž",Zcy:"З",Zdot:"Ż",ZeroWidthSpace:"​",Zeta:"Ζ",Zfr:"ℨ",Zopf:"ℤ",Zscr:"𝒵",aacute:"á",abreve:"ă",ac:"∾",acE:"∾̳",acd:"∿",acirc:"â",acute:"´",acy:"а",aelig:"æ",af:"⁡",afr:"𝔞",agrave:"à",alefsym:"ℵ",aleph:"ℵ",alpha:"α",amacr:"ā",amalg:"⨿",amp:"&",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",aopf:"𝕒",ap:"≈",apE:"⩰",apacir:"⩯",ape:"≊",apid:"≋",apos:"'",approx:"≈",approxeq:"≊",aring:"å",ascr:"𝒶",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",auml:"ä",awconint:"∳",awint:"⨑",bNot:"⫭",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",barvee:"⊽",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",bdquo:"„",becaus:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",beta:"β",beth:"ℶ",between:"≬",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxDL:"╗",boxDR:"╔",boxDl:"╖",boxDr:"╓",boxH:"═",boxHD:"╦",boxHU:"╩",boxHd:"╤",boxHu:"╧",boxUL:"╝",boxUR:"╚",boxUl:"╜",boxUr:"╙",boxV:"║",boxVH:"╬",boxVL:"╣",boxVR:"╠",boxVh:"╫",boxVl:"╢",boxVr:"╟",boxbox:"⧉",boxdL:"╕",boxdR:"╒",boxdl:"┐",boxdr:"┌",boxh:"─",boxhD:"╥",boxhU:"╨",boxhd:"┬",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxuL:"╛",boxuR:"╘",boxul:"┘",boxur:"└",boxv:"│",boxvH:"╪",boxvL:"╡",boxvR:"╞",boxvh:"┼",boxvl:"┤",boxvr:"├",bprime:"‵",breve:"˘",brvbar:"¦",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",bumpeq:"≏",cacute:"ć",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",caps:"∩︀",caret:"⁁",caron:"ˇ",ccaps:"⩍",ccaron:"č",ccedil:"ç",ccirc:"ĉ",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",cedil:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",cfr:"𝔠",chcy:"ч",check:"✓",checkmark:"✓",chi:"χ",cir:"○",cirE:"⧃",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledR:"®",circledS:"Ⓢ",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",clubs:"♣",clubsuit:"♣",colon:":",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",conint:"∮",copf:"𝕔",coprod:"∐",copy:"©",copysr:"℗",crarr:"↵",cross:"✗",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",cupbrcap:"⩈",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dArr:"⇓",dHar:"⥥",dagger:"†",daleth:"ℸ",darr:"↓",dash:"‐",dashv:"⊣",dbkarow:"⤏",dblac:"˝",dcaron:"ď",dcy:"д",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",ddotseq:"⩷",deg:"°",delta:"δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",dharl:"⇃",dharr:"⇂",diam:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",dot:"˙",doteq:"≐",doteqdot:"≑",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",downarrow:"↓",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",dscy:"ѕ",dsol:"⧶",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",dzigrarr:"⟿",eDDot:"⩷",eDot:"≑",eacute:"é",easter:"⩮",ecaron:"ě",ecir:"≖",ecirc:"ê",ecolon:"≕",ecy:"э",edot:"ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",eg:"⪚",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",empty:"∅",emptyset:"∅",emptyv:"∅",emsp13:" ",emsp14:" ",emsp:" ",eng:"ŋ",ensp:" ",eogon:"ę",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",equals:"=",equest:"≟",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erDot:"≓",erarr:"⥱",escr:"ℯ",esdot:"≐",esim:"≂",eta:"η",eth:"ð",euml:"ë",euro:"€",excl:"!",exist:"∃",expectation:"ℰ",exponentiale:"ⅇ",fallingdotseq:"≒",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",filig:"ﬁ",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",forall:"∀",fork:"⋔",forkv:"⫙",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",gE:"≧",gEl:"⪌",gacute:"ǵ",gamma:"γ",gammad:"ϝ",gap:"⪆",gbreve:"ğ",gcirc:"ĝ",gcy:"г",gdot:"ġ",ge:"≥",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",gg:"≫",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",gl:"≷",glE:"⪒",gla:"⪥",glj:"⪤",gnE:"≩",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",grave:"`",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",hArr:"⇔",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",harr:"↔",harrcir:"⥈",harrw:"↭",hbar:"ℏ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",horbar:"―",hscr:"𝒽",hslash:"ℏ",hstrok:"ħ",hybull:"⁃",hyphen:"‐",iacute:"í",ic:"⁣",icirc:"î",icy:"и",iecy:"е",iexcl:"¡",iff:"⇔",ifr:"𝔦",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",imacr:"ī",image:"ℑ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",intcal:"⊺",integers:"ℤ",intercal:"⊺",intlarhk:"⨗",intprod:"⨼",iocy:"ё",iogon:"į",iopf:"𝕚",iota:"ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",isin:"∈",isinE:"⋹",isindot:"⋵",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",iukcy:"і",iuml:"ï",jcirc:"ĵ",jcy:"й",jfr:"𝔧",jmath:"ȷ",jopf:"𝕛",jscr:"𝒿",jsercy:"ј",jukcy:"є",kappa:"κ",kappav:"ϰ",kcedil:"ķ",kcy:"к",kfr:"𝔨",kgreen:"ĸ",khcy:"х",kjcy:"ќ",kopf:"𝕜",kscr:"𝓀",lAarr:"⇚",lArr:"⇐",lAtail:"⤛",lBarr:"⤎",lE:"≦",lEg:"⪋",lHar:"⥢",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",laquo:"«",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",late:"⪭",lates:"⪭︀",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",lcedil:"ļ",lceil:"⌈",lcub:"{",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",leftarrow:"←",leftarrowtail:"↢",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",leftthreetimes:"⋋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",lessgtr:"≶",lesssim:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",lg:"≶",lgE:"⪑",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",ll:"≪",llarr:"⇇",llcorner:"⌞",llhard:"⥫",lltri:"◺",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnE:"≨",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",longleftrightarrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltrPar:"⦖",ltri:"◃",ltrie:"⊴",ltrif:"◂",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",mDDot:"∺",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",mdash:"—",measuredangle:"∡",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",mp:"∓",mscr:"𝓂",mstpos:"∾",mu:"μ",multimap:"⊸",mumap:"⊸",nGg:"⋙̸",nGt:"≫⃒",nGtv:"≫̸",nLeftarrow:"⇍",nLeftrightarrow:"⇎",nLl:"⋘̸",nLt:"≪⃒",nLtv:"≪̸",nRightarrow:"⇏",nVDash:"⊯",nVdash:"⊮",nabla:"∇",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",ndash:"–",ne:"≠",neArr:"⇗",nearhk:"⤤",nearr:"↗",nearrow:"↗",nedot:"≐̸",nequiv:"≢",nesear:"⤨",nesim:"≂̸",nexist:"∄",nexists:"∄",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",ngsim:"≵",ngt:"≯",ngtr:"≯",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",nlArr:"⇍",nlE:"≦̸",nlarr:"↚",nldr:"‥",nle:"≰",nleftarrow:"↚",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nlsim:"≴",nlt:"≮",nltri:"⋪",nltrie:"⋬",nmid:"∤",nopf:"𝕟",not:"¬",notin:"∉",notinE:"⋹̸",notindot:"⋵̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",num:"#",numero:"№",numsp:" ",nvDash:"⊭",nvHarr:"⤄",nvap:"≍⃒",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwArr:"⇖",nwarhk:"⤣",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",oS:"Ⓢ",oacute:"ó",oast:"⊛",ocir:"⊚",ocirc:"ô",ocy:"о",odash:"⊝",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",ofcir:"⦿",ofr:"𝔬",ogon:"˛",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",omega:"ω",omicron:"ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",opar:"⦷",operp:"⦹",oplus:"⊕",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oscr:"ℴ",oslash:"ø",osol:"⊘",otilde:"õ",otimes:"⊗",otimesas:"⨶",ouml:"ö",ovbar:"⌽",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",pointint:"⨕",popf:"𝕡",pound:"£",pr:"≺",prE:"⪳",prap:"⪷",prcue:"≼",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",primes:"ℙ",prnE:"⪵",prnap:"⪹",prnsim:"⋨",prod:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",psi:"ψ",puncsp:" ",qfr:"𝔮",qint:"⨌",qopf:"𝕢",qprime:"⁗",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',rAarr:"⇛",rArr:"⇒",rAtail:"⤜",rBarr:"⤏",rHar:"⥤",race:"∽̱",racute:"ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",rarrw:"↝",ratail:"⤚",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",rcedil:"ŗ",rceil:"⌉",rcub:"}",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",rhov:"ϱ",rightarrow:"→",rightarrowtail:"↣",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",rightthreetimes:"⋌",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",rsaquo:"›",rscr:"𝓇",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",ruluhar:"⥨",rx:"℞",sacute:"ś",sbquo:"‚",sc:"≻",scE:"⪴",scap:"⪸",scaron:"š",sccue:"≽",sce:"⪰",scedil:"ş",scirc:"ŝ",scnE:"⪶",scnap:"⪺",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",seArr:"⇘",searhk:"⤥",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",sfrown:"⌢",sharp:"♯",shchcy:"щ",shcy:"ш",shortmid:"∣",shortparallel:"∥",shy:"­",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",subE:"⫅",subdot:"⪽",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",sum:"∑",sung:"♪",sup1:"¹",sup2:"²",sup3:"³",sup:"⊃",supE:"⫆",supdot:"⪾",supdsub:"⫘",supe:"⊇",supedot:"⫄",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swArr:"⇙",swarhk:"⤦",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",target:"⌖",tau:"τ",tbrk:"⎴",tcaron:"ť",tcedil:"ţ",tcy:"т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",there4:"∴",therefore:"∴",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",thinsp:" ",thkap:"≈",thksim:"∼",thorn:"þ",tilde:"˜",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",tscy:"ц",tshcy:"ћ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uArr:"⇑",uHar:"⥣",uacute:"ú",uarr:"↑",ubrcy:"ў",ubreve:"ŭ",ucirc:"û",ucy:"у",udarr:"⇅",udblac:"ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",ugrave:"ù",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",uml:"¨",uogon:"ų",uopf:"𝕦",uparrow:"↑",updownarrow:"↕",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",upsi:"υ",upsih:"ϒ",upsilon:"υ",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",urtri:"◹",uscr:"𝓊",utdot:"⋰",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",uwangle:"⦧",vArr:"⇕",vBar:"⫨",vBarv:"⫩",vDash:"⊨",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vcy:"в",vdash:"⊢",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",vert:"|",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",vprop:"∝",vrtri:"⊳",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",vzigzag:"⦚",wcirc:"ŵ",wedbar:"⩟",wedge:"∧",wedgeq:"≙",weierp:"℘",wfr:"𝔴",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",yacy:"я",ycirc:"ŷ",ycy:"ы",yen:"¥",yfr:"𝔶",yicy:"ї",yopf:"𝕪",yscr:"𝓎",yucy:"ю",yuml:"ÿ",zacute:"ź",zcaron:"ž",zcy:"з",zdot:"ż",zeetrf:"ℨ",zeta:"ζ",zfr:"𝔷",zhcy:"ж",zigrarr:"⇝",zopf:"𝕫",zscr:"𝓏",zwj:"‍",zwnj:"‌"},hN={}.hasOwnProperty;function ww(r){return hN.call(YA,r)?YA[r]:!1}function Sa(r,i,s,c){const d=r.length;let m=0,e;if(i<0?i=-i>d?0:d+i:i=i>d?d:i,s=s>0?s:0,c.length<1e4)e=Array.from(c),e.unshift(i,s),r.splice(...e);else for(s&&r.splice(i,s);m<c.length;)e=c.slice(m,m+1e4),e.unshift(i,0),r.splice(...e),m+=1e4,i+=1e4}function vo(r,i){return r.length>0?(Sa(r,r.length,0,i),r):i}var JA={}.hasOwnProperty;function mN(r){const i={};let s=-1;for(;++s<r.length;)yN(i,r[s]);return i}function yN(r,i){let s;for(s in i){const d=(JA.call(r,s)?r[s]:void 0)||(r[s]={}),m=i[s];let e;if(m)for(e in m){JA.call(d,e)||(d[e]=[]);const a=m[e];gN(d[e],Array.isArray(a)?a:a?[a]:[])}}}function gN(r,i){let s=-1;const c=[];for(;++s<i.length;)(i[s].add==="after"?r:c).push(i[s]);Sa(r,0,0,c)}function DB(r,i){const s=Number.parseInt(r,i);return s<9||s===11||s>13&&s<32||s>126&&s<160||s>55295&&s<57344||s>64975&&s<65008||(s&65535)===65535||(s&65535)===65534||s>1114111?"�":String.fromCodePoint(s)}function df(r){return r.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var va=yu(/[A-Za-z]/),io=yu(/[\dA-Za-z]/),_N=yu(/[#-'*+\--9=?A-Z^-~]/);function P1(r){return r!==null&&(r<32||r===127)}var L1=yu(/\d/),bN=yu(/[\dA-Fa-f]/),vN=yu(/[!-/:-@[-`{-~]/);function xr(r){return r!==null&&r<-2}function Bs(r){return r!==null&&(r<0||r===32)}function di(r){return r===-2||r===-1||r===32}var xN=yu(new RegExp("\\p{P}|\\p{S}","u")),wN=yu(/\s/);function yu(r){return i;function i(s){return s!==null&&s>-1&&r.test(String.fromCharCode(s))}}function Ef(r){const i=[];let s=-1,c=0,d=0;for(;++s<r.length;){const m=r.charCodeAt(s);let e="";if(m===37&&io(r.charCodeAt(s+1))&&io(r.charCodeAt(s+2)))d=2;else if(m<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(m))||(e=String.fromCharCode(m));else if(m>55295&&m<57344){const a=r.charCodeAt(s+1);m<56320&&a>56319&&a<57344?(e=String.fromCharCode(m,a),d=1):e="�"}else e=String.fromCharCode(m);e&&(i.push(r.slice(c,s),encodeURIComponent(e)),c=s+d+1,e=""),d&&(s+=d,d=0)}return i.join("")+r.slice(c)}function Ti(r,i,s,c){const d=c?c-1:Number.POSITIVE_INFINITY;let m=0;return e;function e(g){return di(g)?(r.enter(s),a(g)):i(g)}function a(g){return di(g)&&m++<d?(r.consume(g),a):(r.exit(s),i(g))}}var EN={tokenize:AN};function AN(r){const i=r.attempt(this.parser.constructs.contentInitial,c,d);let s;return i;function c(a){if(a===null){r.consume(a);return}return r.enter("lineEnding"),r.consume(a),r.exit("lineEnding"),Ti(r,i,"linePrefix")}function d(a){return r.enter("paragraph"),m(a)}function m(a){const g=r.enter("chunkText",{contentType:"text",previous:s});return s&&(s.next=g),s=g,e(a)}function e(a){if(a===null){r.exit("chunkText"),r.exit("paragraph"),r.consume(a);return}return xr(a)?(r.consume(a),r.exit("chunkText"),m):(r.consume(a),e)}}var RN={tokenize:SN},QA={tokenize:TN};function SN(r){const i=this,s=[];let c=0,d,m,e;return a;function a(le){if(c<s.length){const Q=s[c];return i.containerState=Q[1],r.attempt(Q[0].continuation,g,w)(le)}return w(le)}function g(le){if(c++,i.containerState._closeFlow){i.containerState._closeFlow=void 0,d&&ee();const Q=i.events.length;let Te=Q,pe;for(;Te--;)if(i.events[Te][0]==="exit"&&i.events[Te][1].type==="chunkFlow"){pe=i.events[Te][1].end;break}U(c);let _e=Q;for(;_e<i.events.length;)i.events[_e][1].end={...pe},_e++;return Sa(i.events,Te+1,0,i.events.slice(Q)),i.events.length=_e,w(le)}return a(le)}function w(le){if(c===s.length){if(!d)return D(le);if(d.currentConstruct&&d.currentConstruct.concrete)return B(le);i.interrupt=!!(d.currentConstruct&&!d._gfmTableDynamicInterruptHack)}return i.containerState={},r.check(QA,R,S)(le)}function R(le){return d&&ee(),U(c),D(le)}function S(le){return i.parser.lazy[i.now().line]=c!==s.length,e=i.now().offset,B(le)}function D(le){return i.containerState={},r.attempt(QA,k,B)(le)}function k(le){return c++,s.push([i.currentConstruct,i.containerState]),D(le)}function B(le){if(le===null){d&&ee(),U(0),r.consume(le);return}return d=d||i.parser.flow(i.now()),r.enter("chunkFlow",{_tokenizer:d,contentType:"flow",previous:m}),F(le)}function F(le){if(le===null){K(r.exit("chunkFlow"),!0),U(0),r.consume(le);return}return xr(le)?(r.consume(le),K(r.exit("chunkFlow")),c=0,i.interrupt=void 0,a):(r.consume(le),F)}function K(le,Q){const Te=i.sliceStream(le);if(Q&&Te.push(null),le.previous=m,m&&(m.next=le),m=le,d.defineSkip(le.start),d.write(Te),i.parser.lazy[le.start.line]){let pe=d.events.length;for(;pe--;)if(d.events[pe][1].start.offset<e&&(!d.events[pe][1].end||d.events[pe][1].end.offset>e))return;const _e=i.events.length;let Xe=_e,dt,He;for(;Xe--;)if(i.events[Xe][0]==="exit"&&i.events[Xe][1].type==="chunkFlow"){if(dt){He=i.events[Xe][1].end;break}dt=!0}for(U(c),pe=_e;pe<i.events.length;)i.events[pe][1].end={...He},pe++;Sa(i.events,Xe+1,0,i.events.slice(_e)),i.events.length=pe}}function U(le){let Q=s.length;for(;Q-- >le;){const Te=s[Q];i.containerState=Te[1],Te[0].exit.call(i,r)}s.length=le}function ee(){d.write([null]),m=void 0,d=void 0,i.containerState._closeFlow=void 0}}function TN(r,i,s){return Ti(r,r.attempt(this.parser.constructs.document,i,s),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function eR(r){if(r===null||Bs(r)||wN(r))return 1;if(xN(r))return 2}function Ew(r,i,s){const c=[];let d=-1;for(;++d<r.length;){const m=r[d].resolveAll;m&&!c.includes(m)&&(i=m(i,s),c.push(m))}return i}var D1={name:"attention",resolveAll:CN,tokenize:kN};function CN(r,i){let s=-1,c,d,m,e,a,g,w,R;for(;++s<r.length;)if(r[s][0]==="enter"&&r[s][1].type==="attentionSequence"&&r[s][1]._close){for(c=s;c--;)if(r[c][0]==="exit"&&r[c][1].type==="attentionSequence"&&r[c][1]._open&&i.sliceSerialize(r[c][1]).charCodeAt(0)===i.sliceSerialize(r[s][1]).charCodeAt(0)){if((r[c][1]._close||r[s][1]._open)&&(r[s][1].end.offset-r[s][1].start.offset)%3&&!((r[c][1].end.offset-r[c][1].start.offset+r[s][1].end.offset-r[s][1].start.offset)%3))continue;g=r[c][1].end.offset-r[c][1].start.offset>1&&r[s][1].end.offset-r[s][1].start.offset>1?2:1;const S={...r[c][1].end},D={...r[s][1].start};tR(S,-g),tR(D,g),e={type:g>1?"strongSequence":"emphasisSequence",start:S,end:{...r[c][1].end}},a={type:g>1?"strongSequence":"emphasisSequence",start:{...r[s][1].start},end:D},m={type:g>1?"strongText":"emphasisText",start:{...r[c][1].end},end:{...r[s][1].start}},d={type:g>1?"strong":"emphasis",start:{...e.start},end:{...a.end}},r[c][1].end={...e.start},r[s][1].start={...a.end},w=[],r[c][1].end.offset-r[c][1].start.offset&&(w=vo(w,[["enter",r[c][1],i],["exit",r[c][1],i]])),w=vo(w,[["enter",d,i],["enter",e,i],["exit",e,i],["enter",m,i]]),w=vo(w,Ew(i.parser.constructs.insideSpan.null,r.slice(c+1,s),i)),w=vo(w,[["exit",m,i],["enter",a,i],["exit",a,i],["exit",d,i]]),r[s][1].end.offset-r[s][1].start.offset?(R=2,w=vo(w,[["enter",r[s][1],i],["exit",r[s][1],i]])):R=0,Sa(r,c-1,s-c+3,w),s=c+w.length-R-2;break}}for(s=-1;++s<r.length;)r[s][1].type==="attentionSequence"&&(r[s][1].type="data");return r}function kN(r,i){const s=this.parser.constructs.attentionMarkers.null,c=this.previous,d=eR(c);let m;return e;function e(g){return m=g,r.enter("attentionSequence"),a(g)}function a(g){if(g===m)return r.consume(g),a;const w=r.exit("attentionSequence"),R=eR(g),S=!R||R===2&&d||s.includes(g),D=!d||d===2&&R||s.includes(c);return w._open=!!(m===42?S:S&&(d||!D)),w._close=!!(m===42?D:D&&(R||!S)),i(g)}}function tR(r,i){r.column+=i,r.offset+=i,r._bufferIndex+=i}var PN={name:"autolink",tokenize:LN};function LN(r,i,s){let c=0;return d;function d(k){return r.enter("autolink"),r.enter("autolinkMarker"),r.consume(k),r.exit("autolinkMarker"),r.enter("autolinkProtocol"),m}function m(k){return va(k)?(r.consume(k),e):k===64?s(k):w(k)}function e(k){return k===43||k===45||k===46||io(k)?(c=1,a(k)):w(k)}function a(k){return k===58?(r.consume(k),c=0,g):(k===43||k===45||k===46||io(k))&&c++<32?(r.consume(k),a):(c=0,w(k))}function g(k){return k===62?(r.exit("autolinkProtocol"),r.enter("autolinkMarker"),r.consume(k),r.exit("autolinkMarker"),r.exit("autolink"),i):k===null||k===32||k===60||P1(k)?s(k):(r.consume(k),g)}function w(k){return k===64?(r.consume(k),R):_N(k)?(r.consume(k),w):s(k)}function R(k){return io(k)?S(k):s(k)}function S(k){return k===46?(r.consume(k),c=0,R):k===62?(r.exit("autolinkProtocol").type="autolinkEmail",r.enter("autolinkMarker"),r.consume(k),r.exit("autolinkMarker"),r.exit("autolink"),i):D(k)}function D(k){if((k===45||io(k))&&c++<63){const B=k===45?D:S;return r.consume(k),B}return s(k)}}var u0={partial:!0,tokenize:DN};function DN(r,i,s){return c;function c(m){return di(m)?Ti(r,d,"linePrefix")(m):d(m)}function d(m){return m===null||xr(m)?i(m):s(m)}}var IB={continuation:{tokenize:BN},exit:MN,name:"blockQuote",tokenize:IN};function IN(r,i,s){const c=this;return d;function d(e){if(e===62){const a=c.containerState;return a.open||(r.enter("blockQuote",{_container:!0}),a.open=!0),r.enter("blockQuotePrefix"),r.enter("blockQuoteMarker"),r.consume(e),r.exit("blockQuoteMarker"),m}return s(e)}function m(e){return di(e)?(r.enter("blockQuotePrefixWhitespace"),r.consume(e),r.exit("blockQuotePrefixWhitespace"),r.exit("blockQuotePrefix"),i):(r.exit("blockQuotePrefix"),i(e))}}function BN(r,i,s){const c=this;return d;function d(e){return di(e)?Ti(r,m,"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(e):m(e)}function m(e){return r.attempt(IB,i,s)(e)}}function MN(r){r.exit("blockQuote")}var BB={name:"characterEscape",tokenize:zN};function zN(r,i,s){return c;function c(m){return r.enter("characterEscape"),r.enter("escapeMarker"),r.consume(m),r.exit("escapeMarker"),d}function d(m){return vN(m)?(r.enter("characterEscapeValue"),r.consume(m),r.exit("characterEscapeValue"),r.exit("characterEscape"),i):s(m)}}var MB={name:"characterReference",tokenize:ON};function ON(r,i,s){const c=this;let d=0,m,e;return a;function a(S){return r.enter("characterReference"),r.enter("characterReferenceMarker"),r.consume(S),r.exit("characterReferenceMarker"),g}function g(S){return S===35?(r.enter("characterReferenceMarkerNumeric"),r.consume(S),r.exit("characterReferenceMarkerNumeric"),w):(r.enter("characterReferenceValue"),m=31,e=io,R(S))}function w(S){return S===88||S===120?(r.enter("characterReferenceMarkerHexadecimal"),r.consume(S),r.exit("characterReferenceMarkerHexadecimal"),r.enter("characterReferenceValue"),m=6,e=bN,R):(r.enter("characterReferenceValue"),m=7,e=L1,R(S))}function R(S){if(S===59&&d){const D=r.exit("characterReferenceValue");return e===io&&!ww(c.sliceSerialize(D))?s(S):(r.enter("characterReferenceMarker"),r.consume(S),r.exit("characterReferenceMarker"),r.exit("characterReference"),i)}return e(S)&&d++<m?(r.consume(S),R):s(S)}}var rR={partial:!0,tokenize:UN},iR={concrete:!0,name:"codeFenced",tokenize:VN};function VN(r,i,s){const c=this,d={partial:!0,tokenize:Te};let m=0,e=0,a;return g;function g(pe){return w(pe)}function w(pe){const _e=c.events[c.events.length-1];return m=_e&&_e[1].type==="linePrefix"?_e[2].sliceSerialize(_e[1],!0).length:0,a=pe,r.enter("codeFenced"),r.enter("codeFencedFence"),r.enter("codeFencedFenceSequence"),R(pe)}function R(pe){return pe===a?(e++,r.consume(pe),R):e<3?s(pe):(r.exit("codeFencedFenceSequence"),di(pe)?Ti(r,S,"whitespace")(pe):S(pe))}function S(pe){return pe===null||xr(pe)?(r.exit("codeFencedFence"),c.interrupt?i(pe):r.check(rR,F,Q)(pe)):(r.enter("codeFencedFenceInfo"),r.enter("chunkString",{contentType:"string"}),D(pe))}function D(pe){return pe===null||xr(pe)?(r.exit("chunkString"),r.exit("codeFencedFenceInfo"),S(pe)):di(pe)?(r.exit("chunkString"),r.exit("codeFencedFenceInfo"),Ti(r,k,"whitespace")(pe)):pe===96&&pe===a?s(pe):(r.consume(pe),D)}function k(pe){return pe===null||xr(pe)?S(pe):(r.enter("codeFencedFenceMeta"),r.enter("chunkString",{contentType:"string"}),B(pe))}function B(pe){return pe===null||xr(pe)?(r.exit("chunkString"),r.exit("codeFencedFenceMeta"),S(pe)):pe===96&&pe===a?s(pe):(r.consume(pe),B)}function F(pe){return r.attempt(d,Q,K)(pe)}function K(pe){return r.enter("lineEnding"),r.consume(pe),r.exit("lineEnding"),U}function U(pe){return m>0&&di(pe)?Ti(r,ee,"linePrefix",m+1)(pe):ee(pe)}function ee(pe){return pe===null||xr(pe)?r.check(rR,F,Q)(pe):(r.enter("codeFlowValue"),le(pe))}function le(pe){return pe===null||xr(pe)?(r.exit("codeFlowValue"),ee(pe)):(r.consume(pe),le)}function Q(pe){return r.exit("codeFenced"),i(pe)}function Te(pe,_e,Xe){let dt=0;return He;function He(fe){return pe.enter("lineEnding"),pe.consume(fe),pe.exit("lineEnding"),et}function et(fe){return pe.enter("codeFencedFence"),di(fe)?Ti(pe,rt,"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(fe):rt(fe)}function rt(fe){return fe===a?(pe.enter("codeFencedFenceSequence"),te(fe)):Xe(fe)}function te(fe){return fe===a?(dt++,pe.consume(fe),te):dt>=e?(pe.exit("codeFencedFenceSequence"),di(fe)?Ti(pe,Be,"whitespace")(fe):Be(fe)):Xe(fe)}function Be(fe){return fe===null||xr(fe)?(pe.exit("codeFencedFence"),_e(fe)):Xe(fe)}}}function UN(r,i,s){const c=this;return d;function d(e){return e===null?s(e):(r.enter("lineEnding"),r.consume(e),r.exit("lineEnding"),m)}function m(e){return c.parser.lazy[c.now().line]?s(e):i(e)}}var Ix={name:"codeIndented",tokenize:NN},jN={partial:!0,tokenize:FN};function NN(r,i,s){const c=this;return d;function d(w){return r.enter("codeIndented"),Ti(r,m,"linePrefix",5)(w)}function m(w){const R=c.events[c.events.length-1];return R&&R[1].type==="linePrefix"&&R[2].sliceSerialize(R[1],!0).length>=4?e(w):s(w)}function e(w){return w===null?g(w):xr(w)?r.attempt(jN,e,g)(w):(r.enter("codeFlowValue"),a(w))}function a(w){return w===null||xr(w)?(r.exit("codeFlowValue"),e(w)):(r.consume(w),a)}function g(w){return r.exit("codeIndented"),i(w)}}function FN(r,i,s){const c=this;return d;function d(e){return c.parser.lazy[c.now().line]?s(e):xr(e)?(r.enter("lineEnding"),r.consume(e),r.exit("lineEnding"),d):Ti(r,m,"linePrefix",5)(e)}function m(e){const a=c.events[c.events.length-1];return a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?i(e):xr(e)?d(e):s(e)}}var qN={name:"codeText",previous:GN,resolve:KN,tokenize:$N};function KN(r){let i=r.length-4,s=3,c,d;if((r[s][1].type==="lineEnding"||r[s][1].type==="space")&&(r[i][1].type==="lineEnding"||r[i][1].type==="space")){for(c=s;++c<i;)if(r[c][1].type==="codeTextData"){r[s][1].type="codeTextPadding",r[i][1].type="codeTextPadding",s+=2,i-=2;break}}for(c=s-1,i++;++c<=i;)d===void 0?c!==i&&r[c][1].type!=="lineEnding"&&(d=c):(c===i||r[c][1].type==="lineEnding")&&(r[d][1].type="codeTextData",c!==d+2&&(r[d][1].end=r[c-1][1].end,r.splice(d+2,c-d-2),i-=c-d-2,c=d+2),d=void 0);return r}function GN(r){return r!==96||this.events[this.events.length-1][1].type==="characterEscape"}function $N(r,i,s){let c=0,d,m;return e;function e(S){return r.enter("codeText"),r.enter("codeTextSequence"),a(S)}function a(S){return S===96?(r.consume(S),c++,a):(r.exit("codeTextSequence"),g(S))}function g(S){return S===null?s(S):S===32?(r.enter("space"),r.consume(S),r.exit("space"),g):S===96?(m=r.enter("codeTextSequence"),d=0,R(S)):xr(S)?(r.enter("lineEnding"),r.consume(S),r.exit("lineEnding"),g):(r.enter("codeTextData"),w(S))}function w(S){return S===null||S===32||S===96||xr(S)?(r.exit("codeTextData"),g(S)):(r.consume(S),w)}function R(S){return S===96?(r.consume(S),d++,R):d===c?(r.exit("codeTextSequence"),r.exit("codeText"),i(S)):(m.type="codeTextData",w(S))}}var ZN=class{constructor(r){this.left=r?[...r]:[],this.right=[]}get(r){if(r<0||r>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+r+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return r<this.left.length?this.left[r]:this.right[this.right.length-r+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(r,i){const s=i??Number.POSITIVE_INFINITY;return s<this.left.length?this.left.slice(r,s):r>this.left.length?this.right.slice(this.right.length-s+this.left.length,this.right.length-r+this.left.length).reverse():this.left.slice(r).concat(this.right.slice(this.right.length-s+this.left.length).reverse())}splice(r,i,s){const c=i||0;this.setCursor(Math.trunc(r));const d=this.right.splice(this.right.length-c,Number.POSITIVE_INFINITY);return s&&Mh(this.left,s),d.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(r){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(r)}pushMany(r){this.setCursor(Number.POSITIVE_INFINITY),Mh(this.left,r)}unshift(r){this.setCursor(0),this.right.push(r)}unshiftMany(r){this.setCursor(0),Mh(this.right,r.reverse())}setCursor(r){if(!(r===this.left.length||r>this.left.length&&this.right.length===0||r<0&&this.left.length===0))if(r<this.left.length){const i=this.left.splice(r,Number.POSITIVE_INFINITY);Mh(this.right,i.reverse())}else{const i=this.right.splice(this.left.length+this.right.length-r,Number.POSITIVE_INFINITY);Mh(this.left,i.reverse())}}};function Mh(r,i){let s=0;if(i.length<1e4)r.push(...i);else for(;s<i.length;)r.push(...i.slice(s,s+1e4)),s+=1e4}function zB(r){const i={};let s=-1,c,d,m,e,a,g,w;const R=new ZN(r);for(;++s<R.length;){for(;s in i;)s=i[s];if(c=R.get(s),s&&c[1].type==="chunkFlow"&&R.get(s-1)[1].type==="listItemPrefix"&&(g=c[1]._tokenizer.events,m=0,m<g.length&&g[m][1].type==="lineEndingBlank"&&(m+=2),m<g.length&&g[m][1].type==="content"))for(;++m<g.length&&g[m][1].type!=="content";)g[m][1].type==="chunkText"&&(g[m][1]._isInFirstContentOfListItem=!0,m++);if(c[0]==="enter")c[1].contentType&&(Object.assign(i,HN(R,s)),s=i[s],w=!0);else if(c[1]._container){for(m=s,d=void 0;m--;)if(e=R.get(m),e[1].type==="lineEnding"||e[1].type==="lineEndingBlank")e[0]==="enter"&&(d&&(R.get(d)[1].type="lineEndingBlank"),e[1].type="lineEnding",d=m);else if(!(e[1].type==="linePrefix"||e[1].type==="listItemIndent"))break;d&&(c[1].end={...R.get(d)[1].start},a=R.slice(d,s),a.unshift(c),R.splice(d,s-d+1,a))}}return Sa(r,0,Number.POSITIVE_INFINITY,R.slice(0)),!w}function HN(r,i){const s=r.get(i)[1],c=r.get(i)[2];let d=i-1;const m=[];let e=s._tokenizer;e||(e=c.parser[s.contentType](s.start),s._contentTypeTextTrailing&&(e._contentTypeTextTrailing=!0));const a=e.events,g=[],w={};let R,S,D=-1,k=s,B=0,F=0;const K=[F];for(;k;){for(;r.get(++d)[1]!==k;);m.push(d),k._tokenizer||(R=c.sliceStream(k),k.next||R.push(null),S&&e.defineSkip(k.start),k._isInFirstContentOfListItem&&(e._gfmTasklistFirstContentOfListItem=!0),e.write(R),k._isInFirstContentOfListItem&&(e._gfmTasklistFirstContentOfListItem=void 0)),S=k,k=k.next}for(k=s;++D<a.length;)a[D][0]==="exit"&&a[D-1][0]==="enter"&&a[D][1].type===a[D-1][1].type&&a[D][1].start.line!==a[D][1].end.line&&(F=D+1,K.push(F),k._tokenizer=void 0,k.previous=void 0,k=k.next);for(e.events=[],k?(k._tokenizer=void 0,k.previous=void 0):K.pop(),D=K.length;D--;){const U=a.slice(K[D],K[D+1]),ee=m.pop();g.push([ee,ee+U.length-1]),r.splice(ee,2,U)}for(g.reverse(),D=-1;++D<g.length;)w[B+g[D][0]]=B+g[D][1],B+=g[D][1]-g[D][0]-1;return w}var XN={resolve:YN,tokenize:JN},WN={partial:!0,tokenize:QN};function YN(r){return zB(r),r}function JN(r,i){let s;return c;function c(a){return r.enter("content"),s=r.enter("chunkContent",{contentType:"content"}),d(a)}function d(a){return a===null?m(a):xr(a)?r.check(WN,e,m)(a):(r.consume(a),d)}function m(a){return r.exit("chunkContent"),r.exit("content"),i(a)}function e(a){return r.consume(a),r.exit("chunkContent"),s.next=r.enter("chunkContent",{contentType:"content",previous:s}),s=s.next,d}}function QN(r,i,s){const c=this;return d;function d(e){return r.exit("chunkContent"),r.enter("lineEnding"),r.consume(e),r.exit("lineEnding"),Ti(r,m,"linePrefix")}function m(e){if(e===null||xr(e))return s(e);const a=c.events[c.events.length-1];return!c.parser.constructs.disable.null.includes("codeIndented")&&a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?i(e):r.interrupt(c.parser.constructs.flow,s,i)(e)}}function OB(r,i,s,c,d,m,e,a,g){const w=g||Number.POSITIVE_INFINITY;let R=0;return S;function S(U){return U===60?(r.enter(c),r.enter(d),r.enter(m),r.consume(U),r.exit(m),D):U===null||U===32||U===41||P1(U)?s(U):(r.enter(c),r.enter(e),r.enter(a),r.enter("chunkString",{contentType:"string"}),F(U))}function D(U){return U===62?(r.enter(m),r.consume(U),r.exit(m),r.exit(d),r.exit(c),i):(r.enter(a),r.enter("chunkString",{contentType:"string"}),k(U))}function k(U){return U===62?(r.exit("chunkString"),r.exit(a),D(U)):U===null||U===60||xr(U)?s(U):(r.consume(U),U===92?B:k)}function B(U){return U===60||U===62||U===92?(r.consume(U),k):k(U)}function F(U){return!R&&(U===null||U===41||Bs(U))?(r.exit("chunkString"),r.exit(a),r.exit(e),r.exit(c),i(U)):R<w&&U===40?(r.consume(U),R++,F):U===41?(r.consume(U),R--,F):U===null||U===32||U===40||P1(U)?s(U):(r.consume(U),U===92?K:F)}function K(U){return U===40||U===41||U===92?(r.consume(U),F):F(U)}}function VB(r,i,s,c,d,m){const e=this;let a=0,g;return w;function w(k){return r.enter(c),r.enter(d),r.consume(k),r.exit(d),r.enter(m),R}function R(k){return a>999||k===null||k===91||k===93&&!g||k===94&&!a&&"_hiddenFootnoteSupport"in e.parser.constructs?s(k):k===93?(r.exit(m),r.enter(d),r.consume(k),r.exit(d),r.exit(c),i):xr(k)?(r.enter("lineEnding"),r.consume(k),r.exit("lineEnding"),R):(r.enter("chunkString",{contentType:"string"}),S(k))}function S(k){return k===null||k===91||k===93||xr(k)||a++>999?(r.exit("chunkString"),R(k)):(r.consume(k),g||(g=!di(k)),k===92?D:S)}function D(k){return k===91||k===92||k===93?(r.consume(k),a++,S):S(k)}}function UB(r,i,s,c,d,m){let e;return a;function a(D){return D===34||D===39||D===40?(r.enter(c),r.enter(d),r.consume(D),r.exit(d),e=D===40?41:D,g):s(D)}function g(D){return D===e?(r.enter(d),r.consume(D),r.exit(d),r.exit(c),i):(r.enter(m),w(D))}function w(D){return D===e?(r.exit(m),g(e)):D===null?s(D):xr(D)?(r.enter("lineEnding"),r.consume(D),r.exit("lineEnding"),Ti(r,w,"linePrefix")):(r.enter("chunkString",{contentType:"string"}),R(D))}function R(D){return D===e||D===null||xr(D)?(r.exit("chunkString"),w(D)):(r.consume(D),D===92?S:R)}function S(D){return D===e||D===92?(r.consume(D),R):R(D)}}function Dm(r,i){let s;return c;function c(d){return xr(d)?(r.enter("lineEnding"),r.consume(d),r.exit("lineEnding"),s=!0,c):di(d)?Ti(r,c,s?"linePrefix":"lineSuffix")(d):i(d)}}var e5={name:"definition",tokenize:r5},t5={partial:!0,tokenize:i5};function r5(r,i,s){const c=this;let d;return m;function m(k){return r.enter("definition"),e(k)}function e(k){return VB.call(c,r,a,s,"definitionLabel","definitionLabelMarker","definitionLabelString")(k)}function a(k){return d=df(c.sliceSerialize(c.events[c.events.length-1][1]).slice(1,-1)),k===58?(r.enter("definitionMarker"),r.consume(k),r.exit("definitionMarker"),g):s(k)}function g(k){return Bs(k)?Dm(r,w)(k):w(k)}function w(k){return OB(r,R,s,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(k)}function R(k){return r.attempt(t5,S,S)(k)}function S(k){return di(k)?Ti(r,D,"whitespace")(k):D(k)}function D(k){return k===null||xr(k)?(r.exit("definition"),c.parser.defined.push(d),i(k)):s(k)}}function i5(r,i,s){return c;function c(a){return Bs(a)?Dm(r,d)(a):s(a)}function d(a){return UB(r,m,s,"definitionTitle","definitionTitleMarker","definitionTitleString")(a)}function m(a){return di(a)?Ti(r,e,"whitespace")(a):e(a)}function e(a){return a===null||xr(a)?i(a):s(a)}}var n5={name:"hardBreakEscape",tokenize:s5};function s5(r,i,s){return c;function c(m){return r.enter("hardBreakEscape"),r.consume(m),d}function d(m){return xr(m)?(r.exit("hardBreakEscape"),i(m)):s(m)}}var o5={name:"headingAtx",resolve:a5,tokenize:l5};function a5(r,i){let s=r.length-2,c=3,d,m;return r[c][1].type==="whitespace"&&(c+=2),s-2>c&&r[s][1].type==="whitespace"&&(s-=2),r[s][1].type==="atxHeadingSequence"&&(c===s-1||s-4>c&&r[s-2][1].type==="whitespace")&&(s-=c+1===s?2:4),s>c&&(d={type:"atxHeadingText",start:r[c][1].start,end:r[s][1].end},m={type:"chunkText",start:r[c][1].start,end:r[s][1].end,contentType:"text"},Sa(r,c,s-c+1,[["enter",d,i],["enter",m,i],["exit",m,i],["exit",d,i]])),r}function l5(r,i,s){let c=0;return d;function d(R){return r.enter("atxHeading"),m(R)}function m(R){return r.enter("atxHeadingSequence"),e(R)}function e(R){return R===35&&c++<6?(r.consume(R),e):R===null||Bs(R)?(r.exit("atxHeadingSequence"),a(R)):s(R)}function a(R){return R===35?(r.enter("atxHeadingSequence"),g(R)):R===null||xr(R)?(r.exit("atxHeading"),i(R)):di(R)?Ti(r,a,"whitespace")(R):(r.enter("atxHeadingText"),w(R))}function g(R){return R===35?(r.consume(R),g):(r.exit("atxHeadingSequence"),a(R))}function w(R){return R===null||R===35||Bs(R)?(r.exit("atxHeadingText"),a(R)):(r.consume(R),w)}}var u5=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],nR=["pre","script","style","textarea"],c5={concrete:!0,name:"htmlFlow",resolveTo:f5,tokenize:h5},d5={partial:!0,tokenize:y5},p5={partial:!0,tokenize:m5};function f5(r){let i=r.length;for(;i--&&!(r[i][0]==="enter"&&r[i][1].type==="htmlFlow"););return i>1&&r[i-2][1].type==="linePrefix"&&(r[i][1].start=r[i-2][1].start,r[i+1][1].start=r[i-2][1].start,r.splice(i-2,2)),r}function h5(r,i,s){const c=this;let d,m,e,a,g;return w;function w(Le){return R(Le)}function R(Le){return r.enter("htmlFlow"),r.enter("htmlFlowData"),r.consume(Le),S}function S(Le){return Le===33?(r.consume(Le),D):Le===47?(r.consume(Le),m=!0,F):Le===63?(r.consume(Le),d=3,c.interrupt?i:be):va(Le)?(r.consume(Le),e=String.fromCharCode(Le),K):s(Le)}function D(Le){return Le===45?(r.consume(Le),d=2,k):Le===91?(r.consume(Le),d=5,a=0,B):va(Le)?(r.consume(Le),d=4,c.interrupt?i:be):s(Le)}function k(Le){return Le===45?(r.consume(Le),c.interrupt?i:be):s(Le)}function B(Le){const ur="CDATA[";return Le===ur.charCodeAt(a++)?(r.consume(Le),a===ur.length?c.interrupt?i:rt:B):s(Le)}function F(Le){return va(Le)?(r.consume(Le),e=String.fromCharCode(Le),K):s(Le)}function K(Le){if(Le===null||Le===47||Le===62||Bs(Le)){const ur=Le===47,Tt=e.toLowerCase();return!ur&&!m&&nR.includes(Tt)?(d=1,c.interrupt?i(Le):rt(Le)):u5.includes(e.toLowerCase())?(d=6,ur?(r.consume(Le),U):c.interrupt?i(Le):rt(Le)):(d=7,c.interrupt&&!c.parser.lazy[c.now().line]?s(Le):m?ee(Le):le(Le))}return Le===45||io(Le)?(r.consume(Le),e+=String.fromCharCode(Le),K):s(Le)}function U(Le){return Le===62?(r.consume(Le),c.interrupt?i:rt):s(Le)}function ee(Le){return di(Le)?(r.consume(Le),ee):He(Le)}function le(Le){return Le===47?(r.consume(Le),He):Le===58||Le===95||va(Le)?(r.consume(Le),Q):di(Le)?(r.consume(Le),le):He(Le)}function Q(Le){return Le===45||Le===46||Le===58||Le===95||io(Le)?(r.consume(Le),Q):Te(Le)}function Te(Le){return Le===61?(r.consume(Le),pe):di(Le)?(r.consume(Le),Te):le(Le)}function pe(Le){return Le===null||Le===60||Le===61||Le===62||Le===96?s(Le):Le===34||Le===39?(r.consume(Le),g=Le,_e):di(Le)?(r.consume(Le),pe):Xe(Le)}function _e(Le){return Le===g?(r.consume(Le),g=null,dt):Le===null||xr(Le)?s(Le):(r.consume(Le),_e)}function Xe(Le){return Le===null||Le===34||Le===39||Le===47||Le===60||Le===61||Le===62||Le===96||Bs(Le)?Te(Le):(r.consume(Le),Xe)}function dt(Le){return Le===47||Le===62||di(Le)?le(Le):s(Le)}function He(Le){return Le===62?(r.consume(Le),et):s(Le)}function et(Le){return Le===null||xr(Le)?rt(Le):di(Le)?(r.consume(Le),et):s(Le)}function rt(Le){return Le===45&&d===2?(r.consume(Le),ye):Le===60&&d===1?(r.consume(Le),nt):Le===62&&d===4?(r.consume(Le),Ft):Le===63&&d===3?(r.consume(Le),be):Le===93&&d===5?(r.consume(Le),lt):xr(Le)&&(d===6||d===7)?(r.exit("htmlFlowData"),r.check(d5,Ut,te)(Le)):Le===null||xr(Le)?(r.exit("htmlFlowData"),te(Le)):(r.consume(Le),rt)}function te(Le){return r.check(p5,Be,Ut)(Le)}function Be(Le){return r.enter("lineEnding"),r.consume(Le),r.exit("lineEnding"),fe}function fe(Le){return Le===null||xr(Le)?te(Le):(r.enter("htmlFlowData"),rt(Le))}function ye(Le){return Le===45?(r.consume(Le),be):rt(Le)}function nt(Le){return Le===47?(r.consume(Le),e="",gt):rt(Le)}function gt(Le){if(Le===62){const ur=e.toLowerCase();return nR.includes(ur)?(r.consume(Le),Ft):rt(Le)}return va(Le)&&e.length<8?(r.consume(Le),e+=String.fromCharCode(Le),gt):rt(Le)}function lt(Le){return Le===93?(r.consume(Le),be):rt(Le)}function be(Le){return Le===62?(r.consume(Le),Ft):Le===45&&d===2?(r.consume(Le),be):rt(Le)}function Ft(Le){return Le===null||xr(Le)?(r.exit("htmlFlowData"),Ut(Le)):(r.consume(Le),Ft)}function Ut(Le){return r.exit("htmlFlow"),i(Le)}}function m5(r,i,s){const c=this;return d;function d(e){return xr(e)?(r.enter("lineEnding"),r.consume(e),r.exit("lineEnding"),m):s(e)}function m(e){return c.parser.lazy[c.now().line]?s(e):i(e)}}function y5(r,i,s){return c;function c(d){return r.enter("lineEnding"),r.consume(d),r.exit("lineEnding"),r.attempt(u0,i,s)}}var g5={name:"htmlText",tokenize:_5};function _5(r,i,s){const c=this;let d,m,e;return a;function a(be){return r.enter("htmlText"),r.enter("htmlTextData"),r.consume(be),g}function g(be){return be===33?(r.consume(be),w):be===47?(r.consume(be),Te):be===63?(r.consume(be),le):va(be)?(r.consume(be),Xe):s(be)}function w(be){return be===45?(r.consume(be),R):be===91?(r.consume(be),m=0,B):va(be)?(r.consume(be),ee):s(be)}function R(be){return be===45?(r.consume(be),k):s(be)}function S(be){return be===null?s(be):be===45?(r.consume(be),D):xr(be)?(e=S,nt(be)):(r.consume(be),S)}function D(be){return be===45?(r.consume(be),k):S(be)}function k(be){return be===62?ye(be):be===45?D(be):S(be)}function B(be){const Ft="CDATA[";return be===Ft.charCodeAt(m++)?(r.consume(be),m===Ft.length?F:B):s(be)}function F(be){return be===null?s(be):be===93?(r.consume(be),K):xr(be)?(e=F,nt(be)):(r.consume(be),F)}function K(be){return be===93?(r.consume(be),U):F(be)}function U(be){return be===62?ye(be):be===93?(r.consume(be),U):F(be)}function ee(be){return be===null||be===62?ye(be):xr(be)?(e=ee,nt(be)):(r.consume(be),ee)}function le(be){return be===null?s(be):be===63?(r.consume(be),Q):xr(be)?(e=le,nt(be)):(r.consume(be),le)}function Q(be){return be===62?ye(be):le(be)}function Te(be){return va(be)?(r.consume(be),pe):s(be)}function pe(be){return be===45||io(be)?(r.consume(be),pe):_e(be)}function _e(be){return xr(be)?(e=_e,nt(be)):di(be)?(r.consume(be),_e):ye(be)}function Xe(be){return be===45||io(be)?(r.consume(be),Xe):be===47||be===62||Bs(be)?dt(be):s(be)}function dt(be){return be===47?(r.consume(be),ye):be===58||be===95||va(be)?(r.consume(be),He):xr(be)?(e=dt,nt(be)):di(be)?(r.consume(be),dt):ye(be)}function He(be){return be===45||be===46||be===58||be===95||io(be)?(r.consume(be),He):et(be)}function et(be){return be===61?(r.consume(be),rt):xr(be)?(e=et,nt(be)):di(be)?(r.consume(be),et):dt(be)}function rt(be){return be===null||be===60||be===61||be===62||be===96?s(be):be===34||be===39?(r.consume(be),d=be,te):xr(be)?(e=rt,nt(be)):di(be)?(r.consume(be),rt):(r.consume(be),Be)}function te(be){return be===d?(r.consume(be),d=void 0,fe):be===null?s(be):xr(be)?(e=te,nt(be)):(r.consume(be),te)}function Be(be){return be===null||be===34||be===39||be===60||be===61||be===96?s(be):be===47||be===62||Bs(be)?dt(be):(r.consume(be),Be)}function fe(be){return be===47||be===62||Bs(be)?dt(be):s(be)}function ye(be){return be===62?(r.consume(be),r.exit("htmlTextData"),r.exit("htmlText"),i):s(be)}function nt(be){return r.exit("htmlTextData"),r.enter("lineEnding"),r.consume(be),r.exit("lineEnding"),gt}function gt(be){return di(be)?Ti(r,lt,"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(be):lt(be)}function lt(be){return r.enter("htmlTextData"),e(be)}}var Aw={name:"labelEnd",resolveAll:w5,resolveTo:E5,tokenize:A5},b5={tokenize:R5},v5={tokenize:S5},x5={tokenize:T5};function w5(r){let i=-1;const s=[];for(;++i<r.length;){const c=r[i][1];if(s.push(r[i]),c.type==="labelImage"||c.type==="labelLink"||c.type==="labelEnd"){const d=c.type==="labelImage"?4:2;c.type="data",i+=d}}return r.length!==s.length&&Sa(r,0,r.length,s),r}function E5(r,i){let s=r.length,c=0,d,m,e,a;for(;s--;)if(d=r[s][1],m){if(d.type==="link"||d.type==="labelLink"&&d._inactive)break;r[s][0]==="enter"&&d.type==="labelLink"&&(d._inactive=!0)}else if(e){if(r[s][0]==="enter"&&(d.type==="labelImage"||d.type==="labelLink")&&!d._balanced&&(m=s,d.type!=="labelLink")){c=2;break}}else d.type==="labelEnd"&&(e=s);const g={type:r[m][1].type==="labelLink"?"link":"image",start:{...r[m][1].start},end:{...r[r.length-1][1].end}},w={type:"label",start:{...r[m][1].start},end:{...r[e][1].end}},R={type:"labelText",start:{...r[m+c+2][1].end},end:{...r[e-2][1].start}};return a=[["enter",g,i],["enter",w,i]],a=vo(a,r.slice(m+1,m+c+3)),a=vo(a,[["enter",R,i]]),a=vo(a,Ew(i.parser.constructs.insideSpan.null,r.slice(m+c+4,e-3),i)),a=vo(a,[["exit",R,i],r[e-2],r[e-1],["exit",w,i]]),a=vo(a,r.slice(e+1)),a=vo(a,[["exit",g,i]]),Sa(r,m,r.length,a),r}function A5(r,i,s){const c=this;let d=c.events.length,m,e;for(;d--;)if((c.events[d][1].type==="labelImage"||c.events[d][1].type==="labelLink")&&!c.events[d][1]._balanced){m=c.events[d][1];break}return a;function a(D){return m?m._inactive?S(D):(e=c.parser.defined.includes(df(c.sliceSerialize({start:m.end,end:c.now()}))),r.enter("labelEnd"),r.enter("labelMarker"),r.consume(D),r.exit("labelMarker"),r.exit("labelEnd"),g):s(D)}function g(D){return D===40?r.attempt(b5,R,e?R:S)(D):D===91?r.attempt(v5,R,e?w:S)(D):e?R(D):S(D)}function w(D){return r.attempt(x5,R,S)(D)}function R(D){return i(D)}function S(D){return m._balanced=!0,s(D)}}function R5(r,i,s){return c;function c(S){return r.enter("resource"),r.enter("resourceMarker"),r.consume(S),r.exit("resourceMarker"),d}function d(S){return Bs(S)?Dm(r,m)(S):m(S)}function m(S){return S===41?R(S):OB(r,e,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(S)}function e(S){return Bs(S)?Dm(r,g)(S):R(S)}function a(S){return s(S)}function g(S){return S===34||S===39||S===40?UB(r,w,s,"resourceTitle","resourceTitleMarker","resourceTitleString")(S):R(S)}function w(S){return Bs(S)?Dm(r,R)(S):R(S)}function R(S){return S===41?(r.enter("resourceMarker"),r.consume(S),r.exit("resourceMarker"),r.exit("resource"),i):s(S)}}function S5(r,i,s){const c=this;return d;function d(a){return VB.call(c,r,m,e,"reference","referenceMarker","referenceString")(a)}function m(a){return c.parser.defined.includes(df(c.sliceSerialize(c.events[c.events.length-1][1]).slice(1,-1)))?i(a):s(a)}function e(a){return s(a)}}function T5(r,i,s){return c;function c(m){return r.enter("reference"),r.enter("referenceMarker"),r.consume(m),r.exit("referenceMarker"),d}function d(m){return m===93?(r.enter("referenceMarker"),r.consume(m),r.exit("referenceMarker"),r.exit("reference"),i):s(m)}}var C5={name:"labelStartImage",resolveAll:Aw.resolveAll,tokenize:k5};function k5(r,i,s){const c=this;return d;function d(a){return r.enter("labelImage"),r.enter("labelImageMarker"),r.consume(a),r.exit("labelImageMarker"),m}function m(a){return a===91?(r.enter("labelMarker"),r.consume(a),r.exit("labelMarker"),r.exit("labelImage"),e):s(a)}function e(a){return a===94&&"_hiddenFootnoteSupport"in c.parser.constructs?s(a):i(a)}}var P5={name:"labelStartLink",resolveAll:Aw.resolveAll,tokenize:L5};function L5(r,i,s){const c=this;return d;function d(e){return r.enter("labelLink"),r.enter("labelMarker"),r.consume(e),r.exit("labelMarker"),r.exit("labelLink"),m}function m(e){return e===94&&"_hiddenFootnoteSupport"in c.parser.constructs?s(e):i(e)}}var Bx={name:"lineEnding",tokenize:D5};function D5(r,i){return s;function s(c){return r.enter("lineEnding"),r.consume(c),r.exit("lineEnding"),Ti(r,i,"linePrefix")}}var wv={name:"thematicBreak",tokenize:I5};function I5(r,i,s){let c=0,d;return m;function m(w){return r.enter("thematicBreak"),e(w)}function e(w){return d=w,a(w)}function a(w){return w===d?(r.enter("thematicBreakSequence"),g(w)):c>=3&&(w===null||xr(w))?(r.exit("thematicBreak"),i(w)):s(w)}function g(w){return w===d?(r.consume(w),c++,g):(r.exit("thematicBreakSequence"),di(w)?Ti(r,a,"whitespace")(w):a(w))}}var Ds={continuation:{tokenize:O5},exit:U5,name:"list",tokenize:z5},B5={partial:!0,tokenize:j5},M5={partial:!0,tokenize:V5};function z5(r,i,s){const c=this,d=c.events[c.events.length-1];let m=d&&d[1].type==="linePrefix"?d[2].sliceSerialize(d[1],!0).length:0,e=0;return a;function a(k){const B=c.containerState.type||(k===42||k===43||k===45?"listUnordered":"listOrdered");if(B==="listUnordered"?!c.containerState.marker||k===c.containerState.marker:L1(k)){if(c.containerState.type||(c.containerState.type=B,r.enter(B,{_container:!0})),B==="listUnordered")return r.enter("listItemPrefix"),k===42||k===45?r.check(wv,s,w)(k):w(k);if(!c.interrupt||k===49)return r.enter("listItemPrefix"),r.enter("listItemValue"),g(k)}return s(k)}function g(k){return L1(k)&&++e<10?(r.consume(k),g):(!c.interrupt||e<2)&&(c.containerState.marker?k===c.containerState.marker:k===41||k===46)?(r.exit("listItemValue"),w(k)):s(k)}function w(k){return r.enter("listItemMarker"),r.consume(k),r.exit("listItemMarker"),c.containerState.marker=c.containerState.marker||k,r.check(u0,c.interrupt?s:R,r.attempt(B5,D,S))}function R(k){return c.containerState.initialBlankLine=!0,m++,D(k)}function S(k){return di(k)?(r.enter("listItemPrefixWhitespace"),r.consume(k),r.exit("listItemPrefixWhitespace"),D):s(k)}function D(k){return c.containerState.size=m+c.sliceSerialize(r.exit("listItemPrefix"),!0).length,i(k)}}function O5(r,i,s){const c=this;return c.containerState._closeFlow=void 0,r.check(u0,d,m);function d(a){return c.containerState.furtherBlankLines=c.containerState.furtherBlankLines||c.containerState.initialBlankLine,Ti(r,i,"listItemIndent",c.containerState.size+1)(a)}function m(a){return c.containerState.furtherBlankLines||!di(a)?(c.containerState.furtherBlankLines=void 0,c.containerState.initialBlankLine=void 0,e(a)):(c.containerState.furtherBlankLines=void 0,c.containerState.initialBlankLine=void 0,r.attempt(M5,i,e)(a))}function e(a){return c.containerState._closeFlow=!0,c.interrupt=void 0,Ti(r,r.attempt(Ds,i,s),"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function V5(r,i,s){const c=this;return Ti(r,d,"listItemIndent",c.containerState.size+1);function d(m){const e=c.events[c.events.length-1];return e&&e[1].type==="listItemIndent"&&e[2].sliceSerialize(e[1],!0).length===c.containerState.size?i(m):s(m)}}function U5(r){r.exit(this.containerState.type)}function j5(r,i,s){const c=this;return Ti(r,d,"listItemPrefixWhitespace",c.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function d(m){const e=c.events[c.events.length-1];return!di(m)&&e&&e[1].type==="listItemPrefixWhitespace"?i(m):s(m)}}var sR={name:"setextUnderline",resolveTo:N5,tokenize:F5};function N5(r,i){let s=r.length,c,d,m;for(;s--;)if(r[s][0]==="enter"){if(r[s][1].type==="content"){c=s;break}r[s][1].type==="paragraph"&&(d=s)}else r[s][1].type==="content"&&r.splice(s,1),!m&&r[s][1].type==="definition"&&(m=s);const e={type:"setextHeading",start:{...r[c][1].start},end:{...r[r.length-1][1].end}};return r[d][1].type="setextHeadingText",m?(r.splice(d,0,["enter",e,i]),r.splice(m+1,0,["exit",r[c][1],i]),r[c][1].end={...r[m][1].end}):r[c][1]=e,r.push(["exit",e,i]),r}function F5(r,i,s){const c=this;let d;return m;function m(w){let R=c.events.length,S;for(;R--;)if(c.events[R][1].type!=="lineEnding"&&c.events[R][1].type!=="linePrefix"&&c.events[R][1].type!=="content"){S=c.events[R][1].type==="paragraph";break}return!c.parser.lazy[c.now().line]&&(c.interrupt||S)?(r.enter("setextHeadingLine"),d=w,e(w)):s(w)}function e(w){return r.enter("setextHeadingLineSequence"),a(w)}function a(w){return w===d?(r.consume(w),a):(r.exit("setextHeadingLineSequence"),di(w)?Ti(r,g,"lineSuffix")(w):g(w))}function g(w){return w===null||xr(w)?(r.exit("setextHeadingLine"),i(w)):s(w)}}var q5={tokenize:K5};function K5(r){const i=this,s=r.attempt(u0,c,r.attempt(this.parser.constructs.flowInitial,d,Ti(r,r.attempt(this.parser.constructs.flow,d,r.attempt(XN,d)),"linePrefix")));return s;function c(m){if(m===null){r.consume(m);return}return r.enter("lineEndingBlank"),r.consume(m),r.exit("lineEndingBlank"),i.currentConstruct=void 0,s}function d(m){if(m===null){r.consume(m);return}return r.enter("lineEnding"),r.consume(m),r.exit("lineEnding"),i.currentConstruct=void 0,s}}var G5={resolveAll:NB()},$5=jB("string"),Z5=jB("text");function jB(r){return{resolveAll:NB(r==="text"?H5:void 0),tokenize:i};function i(s){const c=this,d=this.parser.constructs[r],m=s.attempt(d,e,a);return e;function e(R){return w(R)?m(R):a(R)}function a(R){if(R===null){s.consume(R);return}return s.enter("data"),s.consume(R),g}function g(R){return w(R)?(s.exit("data"),m(R)):(s.consume(R),g)}function w(R){if(R===null)return!0;const S=d[R];let D=-1;if(S)for(;++D<S.length;){const k=S[D];if(!k.previous||k.previous.call(c,c.previous))return!0}return!1}}}function NB(r){return i;function i(s,c){let d=-1,m;for(;++d<=s.length;)m===void 0?s[d]&&s[d][1].type==="data"&&(m=d,d++):(!s[d]||s[d][1].type!=="data")&&(d!==m+2&&(s[m][1].end=s[d-1][1].end,s.splice(m+2,d-m-2),d=m+2),m=void 0);return r?r(s,c):s}}function H5(r,i){let s=0;for(;++s<=r.length;)if((s===r.length||r[s][1].type==="lineEnding")&&r[s-1][1].type==="data"){const c=r[s-1][1],d=i.sliceStream(c);let m=d.length,e=-1,a=0,g;for(;m--;){const w=d[m];if(typeof w=="string"){for(e=w.length;w.charCodeAt(e-1)===32;)a++,e--;if(e)break;e=-1}else if(w===-2)g=!0,a++;else if(w!==-1){m++;break}}if(i._contentTypeTextTrailing&&s===r.length&&(a=0),a){const w={type:s===r.length||g||a<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:m?e:c.start._bufferIndex+e,_index:c.start._index+m,line:c.end.line,column:c.end.column-a,offset:c.end.offset-a},end:{...c.end}};c.end={...w.start},c.start.offset===c.end.offset?Object.assign(c,w):(r.splice(s,0,["enter",w,i],["exit",w,i]),s+=2)}s++}return r}var FB={};aN(FB,{attentionMarkers:()=>r4,contentInitial:()=>W5,disable:()=>i4,document:()=>X5,flow:()=>J5,flowInitial:()=>Y5,insideSpan:()=>t4,string:()=>Q5,text:()=>e4});var X5={42:Ds,43:Ds,45:Ds,48:Ds,49:Ds,50:Ds,51:Ds,52:Ds,53:Ds,54:Ds,55:Ds,56:Ds,57:Ds,62:IB},W5={91:e5},Y5={[-2]:Ix,[-1]:Ix,32:Ix},J5={35:o5,42:wv,45:[sR,wv],60:c5,61:sR,95:wv,96:iR,126:iR},Q5={38:MB,92:BB},e4={[-5]:Bx,[-4]:Bx,[-3]:Bx,33:C5,38:MB,42:D1,60:[PN,g5],91:P5,92:[n5,BB],93:Aw,95:D1,96:qN},t4={null:[D1,G5]},r4={null:[42,95]},i4={null:[]};function n4(r,i,s){let c={_bufferIndex:-1,_index:0,line:s&&s.line||1,column:s&&s.column||1,offset:s&&s.offset||0};const d={},m=[];let e=[],a=[];const g={attempt:_e(Te),check:_e(pe),consume:ee,enter:le,exit:Q,interrupt:_e(pe,{interrupt:!0})},w={code:null,containerState:{},defineSkip:F,events:[],now:B,parser:r,previous:null,sliceSerialize:D,sliceStream:k,write:S};let R=i.tokenize.call(w,g);return i.resolveAll&&m.push(i),w;function S(et){return e=vo(e,et),K(),e[e.length-1]!==null?[]:(Xe(i,0),w.events=Ew(m,w.events,w),w.events)}function D(et,rt){return o4(k(et),rt)}function k(et){return s4(e,et)}function B(){const{_bufferIndex:et,_index:rt,line:te,column:Be,offset:fe}=c;return{_bufferIndex:et,_index:rt,line:te,column:Be,offset:fe}}function F(et){d[et.line]=et.column,He()}function K(){let et;for(;c._index<e.length;){const rt=e[c._index];if(typeof rt=="string")for(et=c._index,c._bufferIndex<0&&(c._bufferIndex=0);c._index===et&&c._bufferIndex<rt.length;)U(rt.charCodeAt(c._bufferIndex));else U(rt)}}function U(et){R=R(et)}function ee(et){xr(et)?(c.line++,c.column=1,c.offset+=et===-3?2:1,He()):et!==-1&&(c.column++,c.offset++),c._bufferIndex<0?c._index++:(c._bufferIndex++,c._bufferIndex===e[c._index].length&&(c._bufferIndex=-1,c._index++)),w.previous=et}function le(et,rt){const te=rt||{};return te.type=et,te.start=B(),w.events.push(["enter",te,w]),a.push(te),te}function Q(et){const rt=a.pop();return rt.end=B(),w.events.push(["exit",rt,w]),rt}function Te(et,rt){Xe(et,rt.from)}function pe(et,rt){rt.restore()}function _e(et,rt){return te;function te(Be,fe,ye){let nt,gt,lt,be;return Array.isArray(Be)?Ut(Be):"tokenize"in Be?Ut([Be]):Ft(Be);function Ft(tr){return qr;function qr(lr){const kr=lr!==null&&tr[lr],Sr=lr!==null&&tr.null,$r=[...Array.isArray(kr)?kr:kr?[kr]:[],...Array.isArray(Sr)?Sr:Sr?[Sr]:[]];return Ut($r)(lr)}}function Ut(tr){return nt=tr,gt=0,tr.length===0?ye:Le(tr[gt])}function Le(tr){return qr;function qr(lr){return be=dt(),lt=tr,tr.partial||(w.currentConstruct=tr),tr.name&&w.parser.constructs.disable.null.includes(tr.name)?Tt():tr.tokenize.call(rt?Object.assign(Object.create(w),rt):w,g,ur,Tt)(lr)}}function ur(tr){return et(lt,be),fe}function Tt(tr){return be.restore(),++gt<nt.length?Le(nt[gt]):ye}}}function Xe(et,rt){et.resolveAll&&!m.includes(et)&&m.push(et),et.resolve&&Sa(w.events,rt,w.events.length-rt,et.resolve(w.events.slice(rt),w)),et.resolveTo&&(w.events=et.resolveTo(w.events,w))}function dt(){const et=B(),rt=w.previous,te=w.currentConstruct,Be=w.events.length,fe=Array.from(a);return{from:Be,restore:ye};function ye(){c=et,w.previous=rt,w.currentConstruct=te,w.events.length=Be,a=fe,He()}}function He(){c.line in d&&c.column<2&&(c.column=d[c.line],c.offset+=d[c.line]-1)}}function s4(r,i){const s=i.start._index,c=i.start._bufferIndex,d=i.end._index,m=i.end._bufferIndex;let e;if(s===d)e=[r[s].slice(c,m)];else{if(e=r.slice(s,d),c>-1){const a=e[0];typeof a=="string"?e[0]=a.slice(c):e.shift()}m>0&&e.push(r[d].slice(0,m))}return e}function o4(r,i){let s=-1;const c=[];let d;for(;++s<r.length;){const m=r[s];let e;if(typeof m=="string")e=m;else switch(m){case-5:{e="\r";break}case-4:{e=`
`;break}case-3:{e=`\r
`;break}case-2:{e=i?" ":"	";break}case-1:{if(!i&&d)continue;e=" ";break}default:e=String.fromCharCode(m)}d=m===-2,c.push(e)}return c.join("")}function a4(r){const c={constructs:mN([FB,...(r||{}).extensions||[]]),content:d(EN),defined:[],document:d(RN),flow:d(q5),lazy:{},string:d($5),text:d(Z5)};return c;function d(m){return e;function e(a){return n4(c,m,a)}}}function l4(r){for(;!zB(r););return r}var oR=/[\0\t\n\r]/g;function u4(){let r=1,i="",s=!0,c;return d;function d(m,e,a){const g=[];let w,R,S,D,k;for(m=i+(typeof m=="string"?m.toString():new TextDecoder(e||void 0).decode(m)),S=0,i="",s&&(m.charCodeAt(0)===65279&&S++,s=void 0);S<m.length;){if(oR.lastIndex=S,w=oR.exec(m),D=w&&w.index!==void 0?w.index:m.length,k=m.charCodeAt(D),!w){i=m.slice(S);break}if(k===10&&S===D&&c)g.push(-3),c=void 0;else switch(c&&(g.push(-5),c=void 0),S<D&&(g.push(m.slice(S,D)),r+=D-S),k){case 0:{g.push(65533),r++;break}case 9:{for(R=Math.ceil(r/4)*4,g.push(-2);r++<R;)g.push(-1);break}case 10:{g.push(-4),r=1;break}default:c=!0,r=1}S=D+1}return a&&(c&&g.push(-5),i&&g.push(i),g.push(null)),g}}var c4=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function d4(r){return r.replace(c4,p4)}function p4(r,i,s){if(i)return i;if(s.charCodeAt(0)===35){const d=s.charCodeAt(1),m=d===120||d===88;return DB(s.slice(m?2:1),m?16:10)}return ww(s)||r}function Im(r){return!r||typeof r!="object"?"":"position"in r||"type"in r?aR(r.position):"start"in r||"end"in r?aR(r):"line"in r||"column"in r?I1(r):""}function I1(r){return lR(r&&r.line)+":"+lR(r&&r.column)}function aR(r){return I1(r&&r.start)+"-"+I1(r&&r.end)}function lR(r){return r&&typeof r=="number"?r:1}var qB={}.hasOwnProperty;function f4(r,i,s){return typeof i!="string"&&(s=i,i=void 0),h4(s)(l4(a4(s).document().write(u4()(r,i,!0))))}function h4(r){const i={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:m(er),autolinkProtocol:dt,autolinkEmail:dt,atxHeading:m(Xr),blockQuote:m(Sr),characterEscape:dt,characterReference:dt,codeFenced:m($r),codeFencedFenceInfo:e,codeFencedFenceMeta:e,codeIndented:m($r,e),codeText:m(sr,e),codeTextData:dt,data:dt,codeFlowValue:dt,definition:m(br),definitionDestinationString:e,definitionLabelString:e,definitionTitleString:e,emphasis:m(nr),hardBreakEscape:m(Vt),hardBreakTrailing:m(Vt),htmlFlow:m(Pr,e),htmlFlowData:dt,htmlText:m(Pr,e),htmlTextData:dt,image:m(Ct),label:e,link:m(er),listItem:m(Lr),listItemValue:D,listOrdered:m(or,S),listUnordered:m(or),paragraph:m(Jr),reference:Le,referenceString:e,resourceDestinationString:e,resourceTitleString:e,setextHeading:m(Xr),strong:m(bt),thematicBreak:m(Oi)},exit:{atxHeading:g(),atxHeadingSequence:Te,autolink:g(),autolinkEmail:kr,autolinkProtocol:lr,blockQuote:g(),characterEscapeValue:He,characterReferenceMarkerHexadecimal:Tt,characterReferenceMarkerNumeric:Tt,characterReferenceValue:tr,characterReference:qr,codeFenced:g(K),codeFencedFence:F,codeFencedFenceInfo:k,codeFencedFenceMeta:B,codeFlowValue:He,codeIndented:g(U),codeText:g(fe),codeTextData:He,data:He,definition:g(),definitionDestinationString:Q,definitionLabelString:ee,definitionTitleString:le,emphasis:g(),hardBreakEscape:g(rt),hardBreakTrailing:g(rt),htmlFlow:g(te),htmlFlowData:He,htmlText:g(Be),htmlTextData:He,image:g(nt),label:lt,labelText:gt,lineEnding:et,link:g(ye),listItem:g(),listOrdered:g(),listUnordered:g(),paragraph:g(),referenceString:ur,resourceDestinationString:be,resourceTitleString:Ft,resource:Ut,setextHeading:g(Xe),setextHeadingLineSequence:_e,setextHeadingText:pe,strong:g(),thematicBreak:g()}};KB(i,(r||{}).mdastExtensions||[]);const s={};return c;function c(Oe){let vt={type:"root",children:[]};const Nt={stack:[vt],tokenStack:[],config:i,enter:a,exit:w,buffer:e,resume:R,data:s},we=[];let W=-1;for(;++W<Oe.length;)if(Oe[W][1].type==="listOrdered"||Oe[W][1].type==="listUnordered")if(Oe[W][0]==="enter")we.push(W);else{const J=we.pop();W=d(Oe,J,W)}for(W=-1;++W<Oe.length;){const J=i[Oe[W][0]];qB.call(J,Oe[W][1].type)&&J[Oe[W][1].type].call(Object.assign({sliceSerialize:Oe[W][2].sliceSerialize},Nt),Oe[W][1])}if(Nt.tokenStack.length>0){const J=Nt.tokenStack[Nt.tokenStack.length-1];(J[1]||uR).call(Nt,void 0,J[0])}for(vt.position={start:Nl(Oe.length>0?Oe[0][1].start:{line:1,column:1,offset:0}),end:Nl(Oe.length>0?Oe[Oe.length-2][1].end:{line:1,column:1,offset:0})},W=-1;++W<i.transforms.length;)vt=i.transforms[W](vt)||vt;return vt}function d(Oe,vt,Nt){let we=vt-1,W=-1,J=!1,se,ve,Se,je;for(;++we<=Nt;){const Ge=Oe[we];switch(Ge[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ge[0]==="enter"?W++:W--,je=void 0;break}case"lineEndingBlank":{Ge[0]==="enter"&&(se&&!je&&!W&&!Se&&(Se=we),je=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:je=void 0}if(!W&&Ge[0]==="enter"&&Ge[1].type==="listItemPrefix"||W===-1&&Ge[0]==="exit"&&(Ge[1].type==="listUnordered"||Ge[1].type==="listOrdered")){if(se){let Ne=we;for(ve=void 0;Ne--;){const Qe=Oe[Ne];if(Qe[1].type==="lineEnding"||Qe[1].type==="lineEndingBlank"){if(Qe[0]==="exit")continue;ve&&(Oe[ve][1].type="lineEndingBlank",J=!0),Qe[1].type="lineEnding",ve=Ne}else if(!(Qe[1].type==="linePrefix"||Qe[1].type==="blockQuotePrefix"||Qe[1].type==="blockQuotePrefixWhitespace"||Qe[1].type==="blockQuoteMarker"||Qe[1].type==="listItemIndent"))break}Se&&(!ve||Se<ve)&&(se._spread=!0),se.end=Object.assign({},ve?Oe[ve][1].start:Ge[1].end),Oe.splice(ve||we,0,["exit",se,Ge[2]]),we++,Nt++}if(Ge[1].type==="listItemPrefix"){const Ne={type:"listItem",_spread:!1,start:Object.assign({},Ge[1].start),end:void 0};se=Ne,Oe.splice(we,0,["enter",Ne,Ge[2]]),we++,Nt++,Se=void 0,je=!0}}}return Oe[vt][1]._spread=J,Nt}function m(Oe,vt){return Nt;function Nt(we){a.call(this,Oe(we),we),vt&&vt.call(this,we)}}function e(){this.stack.push({type:"fragment",children:[]})}function a(Oe,vt,Nt){this.stack[this.stack.length-1].children.push(Oe),this.stack.push(Oe),this.tokenStack.push([vt,Nt||void 0]),Oe.position={start:Nl(vt.start),end:void 0}}function g(Oe){return vt;function vt(Nt){Oe&&Oe.call(this,Nt),w.call(this,Nt)}}function w(Oe,vt){const Nt=this.stack.pop(),we=this.tokenStack.pop();if(we)we[0].type!==Oe.type&&(vt?vt.call(this,Oe,we[0]):(we[1]||uR).call(this,Oe,we[0]));else throw new Error("Cannot close `"+Oe.type+"` ("+Im({start:Oe.start,end:Oe.end})+"): it’s not open");Nt.position.end=Nl(Oe.end)}function R(){return pN(this.stack.pop())}function S(){this.data.expectingFirstListItemValue=!0}function D(Oe){if(this.data.expectingFirstListItemValue){const vt=this.stack[this.stack.length-2];vt.start=Number.parseInt(this.sliceSerialize(Oe),10),this.data.expectingFirstListItemValue=void 0}}function k(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.lang=Oe}function B(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.meta=Oe}function F(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function K(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function U(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe.replace(/(\r?\n|\r)$/g,"")}function ee(Oe){const vt=this.resume(),Nt=this.stack[this.stack.length-1];Nt.label=vt,Nt.identifier=df(this.sliceSerialize(Oe)).toLowerCase()}function le(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.title=Oe}function Q(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.url=Oe}function Te(Oe){const vt=this.stack[this.stack.length-1];if(!vt.depth){const Nt=this.sliceSerialize(Oe).length;vt.depth=Nt}}function pe(){this.data.setextHeadingSlurpLineEnding=!0}function _e(Oe){const vt=this.stack[this.stack.length-1];vt.depth=this.sliceSerialize(Oe).codePointAt(0)===61?1:2}function Xe(){this.data.setextHeadingSlurpLineEnding=void 0}function dt(Oe){const Nt=this.stack[this.stack.length-1].children;let we=Nt[Nt.length-1];(!we||we.type!=="text")&&(we=gi(),we.position={start:Nl(Oe.start),end:void 0},Nt.push(we)),this.stack.push(we)}function He(Oe){const vt=this.stack.pop();vt.value+=this.sliceSerialize(Oe),vt.position.end=Nl(Oe.end)}function et(Oe){const vt=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Nt=vt.children[vt.children.length-1];Nt.position.end=Nl(Oe.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&i.canContainEols.includes(vt.type)&&(dt.call(this,Oe),He.call(this,Oe))}function rt(){this.data.atHardBreak=!0}function te(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe}function Be(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe}function fe(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe}function ye(){const Oe=this.stack[this.stack.length-1];if(this.data.inReference){const vt=this.data.referenceType||"shortcut";Oe.type+="Reference",Oe.referenceType=vt,delete Oe.url,delete Oe.title}else delete Oe.identifier,delete Oe.label;this.data.referenceType=void 0}function nt(){const Oe=this.stack[this.stack.length-1];if(this.data.inReference){const vt=this.data.referenceType||"shortcut";Oe.type+="Reference",Oe.referenceType=vt,delete Oe.url,delete Oe.title}else delete Oe.identifier,delete Oe.label;this.data.referenceType=void 0}function gt(Oe){const vt=this.sliceSerialize(Oe),Nt=this.stack[this.stack.length-2];Nt.label=d4(vt),Nt.identifier=df(vt).toLowerCase()}function lt(){const Oe=this.stack[this.stack.length-1],vt=this.resume(),Nt=this.stack[this.stack.length-1];if(this.data.inReference=!0,Nt.type==="link"){const we=Oe.children;Nt.children=we}else Nt.alt=vt}function be(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.url=Oe}function Ft(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.title=Oe}function Ut(){this.data.inReference=void 0}function Le(){this.data.referenceType="collapsed"}function ur(Oe){const vt=this.resume(),Nt=this.stack[this.stack.length-1];Nt.label=vt,Nt.identifier=df(this.sliceSerialize(Oe)).toLowerCase(),this.data.referenceType="full"}function Tt(Oe){this.data.characterReferenceType=Oe.type}function tr(Oe){const vt=this.sliceSerialize(Oe),Nt=this.data.characterReferenceType;let we;Nt?(we=DB(vt,Nt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):we=ww(vt);const W=this.stack[this.stack.length-1];W.value+=we}function qr(Oe){const vt=this.stack.pop();vt.position.end=Nl(Oe.end)}function lr(Oe){He.call(this,Oe);const vt=this.stack[this.stack.length-1];vt.url=this.sliceSerialize(Oe)}function kr(Oe){He.call(this,Oe);const vt=this.stack[this.stack.length-1];vt.url="mailto:"+this.sliceSerialize(Oe)}function Sr(){return{type:"blockquote",children:[]}}function $r(){return{type:"code",lang:null,meta:null,value:""}}function sr(){return{type:"inlineCode",value:""}}function br(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function nr(){return{type:"emphasis",children:[]}}function Xr(){return{type:"heading",depth:0,children:[]}}function Vt(){return{type:"break"}}function Pr(){return{type:"html",value:""}}function Ct(){return{type:"image",title:null,url:"",alt:null}}function er(){return{type:"link",title:null,url:"",children:[]}}function or(Oe){return{type:"list",ordered:Oe.type==="listOrdered",start:null,spread:Oe._spread,children:[]}}function Lr(Oe){return{type:"listItem",spread:Oe._spread,checked:null,children:[]}}function Jr(){return{type:"paragraph",children:[]}}function bt(){return{type:"strong",children:[]}}function gi(){return{type:"text",value:""}}function Oi(){return{type:"thematicBreak"}}}function Nl(r){return{line:r.line,column:r.column,offset:r.offset}}function KB(r,i){let s=-1;for(;++s<i.length;){const c=i[s];Array.isArray(c)?KB(r,c):m4(r,c)}}function m4(r,i){let s;for(s in i)if(qB.call(i,s))switch(s){case"canContainEols":{const c=i[s];c&&r[s].push(...c);break}case"transforms":{const c=i[s];c&&r[s].push(...c);break}case"enter":case"exit":{const c=i[s];c&&Object.assign(r[s],c);break}}}function uR(r,i){throw r?new Error("Cannot close `"+r.type+"` ("+Im({start:r.start,end:r.end})+"): a different token (`"+i.type+"`, "+Im({start:i.start,end:i.end})+") is open"):new Error("Cannot close document, a token (`"+i.type+"`, "+Im({start:i.start,end:i.end})+") is still open")}function y4(r){const i=this;i.parser=s;function s(c){return f4(c,{...i.data("settings"),...r,extensions:i.data("micromarkExtensions")||[],mdastExtensions:i.data("fromMarkdownExtensions")||[]})}}function g4(r,i){const s={type:"element",tagName:"blockquote",properties:{},children:r.wrap(r.all(i),!0)};return r.patch(i,s),r.applyData(i,s)}function _4(r,i){const s={type:"element",tagName:"br",properties:{},children:[]};return r.patch(i,s),[r.applyData(i,s),{type:"text",value:`
`}]}function b4(r,i){const s=i.value?i.value+`
`:"",c={};i.lang&&(c.className=["language-"+i.lang]);let d={type:"element",tagName:"code",properties:c,children:[{type:"text",value:s}]};return i.meta&&(d.data={meta:i.meta}),r.patch(i,d),d=r.applyData(i,d),d={type:"element",tagName:"pre",properties:{},children:[d]},r.patch(i,d),d}function v4(r,i){const s={type:"element",tagName:"del",properties:{},children:r.all(i)};return r.patch(i,s),r.applyData(i,s)}function x4(r,i){const s={type:"element",tagName:"em",properties:{},children:r.all(i)};return r.patch(i,s),r.applyData(i,s)}function w4(r,i){const s=typeof r.options.clobberPrefix=="string"?r.options.clobberPrefix:"user-content-",c=String(i.identifier).toUpperCase(),d=Ef(c.toLowerCase()),m=r.footnoteOrder.indexOf(c);let e,a=r.footnoteCounts.get(c);a===void 0?(a=0,r.footnoteOrder.push(c),e=r.footnoteOrder.length):e=m+1,a+=1,r.footnoteCounts.set(c,a);const g={type:"element",tagName:"a",properties:{href:"#"+s+"fn-"+d,id:s+"fnref-"+d+(a>1?"-"+a:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(e)}]};r.patch(i,g);const w={type:"element",tagName:"sup",properties:{},children:[g]};return r.patch(i,w),r.applyData(i,w)}function E4(r,i){const s={type:"element",tagName:"h"+i.depth,properties:{},children:r.all(i)};return r.patch(i,s),r.applyData(i,s)}function A4(r,i){if(r.options.allowDangerousHtml){const s={type:"raw",value:i.value};return r.patch(i,s),r.applyData(i,s)}}function GB(r,i){const s=i.referenceType;let c="]";if(s==="collapsed"?c+="[]":s==="full"&&(c+="["+(i.label||i.identifier)+"]"),i.type==="imageReference")return[{type:"text",value:"!["+i.alt+c}];const d=r.all(i),m=d[0];m&&m.type==="text"?m.value="["+m.value:d.unshift({type:"text",value:"["});const e=d[d.length-1];return e&&e.type==="text"?e.value+=c:d.push({type:"text",value:c}),d}function R4(r,i){const s=String(i.identifier).toUpperCase(),c=r.definitionById.get(s);if(!c)return GB(r,i);const d={src:Ef(c.url||""),alt:i.alt};c.title!==null&&c.title!==void 0&&(d.title=c.title);const m={type:"element",tagName:"img",properties:d,children:[]};return r.patch(i,m),r.applyData(i,m)}function S4(r,i){const s={src:Ef(i.url)};i.alt!==null&&i.alt!==void 0&&(s.alt=i.alt),i.title!==null&&i.title!==void 0&&(s.title=i.title);const c={type:"element",tagName:"img",properties:s,children:[]};return r.patch(i,c),r.applyData(i,c)}function T4(r,i){const s={type:"text",value:i.value.replace(/\r?\n|\r/g," ")};r.patch(i,s);const c={type:"element",tagName:"code",properties:{},children:[s]};return r.patch(i,c),r.applyData(i,c)}function C4(r,i){const s=String(i.identifier).toUpperCase(),c=r.definitionById.get(s);if(!c)return GB(r,i);const d={href:Ef(c.url||"")};c.title!==null&&c.title!==void 0&&(d.title=c.title);const m={type:"element",tagName:"a",properties:d,children:r.all(i)};return r.patch(i,m),r.applyData(i,m)}function k4(r,i){const s={href:Ef(i.url)};i.title!==null&&i.title!==void 0&&(s.title=i.title);const c={type:"element",tagName:"a",properties:s,children:r.all(i)};return r.patch(i,c),r.applyData(i,c)}function P4(r,i,s){const c=r.all(i),d=s?L4(s):$B(i),m={},e=[];if(typeof i.checked=="boolean"){const R=c[0];let S;R&&R.type==="element"&&R.tagName==="p"?S=R:(S={type:"element",tagName:"p",properties:{},children:[]},c.unshift(S)),S.children.length>0&&S.children.unshift({type:"text",value:" "}),S.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:i.checked,disabled:!0},children:[]}),m.className=["task-list-item"]}let a=-1;for(;++a<c.length;){const R=c[a];(d||a!==0||R.type!=="element"||R.tagName!=="p")&&e.push({type:"text",value:`
`}),R.type==="element"&&R.tagName==="p"&&!d?e.push(...R.children):e.push(R)}const g=c[c.length-1];g&&(d||g.type!=="element"||g.tagName!=="p")&&e.push({type:"text",value:`
`});const w={type:"element",tagName:"li",properties:m,children:e};return r.patch(i,w),r.applyData(i,w)}function L4(r){let i=!1;if(r.type==="list"){i=r.spread||!1;const s=r.children;let c=-1;for(;!i&&++c<s.length;)i=$B(s[c])}return i}function $B(r){const i=r.spread;return i??r.children.length>1}function D4(r,i){const s={},c=r.all(i);let d=-1;for(typeof i.start=="number"&&i.start!==1&&(s.start=i.start);++d<c.length;){const e=c[d];if(e.type==="element"&&e.tagName==="li"&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){s.className=["contains-task-list"];break}}const m={type:"element",tagName:i.ordered?"ol":"ul",properties:s,children:r.wrap(c,!0)};return r.patch(i,m),r.applyData(i,m)}function I4(r,i){const s={type:"element",tagName:"p",properties:{},children:r.all(i)};return r.patch(i,s),r.applyData(i,s)}function B4(r,i){const s={type:"root",children:r.wrap(r.all(i))};return r.patch(i,s),r.applyData(i,s)}function M4(r,i){const s={type:"element",tagName:"strong",properties:{},children:r.all(i)};return r.patch(i,s),r.applyData(i,s)}var ZB=XB("end"),HB=XB("start");function XB(r){return i;function i(s){const c=s&&s.position&&s.position[r]||{};if(typeof c.line=="number"&&c.line>0&&typeof c.column=="number"&&c.column>0)return{line:c.line,column:c.column,offset:typeof c.offset=="number"&&c.offset>-1?c.offset:void 0}}}function z4(r){const i=HB(r),s=ZB(r);if(i&&s)return{start:i,end:s}}function O4(r,i){const s=r.all(i),c=s.shift(),d=[];if(c){const e={type:"element",tagName:"thead",properties:{},children:r.wrap([c],!0)};r.patch(i.children[0],e),d.push(e)}if(s.length>0){const e={type:"element",tagName:"tbody",properties:{},children:r.wrap(s,!0)},a=HB(i.children[1]),g=ZB(i.children[i.children.length-1]);a&&g&&(e.position={start:a,end:g}),d.push(e)}const m={type:"element",tagName:"table",properties:{},children:r.wrap(d,!0)};return r.patch(i,m),r.applyData(i,m)}function V4(r,i,s){const c=s?s.children:void 0,m=(c?c.indexOf(i):1)===0?"th":"td",e=s&&s.type==="table"?s.align:void 0,a=e?e.length:i.children.length;let g=-1;const w=[];for(;++g<a;){const S=i.children[g],D={},k=e?e[g]:void 0;k&&(D.align=k);let B={type:"element",tagName:m,properties:D,children:[]};S&&(B.children=r.all(S),r.patch(S,B),B=r.applyData(S,B)),w.push(B)}const R={type:"element",tagName:"tr",properties:{},children:r.wrap(w,!0)};return r.patch(i,R),r.applyData(i,R)}function U4(r,i){const s={type:"element",tagName:"td",properties:{},children:r.all(i)};return r.patch(i,s),r.applyData(i,s)}var cR=9,dR=32;function j4(r){const i=String(r),s=/\r?\n|\r/g;let c=s.exec(i),d=0;const m=[];for(;c;)m.push(pR(i.slice(d,c.index),d>0,!0),c[0]),d=c.index+c[0].length,c=s.exec(i);return m.push(pR(i.slice(d),d>0,!1)),m.join("")}function pR(r,i,s){let c=0,d=r.length;if(i){let m=r.codePointAt(c);for(;m===cR||m===dR;)c++,m=r.codePointAt(c)}if(s){let m=r.codePointAt(d-1);for(;m===cR||m===dR;)d--,m=r.codePointAt(d-1)}return d>c?r.slice(c,d):""}function N4(r,i){const s={type:"text",value:j4(String(i.value))};return r.patch(i,s),r.applyData(i,s)}function F4(r,i){const s={type:"element",tagName:"hr",properties:{},children:[]};return r.patch(i,s),r.applyData(i,s)}var q4={blockquote:g4,break:_4,code:b4,delete:v4,emphasis:x4,footnoteReference:w4,heading:E4,html:A4,imageReference:R4,image:S4,inlineCode:T4,linkReference:C4,link:k4,listItem:P4,list:D4,paragraph:I4,root:B4,strong:M4,table:O4,tableCell:U4,tableRow:V4,text:N4,thematicBreak:F4,toml:yg,yaml:yg,definition:yg,footnoteDefinition:yg};function yg(){}var WB=-1,c0=0,Bm=1,jv=2,Rw=3,Sw=4,Tw=5,Cw=6,YB=7,JB=8,fR=typeof self=="object"?self:globalThis,K4=(r,i)=>{const s=(d,m)=>(r.set(m,d),d),c=d=>{if(r.has(d))return r.get(d);const[m,e]=i[d];switch(m){case c0:case WB:return s(e,d);case Bm:{const a=s([],d);for(const g of e)a.push(c(g));return a}case jv:{const a=s({},d);for(const[g,w]of e)a[c(g)]=c(w);return a}case Rw:return s(new Date(e),d);case Sw:{const{source:a,flags:g}=e;return s(new RegExp(a,g),d)}case Tw:{const a=s(new Map,d);for(const[g,w]of e)a.set(c(g),c(w));return a}case Cw:{const a=s(new Set,d);for(const g of e)a.add(c(g));return a}case YB:{const{name:a,message:g}=e;return s(new fR[a](g),d)}case JB:return s(BigInt(e),d);case"BigInt":return s(Object(BigInt(e)),d);case"ArrayBuffer":return s(new Uint8Array(e).buffer,e);case"DataView":{const{buffer:a}=new Uint8Array(e);return s(new DataView(a),e)}}return s(new fR[m](e),d)};return c},hR=r=>K4(new Map,r)(0),Yd="",{toString:G4}={},{keys:$4}=Object,zh=r=>{const i=typeof r;if(i!=="object"||!r)return[c0,i];const s=G4.call(r).slice(8,-1);switch(s){case"Array":return[Bm,Yd];case"Object":return[jv,Yd];case"Date":return[Rw,Yd];case"RegExp":return[Sw,Yd];case"Map":return[Tw,Yd];case"Set":return[Cw,Yd];case"DataView":return[Bm,s]}return s.includes("Array")?[Bm,s]:s.includes("Error")?[YB,s]:[jv,s]},gg=([r,i])=>r===c0&&(i==="function"||i==="symbol"),Z4=(r,i,s,c)=>{const d=(e,a)=>{const g=c.push(e)-1;return s.set(a,g),g},m=e=>{if(s.has(e))return s.get(e);let[a,g]=zh(e);switch(a){case c0:{let R=e;switch(g){case"bigint":a=JB,R=e.toString();break;case"function":case"symbol":if(r)throw new TypeError("unable to serialize "+g);R=null;break;case"undefined":return d([WB],e)}return d([a,R],e)}case Bm:{if(g){let D=e;return g==="DataView"?D=new Uint8Array(e.buffer):g==="ArrayBuffer"&&(D=new Uint8Array(e)),d([g,[...D]],e)}const R=[],S=d([a,R],e);for(const D of e)R.push(m(D));return S}case jv:{if(g)switch(g){case"BigInt":return d([g,e.toString()],e);case"Boolean":case"Number":case"String":return d([g,e.valueOf()],e)}if(i&&"toJSON"in e)return m(e.toJSON());const R=[],S=d([a,R],e);for(const D of $4(e))(r||!gg(zh(e[D])))&&R.push([m(D),m(e[D])]);return S}case Rw:return d([a,e.toISOString()],e);case Sw:{const{source:R,flags:S}=e;return d([a,{source:R,flags:S}],e)}case Tw:{const R=[],S=d([a,R],e);for(const[D,k]of e)(r||!(gg(zh(D))||gg(zh(k))))&&R.push([m(D),m(k)]);return S}case Cw:{const R=[],S=d([a,R],e);for(const D of e)(r||!gg(zh(D)))&&R.push(m(D));return S}}const{message:w}=e;return d([a,{name:g,message:w}],e)};return m},mR=(r,{json:i,lossy:s}={})=>{const c=[];return Z4(!(i||s),!!i,new Map,c)(r),c},Nv=typeof structuredClone=="function"?((r,i)=>i&&("json"in i||"lossy"in i)?hR(mR(r,i)):structuredClone(r)):(r,i)=>hR(mR(r,i));function H4(r,i){const s=[{type:"text",value:"↩"}];return i>1&&s.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(i)}]}),s}function X4(r,i){return"Back to reference "+(r+1)+(i>1?"-"+i:"")}function W4(r){const i=typeof r.options.clobberPrefix=="string"?r.options.clobberPrefix:"user-content-",s=r.options.footnoteBackContent||H4,c=r.options.footnoteBackLabel||X4,d=r.options.footnoteLabel||"Footnotes",m=r.options.footnoteLabelTagName||"h2",e=r.options.footnoteLabelProperties||{className:["sr-only"]},a=[];let g=-1;for(;++g<r.footnoteOrder.length;){const w=r.footnoteById.get(r.footnoteOrder[g]);if(!w)continue;const R=r.all(w),S=String(w.identifier).toUpperCase(),D=Ef(S.toLowerCase());let k=0;const B=[],F=r.footnoteCounts.get(S);for(;F!==void 0&&++k<=F;){B.length>0&&B.push({type:"text",value:" "});let ee=typeof s=="string"?s:s(g,k);typeof ee=="string"&&(ee={type:"text",value:ee}),B.push({type:"element",tagName:"a",properties:{href:"#"+i+"fnref-"+D+(k>1?"-"+k:""),dataFootnoteBackref:"",ariaLabel:typeof c=="string"?c:c(g,k),className:["data-footnote-backref"]},children:Array.isArray(ee)?ee:[ee]})}const K=R[R.length-1];if(K&&K.type==="element"&&K.tagName==="p"){const ee=K.children[K.children.length-1];ee&&ee.type==="text"?ee.value+=" ":K.children.push({type:"text",value:" "}),K.children.push(...B)}else R.push(...B);const U={type:"element",tagName:"li",properties:{id:i+"fn-"+D},children:r.wrap(R,!0)};r.patch(w,U),a.push(U)}if(a.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:m,properties:{...Nv(e),id:"footnote-label"},children:[{type:"text",value:d}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:r.wrap(a,!0)},{type:"text",value:`
`}]}}var QB=(function(r){if(r==null)return eF;if(typeof r=="function")return d0(r);if(typeof r=="object")return Array.isArray(r)?Y4(r):J4(r);if(typeof r=="string")return Q4(r);throw new Error("Expected function, string, or object as test")});function Y4(r){const i=[];let s=-1;for(;++s<r.length;)i[s]=QB(r[s]);return d0(c);function c(...d){let m=-1;for(;++m<i.length;)if(i[m].apply(this,d))return!0;return!1}}function J4(r){const i=r;return d0(s);function s(c){const d=c;let m;for(m in r)if(d[m]!==i[m])return!1;return!0}}function Q4(r){return d0(i);function i(s){return s&&s.type===r}}function d0(r){return i;function i(s,c,d){return!!(tF(s)&&r.call(this,s,typeof c=="number"?c:void 0,d||void 0))}}function eF(){return!0}function tF(r){return r!==null&&typeof r=="object"&&"type"in r}var eM=[],rF=!0,yR=!1,iF="skip";function nF(r,i,s,c){let d;typeof i=="function"&&typeof s!="function"?(c=s,s=i):d=i;const m=QB(d),e=c?-1:1;a(r,void 0,[])();function a(g,w,R){const S=g&&typeof g=="object"?g:{};if(typeof S.type=="string"){const k=typeof S.tagName=="string"?S.tagName:typeof S.name=="string"?S.name:void 0;Object.defineProperty(D,"name",{value:"node ("+(g.type+(k?"<"+k+">":""))+")"})}return D;function D(){let k=eM,B,F,K;if((!i||m(g,w,R[R.length-1]||void 0))&&(k=sF(s(g,R)),k[0]===yR))return k;if("children"in g&&g.children){const U=g;if(U.children&&k[0]!==iF)for(F=(c?U.children.length:-1)+e,K=R.concat(U);F>-1&&F<U.children.length;){const ee=U.children[F];if(B=a(ee,F,K)(),B[0]===yR)return B;F=typeof B[1]=="number"?B[1]:F+e}}return k}}}function sF(r){return Array.isArray(r)?r:typeof r=="number"?[rF,r]:r==null?eM:[r]}function oF(r,i,s,c){let d,m,e;typeof i=="function"&&typeof s!="function"?(m=void 0,e=i,d=s):(m=i,e=s,d=c),nF(r,m,a,d);function a(g,w){const R=w[w.length-1],S=R?R.children.indexOf(g):void 0;return e(g,S,R)}}var B1={}.hasOwnProperty,aF={};function lF(r,i){const s=i||aF,c=new Map,d=new Map,m=new Map,e={...q4,...s.handlers},a={all:w,applyData:cF,definitionById:c,footnoteById:d,footnoteCounts:m,footnoteOrder:[],handlers:e,one:g,options:s,patch:uF,wrap:pF};return oF(r,function(R){if(R.type==="definition"||R.type==="footnoteDefinition"){const S=R.type==="definition"?c:d,D=String(R.identifier).toUpperCase();S.has(D)||S.set(D,R)}}),a;function g(R,S){const D=R.type,k=a.handlers[D];if(B1.call(a.handlers,D)&&k)return k(a,R,S);if(a.options.passThrough&&a.options.passThrough.includes(D)){if("children"in R){const{children:F,...K}=R,U=Nv(K);return U.children=a.all(R),U}return Nv(R)}return(a.options.unknownHandler||dF)(a,R,S)}function w(R){const S=[];if("children"in R){const D=R.children;let k=-1;for(;++k<D.length;){const B=a.one(D[k],R);if(B){if(k&&D[k-1].type==="break"&&(!Array.isArray(B)&&B.type==="text"&&(B.value=gR(B.value)),!Array.isArray(B)&&B.type==="element")){const F=B.children[0];F&&F.type==="text"&&(F.value=gR(F.value))}Array.isArray(B)?S.push(...B):S.push(B)}}}return S}}function uF(r,i){r.position&&(i.position=z4(r))}function cF(r,i){let s=i;if(r&&r.data){const c=r.data.hName,d=r.data.hChildren,m=r.data.hProperties;if(typeof c=="string")if(s.type==="element")s.tagName=c;else{const e="children"in s?s.children:[s];s={type:"element",tagName:c,properties:{},children:e}}s.type==="element"&&m&&Object.assign(s.properties,Nv(m)),"children"in s&&s.children&&d!==null&&d!==void 0&&(s.children=d)}return s}function dF(r,i){const s=i.data||{},c="value"in i&&!(B1.call(s,"hProperties")||B1.call(s,"hChildren"))?{type:"text",value:i.value}:{type:"element",tagName:"div",properties:{},children:r.all(i)};return r.patch(i,c),r.applyData(i,c)}function pF(r,i){const s=[];let c=-1;for(i&&s.push({type:"text",value:`
`});++c<r.length;)c&&s.push({type:"text",value:`
`}),s.push(r[c]);return i&&r.length>0&&s.push({type:"text",value:`
`}),s}function gR(r){let i=0,s=r.charCodeAt(i);for(;s===9||s===32;)i++,s=r.charCodeAt(i);return r.slice(i)}function _R(r,i){const s=lF(r,i),c=s.one(r,void 0),d=W4(s),m=Array.isArray(c)?{type:"root",children:c}:c||{type:"root",children:[]};return d&&m.children.push({type:"text",value:`
`},d),m}function fF(r,i){return r&&"run"in r?async function(s,c){const d=_R(s,{file:c,...i});await r.run(d,c)}:function(s,c){return _R(s,{file:c,...r||i})}}function bR(r){if(r)throw r}var Mx=uN(cN());function M1(r){if(typeof r!="object"||r===null)return!1;const i=Object.getPrototypeOf(r);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}function hF(){const r=[],i={run:s,use:c};return i;function s(...d){let m=-1;const e=d.pop();if(typeof e!="function")throw new TypeError("Expected function as last argument, not "+e);a(null,...d);function a(g,...w){const R=r[++m];let S=-1;if(g){e(g);return}for(;++S<d.length;)(w[S]===null||w[S]===void 0)&&(w[S]=d[S]);d=w,R?mF(R,a)(...w):e(null,...w)}}function c(d){if(typeof d!="function")throw new TypeError("Expected `middelware` to be a function, not "+d);return r.push(d),i}}function mF(r,i){let s;return c;function c(...e){const a=r.length>e.length;let g;a&&e.push(d);try{g=r.apply(this,e)}catch(w){const R=w;if(a&&s)throw R;return d(R)}a||(g&&g.then&&typeof g.then=="function"?g.then(m,d):g instanceof Error?d(g):m(g))}function d(e,...a){s||(s=!0,i(e,...a))}function m(e){d(null,e)}}var zs=class extends Error{constructor(r,i,s){super(),typeof i=="string"&&(s=i,i=void 0);let c="",d={},m=!1;if(i&&("line"in i&&"column"in i?d={place:i}:"start"in i&&"end"in i?d={place:i}:"type"in i?d={ancestors:[i],place:i.position}:d={...i}),typeof r=="string"?c=r:!d.cause&&r&&(m=!0,c=r.message,d.cause=r),!d.ruleId&&!d.source&&typeof s=="string"){const a=s.indexOf(":");a===-1?d.ruleId=s:(d.source=s.slice(0,a),d.ruleId=s.slice(a+1))}if(!d.place&&d.ancestors&&d.ancestors){const a=d.ancestors[d.ancestors.length-1];a&&(d.place=a.position)}const e=d.place&&"start"in d.place?d.place.start:d.place;this.ancestors=d.ancestors||void 0,this.cause=d.cause||void 0,this.column=e?e.column:void 0,this.fatal=void 0,this.file="",this.message=c,this.line=e?e.line:void 0,this.name=Im(d.place)||"1:1",this.place=d.place||void 0,this.reason=this.message,this.ruleId=d.ruleId||void 0,this.source=d.source||void 0,this.stack=m&&d.cause&&typeof d.cause.stack=="string"?d.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}};zs.prototype.file="";zs.prototype.name="";zs.prototype.reason="";zs.prototype.message="";zs.prototype.stack="";zs.prototype.column=void 0;zs.prototype.line=void 0;zs.prototype.ancestors=void 0;zs.prototype.cause=void 0;zs.prototype.fatal=void 0;zs.prototype.place=void 0;zs.prototype.ruleId=void 0;zs.prototype.source=void 0;var _a={basename:yF,dirname:gF,extname:_F,join:bF,sep:"/"};function yF(r,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');Qm(r);let s=0,c=-1,d=r.length,m;if(i===void 0||i.length===0||i.length>r.length){for(;d--;)if(r.codePointAt(d)===47){if(m){s=d+1;break}}else c<0&&(m=!0,c=d+1);return c<0?"":r.slice(s,c)}if(i===r)return"";let e=-1,a=i.length-1;for(;d--;)if(r.codePointAt(d)===47){if(m){s=d+1;break}}else e<0&&(m=!0,e=d+1),a>-1&&(r.codePointAt(d)===i.codePointAt(a--)?a<0&&(c=d):(a=-1,c=e));return s===c?c=e:c<0&&(c=r.length),r.slice(s,c)}function gF(r){if(Qm(r),r.length===0)return".";let i=-1,s=r.length,c;for(;--s;)if(r.codePointAt(s)===47){if(c){i=s;break}}else c||(c=!0);return i<0?r.codePointAt(0)===47?"/":".":i===1&&r.codePointAt(0)===47?"//":r.slice(0,i)}function _F(r){Qm(r);let i=r.length,s=-1,c=0,d=-1,m=0,e;for(;i--;){const a=r.codePointAt(i);if(a===47){if(e){c=i+1;break}continue}s<0&&(e=!0,s=i+1),a===46?d<0?d=i:m!==1&&(m=1):d>-1&&(m=-1)}return d<0||s<0||m===0||m===1&&d===s-1&&d===c+1?"":r.slice(d,s)}function bF(...r){let i=-1,s;for(;++i<r.length;)Qm(r[i]),r[i]&&(s=s===void 0?r[i]:s+"/"+r[i]);return s===void 0?".":vF(s)}function vF(r){Qm(r);const i=r.codePointAt(0)===47;let s=xF(r,!i);return s.length===0&&!i&&(s="."),s.length>0&&r.codePointAt(r.length-1)===47&&(s+="/"),i?"/"+s:s}function xF(r,i){let s="",c=0,d=-1,m=0,e=-1,a,g;for(;++e<=r.length;){if(e<r.length)a=r.codePointAt(e);else{if(a===47)break;a=47}if(a===47){if(!(d===e-1||m===1))if(d!==e-1&&m===2){if(s.length<2||c!==2||s.codePointAt(s.length-1)!==46||s.codePointAt(s.length-2)!==46){if(s.length>2){if(g=s.lastIndexOf("/"),g!==s.length-1){g<0?(s="",c=0):(s=s.slice(0,g),c=s.length-1-s.lastIndexOf("/")),d=e,m=0;continue}}else if(s.length>0){s="",c=0,d=e,m=0;continue}}i&&(s=s.length>0?s+"/..":"..",c=2)}else s.length>0?s+="/"+r.slice(d+1,e):s=r.slice(d+1,e),c=e-d-1;d=e,m=0}else a===46&&m>-1?m++:m=-1}return s}function Qm(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}var wF={cwd:EF};function EF(){return"/"}function z1(r){return!!(r!==null&&typeof r=="object"&&"href"in r&&r.href&&"protocol"in r&&r.protocol&&r.auth===void 0)}function AF(r){if(typeof r=="string")r=new URL(r);else if(!z1(r)){const i=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+r+"`");throw i.code="ERR_INVALID_ARG_TYPE",i}if(r.protocol!=="file:"){const i=new TypeError("The URL must be of scheme file");throw i.code="ERR_INVALID_URL_SCHEME",i}return RF(r)}function RF(r){if(r.hostname!==""){const c=new TypeError('File URL host must be "localhost" or empty on darwin');throw c.code="ERR_INVALID_FILE_URL_HOST",c}const i=r.pathname;let s=-1;for(;++s<i.length;)if(i.codePointAt(s)===37&&i.codePointAt(s+1)===50){const c=i.codePointAt(s+2);if(c===70||c===102){const d=new TypeError("File URL path must not include encoded / characters");throw d.code="ERR_INVALID_FILE_URL_PATH",d}}return decodeURIComponent(i)}var zx=["history","path","basename","stem","extname","dirname"],SF=class{constructor(r){let i;r?z1(r)?i={path:r}:typeof r=="string"||TF(r)?i={value:r}:i=r:i={},this.cwd="cwd"in i?"":wF.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let s=-1;for(;++s<zx.length;){const d=zx[s];d in i&&i[d]!==void 0&&i[d]!==null&&(this[d]=d==="history"?[...i[d]]:i[d])}let c;for(c in i)zx.includes(c)||(this[c]=i[c])}get basename(){return typeof this.path=="string"?_a.basename(this.path):void 0}set basename(r){Vx(r,"basename"),Ox(r,"basename"),this.path=_a.join(this.dirname||"",r)}get dirname(){return typeof this.path=="string"?_a.dirname(this.path):void 0}set dirname(r){vR(this.basename,"dirname"),this.path=_a.join(r||"",this.basename)}get extname(){return typeof this.path=="string"?_a.extname(this.path):void 0}set extname(r){if(Ox(r,"extname"),vR(this.dirname,"extname"),r){if(r.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(r.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=_a.join(this.dirname,this.stem+(r||""))}get path(){return this.history[this.history.length-1]}set path(r){z1(r)&&(r=AF(r)),Vx(r,"path"),this.path!==r&&this.history.push(r)}get stem(){return typeof this.path=="string"?_a.basename(this.path,this.extname):void 0}set stem(r){Vx(r,"stem"),Ox(r,"stem"),this.path=_a.join(this.dirname||"",r+(this.extname||""))}fail(r,i,s){const c=this.message(r,i,s);throw c.fatal=!0,c}info(r,i,s){const c=this.message(r,i,s);return c.fatal=void 0,c}message(r,i,s){const c=new zs(r,i,s);return this.path&&(c.name=this.path+":"+c.name,c.file=this.path),c.fatal=!1,this.messages.push(c),c}toString(r){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(r||void 0).decode(this.value)}};function Ox(r,i){if(r&&r.includes(_a.sep))throw new Error("`"+i+"` cannot be a path: did not expect `"+_a.sep+"`")}function Vx(r,i){if(!r)throw new Error("`"+i+"` cannot be empty")}function vR(r,i){if(!r)throw new Error("Setting `"+i+"` requires `path` to be set too")}function TF(r){return!!(r&&typeof r=="object"&&"byteLength"in r&&"byteOffset"in r)}var CF=(function(r){const c=this.constructor.prototype,d=c[r],m=function(){return d.apply(m,arguments)};return Object.setPrototypeOf(m,c),m}),kF={}.hasOwnProperty,PF=class tM extends CF{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=hF()}copy(){const i=new tM;let s=-1;for(;++s<this.attachers.length;){const c=this.attachers[s];i.use(...c)}return i.data((0,Mx.default)(!0,{},this.namespace)),i}data(i,s){return typeof i=="string"?arguments.length===2?(Nx("data",this.frozen),this.namespace[i]=s,this):kF.call(this.namespace,i)&&this.namespace[i]||void 0:i?(Nx("data",this.frozen),this.namespace=i,this):this.namespace}freeze(){if(this.frozen)return this;const i=this;for(;++this.freezeIndex<this.attachers.length;){const[s,...c]=this.attachers[this.freezeIndex];if(c[0]===!1)continue;c[0]===!0&&(c[0]=void 0);const d=s.call(i,...c);typeof d=="function"&&this.transformers.use(d)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(i){this.freeze();const s=_g(i),c=this.parser||this.Parser;return Ux("parse",c),c(String(s),s)}process(i,s){const c=this;return this.freeze(),Ux("process",this.parser||this.Parser),jx("process",this.compiler||this.Compiler),s?d(void 0,s):new Promise(d);function d(m,e){const a=_g(i),g=c.parse(a);c.run(g,a,function(R,S,D){if(R||!S||!D)return w(R);const k=S,B=c.stringify(k,D);IF(B)?D.value=B:D.result=B,w(R,D)});function w(R,S){R||!S?e(R):m?m(S):s(void 0,S)}}}processSync(i){let s=!1,c;return this.freeze(),Ux("processSync",this.parser||this.Parser),jx("processSync",this.compiler||this.Compiler),this.process(i,d),wR("processSync","process",s),c;function d(m,e){s=!0,bR(m),c=e}}run(i,s,c){xR(i),this.freeze();const d=this.transformers;return!c&&typeof s=="function"&&(c=s,s=void 0),c?m(void 0,c):new Promise(m);function m(e,a){const g=_g(s);d.run(i,g,w);function w(R,S,D){const k=S||i;R?a(R):e?e(k):c(void 0,k,D)}}}runSync(i,s){let c=!1,d;return this.run(i,s,m),wR("runSync","run",c),d;function m(e,a){bR(e),d=a,c=!0}}stringify(i,s){this.freeze();const c=_g(s),d=this.compiler||this.Compiler;return jx("stringify",d),xR(i),d(i,c)}use(i,...s){const c=this.attachers,d=this.namespace;if(Nx("use",this.frozen),i!=null)if(typeof i=="function")g(i,s);else if(typeof i=="object")Array.isArray(i)?a(i):e(i);else throw new TypeError("Expected usable value, not `"+i+"`");return this;function m(w){if(typeof w=="function")g(w,[]);else if(typeof w=="object")if(Array.isArray(w)){const[R,...S]=w;g(R,S)}else e(w);else throw new TypeError("Expected usable value, not `"+w+"`")}function e(w){if(!("plugins"in w)&&!("settings"in w))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");a(w.plugins),w.settings&&(d.settings=(0,Mx.default)(!0,d.settings,w.settings))}function a(w){let R=-1;if(w!=null)if(Array.isArray(w))for(;++R<w.length;){const S=w[R];m(S)}else throw new TypeError("Expected a list of plugins, not `"+w+"`")}function g(w,R){let S=-1,D=-1;for(;++S<c.length;)if(c[S][0]===w){D=S;break}if(D===-1)c.push([w,...R]);else if(R.length>0){let[k,...B]=R;const F=c[D][1];M1(F)&&M1(k)&&(k=(0,Mx.default)(!0,F,k)),c[D]=[w,k,...B]}}}},LF=new PF().freeze();function Ux(r,i){if(typeof i!="function")throw new TypeError("Cannot `"+r+"` without `parser`")}function jx(r,i){if(typeof i!="function")throw new TypeError("Cannot `"+r+"` without `compiler`")}function Nx(r,i){if(i)throw new Error("Cannot call `"+r+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function xR(r){if(!M1(r)||typeof r.type!="string")throw new TypeError("Expected node, got `"+r+"`")}function wR(r,i,s){if(!s)throw new Error("`"+r+"` finished async. Use `"+i+"` instead")}function _g(r){return DF(r)?r:new SF(r)}function DF(r){return!!(r&&typeof r=="object"&&"message"in r&&"messages"in r)}function IF(r){return typeof r=="string"||BF(r)}function BF(r){return!!(r&&typeof r=="object"&&"byteLength"in r&&"byteOffset"in r)}var O1=r=>r!=null,MF=r=>r.replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`),zF=r=>{r.type!=="element"||r.properties===void 0||!Array.isArray(r.properties.className)||(r.properties.class=r.properties.className.join(" "),delete r.properties.className)},OF=r=>{if(r.type!=="element"||r.properties===void 0)return;const i=Object.keys(r.properties).filter(s=>s.startsWith("aria"));for(const s of i){const c=r.properties[s];delete r.properties[s],r.properties[MF(s)]=c}},VF=r=>{zF(r),OF(r)},rM=(r,i)=>{r(i),i.children?.forEach(s=>rM(r,s))},UF=()=>(r,i,s)=>{try{rM(VF,r),s()}catch(c){return c instanceof Error?s(c):s(new Error(String(c)))}},jF=r=>{const i=LF().use(y4).use(r.map(s=>s.remarkPlugin).filter(O1)).use(fF,{allowDangerousHtml:!0}).use(r.map(s=>s.rehypePlugin).filter(O1)).use(UF);return s=>i.runSync(i.parse(s),s)},iM=(r,i,s=[])=>{if(s.includes(i))throw s.push(i),new Error(`Circular dependency detected: ${s.join(" -> ")}`);const c=r[i];return typeof c=="string"?iM(r,c,[...s,i]):c===null?null:c===void 0?i:c},ER=r=>r.map(i=>i.renderer).filter(O1).reduce((i,s)=>({...i,...s}),{}),V1=Symbol.for("snippetRenderer"),NF=r=>{const i=r;return i[V1]=!0,i};const Oh=(r,i=xa)=>{var s=ai(),c=Fr(s);Cc(c,17,i,Tc,(d,m)=>{nM(d,{get astNode(){return Pe(m)}})}),fr(r,s)};function nM(r,i){mn(i,!0);const s=Jj(),c=CB(i.astNode);tw(()=>{c.current=i.astNode}),tN(c);const d="svg";i.astNode.type==="element"&&i.astNode.tagName==="svg"&&mu(d,!0);var m=ai(),e=Fr(m);{var a=w=>{Oh(w,()=>i.astNode.children)},g=w=>{var R=ai(),S=Fr(R);{var D=B=>{const F=Hr(()=>iM(s.current,i.astNode.tagName));var K=ai(),U=Fr(K);{var ee=Q=>{var Te=ai(),pe=Fr(Te);{var _e=dt=>{const He=Hr(()=>Pe(F));var et=ai(),rt=Fr(et);{var te=fe=>{var ye=ai(),nt=Fr(ye);Rm(nt,()=>Pe(He),!0,(gt,lt)=>{sf(gt,()=>({xmlns:"http://www.w3.org/2000/svg",...i.astNode.properties})),Oh(lt,()=>i.astNode.children)}),fr(fe,ye)},Be=fe=>{var ye=ai(),nt=Fr(ye);Rm(nt,()=>Pe(He),!0,(gt,lt)=>{sf(gt,()=>({xmlns:"http://www.w3.org/2000/svg",...i.astNode.properties}))}),fr(fe,ye)};Qi(rt,fe=>{Array.isArray(i.astNode.children)&&i.astNode.children.length!==0?fe(te):fe(Be,!1)})}fr(dt,et)},Xe=dt=>{var He=ai(),et=Fr(He);{var rt=Be=>{var fe=ai(),ye=Fr(fe);Rm(ye,()=>Pe(F),!1,(nt,gt)=>{sf(nt,()=>({...i.astNode.properties})),Oh(gt,()=>i.astNode.children)}),fr(Be,fe)},te=Be=>{var fe=ai(),ye=Fr(fe);Rm(ye,()=>Pe(F),!1,(nt,gt)=>{sf(nt,()=>({...i.astNode.properties}))}),fr(Be,fe)};Qi(et,Be=>{Array.isArray(i.astNode.children)&&i.astNode.children.length!==0?Be(rt):Be(te,!1)},!0)}fr(dt,He)};Qi(pe,dt=>{hu(d)?dt(_e):dt(Xe,!1)})}fr(Q,Te)},le=Q=>{var Te=ai(),pe=Fr(Te);{var _e=Xe=>{var dt=ai(),He=Fr(dt);{var et=te=>{var Be=ai(),fe=Fr(Be);{var ye=gt=>{var lt=ai();const be=Ut=>{Oh(Ut,()=>i.astNode.children)};var Ft=Fr(lt);{let Ut=Hr(()=>({...i.astNode.properties,children:be}));hf(Ft,()=>Pe(F),()=>Pe(Ut))}fr(gt,lt)},nt=gt=>{var lt=ai(),be=Fr(lt);hf(be,()=>Pe(F),()=>i.astNode.properties),fr(gt,lt)};Qi(fe,gt=>{Array.isArray(i.astNode.children)&&i.astNode.children.length!==0?gt(ye):gt(nt,!1)})}fr(te,Be)},rt=te=>{var Be=ai(),fe=Fr(Be);{var ye=gt=>{var lt=ai(),be=Fr(lt);Tm(be,()=>Pe(F),(Ft,Ut)=>{Ut(Ft,R1(()=>i.astNode.properties,{children:(Le,ur)=>{Oh(Le,()=>i.astNode.children)},$$slots:{default:!0}}))}),fr(gt,lt)},nt=gt=>{var lt=ai(),be=Fr(lt);Tm(be,()=>Pe(F),(Ft,Ut)=>{Ut(Ft,R1(()=>i.astNode.properties))}),fr(gt,lt)};Qi(fe,gt=>{Array.isArray(i.astNode.children)&&i.astNode.children.length!==0?gt(ye):gt(nt,!1)},!0)}fr(te,Be)};Qi(He,te=>{V1 in Pe(F)&&Pe(F)[V1]?te(et):te(rt,!1)})}fr(Xe,dt)};Qi(pe,Xe=>{Pe(F)!==null&&Xe(_e)},!0)}fr(Q,Te)};Qi(U,Q=>{typeof Pe(F)=="string"?Q(ee):Q(le,!1)})}fr(B,K)},k=B=>{var F=ai(),K=Fr(F);{var U=ee=>{var le=LI();no(()=>Ea(le,i.astNode.value)),fr(ee,le)};Qi(K,ee=>{(i.astNode.type==="text"||i.astNode.type==="raw")&&ee(U)},!0)}fr(B,F)};Qi(S,B=>{i.astNode.type==="element"?B(D):B(k,!1)},!0)}fr(w,R)};Qi(e,w=>{i.astNode.type==="root"?w(a):w(g,!1)})}fr(r,m),yn()}function FF(r,i){mn(i,!0);let s=St(i,"plugins",19,()=>[]),c=GI(i,["$$slots","$$events","$$legacy","md","plugins"]),d=Hr(()=>({renderer:Object.fromEntries(Object.entries(c).map(([g,w])=>{if(typeof w=="string")return[g,w];if(typeof w=="function")return[g,NF(w)]}).filter(g=>g!=null))})),m=Hr(()=>jF(s()));const e=CB(ER([...s(),Pe(d)]));xi(()=>{e.current=ER([...s(),Pe(d)])}),Qj(e);let a=Hr(()=>Pe(m)(i.md));nM(r,{get astNode(){return Pe(a)}}),yn()}var tc={},rc={},Fx={},Mo={},ic={},Ha={},bg={},Xa={},qx={},AR;function p0(){return AR||(AR=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getParsedType=r.ZodParsedType=r.objectUtil=r.util=void 0;var i;(function(d){d.assertEqual=g=>{};function m(g){}d.assertIs=m;function e(g){throw new Error}d.assertNever=e,d.arrayToEnum=g=>{const w={};for(const R of g)w[R]=R;return w},d.getValidEnumValues=g=>{const w=d.objectKeys(g).filter(S=>typeof g[g[S]]!="number"),R={};for(const S of w)R[S]=g[S];return d.objectValues(R)},d.objectValues=g=>d.objectKeys(g).map(function(w){return g[w]}),d.objectKeys=typeof Object.keys=="function"?g=>Object.keys(g):g=>{const w=[];for(const R in g)Object.prototype.hasOwnProperty.call(g,R)&&w.push(R);return w},d.find=(g,w)=>{for(const R of g)if(w(R))return R},d.isInteger=typeof Number.isInteger=="function"?g=>Number.isInteger(g):g=>typeof g=="number"&&Number.isFinite(g)&&Math.floor(g)===g;function a(g,w=" | "){return g.map(R=>typeof R=="string"?`'${R}'`:R).join(w)}d.joinValues=a,d.jsonStringifyReplacer=(g,w)=>typeof w=="bigint"?w.toString():w})(i||(r.util=i={}));var s;(function(d){d.mergeShapes=(m,e)=>({...m,...e})})(s||(r.objectUtil=s={})),r.ZodParsedType=i.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);const c=d=>{switch(typeof d){case"undefined":return r.ZodParsedType.undefined;case"string":return r.ZodParsedType.string;case"number":return Number.isNaN(d)?r.ZodParsedType.nan:r.ZodParsedType.number;case"boolean":return r.ZodParsedType.boolean;case"function":return r.ZodParsedType.function;case"bigint":return r.ZodParsedType.bigint;case"symbol":return r.ZodParsedType.symbol;case"object":return Array.isArray(d)?r.ZodParsedType.array:d===null?r.ZodParsedType.null:d.then&&typeof d.then=="function"&&d.catch&&typeof d.catch=="function"?r.ZodParsedType.promise:typeof Map<"u"&&d instanceof Map?r.ZodParsedType.map:typeof Set<"u"&&d instanceof Set?r.ZodParsedType.set:typeof Date<"u"&&d instanceof Date?r.ZodParsedType.date:r.ZodParsedType.object;default:return r.ZodParsedType.unknown}};r.getParsedType=c})(qx)),qx}var RR;function kw(){if(RR)return Xa;RR=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.ZodError=Xa.quotelessJson=Xa.ZodIssueCode=void 0;const r=p0();Xa.ZodIssueCode=r.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);const i=c=>JSON.stringify(c,null,2).replace(/"([^"]+)":/g,"$1:");Xa.quotelessJson=i;let s=class sM extends Error{get errors(){return this.issues}constructor(d){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const m=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,m):this.__proto__=m,this.name="ZodError",this.issues=d}format(d){const m=d||function(g){return g.message},e={_errors:[]},a=g=>{for(const w of g.issues)if(w.code==="invalid_union")w.unionErrors.map(a);else if(w.code==="invalid_return_type")a(w.returnTypeError);else if(w.code==="invalid_arguments")a(w.argumentsError);else if(w.path.length===0)e._errors.push(m(w));else{let R=e,S=0;for(;S<w.path.length;){const D=w.path[S];S===w.path.length-1?(R[D]=R[D]||{_errors:[]},R[D]._errors.push(m(w))):R[D]=R[D]||{_errors:[]},R=R[D],S++}}};return a(this),e}static assert(d){if(!(d instanceof sM))throw new Error(`Not a ZodError: ${d}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,r.util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(d=m=>m.message){const m={},e=[];for(const a of this.issues)if(a.path.length>0){const g=a.path[0];m[g]=m[g]||[],m[g].push(d(a))}else e.push(d(a));return{formErrors:e,fieldErrors:m}}get formErrors(){return this.flatten()}};return Xa.ZodError=s,s.create=c=>new s(c),Xa}var SR;function oM(){if(SR)return bg;SR=1,Object.defineProperty(bg,"__esModule",{value:!0});const r=kw(),i=p0(),s=(c,d)=>{let m;switch(c.code){case r.ZodIssueCode.invalid_type:c.received===i.ZodParsedType.undefined?m="Required":m=`Expected ${c.expected}, received ${c.received}`;break;case r.ZodIssueCode.invalid_literal:m=`Invalid literal value, expected ${JSON.stringify(c.expected,i.util.jsonStringifyReplacer)}`;break;case r.ZodIssueCode.unrecognized_keys:m=`Unrecognized key(s) in object: ${i.util.joinValues(c.keys,", ")}`;break;case r.ZodIssueCode.invalid_union:m="Invalid input";break;case r.ZodIssueCode.invalid_union_discriminator:m=`Invalid discriminator value. Expected ${i.util.joinValues(c.options)}`;break;case r.ZodIssueCode.invalid_enum_value:m=`Invalid enum value. Expected ${i.util.joinValues(c.options)}, received '${c.received}'`;break;case r.ZodIssueCode.invalid_arguments:m="Invalid function arguments";break;case r.ZodIssueCode.invalid_return_type:m="Invalid function return type";break;case r.ZodIssueCode.invalid_date:m="Invalid date";break;case r.ZodIssueCode.invalid_string:typeof c.validation=="object"?"includes"in c.validation?(m=`Invalid input: must include "${c.validation.includes}"`,typeof c.validation.position=="number"&&(m=`${m} at one or more positions greater than or equal to ${c.validation.position}`)):"startsWith"in c.validation?m=`Invalid input: must start with "${c.validation.startsWith}"`:"endsWith"in c.validation?m=`Invalid input: must end with "${c.validation.endsWith}"`:i.util.assertNever(c.validation):c.validation!=="regex"?m=`Invalid ${c.validation}`:m="Invalid";break;case r.ZodIssueCode.too_small:c.type==="array"?m=`Array must contain ${c.exact?"exactly":c.inclusive?"at least":"more than"} ${c.minimum} element(s)`:c.type==="string"?m=`String must contain ${c.exact?"exactly":c.inclusive?"at least":"over"} ${c.minimum} character(s)`:c.type==="number"?m=`Number must be ${c.exact?"exactly equal to ":c.inclusive?"greater than or equal to ":"greater than "}${c.minimum}`:c.type==="bigint"?m=`Number must be ${c.exact?"exactly equal to ":c.inclusive?"greater than or equal to ":"greater than "}${c.minimum}`:c.type==="date"?m=`Date must be ${c.exact?"exactly equal to ":c.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(c.minimum))}`:m="Invalid input";break;case r.ZodIssueCode.too_big:c.type==="array"?m=`Array must contain ${c.exact?"exactly":c.inclusive?"at most":"less than"} ${c.maximum} element(s)`:c.type==="string"?m=`String must contain ${c.exact?"exactly":c.inclusive?"at most":"under"} ${c.maximum} character(s)`:c.type==="number"?m=`Number must be ${c.exact?"exactly":c.inclusive?"less than or equal to":"less than"} ${c.maximum}`:c.type==="bigint"?m=`BigInt must be ${c.exact?"exactly":c.inclusive?"less than or equal to":"less than"} ${c.maximum}`:c.type==="date"?m=`Date must be ${c.exact?"exactly":c.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(c.maximum))}`:m="Invalid input";break;case r.ZodIssueCode.custom:m="Invalid input";break;case r.ZodIssueCode.invalid_intersection_types:m="Intersection results could not be merged";break;case r.ZodIssueCode.not_multiple_of:m=`Number must be a multiple of ${c.multipleOf}`;break;case r.ZodIssueCode.not_finite:m="Number must be finite";break;default:m=d.defaultError,i.util.assertNever(c)}return{message:m}};return bg.default=s,bg}var TR;function Pw(){if(TR)return Ha;TR=1;var r=Ha&&Ha.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.defaultErrorMap=void 0,Ha.setErrorMap=c,Ha.getErrorMap=d;const i=r(oM());Ha.defaultErrorMap=i.default;let s=i.default;function c(m){s=m}function d(){return s}return Ha}var Vh={},CR;function aM(){return CR||(CR=1,(function(r){var i=Vh&&Vh.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(r,"__esModule",{value:!0}),r.isAsync=r.isValid=r.isDirty=r.isAborted=r.OK=r.DIRTY=r.INVALID=r.ParseStatus=r.EMPTY_PATH=r.makeIssue=void 0,r.addIssueToContext=m;const s=Pw(),c=i(oM()),d=k=>{const{data:B,path:F,errorMaps:K,issueData:U}=k,ee=[...F,...U.path||[]],le={...U,path:ee};if(U.message!==void 0)return{...U,path:ee,message:U.message};let Q="";const Te=K.filter(pe=>!!pe).slice().reverse();for(const pe of Te)Q=pe(le,{data:B,defaultError:Q}).message;return{...U,path:ee,message:Q}};r.makeIssue=d,r.EMPTY_PATH=[];function m(k,B){const F=(0,s.getErrorMap)(),K=(0,r.makeIssue)({issueData:B,data:k.data,path:k.path,errorMaps:[k.common.contextualErrorMap,k.schemaErrorMap,F,F===c.default?void 0:c.default].filter(U=>!!U)});k.common.issues.push(K)}class e{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(B,F){const K=[];for(const U of F){if(U.status==="aborted")return r.INVALID;U.status==="dirty"&&B.dirty(),K.push(U.value)}return{status:B.value,value:K}}static async mergeObjectAsync(B,F){const K=[];for(const U of F){const ee=await U.key,le=await U.value;K.push({key:ee,value:le})}return e.mergeObjectSync(B,K)}static mergeObjectSync(B,F){const K={};for(const U of F){const{key:ee,value:le}=U;if(ee.status==="aborted"||le.status==="aborted")return r.INVALID;ee.status==="dirty"&&B.dirty(),le.status==="dirty"&&B.dirty(),ee.value!=="__proto__"&&(typeof le.value<"u"||U.alwaysSet)&&(K[ee.value]=le.value)}return{status:B.value,value:K}}}r.ParseStatus=e,r.INVALID=Object.freeze({status:"aborted"});const a=k=>({status:"dirty",value:k});r.DIRTY=a;const g=k=>({status:"valid",value:k});r.OK=g;const w=k=>k.status==="aborted";r.isAborted=w;const R=k=>k.status==="dirty";r.isDirty=R;const S=k=>k.status==="valid";r.isValid=S;const D=k=>typeof Promise<"u"&&k instanceof Promise;r.isAsync=D})(Vh)),Vh}var Kx={},kR;function qF(){return kR||(kR=1,Object.defineProperty(Kx,"__esModule",{value:!0})),Kx}var We={},Uh={},PR;function KF(){if(PR)return Uh;PR=1,Object.defineProperty(Uh,"__esModule",{value:!0}),Uh.errorUtil=void 0;var r;return(function(i){i.errToObj=s=>typeof s=="string"?{message:s}:s||{},i.toString=s=>typeof s=="string"?s:s?.message})(r||(Uh.errorUtil=r={})),Uh}var LR;function GF(){if(LR)return We;LR=1,Object.defineProperty(We,"__esModule",{value:!0}),We.discriminatedUnion=We.date=We.boolean=We.bigint=We.array=We.any=We.coerce=We.ZodFirstPartyTypeKind=We.late=We.ZodSchema=We.Schema=We.ZodReadonly=We.ZodPipeline=We.ZodBranded=We.BRAND=We.ZodNaN=We.ZodCatch=We.ZodDefault=We.ZodNullable=We.ZodOptional=We.ZodTransformer=We.ZodEffects=We.ZodPromise=We.ZodNativeEnum=We.ZodEnum=We.ZodLiteral=We.ZodLazy=We.ZodFunction=We.ZodSet=We.ZodMap=We.ZodRecord=We.ZodTuple=We.ZodIntersection=We.ZodDiscriminatedUnion=We.ZodUnion=We.ZodObject=We.ZodArray=We.ZodVoid=We.ZodNever=We.ZodUnknown=We.ZodAny=We.ZodNull=We.ZodUndefined=We.ZodSymbol=We.ZodDate=We.ZodBoolean=We.ZodBigInt=We.ZodNumber=We.ZodString=We.ZodType=void 0,We.NEVER=We.void=We.unknown=We.union=We.undefined=We.tuple=We.transformer=We.symbol=We.string=We.strictObject=We.set=We.record=We.promise=We.preprocess=We.pipeline=We.ostring=We.optional=We.onumber=We.oboolean=We.object=We.number=We.nullable=We.null=We.never=We.nativeEnum=We.nan=We.map=We.literal=We.lazy=We.intersection=We.instanceof=We.function=We.enum=We.effect=void 0,We.datetimeRegex=te,We.custom=mt;const r=kw(),i=Pw(),s=KF(),c=aM(),d=p0();class m{constructor(j,re,oe,De){this._cachedPath=[],this.parent=j,this.data=re,this._path=oe,this._key=De}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const e=(ke,j)=>{if((0,c.isValid)(j))return{success:!0,data:j.value};if(!ke.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const re=new r.ZodError(ke.common.issues);return this._error=re,this._error}}};function a(ke){if(!ke)return{};const{errorMap:j,invalid_type_error:re,required_error:oe,description:De}=ke;if(j&&(re||oe))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return j?{errorMap:j,description:De}:{errorMap:(Et,ht)=>{const{message:$t}=ke;return Et.code==="invalid_enum_value"?{message:$t??ht.defaultError}:typeof ht.data>"u"?{message:$t??oe??ht.defaultError}:Et.code!=="invalid_type"?{message:ht.defaultError}:{message:$t??re??ht.defaultError}},description:De}}class g{get description(){return this._def.description}_getType(j){return(0,d.getParsedType)(j.data)}_getOrReturnCtx(j,re){return re||{common:j.parent.common,data:j.data,parsedType:(0,d.getParsedType)(j.data),schemaErrorMap:this._def.errorMap,path:j.path,parent:j.parent}}_processInputParams(j){return{status:new c.ParseStatus,ctx:{common:j.parent.common,data:j.data,parsedType:(0,d.getParsedType)(j.data),schemaErrorMap:this._def.errorMap,path:j.path,parent:j.parent}}}_parseSync(j){const re=this._parse(j);if((0,c.isAsync)(re))throw new Error("Synchronous parse encountered promise.");return re}_parseAsync(j){const re=this._parse(j);return Promise.resolve(re)}parse(j,re){const oe=this.safeParse(j,re);if(oe.success)return oe.data;throw oe.error}safeParse(j,re){const oe={common:{issues:[],async:re?.async??!1,contextualErrorMap:re?.errorMap},path:re?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:j,parsedType:(0,d.getParsedType)(j)},De=this._parseSync({data:j,path:oe.path,parent:oe});return e(oe,De)}"~validate"(j){const re={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:j,parsedType:(0,d.getParsedType)(j)};if(!this["~standard"].async)try{const oe=this._parseSync({data:j,path:[],parent:re});return(0,c.isValid)(oe)?{value:oe.value}:{issues:re.common.issues}}catch(oe){oe?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),re.common={issues:[],async:!0}}return this._parseAsync({data:j,path:[],parent:re}).then(oe=>(0,c.isValid)(oe)?{value:oe.value}:{issues:re.common.issues})}async parseAsync(j,re){const oe=await this.safeParseAsync(j,re);if(oe.success)return oe.data;throw oe.error}async safeParseAsync(j,re){const oe={common:{issues:[],contextualErrorMap:re?.errorMap,async:!0},path:re?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:j,parsedType:(0,d.getParsedType)(j)},De=this._parse({data:j,path:oe.path,parent:oe}),Me=await((0,c.isAsync)(De)?De:Promise.resolve(De));return e(oe,Me)}refine(j,re){const oe=De=>typeof re=="string"||typeof re>"u"?{message:re}:typeof re=="function"?re(De):re;return this._refinement((De,Me)=>{const Et=j(De),ht=()=>Me.addIssue({code:r.ZodIssueCode.custom,...oe(De)});return typeof Promise<"u"&&Et instanceof Promise?Et.then($t=>$t?!0:(ht(),!1)):Et?!0:(ht(),!1)})}refinement(j,re){return this._refinement((oe,De)=>j(oe)?!0:(De.addIssue(typeof re=="function"?re(oe,De):re),!1))}_refinement(j){return new we({schema:this,typeName:Ze.ZodEffects,effect:{type:"refinement",refinement:j}})}superRefine(j){return this._refinement(j)}constructor(j){this.spa=this.safeParseAsync,this._def=j,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:re=>this["~validate"](re)}}optional(){return W.create(this,this._def)}nullable(){return J.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Sr.create(this)}promise(){return Nt.create(this,this._def)}or(j){return br.create([this,j],this._def)}and(j){return Pr.create(this,j,this._def)}transform(j){return new we({...a(this._def),schema:this,typeName:Ze.ZodEffects,effect:{type:"transform",transform:j}})}default(j){const re=typeof j=="function"?j:()=>j;return new se({...a(this._def),innerType:this,defaultValue:re,typeName:Ze.ZodDefault})}brand(){return new je({typeName:Ze.ZodBranded,type:this,...a(this._def)})}catch(j){const re=typeof j=="function"?j:()=>j;return new ve({...a(this._def),innerType:this,catchValue:re,typeName:Ze.ZodCatch})}describe(j){const re=this.constructor;return new re({...this._def,description:j})}pipe(j){return Ge.create(this,j)}readonly(){return Ne.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}We.ZodType=g,We.Schema=g,We.ZodSchema=g;const w=/^c[^\s-]{8,}$/i,R=/^[0-9a-z]+$/,S=/^[0-9A-HJKMNP-TV-Z]{26}$/i,D=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,k=/^[a-z0-9_-]{21}$/i,B=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,F=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,K=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,U="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ee;const le=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Q=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Te=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,pe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,_e=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Xe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dt="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",He=new RegExp(`^${dt}$`);function et(ke){let j="[0-5]\\d";ke.precision?j=`${j}\\.\\d{${ke.precision}}`:ke.precision==null&&(j=`${j}(\\.\\d+)?`);const re=ke.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${j})${re}`}function rt(ke){return new RegExp(`^${et(ke)}$`)}function te(ke){let j=`${dt}T${et(ke)}`;const re=[];return re.push(ke.local?"Z?":"Z"),ke.offset&&re.push("([+-]\\d{2}:?\\d{2})"),j=`${j}(${re.join("|")})`,new RegExp(`^${j}$`)}function Be(ke,j){return!!((j==="v4"||!j)&&le.test(ke)||(j==="v6"||!j)&&Te.test(ke))}function fe(ke,j){if(!B.test(ke))return!1;try{const[re]=ke.split(".");if(!re)return!1;const oe=re.replace(/-/g,"+").replace(/_/g,"/").padEnd(re.length+(4-re.length%4)%4,"="),De=JSON.parse(atob(oe));return!(typeof De!="object"||De===null||"typ"in De&&De?.typ!=="JWT"||!De.alg||j&&De.alg!==j)}catch{return!1}}function ye(ke,j){return!!((j==="v4"||!j)&&Q.test(ke)||(j==="v6"||!j)&&pe.test(ke))}class nt extends g{_parse(j){if(this._def.coerce&&(j.data=String(j.data)),this._getType(j)!==d.ZodParsedType.string){const Me=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(Me,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.string,received:Me.parsedType}),c.INVALID}const oe=new c.ParseStatus;let De;for(const Me of this._def.checks)if(Me.kind==="min")j.data.length<Me.value&&(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.too_small,minimum:Me.value,type:"string",inclusive:!0,exact:!1,message:Me.message}),oe.dirty());else if(Me.kind==="max")j.data.length>Me.value&&(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.too_big,maximum:Me.value,type:"string",inclusive:!0,exact:!1,message:Me.message}),oe.dirty());else if(Me.kind==="length"){const Et=j.data.length>Me.value,ht=j.data.length<Me.value;(Et||ht)&&(De=this._getOrReturnCtx(j,De),Et?(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.too_big,maximum:Me.value,type:"string",inclusive:!0,exact:!0,message:Me.message}):ht&&(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.too_small,minimum:Me.value,type:"string",inclusive:!0,exact:!0,message:Me.message}),oe.dirty())}else if(Me.kind==="email")K.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"email",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="emoji")ee||(ee=new RegExp(U,"u")),ee.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"emoji",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="uuid")D.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"uuid",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="nanoid")k.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"nanoid",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="cuid")w.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"cuid",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="cuid2")R.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"cuid2",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="ulid")S.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"ulid",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty());else if(Me.kind==="url")try{new URL(j.data)}catch{De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"url",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()}else Me.kind==="regex"?(Me.regex.lastIndex=0,Me.regex.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"regex",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty())):Me.kind==="trim"?j.data=j.data.trim():Me.kind==="includes"?j.data.includes(Me.value,Me.position)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.invalid_string,validation:{includes:Me.value,position:Me.position},message:Me.message}),oe.dirty()):Me.kind==="toLowerCase"?j.data=j.data.toLowerCase():Me.kind==="toUpperCase"?j.data=j.data.toUpperCase():Me.kind==="startsWith"?j.data.startsWith(Me.value)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.invalid_string,validation:{startsWith:Me.value},message:Me.message}),oe.dirty()):Me.kind==="endsWith"?j.data.endsWith(Me.value)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.invalid_string,validation:{endsWith:Me.value},message:Me.message}),oe.dirty()):Me.kind==="datetime"?te(Me).test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.invalid_string,validation:"datetime",message:Me.message}),oe.dirty()):Me.kind==="date"?He.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.invalid_string,validation:"date",message:Me.message}),oe.dirty()):Me.kind==="time"?rt(Me).test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.invalid_string,validation:"time",message:Me.message}),oe.dirty()):Me.kind==="duration"?F.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"duration",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()):Me.kind==="ip"?Be(j.data,Me.version)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"ip",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()):Me.kind==="jwt"?fe(j.data,Me.alg)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"jwt",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()):Me.kind==="cidr"?ye(j.data,Me.version)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"cidr",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()):Me.kind==="base64"?_e.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"base64",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()):Me.kind==="base64url"?Xe.test(j.data)||(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{validation:"base64url",code:r.ZodIssueCode.invalid_string,message:Me.message}),oe.dirty()):d.util.assertNever(Me);return{status:oe.value,value:j.data}}_regex(j,re,oe){return this.refinement(De=>j.test(De),{validation:re,code:r.ZodIssueCode.invalid_string,...s.errorUtil.errToObj(oe)})}_addCheck(j){return new nt({...this._def,checks:[...this._def.checks,j]})}email(j){return this._addCheck({kind:"email",...s.errorUtil.errToObj(j)})}url(j){return this._addCheck({kind:"url",...s.errorUtil.errToObj(j)})}emoji(j){return this._addCheck({kind:"emoji",...s.errorUtil.errToObj(j)})}uuid(j){return this._addCheck({kind:"uuid",...s.errorUtil.errToObj(j)})}nanoid(j){return this._addCheck({kind:"nanoid",...s.errorUtil.errToObj(j)})}cuid(j){return this._addCheck({kind:"cuid",...s.errorUtil.errToObj(j)})}cuid2(j){return this._addCheck({kind:"cuid2",...s.errorUtil.errToObj(j)})}ulid(j){return this._addCheck({kind:"ulid",...s.errorUtil.errToObj(j)})}base64(j){return this._addCheck({kind:"base64",...s.errorUtil.errToObj(j)})}base64url(j){return this._addCheck({kind:"base64url",...s.errorUtil.errToObj(j)})}jwt(j){return this._addCheck({kind:"jwt",...s.errorUtil.errToObj(j)})}ip(j){return this._addCheck({kind:"ip",...s.errorUtil.errToObj(j)})}cidr(j){return this._addCheck({kind:"cidr",...s.errorUtil.errToObj(j)})}datetime(j){return typeof j=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:j}):this._addCheck({kind:"datetime",precision:typeof j?.precision>"u"?null:j?.precision,offset:j?.offset??!1,local:j?.local??!1,...s.errorUtil.errToObj(j?.message)})}date(j){return this._addCheck({kind:"date",message:j})}time(j){return typeof j=="string"?this._addCheck({kind:"time",precision:null,message:j}):this._addCheck({kind:"time",precision:typeof j?.precision>"u"?null:j?.precision,...s.errorUtil.errToObj(j?.message)})}duration(j){return this._addCheck({kind:"duration",...s.errorUtil.errToObj(j)})}regex(j,re){return this._addCheck({kind:"regex",regex:j,...s.errorUtil.errToObj(re)})}includes(j,re){return this._addCheck({kind:"includes",value:j,position:re?.position,...s.errorUtil.errToObj(re?.message)})}startsWith(j,re){return this._addCheck({kind:"startsWith",value:j,...s.errorUtil.errToObj(re)})}endsWith(j,re){return this._addCheck({kind:"endsWith",value:j,...s.errorUtil.errToObj(re)})}min(j,re){return this._addCheck({kind:"min",value:j,...s.errorUtil.errToObj(re)})}max(j,re){return this._addCheck({kind:"max",value:j,...s.errorUtil.errToObj(re)})}length(j,re){return this._addCheck({kind:"length",value:j,...s.errorUtil.errToObj(re)})}nonempty(j){return this.min(1,s.errorUtil.errToObj(j))}trim(){return new nt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new nt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new nt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(j=>j.kind==="datetime")}get isDate(){return!!this._def.checks.find(j=>j.kind==="date")}get isTime(){return!!this._def.checks.find(j=>j.kind==="time")}get isDuration(){return!!this._def.checks.find(j=>j.kind==="duration")}get isEmail(){return!!this._def.checks.find(j=>j.kind==="email")}get isURL(){return!!this._def.checks.find(j=>j.kind==="url")}get isEmoji(){return!!this._def.checks.find(j=>j.kind==="emoji")}get isUUID(){return!!this._def.checks.find(j=>j.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(j=>j.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(j=>j.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(j=>j.kind==="cuid2")}get isULID(){return!!this._def.checks.find(j=>j.kind==="ulid")}get isIP(){return!!this._def.checks.find(j=>j.kind==="ip")}get isCIDR(){return!!this._def.checks.find(j=>j.kind==="cidr")}get isBase64(){return!!this._def.checks.find(j=>j.kind==="base64")}get isBase64url(){return!!this._def.checks.find(j=>j.kind==="base64url")}get minLength(){let j=null;for(const re of this._def.checks)re.kind==="min"&&(j===null||re.value>j)&&(j=re.value);return j}get maxLength(){let j=null;for(const re of this._def.checks)re.kind==="max"&&(j===null||re.value<j)&&(j=re.value);return j}}We.ZodString=nt,nt.create=ke=>new nt({checks:[],typeName:Ze.ZodString,coerce:ke?.coerce??!1,...a(ke)});function gt(ke,j){const re=(ke.toString().split(".")[1]||"").length,oe=(j.toString().split(".")[1]||"").length,De=re>oe?re:oe,Me=Number.parseInt(ke.toFixed(De).replace(".","")),Et=Number.parseInt(j.toFixed(De).replace(".",""));return Me%Et/10**De}class lt extends g{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(j){if(this._def.coerce&&(j.data=Number(j.data)),this._getType(j)!==d.ZodParsedType.number){const Me=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(Me,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.number,received:Me.parsedType}),c.INVALID}let oe;const De=new c.ParseStatus;for(const Me of this._def.checks)Me.kind==="int"?d.util.isInteger(j.data)||(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:Me.message}),De.dirty()):Me.kind==="min"?(Me.inclusive?j.data<Me.value:j.data<=Me.value)&&(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_small,minimum:Me.value,type:"number",inclusive:Me.inclusive,exact:!1,message:Me.message}),De.dirty()):Me.kind==="max"?(Me.inclusive?j.data>Me.value:j.data>=Me.value)&&(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_big,maximum:Me.value,type:"number",inclusive:Me.inclusive,exact:!1,message:Me.message}),De.dirty()):Me.kind==="multipleOf"?gt(j.data,Me.value)!==0&&(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.not_multiple_of,multipleOf:Me.value,message:Me.message}),De.dirty()):Me.kind==="finite"?Number.isFinite(j.data)||(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.not_finite,message:Me.message}),De.dirty()):d.util.assertNever(Me);return{status:De.value,value:j.data}}gte(j,re){return this.setLimit("min",j,!0,s.errorUtil.toString(re))}gt(j,re){return this.setLimit("min",j,!1,s.errorUtil.toString(re))}lte(j,re){return this.setLimit("max",j,!0,s.errorUtil.toString(re))}lt(j,re){return this.setLimit("max",j,!1,s.errorUtil.toString(re))}setLimit(j,re,oe,De){return new lt({...this._def,checks:[...this._def.checks,{kind:j,value:re,inclusive:oe,message:s.errorUtil.toString(De)}]})}_addCheck(j){return new lt({...this._def,checks:[...this._def.checks,j]})}int(j){return this._addCheck({kind:"int",message:s.errorUtil.toString(j)})}positive(j){return this._addCheck({kind:"min",value:0,inclusive:!1,message:s.errorUtil.toString(j)})}negative(j){return this._addCheck({kind:"max",value:0,inclusive:!1,message:s.errorUtil.toString(j)})}nonpositive(j){return this._addCheck({kind:"max",value:0,inclusive:!0,message:s.errorUtil.toString(j)})}nonnegative(j){return this._addCheck({kind:"min",value:0,inclusive:!0,message:s.errorUtil.toString(j)})}multipleOf(j,re){return this._addCheck({kind:"multipleOf",value:j,message:s.errorUtil.toString(re)})}finite(j){return this._addCheck({kind:"finite",message:s.errorUtil.toString(j)})}safe(j){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:s.errorUtil.toString(j)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:s.errorUtil.toString(j)})}get minValue(){let j=null;for(const re of this._def.checks)re.kind==="min"&&(j===null||re.value>j)&&(j=re.value);return j}get maxValue(){let j=null;for(const re of this._def.checks)re.kind==="max"&&(j===null||re.value<j)&&(j=re.value);return j}get isInt(){return!!this._def.checks.find(j=>j.kind==="int"||j.kind==="multipleOf"&&d.util.isInteger(j.value))}get isFinite(){let j=null,re=null;for(const oe of this._def.checks){if(oe.kind==="finite"||oe.kind==="int"||oe.kind==="multipleOf")return!0;oe.kind==="min"?(re===null||oe.value>re)&&(re=oe.value):oe.kind==="max"&&(j===null||oe.value<j)&&(j=oe.value)}return Number.isFinite(re)&&Number.isFinite(j)}}We.ZodNumber=lt,lt.create=ke=>new lt({checks:[],typeName:Ze.ZodNumber,coerce:ke?.coerce||!1,...a(ke)});class be extends g{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(j){if(this._def.coerce)try{j.data=BigInt(j.data)}catch{return this._getInvalidInput(j)}if(this._getType(j)!==d.ZodParsedType.bigint)return this._getInvalidInput(j);let oe;const De=new c.ParseStatus;for(const Me of this._def.checks)Me.kind==="min"?(Me.inclusive?j.data<Me.value:j.data<=Me.value)&&(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_small,type:"bigint",minimum:Me.value,inclusive:Me.inclusive,message:Me.message}),De.dirty()):Me.kind==="max"?(Me.inclusive?j.data>Me.value:j.data>=Me.value)&&(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_big,type:"bigint",maximum:Me.value,inclusive:Me.inclusive,message:Me.message}),De.dirty()):Me.kind==="multipleOf"?j.data%Me.value!==BigInt(0)&&(oe=this._getOrReturnCtx(j,oe),(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.not_multiple_of,multipleOf:Me.value,message:Me.message}),De.dirty()):d.util.assertNever(Me);return{status:De.value,value:j.data}}_getInvalidInput(j){const re=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.bigint,received:re.parsedType}),c.INVALID}gte(j,re){return this.setLimit("min",j,!0,s.errorUtil.toString(re))}gt(j,re){return this.setLimit("min",j,!1,s.errorUtil.toString(re))}lte(j,re){return this.setLimit("max",j,!0,s.errorUtil.toString(re))}lt(j,re){return this.setLimit("max",j,!1,s.errorUtil.toString(re))}setLimit(j,re,oe,De){return new be({...this._def,checks:[...this._def.checks,{kind:j,value:re,inclusive:oe,message:s.errorUtil.toString(De)}]})}_addCheck(j){return new be({...this._def,checks:[...this._def.checks,j]})}positive(j){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:s.errorUtil.toString(j)})}negative(j){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:s.errorUtil.toString(j)})}nonpositive(j){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:s.errorUtil.toString(j)})}nonnegative(j){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:s.errorUtil.toString(j)})}multipleOf(j,re){return this._addCheck({kind:"multipleOf",value:j,message:s.errorUtil.toString(re)})}get minValue(){let j=null;for(const re of this._def.checks)re.kind==="min"&&(j===null||re.value>j)&&(j=re.value);return j}get maxValue(){let j=null;for(const re of this._def.checks)re.kind==="max"&&(j===null||re.value<j)&&(j=re.value);return j}}We.ZodBigInt=be,be.create=ke=>new be({checks:[],typeName:Ze.ZodBigInt,coerce:ke?.coerce??!1,...a(ke)});class Ft extends g{_parse(j){if(this._def.coerce&&(j.data=!!j.data),this._getType(j)!==d.ZodParsedType.boolean){const oe=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.boolean,received:oe.parsedType}),c.INVALID}return(0,c.OK)(j.data)}}We.ZodBoolean=Ft,Ft.create=ke=>new Ft({typeName:Ze.ZodBoolean,coerce:ke?.coerce||!1,...a(ke)});class Ut extends g{_parse(j){if(this._def.coerce&&(j.data=new Date(j.data)),this._getType(j)!==d.ZodParsedType.date){const Me=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(Me,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.date,received:Me.parsedType}),c.INVALID}if(Number.isNaN(j.data.getTime())){const Me=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(Me,{code:r.ZodIssueCode.invalid_date}),c.INVALID}const oe=new c.ParseStatus;let De;for(const Me of this._def.checks)Me.kind==="min"?j.data.getTime()<Me.value&&(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.too_small,message:Me.message,inclusive:!0,exact:!1,minimum:Me.value,type:"date"}),oe.dirty()):Me.kind==="max"?j.data.getTime()>Me.value&&(De=this._getOrReturnCtx(j,De),(0,c.addIssueToContext)(De,{code:r.ZodIssueCode.too_big,message:Me.message,inclusive:!0,exact:!1,maximum:Me.value,type:"date"}),oe.dirty()):d.util.assertNever(Me);return{status:oe.value,value:new Date(j.data.getTime())}}_addCheck(j){return new Ut({...this._def,checks:[...this._def.checks,j]})}min(j,re){return this._addCheck({kind:"min",value:j.getTime(),message:s.errorUtil.toString(re)})}max(j,re){return this._addCheck({kind:"max",value:j.getTime(),message:s.errorUtil.toString(re)})}get minDate(){let j=null;for(const re of this._def.checks)re.kind==="min"&&(j===null||re.value>j)&&(j=re.value);return j!=null?new Date(j):null}get maxDate(){let j=null;for(const re of this._def.checks)re.kind==="max"&&(j===null||re.value<j)&&(j=re.value);return j!=null?new Date(j):null}}We.ZodDate=Ut,Ut.create=ke=>new Ut({checks:[],coerce:ke?.coerce||!1,typeName:Ze.ZodDate,...a(ke)});class Le extends g{_parse(j){if(this._getType(j)!==d.ZodParsedType.symbol){const oe=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.symbol,received:oe.parsedType}),c.INVALID}return(0,c.OK)(j.data)}}We.ZodSymbol=Le,Le.create=ke=>new Le({typeName:Ze.ZodSymbol,...a(ke)});class ur extends g{_parse(j){if(this._getType(j)!==d.ZodParsedType.undefined){const oe=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.undefined,received:oe.parsedType}),c.INVALID}return(0,c.OK)(j.data)}}We.ZodUndefined=ur,ur.create=ke=>new ur({typeName:Ze.ZodUndefined,...a(ke)});class Tt extends g{_parse(j){if(this._getType(j)!==d.ZodParsedType.null){const oe=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.null,received:oe.parsedType}),c.INVALID}return(0,c.OK)(j.data)}}We.ZodNull=Tt,Tt.create=ke=>new Tt({typeName:Ze.ZodNull,...a(ke)});class tr extends g{constructor(){super(...arguments),this._any=!0}_parse(j){return(0,c.OK)(j.data)}}We.ZodAny=tr,tr.create=ke=>new tr({typeName:Ze.ZodAny,...a(ke)});class qr extends g{constructor(){super(...arguments),this._unknown=!0}_parse(j){return(0,c.OK)(j.data)}}We.ZodUnknown=qr,qr.create=ke=>new qr({typeName:Ze.ZodUnknown,...a(ke)});class lr extends g{_parse(j){const re=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.never,received:re.parsedType}),c.INVALID}}We.ZodNever=lr,lr.create=ke=>new lr({typeName:Ze.ZodNever,...a(ke)});class kr extends g{_parse(j){if(this._getType(j)!==d.ZodParsedType.undefined){const oe=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.void,received:oe.parsedType}),c.INVALID}return(0,c.OK)(j.data)}}We.ZodVoid=kr,kr.create=ke=>new kr({typeName:Ze.ZodVoid,...a(ke)});class Sr extends g{_parse(j){const{ctx:re,status:oe}=this._processInputParams(j),De=this._def;if(re.parsedType!==d.ZodParsedType.array)return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.array,received:re.parsedType}),c.INVALID;if(De.exactLength!==null){const Et=re.data.length>De.exactLength.value,ht=re.data.length<De.exactLength.value;(Et||ht)&&((0,c.addIssueToContext)(re,{code:Et?r.ZodIssueCode.too_big:r.ZodIssueCode.too_small,minimum:ht?De.exactLength.value:void 0,maximum:Et?De.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:De.exactLength.message}),oe.dirty())}if(De.minLength!==null&&re.data.length<De.minLength.value&&((0,c.addIssueToContext)(re,{code:r.ZodIssueCode.too_small,minimum:De.minLength.value,type:"array",inclusive:!0,exact:!1,message:De.minLength.message}),oe.dirty()),De.maxLength!==null&&re.data.length>De.maxLength.value&&((0,c.addIssueToContext)(re,{code:r.ZodIssueCode.too_big,maximum:De.maxLength.value,type:"array",inclusive:!0,exact:!1,message:De.maxLength.message}),oe.dirty()),re.common.async)return Promise.all([...re.data].map((Et,ht)=>De.type._parseAsync(new m(re,Et,re.path,ht)))).then(Et=>c.ParseStatus.mergeArray(oe,Et));const Me=[...re.data].map((Et,ht)=>De.type._parseSync(new m(re,Et,re.path,ht)));return c.ParseStatus.mergeArray(oe,Me)}get element(){return this._def.type}min(j,re){return new Sr({...this._def,minLength:{value:j,message:s.errorUtil.toString(re)}})}max(j,re){return new Sr({...this._def,maxLength:{value:j,message:s.errorUtil.toString(re)}})}length(j,re){return new Sr({...this._def,exactLength:{value:j,message:s.errorUtil.toString(re)}})}nonempty(j){return this.min(1,j)}}We.ZodArray=Sr,Sr.create=(ke,j)=>new Sr({type:ke,minLength:null,maxLength:null,exactLength:null,typeName:Ze.ZodArray,...a(j)});function $r(ke){if(ke instanceof sr){const j={};for(const re in ke.shape){const oe=ke.shape[re];j[re]=W.create($r(oe))}return new sr({...ke._def,shape:()=>j})}else return ke instanceof Sr?new Sr({...ke._def,type:$r(ke.element)}):ke instanceof W?W.create($r(ke.unwrap())):ke instanceof J?J.create($r(ke.unwrap())):ke instanceof Ct?Ct.create(ke.items.map(j=>$r(j))):ke}class sr extends g{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const j=this._def.shape(),re=d.util.objectKeys(j);return this._cached={shape:j,keys:re},this._cached}_parse(j){if(this._getType(j)!==d.ZodParsedType.object){const Yt=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(Yt,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.object,received:Yt.parsedType}),c.INVALID}const{status:oe,ctx:De}=this._processInputParams(j),{shape:Me,keys:Et}=this._getCached(),ht=[];if(!(this._def.catchall instanceof lr&&this._def.unknownKeys==="strip"))for(const Yt in De.data)Et.includes(Yt)||ht.push(Yt);const $t=[];for(const Yt of Et){const wr=Me[Yt],ji=De.data[Yt];$t.push({key:{status:"valid",value:Yt},value:wr._parse(new m(De,ji,De.path,Yt)),alwaysSet:Yt in De.data})}if(this._def.catchall instanceof lr){const Yt=this._def.unknownKeys;if(Yt==="passthrough")for(const wr of ht)$t.push({key:{status:"valid",value:wr},value:{status:"valid",value:De.data[wr]}});else if(Yt==="strict")ht.length>0&&((0,c.addIssueToContext)(De,{code:r.ZodIssueCode.unrecognized_keys,keys:ht}),oe.dirty());else if(Yt!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const Yt=this._def.catchall;for(const wr of ht){const ji=De.data[wr];$t.push({key:{status:"valid",value:wr},value:Yt._parse(new m(De,ji,De.path,wr)),alwaysSet:wr in De.data})}}return De.common.async?Promise.resolve().then(async()=>{const Yt=[];for(const wr of $t){const ji=await wr.key,Mn=await wr.value;Yt.push({key:ji,value:Mn,alwaysSet:wr.alwaysSet})}return Yt}).then(Yt=>c.ParseStatus.mergeObjectSync(oe,Yt)):c.ParseStatus.mergeObjectSync(oe,$t)}get shape(){return this._def.shape()}strict(j){return s.errorUtil.errToObj,new sr({...this._def,unknownKeys:"strict",...j!==void 0?{errorMap:(re,oe)=>{const De=this._def.errorMap?.(re,oe).message??oe.defaultError;return re.code==="unrecognized_keys"?{message:s.errorUtil.errToObj(j).message??De}:{message:De}}}:{}})}strip(){return new sr({...this._def,unknownKeys:"strip"})}passthrough(){return new sr({...this._def,unknownKeys:"passthrough"})}extend(j){return new sr({...this._def,shape:()=>({...this._def.shape(),...j})})}merge(j){return new sr({unknownKeys:j._def.unknownKeys,catchall:j._def.catchall,shape:()=>({...this._def.shape(),...j._def.shape()}),typeName:Ze.ZodObject})}setKey(j,re){return this.augment({[j]:re})}catchall(j){return new sr({...this._def,catchall:j})}pick(j){const re={};for(const oe of d.util.objectKeys(j))j[oe]&&this.shape[oe]&&(re[oe]=this.shape[oe]);return new sr({...this._def,shape:()=>re})}omit(j){const re={};for(const oe of d.util.objectKeys(this.shape))j[oe]||(re[oe]=this.shape[oe]);return new sr({...this._def,shape:()=>re})}deepPartial(){return $r(this)}partial(j){const re={};for(const oe of d.util.objectKeys(this.shape)){const De=this.shape[oe];j&&!j[oe]?re[oe]=De:re[oe]=De.optional()}return new sr({...this._def,shape:()=>re})}required(j){const re={};for(const oe of d.util.objectKeys(this.shape))if(j&&!j[oe])re[oe]=this.shape[oe];else{let Me=this.shape[oe];for(;Me instanceof W;)Me=Me._def.innerType;re[oe]=Me}return new sr({...this._def,shape:()=>re})}keyof(){return Oi(d.util.objectKeys(this.shape))}}We.ZodObject=sr,sr.create=(ke,j)=>new sr({shape:()=>ke,unknownKeys:"strip",catchall:lr.create(),typeName:Ze.ZodObject,...a(j)}),sr.strictCreate=(ke,j)=>new sr({shape:()=>ke,unknownKeys:"strict",catchall:lr.create(),typeName:Ze.ZodObject,...a(j)}),sr.lazycreate=(ke,j)=>new sr({shape:ke,unknownKeys:"strip",catchall:lr.create(),typeName:Ze.ZodObject,...a(j)});class br extends g{_parse(j){const{ctx:re}=this._processInputParams(j),oe=this._def.options;function De(Me){for(const ht of Me)if(ht.result.status==="valid")return ht.result;for(const ht of Me)if(ht.result.status==="dirty")return re.common.issues.push(...ht.ctx.common.issues),ht.result;const Et=Me.map(ht=>new r.ZodError(ht.ctx.common.issues));return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_union,unionErrors:Et}),c.INVALID}if(re.common.async)return Promise.all(oe.map(async Me=>{const Et={...re,common:{...re.common,issues:[]},parent:null};return{result:await Me._parseAsync({data:re.data,path:re.path,parent:Et}),ctx:Et}})).then(De);{let Me;const Et=[];for(const $t of oe){const Yt={...re,common:{...re.common,issues:[]},parent:null},wr=$t._parseSync({data:re.data,path:re.path,parent:Yt});if(wr.status==="valid")return wr;wr.status==="dirty"&&!Me&&(Me={result:wr,ctx:Yt}),Yt.common.issues.length&&Et.push(Yt.common.issues)}if(Me)return re.common.issues.push(...Me.ctx.common.issues),Me.result;const ht=Et.map($t=>new r.ZodError($t));return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_union,unionErrors:ht}),c.INVALID}}get options(){return this._def.options}}We.ZodUnion=br,br.create=(ke,j)=>new br({options:ke,typeName:Ze.ZodUnion,...a(j)});const nr=ke=>ke instanceof bt?nr(ke.schema):ke instanceof we?nr(ke.innerType()):ke instanceof gi?[ke.value]:ke instanceof Oe?ke.options:ke instanceof vt?d.util.objectValues(ke.enum):ke instanceof se?nr(ke._def.innerType):ke instanceof ur?[void 0]:ke instanceof Tt?[null]:ke instanceof W?[void 0,...nr(ke.unwrap())]:ke instanceof J?[null,...nr(ke.unwrap())]:ke instanceof je||ke instanceof Ne?nr(ke.unwrap()):ke instanceof ve?nr(ke._def.innerType):[];class Xr extends g{_parse(j){const{ctx:re}=this._processInputParams(j);if(re.parsedType!==d.ZodParsedType.object)return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.object,received:re.parsedType}),c.INVALID;const oe=this.discriminator,De=re.data[oe],Me=this.optionsMap.get(De);return Me?re.common.async?Me._parseAsync({data:re.data,path:re.path,parent:re}):Me._parseSync({data:re.data,path:re.path,parent:re}):((0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[oe]}),c.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(j,re,oe){const De=new Map;for(const Me of re){const Et=nr(Me.shape[j]);if(!Et.length)throw new Error(`A discriminator value for key \`${j}\` could not be extracted from all schema options`);for(const ht of Et){if(De.has(ht))throw new Error(`Discriminator property ${String(j)} has duplicate value ${String(ht)}`);De.set(ht,Me)}}return new Xr({typeName:Ze.ZodDiscriminatedUnion,discriminator:j,options:re,optionsMap:De,...a(oe)})}}We.ZodDiscriminatedUnion=Xr;function Vt(ke,j){const re=(0,d.getParsedType)(ke),oe=(0,d.getParsedType)(j);if(ke===j)return{valid:!0,data:ke};if(re===d.ZodParsedType.object&&oe===d.ZodParsedType.object){const De=d.util.objectKeys(j),Me=d.util.objectKeys(ke).filter(ht=>De.indexOf(ht)!==-1),Et={...ke,...j};for(const ht of Me){const $t=Vt(ke[ht],j[ht]);if(!$t.valid)return{valid:!1};Et[ht]=$t.data}return{valid:!0,data:Et}}else if(re===d.ZodParsedType.array&&oe===d.ZodParsedType.array){if(ke.length!==j.length)return{valid:!1};const De=[];for(let Me=0;Me<ke.length;Me++){const Et=ke[Me],ht=j[Me],$t=Vt(Et,ht);if(!$t.valid)return{valid:!1};De.push($t.data)}return{valid:!0,data:De}}else return re===d.ZodParsedType.date&&oe===d.ZodParsedType.date&&+ke==+j?{valid:!0,data:ke}:{valid:!1}}class Pr extends g{_parse(j){const{status:re,ctx:oe}=this._processInputParams(j),De=(Me,Et)=>{if((0,c.isAborted)(Me)||(0,c.isAborted)(Et))return c.INVALID;const ht=Vt(Me.value,Et.value);return ht.valid?(((0,c.isDirty)(Me)||(0,c.isDirty)(Et))&&re.dirty(),{status:re.value,value:ht.data}):((0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_intersection_types}),c.INVALID)};return oe.common.async?Promise.all([this._def.left._parseAsync({data:oe.data,path:oe.path,parent:oe}),this._def.right._parseAsync({data:oe.data,path:oe.path,parent:oe})]).then(([Me,Et])=>De(Me,Et)):De(this._def.left._parseSync({data:oe.data,path:oe.path,parent:oe}),this._def.right._parseSync({data:oe.data,path:oe.path,parent:oe}))}}We.ZodIntersection=Pr,Pr.create=(ke,j,re)=>new Pr({left:ke,right:j,typeName:Ze.ZodIntersection,...a(re)});class Ct extends g{_parse(j){const{status:re,ctx:oe}=this._processInputParams(j);if(oe.parsedType!==d.ZodParsedType.array)return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.array,received:oe.parsedType}),c.INVALID;if(oe.data.length<this._def.items.length)return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.INVALID;!this._def.rest&&oe.data.length>this._def.items.length&&((0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),re.dirty());const Me=[...oe.data].map((Et,ht)=>{const $t=this._def.items[ht]||this._def.rest;return $t?$t._parse(new m(oe,Et,oe.path,ht)):null}).filter(Et=>!!Et);return oe.common.async?Promise.all(Me).then(Et=>c.ParseStatus.mergeArray(re,Et)):c.ParseStatus.mergeArray(re,Me)}get items(){return this._def.items}rest(j){return new Ct({...this._def,rest:j})}}We.ZodTuple=Ct,Ct.create=(ke,j)=>{if(!Array.isArray(ke))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ct({items:ke,typeName:Ze.ZodTuple,rest:null,...a(j)})};class er extends g{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(j){const{status:re,ctx:oe}=this._processInputParams(j);if(oe.parsedType!==d.ZodParsedType.object)return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.object,received:oe.parsedType}),c.INVALID;const De=[],Me=this._def.keyType,Et=this._def.valueType;for(const ht in oe.data)De.push({key:Me._parse(new m(oe,ht,oe.path,ht)),value:Et._parse(new m(oe,oe.data[ht],oe.path,ht)),alwaysSet:ht in oe.data});return oe.common.async?c.ParseStatus.mergeObjectAsync(re,De):c.ParseStatus.mergeObjectSync(re,De)}get element(){return this._def.valueType}static create(j,re,oe){return re instanceof g?new er({keyType:j,valueType:re,typeName:Ze.ZodRecord,...a(oe)}):new er({keyType:nt.create(),valueType:j,typeName:Ze.ZodRecord,...a(re)})}}We.ZodRecord=er;class or extends g{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(j){const{status:re,ctx:oe}=this._processInputParams(j);if(oe.parsedType!==d.ZodParsedType.map)return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.map,received:oe.parsedType}),c.INVALID;const De=this._def.keyType,Me=this._def.valueType,Et=[...oe.data.entries()].map(([ht,$t],Yt)=>({key:De._parse(new m(oe,ht,oe.path,[Yt,"key"])),value:Me._parse(new m(oe,$t,oe.path,[Yt,"value"]))}));if(oe.common.async){const ht=new Map;return Promise.resolve().then(async()=>{for(const $t of Et){const Yt=await $t.key,wr=await $t.value;if(Yt.status==="aborted"||wr.status==="aborted")return c.INVALID;(Yt.status==="dirty"||wr.status==="dirty")&&re.dirty(),ht.set(Yt.value,wr.value)}return{status:re.value,value:ht}})}else{const ht=new Map;for(const $t of Et){const Yt=$t.key,wr=$t.value;if(Yt.status==="aborted"||wr.status==="aborted")return c.INVALID;(Yt.status==="dirty"||wr.status==="dirty")&&re.dirty(),ht.set(Yt.value,wr.value)}return{status:re.value,value:ht}}}}We.ZodMap=or,or.create=(ke,j,re)=>new or({valueType:j,keyType:ke,typeName:Ze.ZodMap,...a(re)});class Lr extends g{_parse(j){const{status:re,ctx:oe}=this._processInputParams(j);if(oe.parsedType!==d.ZodParsedType.set)return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.set,received:oe.parsedType}),c.INVALID;const De=this._def;De.minSize!==null&&oe.data.size<De.minSize.value&&((0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_small,minimum:De.minSize.value,type:"set",inclusive:!0,exact:!1,message:De.minSize.message}),re.dirty()),De.maxSize!==null&&oe.data.size>De.maxSize.value&&((0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.too_big,maximum:De.maxSize.value,type:"set",inclusive:!0,exact:!1,message:De.maxSize.message}),re.dirty());const Me=this._def.valueType;function Et($t){const Yt=new Set;for(const wr of $t){if(wr.status==="aborted")return c.INVALID;wr.status==="dirty"&&re.dirty(),Yt.add(wr.value)}return{status:re.value,value:Yt}}const ht=[...oe.data.values()].map(($t,Yt)=>Me._parse(new m(oe,$t,oe.path,Yt)));return oe.common.async?Promise.all(ht).then($t=>Et($t)):Et(ht)}min(j,re){return new Lr({...this._def,minSize:{value:j,message:s.errorUtil.toString(re)}})}max(j,re){return new Lr({...this._def,maxSize:{value:j,message:s.errorUtil.toString(re)}})}size(j,re){return this.min(j,re).max(j,re)}nonempty(j){return this.min(1,j)}}We.ZodSet=Lr,Lr.create=(ke,j)=>new Lr({valueType:ke,minSize:null,maxSize:null,typeName:Ze.ZodSet,...a(j)});class Jr extends g{constructor(){super(...arguments),this.validate=this.implement}_parse(j){const{ctx:re}=this._processInputParams(j);if(re.parsedType!==d.ZodParsedType.function)return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.function,received:re.parsedType}),c.INVALID;function oe(ht,$t){return(0,c.makeIssue)({data:ht,path:re.path,errorMaps:[re.common.contextualErrorMap,re.schemaErrorMap,(0,i.getErrorMap)(),i.defaultErrorMap].filter(Yt=>!!Yt),issueData:{code:r.ZodIssueCode.invalid_arguments,argumentsError:$t}})}function De(ht,$t){return(0,c.makeIssue)({data:ht,path:re.path,errorMaps:[re.common.contextualErrorMap,re.schemaErrorMap,(0,i.getErrorMap)(),i.defaultErrorMap].filter(Yt=>!!Yt),issueData:{code:r.ZodIssueCode.invalid_return_type,returnTypeError:$t}})}const Me={errorMap:re.common.contextualErrorMap},Et=re.data;if(this._def.returns instanceof Nt){const ht=this;return(0,c.OK)(async function(...$t){const Yt=new r.ZodError([]),wr=await ht._def.args.parseAsync($t,Me).catch(Bt=>{throw Yt.addIssue(oe($t,Bt)),Yt}),ji=await Reflect.apply(Et,this,wr);return await ht._def.returns._def.type.parseAsync(ji,Me).catch(Bt=>{throw Yt.addIssue(De(ji,Bt)),Yt})})}else{const ht=this;return(0,c.OK)(function(...$t){const Yt=ht._def.args.safeParse($t,Me);if(!Yt.success)throw new r.ZodError([oe($t,Yt.error)]);const wr=Reflect.apply(Et,this,Yt.data),ji=ht._def.returns.safeParse(wr,Me);if(!ji.success)throw new r.ZodError([De(wr,ji.error)]);return ji.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...j){return new Jr({...this._def,args:Ct.create(j).rest(qr.create())})}returns(j){return new Jr({...this._def,returns:j})}implement(j){return this.parse(j)}strictImplement(j){return this.parse(j)}static create(j,re,oe){return new Jr({args:j||Ct.create([]).rest(qr.create()),returns:re||qr.create(),typeName:Ze.ZodFunction,...a(oe)})}}We.ZodFunction=Jr;class bt extends g{get schema(){return this._def.getter()}_parse(j){const{ctx:re}=this._processInputParams(j);return this._def.getter()._parse({data:re.data,path:re.path,parent:re})}}We.ZodLazy=bt,bt.create=(ke,j)=>new bt({getter:ke,typeName:Ze.ZodLazy,...a(j)});class gi extends g{_parse(j){if(j.data!==this._def.value){const re=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(re,{received:re.data,code:r.ZodIssueCode.invalid_literal,expected:this._def.value}),c.INVALID}return{status:"valid",value:j.data}}get value(){return this._def.value}}We.ZodLiteral=gi,gi.create=(ke,j)=>new gi({value:ke,typeName:Ze.ZodLiteral,...a(j)});function Oi(ke,j){return new Oe({values:ke,typeName:Ze.ZodEnum,...a(j)})}class Oe extends g{_parse(j){if(typeof j.data!="string"){const re=this._getOrReturnCtx(j),oe=this._def.values;return(0,c.addIssueToContext)(re,{expected:d.util.joinValues(oe),received:re.parsedType,code:r.ZodIssueCode.invalid_type}),c.INVALID}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(j.data)){const re=this._getOrReturnCtx(j),oe=this._def.values;return(0,c.addIssueToContext)(re,{received:re.data,code:r.ZodIssueCode.invalid_enum_value,options:oe}),c.INVALID}return(0,c.OK)(j.data)}get options(){return this._def.values}get enum(){const j={};for(const re of this._def.values)j[re]=re;return j}get Values(){const j={};for(const re of this._def.values)j[re]=re;return j}get Enum(){const j={};for(const re of this._def.values)j[re]=re;return j}extract(j,re=this._def){return Oe.create(j,{...this._def,...re})}exclude(j,re=this._def){return Oe.create(this.options.filter(oe=>!j.includes(oe)),{...this._def,...re})}}We.ZodEnum=Oe,Oe.create=Oi;class vt extends g{_parse(j){const re=d.util.getValidEnumValues(this._def.values),oe=this._getOrReturnCtx(j);if(oe.parsedType!==d.ZodParsedType.string&&oe.parsedType!==d.ZodParsedType.number){const De=d.util.objectValues(re);return(0,c.addIssueToContext)(oe,{expected:d.util.joinValues(De),received:oe.parsedType,code:r.ZodIssueCode.invalid_type}),c.INVALID}if(this._cache||(this._cache=new Set(d.util.getValidEnumValues(this._def.values))),!this._cache.has(j.data)){const De=d.util.objectValues(re);return(0,c.addIssueToContext)(oe,{received:oe.data,code:r.ZodIssueCode.invalid_enum_value,options:De}),c.INVALID}return(0,c.OK)(j.data)}get enum(){return this._def.values}}We.ZodNativeEnum=vt,vt.create=(ke,j)=>new vt({values:ke,typeName:Ze.ZodNativeEnum,...a(j)});class Nt extends g{unwrap(){return this._def.type}_parse(j){const{ctx:re}=this._processInputParams(j);if(re.parsedType!==d.ZodParsedType.promise&&re.common.async===!1)return(0,c.addIssueToContext)(re,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.promise,received:re.parsedType}),c.INVALID;const oe=re.parsedType===d.ZodParsedType.promise?re.data:Promise.resolve(re.data);return(0,c.OK)(oe.then(De=>this._def.type.parseAsync(De,{path:re.path,errorMap:re.common.contextualErrorMap})))}}We.ZodPromise=Nt,Nt.create=(ke,j)=>new Nt({type:ke,typeName:Ze.ZodPromise,...a(j)});class we extends g{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ze.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(j){const{status:re,ctx:oe}=this._processInputParams(j),De=this._def.effect||null,Me={addIssue:Et=>{(0,c.addIssueToContext)(oe,Et),Et.fatal?re.abort():re.dirty()},get path(){return oe.path}};if(Me.addIssue=Me.addIssue.bind(Me),De.type==="preprocess"){const Et=De.transform(oe.data,Me);if(oe.common.async)return Promise.resolve(Et).then(async ht=>{if(re.value==="aborted")return c.INVALID;const $t=await this._def.schema._parseAsync({data:ht,path:oe.path,parent:oe});return $t.status==="aborted"?c.INVALID:$t.status==="dirty"||re.value==="dirty"?(0,c.DIRTY)($t.value):$t});{if(re.value==="aborted")return c.INVALID;const ht=this._def.schema._parseSync({data:Et,path:oe.path,parent:oe});return ht.status==="aborted"?c.INVALID:ht.status==="dirty"||re.value==="dirty"?(0,c.DIRTY)(ht.value):ht}}if(De.type==="refinement"){const Et=ht=>{const $t=De.refinement(ht,Me);if(oe.common.async)return Promise.resolve($t);if($t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return ht};if(oe.common.async===!1){const ht=this._def.schema._parseSync({data:oe.data,path:oe.path,parent:oe});return ht.status==="aborted"?c.INVALID:(ht.status==="dirty"&&re.dirty(),Et(ht.value),{status:re.value,value:ht.value})}else return this._def.schema._parseAsync({data:oe.data,path:oe.path,parent:oe}).then(ht=>ht.status==="aborted"?c.INVALID:(ht.status==="dirty"&&re.dirty(),Et(ht.value).then(()=>({status:re.value,value:ht.value}))))}if(De.type==="transform")if(oe.common.async===!1){const Et=this._def.schema._parseSync({data:oe.data,path:oe.path,parent:oe});if(!(0,c.isValid)(Et))return c.INVALID;const ht=De.transform(Et.value,Me);if(ht instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:re.value,value:ht}}else return this._def.schema._parseAsync({data:oe.data,path:oe.path,parent:oe}).then(Et=>(0,c.isValid)(Et)?Promise.resolve(De.transform(Et.value,Me)).then(ht=>({status:re.value,value:ht})):c.INVALID);d.util.assertNever(De)}}We.ZodEffects=we,We.ZodTransformer=we,we.create=(ke,j,re)=>new we({schema:ke,typeName:Ze.ZodEffects,effect:j,...a(re)}),we.createWithPreprocess=(ke,j,re)=>new we({schema:j,effect:{type:"preprocess",transform:ke},typeName:Ze.ZodEffects,...a(re)});class W extends g{_parse(j){return this._getType(j)===d.ZodParsedType.undefined?(0,c.OK)(void 0):this._def.innerType._parse(j)}unwrap(){return this._def.innerType}}We.ZodOptional=W,W.create=(ke,j)=>new W({innerType:ke,typeName:Ze.ZodOptional,...a(j)});class J extends g{_parse(j){return this._getType(j)===d.ZodParsedType.null?(0,c.OK)(null):this._def.innerType._parse(j)}unwrap(){return this._def.innerType}}We.ZodNullable=J,J.create=(ke,j)=>new J({innerType:ke,typeName:Ze.ZodNullable,...a(j)});class se extends g{_parse(j){const{ctx:re}=this._processInputParams(j);let oe=re.data;return re.parsedType===d.ZodParsedType.undefined&&(oe=this._def.defaultValue()),this._def.innerType._parse({data:oe,path:re.path,parent:re})}removeDefault(){return this._def.innerType}}We.ZodDefault=se,se.create=(ke,j)=>new se({innerType:ke,typeName:Ze.ZodDefault,defaultValue:typeof j.default=="function"?j.default:()=>j.default,...a(j)});class ve extends g{_parse(j){const{ctx:re}=this._processInputParams(j),oe={...re,common:{...re.common,issues:[]}},De=this._def.innerType._parse({data:oe.data,path:oe.path,parent:{...oe}});return(0,c.isAsync)(De)?De.then(Me=>({status:"valid",value:Me.status==="valid"?Me.value:this._def.catchValue({get error(){return new r.ZodError(oe.common.issues)},input:oe.data})})):{status:"valid",value:De.status==="valid"?De.value:this._def.catchValue({get error(){return new r.ZodError(oe.common.issues)},input:oe.data})}}removeCatch(){return this._def.innerType}}We.ZodCatch=ve,ve.create=(ke,j)=>new ve({innerType:ke,typeName:Ze.ZodCatch,catchValue:typeof j.catch=="function"?j.catch:()=>j.catch,...a(j)});class Se extends g{_parse(j){if(this._getType(j)!==d.ZodParsedType.nan){const oe=this._getOrReturnCtx(j);return(0,c.addIssueToContext)(oe,{code:r.ZodIssueCode.invalid_type,expected:d.ZodParsedType.nan,received:oe.parsedType}),c.INVALID}return{status:"valid",value:j.data}}}We.ZodNaN=Se,Se.create=ke=>new Se({typeName:Ze.ZodNaN,...a(ke)}),We.BRAND=Symbol("zod_brand");class je extends g{_parse(j){const{ctx:re}=this._processInputParams(j),oe=re.data;return this._def.type._parse({data:oe,path:re.path,parent:re})}unwrap(){return this._def.type}}We.ZodBranded=je;class Ge extends g{_parse(j){const{status:re,ctx:oe}=this._processInputParams(j);if(oe.common.async)return(async()=>{const Me=await this._def.in._parseAsync({data:oe.data,path:oe.path,parent:oe});return Me.status==="aborted"?c.INVALID:Me.status==="dirty"?(re.dirty(),(0,c.DIRTY)(Me.value)):this._def.out._parseAsync({data:Me.value,path:oe.path,parent:oe})})();{const De=this._def.in._parseSync({data:oe.data,path:oe.path,parent:oe});return De.status==="aborted"?c.INVALID:De.status==="dirty"?(re.dirty(),{status:"dirty",value:De.value}):this._def.out._parseSync({data:De.value,path:oe.path,parent:oe})}}static create(j,re){return new Ge({in:j,out:re,typeName:Ze.ZodPipeline})}}We.ZodPipeline=Ge;class Ne extends g{_parse(j){const re=this._def.innerType._parse(j),oe=De=>((0,c.isValid)(De)&&(De.value=Object.freeze(De.value)),De);return(0,c.isAsync)(re)?re.then(De=>oe(De)):oe(re)}unwrap(){return this._def.innerType}}We.ZodReadonly=Ne,Ne.create=(ke,j)=>new Ne({innerType:ke,typeName:Ze.ZodReadonly,...a(j)});function Qe(ke,j){const re=typeof ke=="function"?ke(j):typeof ke=="string"?{message:ke}:ke;return typeof re=="string"?{message:re}:re}function mt(ke,j={},re){return ke?tr.create().superRefine((oe,De)=>{const Me=ke(oe);if(Me instanceof Promise)return Me.then(Et=>{if(!Et){const ht=Qe(j,oe),$t=ht.fatal??re??!0;De.addIssue({code:"custom",...ht,fatal:$t})}});if(!Me){const Et=Qe(j,oe),ht=Et.fatal??re??!0;De.addIssue({code:"custom",...Et,fatal:ht})}}):tr.create()}We.late={object:sr.lazycreate};var Ze;(function(ke){ke.ZodString="ZodString",ke.ZodNumber="ZodNumber",ke.ZodNaN="ZodNaN",ke.ZodBigInt="ZodBigInt",ke.ZodBoolean="ZodBoolean",ke.ZodDate="ZodDate",ke.ZodSymbol="ZodSymbol",ke.ZodUndefined="ZodUndefined",ke.ZodNull="ZodNull",ke.ZodAny="ZodAny",ke.ZodUnknown="ZodUnknown",ke.ZodNever="ZodNever",ke.ZodVoid="ZodVoid",ke.ZodArray="ZodArray",ke.ZodObject="ZodObject",ke.ZodUnion="ZodUnion",ke.ZodDiscriminatedUnion="ZodDiscriminatedUnion",ke.ZodIntersection="ZodIntersection",ke.ZodTuple="ZodTuple",ke.ZodRecord="ZodRecord",ke.ZodMap="ZodMap",ke.ZodSet="ZodSet",ke.ZodFunction="ZodFunction",ke.ZodLazy="ZodLazy",ke.ZodLiteral="ZodLiteral",ke.ZodEnum="ZodEnum",ke.ZodEffects="ZodEffects",ke.ZodNativeEnum="ZodNativeEnum",ke.ZodOptional="ZodOptional",ke.ZodNullable="ZodNullable",ke.ZodDefault="ZodDefault",ke.ZodCatch="ZodCatch",ke.ZodPromise="ZodPromise",ke.ZodBranded="ZodBranded",ke.ZodPipeline="ZodPipeline",ke.ZodReadonly="ZodReadonly"})(Ze||(We.ZodFirstPartyTypeKind=Ze={}));const Mt=(ke,j={message:`Input not instance of ${ke.name}`})=>mt(re=>re instanceof ke,j);We.instanceof=Mt;const qt=nt.create;We.string=qt;const Ke=lt.create;We.number=Ke;const yr=Se.create;We.nan=yr;const Dr=be.create;We.bigint=Dr;const Ot=Ft.create;We.boolean=Ot;const gr=Ut.create;We.date=gr;const pi=Le.create;We.symbol=pi;const fi=ur.create;We.undefined=fi;const ti=Tt.create;We.null=ti;const _i=tr.create;We.any=_i;const Kr=qr.create;We.unknown=Kr;const oi=lr.create;We.never=oi;const Mr=kr.create;We.void=Mr;const pt=Sr.create;We.array=pt;const Vi=sr.create;We.object=Vi;const Di=sr.strictCreate;We.strictObject=Di;const Ii=br.create;We.union=Ii;const at=Xr.create;We.discriminatedUnion=at;const At=Pr.create;We.intersection=At;const _r=Ct.create;We.tuple=_r;const cr=er.create;We.record=cr;const Gi=or.create;We.map=Gi;const gn=Lr.create;We.set=gn;const tn=Jr.create;We.function=tn;const dr=bt.create;We.lazy=dr;const ns=gi.create;We.literal=ns;const ss=Oe.create;We.enum=ss;const Kn=vt.create;We.nativeEnum=Kn;const vs=Nt.create;We.promise=vs;const rn=we.create;We.effect=rn,We.transformer=rn;const Gn=W.create;We.optional=Gn;const hi=J.create;We.nullable=hi;const Ui=we.createWithPreprocess;We.preprocess=Ui;const Qr=Ge.create;We.pipeline=Qr;const xs=()=>qt().optional();We.ostring=xs;const $n=()=>Ke().optional();We.onumber=$n;const oo=()=>Ot().optional();return We.oboolean=oo,We.coerce={string:(ke=>nt.create({...ke,coerce:!0})),number:(ke=>lt.create({...ke,coerce:!0})),boolean:(ke=>Ft.create({...ke,coerce:!0})),bigint:(ke=>be.create({...ke,coerce:!0})),date:(ke=>Ut.create({...ke,coerce:!0}))},We.NEVER=c.INVALID,We}var DR;function IR(){return DR||(DR=1,(function(r){var i=ic&&ic.__createBinding||(Object.create?(function(c,d,m,e){e===void 0&&(e=m);var a=Object.getOwnPropertyDescriptor(d,m);(!a||("get"in a?!d.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return d[m]}}),Object.defineProperty(c,e,a)}):(function(c,d,m,e){e===void 0&&(e=m),c[e]=d[m]})),s=ic&&ic.__exportStar||function(c,d){for(var m in c)m!=="default"&&!Object.prototype.hasOwnProperty.call(d,m)&&i(d,c,m)};Object.defineProperty(r,"__esModule",{value:!0}),s(Pw(),r),s(aM(),r),s(qF(),r),s(p0(),r),s(GF(),r),s(kw(),r)})(ic)),ic}var BR;function Fc(){return BR||(BR=1,(function(r){var i=Mo&&Mo.__createBinding||(Object.create?(function(e,a,g,w){w===void 0&&(w=g);var R=Object.getOwnPropertyDescriptor(a,g);(!R||("get"in R?!a.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return a[g]}}),Object.defineProperty(e,w,R)}):(function(e,a,g,w){w===void 0&&(w=g),e[w]=a[g]})),s=Mo&&Mo.__setModuleDefault||(Object.create?(function(e,a){Object.defineProperty(e,"default",{enumerable:!0,value:a})}):function(e,a){e.default=a}),c=Mo&&Mo.__importStar||function(e){if(e&&e.__esModule)return e;var a={};if(e!=null)for(var g in e)g!=="default"&&Object.prototype.hasOwnProperty.call(e,g)&&i(a,e,g);return s(a,e),a},d=Mo&&Mo.__exportStar||function(e,a){for(var g in e)g!=="default"&&!Object.prototype.hasOwnProperty.call(a,g)&&i(a,e,g)};Object.defineProperty(r,"__esModule",{value:!0}),r.z=void 0;const m=c(IR());r.z=m,d(IR(),r),r.default=m})(Mo)),Mo}var zo={},Oo={},MR;function $F(){if(MR)return Oo;MR=1,Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.isObject=Oo.assure=Oo.create=Oo.is=void 0;const r=(d,m)=>m.safeParse(d).success;Oo.is=r;const i=d=>m=>d.safeParse(m).success;Oo.create=i;const s=(d,m)=>d.parse(m);Oo.assure=s;const c=d=>typeof d=="object"&&d!==null;return Oo.isObject=c,Oo}var Gx={},zR;function Km(){return zR||(zR=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.parseIntWithFallback=r.dedupeStrs=r.range=r.chunkArray=r.errHasMsg=r.isErrnoException=r.asyncFilter=r.s32decode=r.s32encode=r.streamToBuffer=r.flattenUint8Arrays=r.bailableWait=r.wait=r.jitter=r.noUndefinedVals=void 0,r.aggregateErrors=s,r.omit=d;const i=Q=>(Object.keys(Q).forEach(Te=>{Q[Te]===void 0&&delete Q[Te]}),Q);r.noUndefinedVals=i;function s(Q,Te){return Q.length===1?Q[0]instanceof Error?Q[0]:new Error(Te??c(Q[0]),{cause:Q[0]}):new AggregateError(Q,Te??`Multiple errors: ${Q.map(c).join(`
`)}`)}function c(Q){return Q instanceof Error?Q.message:String(Q)}function d(Q,Te){if(!Q)return Q;const pe={},_e=Object.keys(Q);for(let Xe=0;Xe<_e.length;Xe++){const dt=_e[Xe];Te.includes(dt)||(pe[dt]=Q[dt])}return pe}const m=Q=>Math.round((Math.random()-.5)*Q*2);r.jitter=m;const e=Q=>new Promise(Te=>setTimeout(Te,Q));r.wait=e;const a=Q=>{let Te;const pe=new Promise(_e=>{const Xe=setTimeout(_e,Q);Te=()=>{clearTimeout(Xe),_e()}});return{bail:Te,wait:()=>pe}};r.bailableWait=a;const g=Q=>{const Te=Q.reduce((Xe,dt)=>Xe+dt.length,0),pe=new Uint8Array(Te);let _e=0;return Q.forEach(Xe=>{pe.set(Xe,_e),_e+=Xe.length}),pe};r.flattenUint8Arrays=g;const w=async Q=>{const Te=[];for await(const pe of Q)Te.push(pe);return(0,r.flattenUint8Arrays)(Te)};r.streamToBuffer=w;const R="234567abcdefghijklmnopqrstuvwxyz",S=Q=>{let Te="";for(;Q;){const pe=Q%32;Q=Math.floor(Q/32),Te=R.charAt(pe)+Te}return Te};r.s32encode=S;const D=Q=>{let Te=0;for(const pe of Q)Te=Te*32+R.indexOf(pe);return Te};r.s32decode=D;const k=async(Q,Te)=>{const pe=await Promise.all(Q.map(_e=>Te(_e)));return Q.filter((_e,Xe)=>pe[Xe])};r.asyncFilter=k;const B=Q=>!!Q&&Q.code;r.isErrnoException=B;const F=(Q,Te)=>!!Q&&typeof Q=="object"&&Q.message===Te;r.errHasMsg=F;const K=(Q,Te)=>Q.reduce((pe,_e,Xe)=>{const dt=Math.floor(Xe/Te);return pe[dt]||(pe[dt]=[]),pe[dt].push(_e),pe},[]);r.chunkArray=K;const U=Q=>{const Te=[];for(let pe=0;pe<Q;pe++)Te.push(pe);return Te};r.range=U;const ee=Q=>[...new Set(Q)];r.dedupeStrs=ee;const le=(Q,Te)=>{const pe=parseInt(Q||"",10);return isNaN(pe)?Te:pe};r.parseIntWithFallback=le})(Gx)),Gx}var Jd={},OR;function ZF(){if(OR)return Jd;OR=1,Object.defineProperty(Jd,"__esModule",{value:!0}),Jd.mapDefined=void 0,Jd.keyBy=r;function r(s,c){return s.reduce((d,m)=>(d.set(m[c],m),d),new Map)}const i=(s,c)=>{const d=[];for(const m of s){const e=c(m);e!==void 0&&d.push(e)}return d};return Jd.mapDefined=i,Jd}var $x={},VR;function HF(){return VR||(VR=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncBufferFullError=r.AsyncBuffer=r.allComplete=r.createDeferrables=r.createDeferrable=r.readFromGenerator=void 0,r.allFulfilled=g,r.handleAllSettledErrors=w,r.isRejectedResult=R,r.isFulfilledResult=D;const i=Km(),s=async(B,F,K=Promise.resolve(),U=Number.MAX_SAFE_INTEGER)=>{const ee=[];let le,Q=!1;const Te=async()=>{if(await F(ee.at(-1)))return!0;const _e=(0,i.bailableWait)(20);return await _e.wait(),le=_e.bail,Q?!1:await Te()},pe=new Promise(_e=>{K.then(()=>{Te().then(()=>_e())})});try{for(;ee.length<U;){const _e=await Promise.race([B.next(),pe]);if(!_e)break;const Xe=_e;if(Xe.done)break;ee.push(Xe.value)}}finally{Q=!0,le&&le()}return ee};r.readFromGenerator=s;const c=()=>{let B;const F=new Promise(K=>{B=()=>K()});return{resolve:B,complete:F}};r.createDeferrable=c;const d=B=>{const F=[];for(let K=0;K<B;K++)F.push((0,r.createDeferrable)());return F};r.createDeferrables=d;const m=async B=>{await Promise.all(B.map(F=>F.complete))};r.allComplete=m;class e{constructor(F){Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:F}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"promise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolve",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"toThrow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.promise=Promise.resolve(),this.resolve=()=>null,this.resetPromise()}get curr(){return this.buffer}get size(){return this.buffer.length}get isClosed(){return this.closed}resetPromise(){this.promise=new Promise(F=>this.resolve=F)}push(F){this.buffer.push(F),this.resolve()}pushMany(F){F.forEach(K=>this.buffer.push(K)),this.resolve()}async*events(){for(;;){if(this.closed&&this.buffer.length===0){if(this.toThrow)throw this.toThrow;return}if(await this.promise,this.toThrow)throw this.toThrow;if(this.maxSize&&this.size>this.maxSize)throw new a(this.maxSize);const[F,...K]=this.buffer;F?(this.buffer=K,yield F):this.resetPromise()}}throw(F){this.toThrow=F,this.closed=!0,this.resolve()}close(){this.closed=!0,this.resolve()}}r.AsyncBuffer=e;class a extends Error{constructor(F){super(`ReachedMaxBufferSize: ${F}`)}}r.AsyncBufferFullError=a;function g(B){return Promise.allSettled(B).then(w)}function w(B){if(B.every(D))return B.map(k);const F=B.filter(R).map(S);throw(0,i.aggregateErrors)(F)}function R(B){return B.status==="rejected"}function S(B){return B.reason}function D(B){return B.status==="fulfilled"}function k(B){return B.value}})($x)),$x}var jh={},UR;function XF(){if(UR)return jh;UR=1,Object.defineProperty(jh,"__esModule",{value:!0}),jh.TID=void 0;const r=Km(),i=13;let s=0,c=0,d=null;function m(a){return a.replaceAll("-","")}class e{constructor(g){Object.defineProperty(this,"str",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const w=m(g);if(w.length!==i)throw new Error(`Poorly formatted TID: ${w.length} length`);this.str=w}static next(g){const w=Math.max(Date.now(),s);w===s&&c++,s=w;const R=w*1e3+c;d===null&&(d=Math.floor(Math.random()*32));const S=e.fromTime(R,d);return!g||S.newerThan(g)?S:e.fromTime(g.timestamp()+1,d)}static nextStr(g){return e.next(g?new e(g):void 0).toString()}static fromTime(g,w){const R=`${(0,r.s32encode)(g)}${(0,r.s32encode)(w).padStart(2,"2")}`;return new e(R)}static fromStr(g){return new e(g)}static oldestFirst(g,w){return g.compareTo(w)}static newestFirst(g,w){return w.compareTo(g)}static is(g){return m(g).length===i}timestamp(){return(0,r.s32decode)(this.str.slice(0,11))}clockid(){return(0,r.s32decode)(this.str.slice(11,13))}formatted(){const g=this.toString();return`${g.slice(0,4)}-${g.slice(4,7)}-${g.slice(7,11)}-${g.slice(11,13)}`}toString(){return this.str}compareTo(g){return this.str>g.str?1:this.str<g.str?-1:0}equals(g){return this.str===g.str}newerThan(g){return this.compareTo(g)>0}olderThan(g){return this.compareTo(g)<0}}return jh.TID=e,jh}var Wa={},WF=lM,jR=128,YF=-128,JF=Math.pow(2,31);function lM(r,i,s){i=i||[],s=s||0;for(var c=s;r>=JF;)i[s++]=r&255|jR,r/=128;for(;r&YF;)i[s++]=r&255|jR,r>>>=7;return i[s]=r|0,lM.bytes=s-c+1,i}var QF=U1,eq=128,NR=127;function U1(r,c){var s=0,c=c||0,d=0,m=c,e,a=r.length;do{if(m>=a)throw U1.bytes=0,new RangeError("Could not decode varint");e=r[m++],s+=d<28?(e&NR)<<d:(e&NR)*Math.pow(2,d),d+=7}while(e>=eq);return U1.bytes=m-c,s}var tq=Math.pow(2,7),rq=Math.pow(2,14),iq=Math.pow(2,21),nq=Math.pow(2,28),sq=Math.pow(2,35),oq=Math.pow(2,42),aq=Math.pow(2,49),lq=Math.pow(2,56),uq=Math.pow(2,63),cq=function(r){return r<tq?1:r<rq?2:r<iq?3:r<nq?4:r<sq?5:r<oq?6:r<aq?7:r<lq?8:r<uq?9:10},dq={encode:WF,decode:QF,encodingLength:cq},Fv=dq;const j1=(r,i=0)=>[Fv.decode(r,i),Fv.decode.bytes],qv=(r,i,s=0)=>(Fv.encode(r,i,s),i),Kv=r=>Fv.encodingLength(r),pq=(r,i)=>{if(r===i)return!0;if(r.byteLength!==i.byteLength)return!1;for(let s=0;s<r.byteLength;s++)if(r[s]!==i[s])return!1;return!0},Lw=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},fq=r=>new TextEncoder().encode(r),hq=r=>new TextDecoder().decode(r),mq=(r,i)=>{const s=i.byteLength,c=Kv(r),d=c+Kv(s),m=new Uint8Array(d+s);return qv(r,m,0),qv(s,m,c),m.set(i,d),new Dw(r,s,i,m)},yq=r=>{const i=Lw(r),[s,c]=j1(i),[d,m]=j1(i.subarray(c)),e=i.subarray(c+m);if(e.byteLength!==d)throw new Error("Incorrect length");return new Dw(s,d,e,i)},gq=(r,i)=>r===i?!0:r.code===i.code&&r.size===i.size&&pq(r.bytes,i.bytes);class Dw{constructor(i,s,c,d){this.code=i,this.size=s,this.digest=c,this.bytes=d}}function _q(r,i){if(r.length>=255)throw new TypeError("Alphabet too long");for(var s=new Uint8Array(256),c=0;c<s.length;c++)s[c]=255;for(var d=0;d<r.length;d++){var m=r.charAt(d),e=m.charCodeAt(0);if(s[e]!==255)throw new TypeError(m+" is ambiguous");s[e]=d}var a=r.length,g=r.charAt(0),w=Math.log(a)/Math.log(256),R=Math.log(256)/Math.log(a);function S(B){if(B instanceof Uint8Array||(ArrayBuffer.isView(B)?B=new Uint8Array(B.buffer,B.byteOffset,B.byteLength):Array.isArray(B)&&(B=Uint8Array.from(B))),!(B instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(B.length===0)return"";for(var F=0,K=0,U=0,ee=B.length;U!==ee&&B[U]===0;)U++,F++;for(var le=(ee-U)*R+1>>>0,Q=new Uint8Array(le);U!==ee;){for(var Te=B[U],pe=0,_e=le-1;(Te!==0||pe<K)&&_e!==-1;_e--,pe++)Te+=256*Q[_e]>>>0,Q[_e]=Te%a>>>0,Te=Te/a>>>0;if(Te!==0)throw new Error("Non-zero carry");K=pe,U++}for(var Xe=le-K;Xe!==le&&Q[Xe]===0;)Xe++;for(var dt=g.repeat(F);Xe<le;++Xe)dt+=r.charAt(Q[Xe]);return dt}function D(B){if(typeof B!="string")throw new TypeError("Expected String");if(B.length===0)return new Uint8Array;var F=0;if(B[F]!==" "){for(var K=0,U=0;B[F]===g;)K++,F++;for(var ee=(B.length-F)*w+1>>>0,le=new Uint8Array(ee);B[F];){var Q=s[B.charCodeAt(F)];if(Q===255)return;for(var Te=0,pe=ee-1;(Q!==0||Te<U)&&pe!==-1;pe--,Te++)Q+=a*le[pe]>>>0,le[pe]=Q%256>>>0,Q=Q/256>>>0;if(Q!==0)throw new Error("Non-zero carry");U=Te,F++}if(B[F]!==" "){for(var _e=ee-U;_e!==ee&&le[_e]===0;)_e++;for(var Xe=new Uint8Array(K+(ee-_e)),dt=K;_e!==ee;)Xe[dt++]=le[_e++];return Xe}}}function k(B){var F=D(B);if(F)return F;throw new Error(`Non-${i} character`)}return{encode:S,decodeUnsafe:D,decode:k}}var bq=_q,vq=bq;class xq{constructor(i,s,c){this.name=i,this.prefix=s,this.baseEncode=c}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class wq{constructor(i,s,c){if(this.name=i,this.prefix=s,s.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=s.codePointAt(0),this.baseDecode=c}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return uM(this,i)}}class Eq{constructor(i){this.decoders=i}or(i){return uM(this,i)}decode(i){const s=i[0],c=this.decoders[s];if(c)return c.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const uM=(r,i)=>new Eq({...r.decoders||{[r.prefix]:r},...i.decoders||{[i.prefix]:i}});class Aq{constructor(i,s,c,d){this.name=i,this.prefix=s,this.baseEncode=c,this.baseDecode=d,this.encoder=new xq(i,s,c),this.decoder=new wq(i,s,d)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const f0=({name:r,prefix:i,encode:s,decode:c})=>new Aq(r,i,s,c),ey=({prefix:r,name:i,alphabet:s})=>{const{encode:c,decode:d}=vq(s,i);return f0({prefix:r,name:i,encode:c,decode:m=>Lw(d(m))})},Rq=(r,i,s,c)=>{const d={};for(let R=0;R<i.length;++R)d[i[R]]=R;let m=r.length;for(;r[m-1]==="=";)--m;const e=new Uint8Array(m*s/8|0);let a=0,g=0,w=0;for(let R=0;R<m;++R){const S=d[r[R]];if(S===void 0)throw new SyntaxError(`Non-${c} character`);g=g<<s|S,a+=s,a>=8&&(a-=8,e[w++]=255&g>>a)}if(a>=s||255&g<<8-a)throw new SyntaxError("Unexpected end of data");return e},Sq=(r,i,s)=>{const c=i[i.length-1]==="=",d=(1<<s)-1;let m="",e=0,a=0;for(let g=0;g<r.length;++g)for(a=a<<8|r[g],e+=8;e>s;)e-=s,m+=i[d&a>>e];if(e&&(m+=i[d&a<<s-e]),c)for(;m.length*s&7;)m+="=";return m},qn=({name:r,prefix:i,bitsPerChar:s,alphabet:c})=>f0({prefix:i,name:r,encode(d){return Sq(d,c,s)},decode(d){return Rq(d,c,s,r)}}),el=ey({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tq=ey({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Cq=Object.freeze(Object.defineProperty({__proto__:null,base58btc:el,base58flickr:Tq},Symbol.toStringTag,{value:"Module"})),Mm=qn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kq=qn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pq=qn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Lq=qn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Dq=qn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Iq=qn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bq=qn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mq=qn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zq=qn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Oq=Object.freeze(Object.defineProperty({__proto__:null,base32:Mm,base32hex:Dq,base32hexpad:Bq,base32hexpadupper:Mq,base32hexupper:Iq,base32pad:Pq,base32padupper:Lq,base32upper:kq,base32z:zq},Symbol.toStringTag,{value:"Module"}));class Jn{constructor(i,s,c,d){this.code=s,this.version=i,this.multihash=c,this.bytes=d,this.byteOffset=d.byteOffset,this.byteLength=d.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:xg,byteLength:xg,code:vg,version:vg,multihash:vg,bytes:vg,_baseCache:xg,asCID:xg})}toV0(){switch(this.version){case 0:return this;default:{const{code:i,multihash:s}=this;if(i!==Nh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(s.code!==Nq)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Jn.createV0(s)}}}toV1(){switch(this.version){case 0:{const{code:i,digest:s}=this.multihash,c=mq(i,s);return Jn.createV1(this.code,c)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(i){return i&&this.code===i.code&&this.version===i.version&&gq(this.multihash,i.multihash)}toString(i){const{bytes:s,version:c,_baseCache:d}=this;switch(c){case 0:return Uq(s,d,i||el.encoder);default:return jq(s,d,i||Mm.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(i){return qq(/^0\.0/,Kq),!!(i&&(i[qR]||i.asCID===i))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(i){if(i instanceof Jn)return i;if(i!=null&&i.asCID===i){const{version:s,code:c,multihash:d,bytes:m}=i;return new Jn(s,c,d,m||FR(s,c,d.bytes))}else if(i!=null&&i[qR]===!0){const{version:s,multihash:c,code:d}=i,m=yq(c);return Jn.create(s,d,m)}else return null}static create(i,s,c){if(typeof s!="number")throw new Error("String codecs are no longer supported");switch(i){case 0:{if(s!==Nh)throw new Error(`Version 0 CID must use dag-pb (code: ${Nh}) block encoding`);return new Jn(i,s,c,c.bytes)}case 1:{const d=FR(i,s,c.bytes);return new Jn(i,s,c,d)}default:throw new Error("Invalid version")}}static createV0(i){return Jn.create(0,Nh,i)}static createV1(i,s){return Jn.create(1,i,s)}static decode(i){const[s,c]=Jn.decodeFirst(i);if(c.length)throw new Error("Incorrect length");return s}static decodeFirst(i){const s=Jn.inspectBytes(i),c=s.size-s.multihashSize,d=Lw(i.subarray(c,c+s.multihashSize));if(d.byteLength!==s.multihashSize)throw new Error("Incorrect length");const m=d.subarray(s.multihashSize-s.digestSize),e=new Dw(s.multihashCode,s.digestSize,m,d);return[s.version===0?Jn.createV0(e):Jn.createV1(s.codec,e),i.subarray(s.size)]}static inspectBytes(i){let s=0;const c=()=>{const[S,D]=j1(i.subarray(s));return s+=D,S};let d=c(),m=Nh;if(d===18?(d=0,s=0):d===1&&(m=c()),d!==0&&d!==1)throw new RangeError(`Invalid CID version ${d}`);const e=s,a=c(),g=c(),w=s+g,R=w-e;return{version:d,codec:m,multihashCode:a,digestSize:g,multihashSize:R,size:w}}static parse(i,s){const[c,d]=Vq(i,s),m=Jn.decode(d);return m._baseCache.set(c,i),m}}const Vq=(r,i)=>{switch(r[0]){case"Q":{const s=i||el;return[el.prefix,s.decode(`${el.prefix}${r}`)]}case el.prefix:{const s=i||el;return[el.prefix,s.decode(r)]}case Mm.prefix:{const s=i||Mm;return[Mm.prefix,s.decode(r)]}default:{if(i==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],i.decode(r)]}}},Uq=(r,i,s)=>{const{prefix:c}=s;if(c!==el.prefix)throw Error(`Cannot string encode V0 in ${s.name} encoding`);const d=i.get(c);if(d==null){const m=s.encode(r).slice(1);return i.set(c,m),m}else return d},jq=(r,i,s)=>{const{prefix:c}=s,d=i.get(c);if(d==null){const m=s.encode(r);return i.set(c,m),m}else return d},Nh=112,Nq=18,FR=(r,i,s)=>{const c=Kv(r),d=c+Kv(i),m=new Uint8Array(d+s.byteLength);return qv(r,m,0),qv(i,m,c),m.set(s,d),m},qR=Symbol.for("@ipld/js-cid/CID"),vg={writable:!1,configurable:!1,enumerable:!0},xg={writable:!1,enumerable:!1,configurable:!1},Fq="0.0.0-dev",qq=(r,i)=>{if(r.test(Fq))console.warn(i);else throw new Error(i)},Kq=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,Gq=Object.freeze(Object.defineProperty({__proto__:null,CID:Jn},Symbol.toStringTag,{value:"Module"})),Af=EB(Gq);function $q(r,i){for(let s=0;s<r.byteLength;s++){if(r[s]<i[s])return-1;if(r[s]>i[s])return 1}return r.byteLength>i.byteLength?1:r.byteLength<i.byteLength?-1:0}function Zq(r,i){i||(i=r.reduce((d,m)=>d+m.length,0));const s=new Uint8Array(i);let c=0;for(const d of r)s.set(d,c),c+=d.length;return s}function Hq(r,i){if(r===i)return!0;if(r.byteLength!==i.byteLength)return!1;for(let s=0;s<r.byteLength;s++)if(r[s]!==i[s])return!1;return!0}const Xq=f0({prefix:"\0",name:"identity",encode:r=>hq(r),decode:r=>fq(r)}),Wq=Object.freeze(Object.defineProperty({__proto__:null,identity:Xq},Symbol.toStringTag,{value:"Module"})),Yq=qn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Jq=Object.freeze(Object.defineProperty({__proto__:null,base2:Yq},Symbol.toStringTag,{value:"Module"})),Qq=qn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),e6=Object.freeze(Object.defineProperty({__proto__:null,base8:Qq},Symbol.toStringTag,{value:"Module"})),t6=ey({prefix:"9",name:"base10",alphabet:"0123456789"}),r6=Object.freeze(Object.defineProperty({__proto__:null,base10:t6},Symbol.toStringTag,{value:"Module"})),i6=qn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),n6=qn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),s6=Object.freeze(Object.defineProperty({__proto__:null,base16:i6,base16upper:n6},Symbol.toStringTag,{value:"Module"})),o6=ey({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),a6=ey({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),l6=Object.freeze(Object.defineProperty({__proto__:null,base36:o6,base36upper:a6},Symbol.toStringTag,{value:"Module"})),u6=qn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),c6=qn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),d6=qn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),p6=qn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),f6=Object.freeze(Object.defineProperty({__proto__:null,base64:u6,base64pad:c6,base64url:d6,base64urlpad:p6},Symbol.toStringTag,{value:"Module"})),cM=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),h6=cM.reduce((r,i,s)=>(r[s]=i,r),[]),m6=cM.reduce((r,i,s)=>(r[i.codePointAt(0)]=s,r),[]);function y6(r){return r.reduce((i,s)=>(i+=h6[s],i),"")}function g6(r){const i=[];for(const s of r){const c=m6[s.codePointAt(0)];if(c===void 0)throw new Error(`Non-base256emoji character: ${s}`);i.push(c)}return new Uint8Array(i)}const _6=f0({prefix:"🚀",name:"base256emoji",encode:y6,decode:g6}),b6=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:_6},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const KR={...Wq,...Jq,...e6,...r6,...s6,...Oq,...l6,...Cq,...f6,...b6};function dM(r,i,s,c){return{name:r,prefix:i,encoder:{name:r,prefix:i,encode:s},decoder:{decode:c}}}const GR=dM("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Zx=dM("ascii","a",r=>{let i="a";for(let s=0;s<r.length;s++)i+=String.fromCharCode(r[s]);return i},r=>{r=r.substring(1);const i=new Uint8Array(r.length);for(let s=0;s<r.length;s++)i[s]=r.charCodeAt(s);return i}),pM={utf8:GR,"utf-8":GR,hex:KR.base16,latin1:Zx,ascii:Zx,binary:Zx,...KR};function v6(r,i="utf8"){const s=pM[i];if(!s)throw new Error(`Unsupported encoding "${i}"`);return s.decoder.decode(`${s.prefix}${r}`)}function x6(r,i="utf8"){const s=pM[i];if(!s)throw new Error(`Unsupported encoding "${i}"`);return s.encoder.encode(r).substring(1)}function w6(r,i){if(r.length!==i.length)throw new Error("Inputs should have the same length");const s=new Uint8Array(r.length);for(let c=0;c<r.length;c++)s[c]=r[c]^i[c];return s}const E6=Object.freeze(Object.defineProperty({__proto__:null,compare:$q,concat:Zq,equals:Hq,fromString:v6,toString:x6,xor:w6},Symbol.toStringTag,{value:"Module"})),fM=EB(E6);var $R;function A6(){return $R||($R=1,(function(r){var i=Wa&&Wa.__createBinding||(Object.create?(function(w,R,S,D){D===void 0&&(D=S);var k=Object.getOwnPropertyDescriptor(R,S);(!k||("get"in k?!R.__esModule:k.writable||k.configurable))&&(k={enumerable:!0,get:function(){return R[S]}}),Object.defineProperty(w,D,k)}):(function(w,R,S,D){D===void 0&&(D=S),w[D]=R[S]})),s=Wa&&Wa.__setModuleDefault||(Object.create?(function(w,R){Object.defineProperty(w,"default",{enumerable:!0,value:R})}):function(w,R){w.default=R}),c=Wa&&Wa.__importStar||(function(){var w=function(R){return w=Object.getOwnPropertyNames||function(S){var D=[];for(var k in S)Object.prototype.hasOwnProperty.call(S,k)&&(D[D.length]=k);return D},w(R)};return function(R){if(R&&R.__esModule)return R;var S={};if(R!=null)for(var D=w(R),k=0;k<D.length;k++)D[k]!=="default"&&i(S,R,D[k]);return s(S,R),S}})();Object.defineProperty(r,"__esModule",{value:!0}),r.ipldEquals=r.ipldToJson=r.jsonToIpld=void 0;const d=Af,m=c(fM),e=w=>{if(Array.isArray(w))return w.map(R=>(0,r.jsonToIpld)(R));if(w&&typeof w=="object"){if(typeof w.$link=="string"&&Object.keys(w).length===1)return d.CID.parse(w.$link);if(typeof w.$bytes=="string"&&Object.keys(w).length===1)return m.fromString(w.$bytes,"base64");const R={};for(const S of Object.keys(w))R[S]=(0,r.jsonToIpld)(w[S]);return R}return w};r.jsonToIpld=e;const a=w=>{if(Array.isArray(w))return w.map(R=>(0,r.ipldToJson)(R));if(w&&typeof w=="object"){if(w instanceof Uint8Array)return{$bytes:m.toString(w,"base64")};if(d.CID.asCID(w))return{$link:w.toString()};const R={};for(const S of Object.keys(w))R[S]=(0,r.ipldToJson)(w[S]);return R}return w};r.ipldToJson=a;const g=(w,R)=>{if(Array.isArray(w)&&Array.isArray(R)){if(w.length!==R.length)return!1;for(let S=0;S<w.length;S++)if(!(0,r.ipldEquals)(w[S],R[S]))return!1;return!0}if(w&&R&&typeof w=="object"&&typeof R=="object"){if(w instanceof Uint8Array&&R instanceof Uint8Array)return m.equals(w,R);if(d.CID.asCID(w)&&d.CID.asCID(R))return d.CID.asCID(w)?.equals(d.CID.asCID(R));if(Object.keys(w).length!==Object.keys(R).length)return!1;for(const S of Object.keys(w))if(!(0,r.ipldEquals)(w[S],R[S]))return!1;return!0}return w===R};r.ipldEquals=g})(Wa)),Wa}var Qd={},ZR;function R6(){if(ZR)return Qd;ZR=1,Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.retry=i,Qd.createRetryable=s,Qd.backoffMs=c;const r=Km();async function i(e,a={}){const{maxRetries:g=3,retryable:w=()=>!0,getWaitMs:R=c}=a;let S=0,D;for(;!D;)try{return await e()}catch(k){const B=R(S);S<g&&B!==null&&w(k)?(S+=1,B!==0&&await(0,r.wait)(B)):D=k}throw D}function s(e){return async(a,g)=>i(a,{...g,retryable:e})}function c(e,a=100,g=1e3){const w=Math.pow(2,e)*a,R=Math.min(w,g);return d(R)}function d(e){const a=e*.15;return e+m(-a,a)}function m(e,a){return Math.random()*(a-e)+e}return Qd}var Hx={},HR;function S6(){return HR||(HR=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.def=r.schema=void 0;const i=Af,s=Fc(),c=s.z.unknown().transform((m,e)=>{const a=i.CID.asCID(m);return a??(e.addIssue({code:s.z.ZodIssueCode.custom,message:"Not a valid CID"}),s.z.NEVER)}),d=s.z.object({version:s.z.literal(1),roots:s.z.array(c)});r.schema={cid:c,carHeader:d,bytes:s.z.instanceof(Uint8Array),string:s.z.string(),array:s.z.array(s.z.unknown()),map:s.z.record(s.z.string(),s.z.unknown()),unknown:s.z.unknown()},r.def={cid:{name:"cid",schema:r.schema.cid},carHeader:{name:"CAR header",schema:r.schema.carHeader},bytes:{name:"bytes",schema:r.schema.bytes},string:{name:"string",schema:r.schema.string},map:{name:"map",schema:r.schema.map},unknown:{name:"unknown",schema:r.schema.unknown}}})(Hx)),Hx}var Xx={},XR;function T6(){return XR||(XR=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.addHoursToDate=r.lessThanAgoMs=r.DAY=r.HOUR=r.MINUTE=r.SECOND=void 0,r.SECOND=1e3,r.MINUTE=r.SECOND*60,r.HOUR=r.MINUTE*60,r.DAY=r.HOUR*24;const i=(c,d)=>Date.now()<c.getTime()+d;r.lessThanAgoMs=i;const s=(c,d)=>{const m=d?new Date(d):new Date;return m.setHours(m.getHours()+c),m};r.addHoursToDate=s})(Xx)),Xx}var Ki={},ep={},tp={},Wx={},WR;function hM(){return WR||(WR=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.EXTENDED_PICTOGRAPHIC=r.CLUSTER_BREAK=void 0,(function(i){i[i.CR=0]="CR",i[i.LF=1]="LF",i[i.CONTROL=2]="CONTROL",i[i.EXTEND=3]="EXTEND",i[i.REGIONAL_INDICATOR=4]="REGIONAL_INDICATOR",i[i.SPACINGMARK=5]="SPACINGMARK",i[i.L=6]="L",i[i.V=7]="V",i[i.T=8]="T",i[i.LV=9]="LV",i[i.LVT=10]="LVT",i[i.OTHER=11]="OTHER",i[i.PREPEND=12]="PREPEND",i[i.E_BASE=13]="E_BASE",i[i.E_MODIFIER=14]="E_MODIFIER",i[i.ZWJ=15]="ZWJ",i[i.GLUE_AFTER_ZWJ=16]="GLUE_AFTER_ZWJ",i[i.E_BASE_GAZ=17]="E_BASE_GAZ"})(r.CLUSTER_BREAK||(r.CLUSTER_BREAK={})),r.EXTENDED_PICTOGRAPHIC=101})(Wx)),Wx}var wg={},YR;function C6(){if(YR)return wg;YR=1,Object.defineProperty(wg,"__esModule",{value:!0});const r=hM(),i=0,s=1,c=2,d=3,m=4;let e=class{static isSurrogate(g,w){return 55296<=g.charCodeAt(w)&&g.charCodeAt(w)<=56319&&56320<=g.charCodeAt(w+1)&&g.charCodeAt(w+1)<=57343}static codePointAt(g,w){w===void 0&&(w=0);const R=g.charCodeAt(w);if(55296<=R&&R<=56319&&w<g.length-1){const S=R,D=g.charCodeAt(w+1);return 56320<=D&&D<=57343?(S-55296)*1024+(D-56320)+65536:S}if(56320<=R&&R<=57343&&w>=1){const S=g.charCodeAt(w-1),D=R;return 55296<=S&&S<=56319?(S-55296)*1024+(D-56320)+65536:D}return R}static shouldBreak(g,w,R,S,D,k){const B=[g].concat(w).concat([R]),F=[S].concat(D).concat([k]),K=B[B.length-2],U=R,ee=k,le=B.lastIndexOf(r.CLUSTER_BREAK.REGIONAL_INDICATOR);if(le>0&&B.slice(1,le).every(function(Te){return Te===r.CLUSTER_BREAK.REGIONAL_INDICATOR})&&[r.CLUSTER_BREAK.PREPEND,r.CLUSTER_BREAK.REGIONAL_INDICATOR].indexOf(K)===-1)return B.filter(function(Te){return Te===r.CLUSTER_BREAK.REGIONAL_INDICATOR}).length%2===1?d:m;if(K===r.CLUSTER_BREAK.CR&&U===r.CLUSTER_BREAK.LF)return i;if(K===r.CLUSTER_BREAK.CONTROL||K===r.CLUSTER_BREAK.CR||K===r.CLUSTER_BREAK.LF)return s;if(U===r.CLUSTER_BREAK.CONTROL||U===r.CLUSTER_BREAK.CR||U===r.CLUSTER_BREAK.LF)return s;if(K===r.CLUSTER_BREAK.L&&(U===r.CLUSTER_BREAK.L||U===r.CLUSTER_BREAK.V||U===r.CLUSTER_BREAK.LV||U===r.CLUSTER_BREAK.LVT))return i;if((K===r.CLUSTER_BREAK.LV||K===r.CLUSTER_BREAK.V)&&(U===r.CLUSTER_BREAK.V||U===r.CLUSTER_BREAK.T))return i;if((K===r.CLUSTER_BREAK.LVT||K===r.CLUSTER_BREAK.T)&&U===r.CLUSTER_BREAK.T)return i;if(U===r.CLUSTER_BREAK.EXTEND||U===r.CLUSTER_BREAK.ZWJ)return i;if(U===r.CLUSTER_BREAK.SPACINGMARK)return i;if(K===r.CLUSTER_BREAK.PREPEND)return i;const Q=F.slice(0,-1).lastIndexOf(r.EXTENDED_PICTOGRAPHIC);return Q!==-1&&F[Q]===r.EXTENDED_PICTOGRAPHIC&&B.slice(Q+1,-2).every(function(Te){return Te===r.CLUSTER_BREAK.EXTEND})&&K===r.CLUSTER_BREAK.ZWJ&&ee===r.EXTENDED_PICTOGRAPHIC?i:w.indexOf(r.CLUSTER_BREAK.REGIONAL_INDICATOR)!==-1?c:K===r.CLUSTER_BREAK.REGIONAL_INDICATOR&&U===r.CLUSTER_BREAK.REGIONAL_INDICATOR?i:s}};return wg.default=e,wg}var Eg={},JR;function k6(){if(JR)return Eg;JR=1,Object.defineProperty(Eg,"__esModule",{value:!0});let r=class{constructor(s,c){this._index=0,this._str=s,this._nextBreak=c}[Symbol.iterator](){return this}next(){let s;if((s=this._nextBreak(this._str,this._index))<this._str.length){const c=this._str.slice(this._index,s);return this._index=s,{value:c,done:!1}}if(this._index<this._str.length){const c=this._str.slice(this._index);return this._index=this._str.length,{value:c,done:!1}}return{value:void 0,done:!0}}};return Eg.default=r,Eg}var QR;function P6(){if(QR)return tp;QR=1;var r=tp&&tp.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(tp,"__esModule",{value:!0});const i=hM(),s=r(C6()),c=r(k6());let d=class au{static nextBreak(e,a){if(a===void 0&&(a=0),a<0)return 0;if(a>=e.length-1)return e.length;const g=s.default.codePointAt(e,a),w=au.getGraphemeBreakProperty(g),R=au.getEmojiProperty(g),S=[],D=[];for(let k=a+1;k<e.length;k++){if(s.default.isSurrogate(e,k-1))continue;const B=s.default.codePointAt(e,k),F=au.getGraphemeBreakProperty(B),K=au.getEmojiProperty(B);if(s.default.shouldBreak(w,S,F,R,D,K))return k;S.push(F),D.push(K)}return e.length}splitGraphemes(e){const a=[];let g=0,w;for(;(w=au.nextBreak(e,g))<e.length;)a.push(e.slice(g,w)),g=w;return g<e.length&&a.push(e.slice(g)),a}iterateGraphemes(e){return new c.default(e,au.nextBreak)}countGraphemes(e){let a=0,g=0,w;for(;(w=au.nextBreak(e,g))<e.length;)g=w,a++;return g<e.length&&a++,a}static getGraphemeBreakProperty(e){if(e<48905){if(e<44116){if(e<4141){if(e<2818){if(e<2363)if(e<1759){if(e<1471){if(e<127){if(e<11){if(e<10){if(0<=e&&e<=9)return i.CLUSTER_BREAK.CONTROL}else if(e===10)return i.CLUSTER_BREAK.LF}else if(e<13){if(11<=e&&e<=12)return i.CLUSTER_BREAK.CONTROL}else if(e<14){if(e===13)return i.CLUSTER_BREAK.CR}else if(14<=e&&e<=31)return i.CLUSTER_BREAK.CONTROL}else if(e<768){if(e<173){if(127<=e&&e<=159)return i.CLUSTER_BREAK.CONTROL}else if(e===173)return i.CLUSTER_BREAK.CONTROL}else if(e<1155){if(768<=e&&e<=879)return i.CLUSTER_BREAK.EXTEND}else if(e<1425){if(1155<=e&&e<=1161)return i.CLUSTER_BREAK.EXTEND}else if(1425<=e&&e<=1469)return i.CLUSTER_BREAK.EXTEND}else if(e<1552){if(e<1476){if(e<1473){if(e===1471)return i.CLUSTER_BREAK.EXTEND}else if(1473<=e&&e<=1474)return i.CLUSTER_BREAK.EXTEND}else if(e<1479){if(1476<=e&&e<=1477)return i.CLUSTER_BREAK.EXTEND}else if(e<1536){if(e===1479)return i.CLUSTER_BREAK.EXTEND}else if(1536<=e&&e<=1541)return i.CLUSTER_BREAK.PREPEND}else if(e<1648){if(e<1564){if(1552<=e&&e<=1562)return i.CLUSTER_BREAK.EXTEND}else if(e<1611){if(e===1564)return i.CLUSTER_BREAK.CONTROL}else if(1611<=e&&e<=1631)return i.CLUSTER_BREAK.EXTEND}else if(e<1750){if(e===1648)return i.CLUSTER_BREAK.EXTEND}else if(e<1757){if(1750<=e&&e<=1756)return i.CLUSTER_BREAK.EXTEND}else if(e===1757)return i.CLUSTER_BREAK.PREPEND}else if(e<2075){if(e<1840)if(e<1770){if(e<1767){if(1759<=e&&e<=1764)return i.CLUSTER_BREAK.EXTEND}else if(1767<=e&&e<=1768)return i.CLUSTER_BREAK.EXTEND}else if(e<1807){if(1770<=e&&e<=1773)return i.CLUSTER_BREAK.EXTEND}else{if(e===1807)return i.CLUSTER_BREAK.PREPEND;if(e===1809)return i.CLUSTER_BREAK.EXTEND}else if(e<2027){if(e<1958){if(1840<=e&&e<=1866)return i.CLUSTER_BREAK.EXTEND}else if(1958<=e&&e<=1968)return i.CLUSTER_BREAK.EXTEND}else if(e<2045){if(2027<=e&&e<=2035)return i.CLUSTER_BREAK.EXTEND}else if(e<2070){if(e===2045)return i.CLUSTER_BREAK.EXTEND}else if(2070<=e&&e<=2073)return i.CLUSTER_BREAK.EXTEND}else if(e<2200){if(e<2089){if(e<2085){if(2075<=e&&e<=2083)return i.CLUSTER_BREAK.EXTEND}else if(2085<=e&&e<=2087)return i.CLUSTER_BREAK.EXTEND}else if(e<2137){if(2089<=e&&e<=2093)return i.CLUSTER_BREAK.EXTEND}else if(e<2192){if(2137<=e&&e<=2139)return i.CLUSTER_BREAK.EXTEND}else if(2192<=e&&e<=2193)return i.CLUSTER_BREAK.PREPEND}else if(e<2275){if(e<2250){if(2200<=e&&e<=2207)return i.CLUSTER_BREAK.EXTEND}else if(e<2274){if(2250<=e&&e<=2273)return i.CLUSTER_BREAK.EXTEND}else if(e===2274)return i.CLUSTER_BREAK.PREPEND}else if(e<2307){if(2275<=e&&e<=2306)return i.CLUSTER_BREAK.EXTEND}else{if(e===2307)return i.CLUSTER_BREAK.SPACINGMARK;if(e===2362)return i.CLUSTER_BREAK.EXTEND}else if(e<2561){if(e<2434){if(e<2381){if(e<2366){if(e===2363)return i.CLUSTER_BREAK.SPACINGMARK;if(e===2364)return i.CLUSTER_BREAK.EXTEND}else if(e<2369){if(2366<=e&&e<=2368)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2377){if(2369<=e&&e<=2376)return i.CLUSTER_BREAK.EXTEND}else if(2377<=e&&e<=2380)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2385){if(e<2382){if(e===2381)return i.CLUSTER_BREAK.EXTEND}else if(2382<=e&&e<=2383)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2402){if(2385<=e&&e<=2391)return i.CLUSTER_BREAK.EXTEND}else if(e<2433){if(2402<=e&&e<=2403)return i.CLUSTER_BREAK.EXTEND}else if(e===2433)return i.CLUSTER_BREAK.EXTEND}else if(e<2503){if(e<2494){if(e<2492){if(2434<=e&&e<=2435)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===2492)return i.CLUSTER_BREAK.EXTEND}else if(e<2495){if(e===2494)return i.CLUSTER_BREAK.EXTEND}else if(e<2497){if(2495<=e&&e<=2496)return i.CLUSTER_BREAK.SPACINGMARK}else if(2497<=e&&e<=2500)return i.CLUSTER_BREAK.EXTEND}else if(e<2519){if(e<2507){if(2503<=e&&e<=2504)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2509){if(2507<=e&&e<=2508)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===2509)return i.CLUSTER_BREAK.EXTEND}else if(e<2530){if(e===2519)return i.CLUSTER_BREAK.EXTEND}else if(e<2558){if(2530<=e&&e<=2531)return i.CLUSTER_BREAK.EXTEND}else if(e===2558)return i.CLUSTER_BREAK.EXTEND}else if(e<2691){if(e<2631){if(e<2620){if(e<2563){if(2561<=e&&e<=2562)return i.CLUSTER_BREAK.EXTEND}else if(e===2563)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2622){if(e===2620)return i.CLUSTER_BREAK.EXTEND}else if(e<2625){if(2622<=e&&e<=2624)return i.CLUSTER_BREAK.SPACINGMARK}else if(2625<=e&&e<=2626)return i.CLUSTER_BREAK.EXTEND}else if(e<2672){if(e<2635){if(2631<=e&&e<=2632)return i.CLUSTER_BREAK.EXTEND}else if(e<2641){if(2635<=e&&e<=2637)return i.CLUSTER_BREAK.EXTEND}else if(e===2641)return i.CLUSTER_BREAK.EXTEND}else if(e<2677){if(2672<=e&&e<=2673)return i.CLUSTER_BREAK.EXTEND}else if(e<2689){if(e===2677)return i.CLUSTER_BREAK.EXTEND}else if(2689<=e&&e<=2690)return i.CLUSTER_BREAK.EXTEND}else if(e<2761){if(e<2750){if(e===2691)return i.CLUSTER_BREAK.SPACINGMARK;if(e===2748)return i.CLUSTER_BREAK.EXTEND}else if(e<2753){if(2750<=e&&e<=2752)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2759){if(2753<=e&&e<=2757)return i.CLUSTER_BREAK.EXTEND}else if(2759<=e&&e<=2760)return i.CLUSTER_BREAK.EXTEND}else if(e<2786){if(e<2763){if(e===2761)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2765){if(2763<=e&&e<=2764)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===2765)return i.CLUSTER_BREAK.EXTEND}else if(e<2810){if(2786<=e&&e<=2787)return i.CLUSTER_BREAK.EXTEND}else if(e<2817){if(2810<=e&&e<=2815)return i.CLUSTER_BREAK.EXTEND}else if(e===2817)return i.CLUSTER_BREAK.EXTEND}else if(e<3315){if(e<3076){if(e<2946){if(e<2887){if(e<2878){if(e<2876){if(2818<=e&&e<=2819)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===2876)return i.CLUSTER_BREAK.EXTEND}else if(e<2880){if(2878<=e&&e<=2879)return i.CLUSTER_BREAK.EXTEND}else if(e<2881){if(e===2880)return i.CLUSTER_BREAK.SPACINGMARK}else if(2881<=e&&e<=2884)return i.CLUSTER_BREAK.EXTEND}else if(e<2893){if(e<2891){if(2887<=e&&e<=2888)return i.CLUSTER_BREAK.SPACINGMARK}else if(2891<=e&&e<=2892)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<2901){if(e===2893)return i.CLUSTER_BREAK.EXTEND}else if(e<2914){if(2901<=e&&e<=2903)return i.CLUSTER_BREAK.EXTEND}else if(2914<=e&&e<=2915)return i.CLUSTER_BREAK.EXTEND}else if(e<3014){if(e<3007){if(e===2946||e===3006)return i.CLUSTER_BREAK.EXTEND}else if(e<3008){if(e===3007)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3009){if(e===3008)return i.CLUSTER_BREAK.EXTEND}else if(3009<=e&&e<=3010)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3031){if(e<3018){if(3014<=e&&e<=3016)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3021){if(3018<=e&&e<=3020)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===3021)return i.CLUSTER_BREAK.EXTEND}else if(e<3072){if(e===3031)return i.CLUSTER_BREAK.EXTEND}else if(e<3073){if(e===3072)return i.CLUSTER_BREAK.EXTEND}else if(3073<=e&&e<=3075)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3262){if(e<3146){if(e<3134){if(e===3076||e===3132)return i.CLUSTER_BREAK.EXTEND}else if(e<3137){if(3134<=e&&e<=3136)return i.CLUSTER_BREAK.EXTEND}else if(e<3142){if(3137<=e&&e<=3140)return i.CLUSTER_BREAK.SPACINGMARK}else if(3142<=e&&e<=3144)return i.CLUSTER_BREAK.EXTEND}else if(e<3201){if(e<3157){if(3146<=e&&e<=3149)return i.CLUSTER_BREAK.EXTEND}else if(e<3170){if(3157<=e&&e<=3158)return i.CLUSTER_BREAK.EXTEND}else if(3170<=e&&e<=3171)return i.CLUSTER_BREAK.EXTEND}else if(e<3202){if(e===3201)return i.CLUSTER_BREAK.EXTEND}else if(e<3260){if(3202<=e&&e<=3203)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===3260)return i.CLUSTER_BREAK.EXTEND}else if(e<3270){if(e<3264){if(e===3262)return i.CLUSTER_BREAK.SPACINGMARK;if(e===3263)return i.CLUSTER_BREAK.EXTEND}else if(e<3266){if(3264<=e&&e<=3265)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3267){if(e===3266)return i.CLUSTER_BREAK.EXTEND}else if(3267<=e&&e<=3268)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3276){if(e<3271){if(e===3270)return i.CLUSTER_BREAK.EXTEND}else if(e<3274){if(3271<=e&&e<=3272)return i.CLUSTER_BREAK.SPACINGMARK}else if(3274<=e&&e<=3275)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3285){if(3276<=e&&e<=3277)return i.CLUSTER_BREAK.EXTEND}else if(e<3298){if(3285<=e&&e<=3286)return i.CLUSTER_BREAK.EXTEND}else if(3298<=e&&e<=3299)return i.CLUSTER_BREAK.EXTEND}else if(e<3551){if(e<3406){if(e<3391){if(e<3330){if(e<3328){if(e===3315)return i.CLUSTER_BREAK.SPACINGMARK}else if(3328<=e&&e<=3329)return i.CLUSTER_BREAK.EXTEND}else if(e<3387){if(3330<=e&&e<=3331)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3390){if(3387<=e&&e<=3388)return i.CLUSTER_BREAK.EXTEND}else if(e===3390)return i.CLUSTER_BREAK.EXTEND}else if(e<3398){if(e<3393){if(3391<=e&&e<=3392)return i.CLUSTER_BREAK.SPACINGMARK}else if(3393<=e&&e<=3396)return i.CLUSTER_BREAK.EXTEND}else if(e<3402){if(3398<=e&&e<=3400)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3405){if(3402<=e&&e<=3404)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===3405)return i.CLUSTER_BREAK.EXTEND}else if(e<3530){if(e<3426){if(e===3406)return i.CLUSTER_BREAK.PREPEND;if(e===3415)return i.CLUSTER_BREAK.EXTEND}else if(e<3457){if(3426<=e&&e<=3427)return i.CLUSTER_BREAK.EXTEND}else if(e<3458){if(e===3457)return i.CLUSTER_BREAK.EXTEND}else if(3458<=e&&e<=3459)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3538){if(e<3535){if(e===3530)return i.CLUSTER_BREAK.EXTEND}else if(e<3536){if(e===3535)return i.CLUSTER_BREAK.EXTEND}else if(3536<=e&&e<=3537)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3542){if(3538<=e&&e<=3540)return i.CLUSTER_BREAK.EXTEND}else if(e<3544){if(e===3542)return i.CLUSTER_BREAK.EXTEND}else if(3544<=e&&e<=3550)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3893){if(e<3655){if(e<3633){if(e<3570){if(e===3551)return i.CLUSTER_BREAK.EXTEND}else if(3570<=e&&e<=3571)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3635){if(e===3633)return i.CLUSTER_BREAK.EXTEND}else if(e<3636){if(e===3635)return i.CLUSTER_BREAK.SPACINGMARK}else if(3636<=e&&e<=3642)return i.CLUSTER_BREAK.EXTEND}else if(e<3764)if(e<3761){if(3655<=e&&e<=3662)return i.CLUSTER_BREAK.EXTEND}else{if(e===3761)return i.CLUSTER_BREAK.EXTEND;if(e===3763)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3784){if(3764<=e&&e<=3772)return i.CLUSTER_BREAK.EXTEND}else if(e<3864){if(3784<=e&&e<=3790)return i.CLUSTER_BREAK.EXTEND}else if(3864<=e&&e<=3865)return i.CLUSTER_BREAK.EXTEND}else if(e<3967){if(e<3897){if(e===3893||e===3895)return i.CLUSTER_BREAK.EXTEND}else if(e<3902){if(e===3897)return i.CLUSTER_BREAK.EXTEND}else if(e<3953){if(3902<=e&&e<=3903)return i.CLUSTER_BREAK.SPACINGMARK}else if(3953<=e&&e<=3966)return i.CLUSTER_BREAK.EXTEND}else if(e<3981){if(e<3968){if(e===3967)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<3974){if(3968<=e&&e<=3972)return i.CLUSTER_BREAK.EXTEND}else if(3974<=e&&e<=3975)return i.CLUSTER_BREAK.EXTEND}else if(e<3993){if(3981<=e&&e<=3991)return i.CLUSTER_BREAK.EXTEND}else if(e<4038){if(3993<=e&&e<=4028)return i.CLUSTER_BREAK.EXTEND}else if(e===4038)return i.CLUSTER_BREAK.EXTEND}else if(e<7204){if(e<6448){if(e<5938){if(e<4226){if(e<4157){if(e<4146){if(e<4145){if(4141<=e&&e<=4144)return i.CLUSTER_BREAK.EXTEND}else if(e===4145)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<4153){if(4146<=e&&e<=4151)return i.CLUSTER_BREAK.EXTEND}else if(e<4155){if(4153<=e&&e<=4154)return i.CLUSTER_BREAK.EXTEND}else if(4155<=e&&e<=4156)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<4184){if(e<4182){if(4157<=e&&e<=4158)return i.CLUSTER_BREAK.EXTEND}else if(4182<=e&&e<=4183)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<4190){if(4184<=e&&e<=4185)return i.CLUSTER_BREAK.EXTEND}else if(e<4209){if(4190<=e&&e<=4192)return i.CLUSTER_BREAK.EXTEND}else if(4209<=e&&e<=4212)return i.CLUSTER_BREAK.EXTEND}else if(e<4352){if(e<4229){if(e===4226)return i.CLUSTER_BREAK.EXTEND;if(e===4228)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<4237){if(4229<=e&&e<=4230)return i.CLUSTER_BREAK.EXTEND}else if(e===4237||e===4253)return i.CLUSTER_BREAK.EXTEND}else if(e<4957){if(e<4448){if(4352<=e&&e<=4447)return i.CLUSTER_BREAK.L}else if(e<4520){if(4448<=e&&e<=4519)return i.CLUSTER_BREAK.V}else if(4520<=e&&e<=4607)return i.CLUSTER_BREAK.T}else if(e<5906){if(4957<=e&&e<=4959)return i.CLUSTER_BREAK.EXTEND}else if(e<5909){if(5906<=e&&e<=5908)return i.CLUSTER_BREAK.EXTEND}else if(e===5909)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6089){if(e<6070){if(e<5970){if(e<5940){if(5938<=e&&e<=5939)return i.CLUSTER_BREAK.EXTEND}else if(e===5940)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6002){if(5970<=e&&e<=5971)return i.CLUSTER_BREAK.EXTEND}else if(e<6068){if(6002<=e&&e<=6003)return i.CLUSTER_BREAK.EXTEND}else if(6068<=e&&e<=6069)return i.CLUSTER_BREAK.EXTEND}else if(e<6078){if(e<6071){if(e===6070)return i.CLUSTER_BREAK.SPACINGMARK}else if(6071<=e&&e<=6077)return i.CLUSTER_BREAK.EXTEND}else if(e<6086){if(6078<=e&&e<=6085)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6087){if(e===6086)return i.CLUSTER_BREAK.EXTEND}else if(6087<=e&&e<=6088)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6277)if(e<6155){if(e<6109){if(6089<=e&&e<=6099)return i.CLUSTER_BREAK.EXTEND}else if(e===6109)return i.CLUSTER_BREAK.EXTEND}else if(e<6158){if(6155<=e&&e<=6157)return i.CLUSTER_BREAK.EXTEND}else{if(e===6158)return i.CLUSTER_BREAK.CONTROL;if(e===6159)return i.CLUSTER_BREAK.EXTEND}else if(e<6435){if(e<6313){if(6277<=e&&e<=6278)return i.CLUSTER_BREAK.EXTEND}else if(e<6432){if(e===6313)return i.CLUSTER_BREAK.EXTEND}else if(6432<=e&&e<=6434)return i.CLUSTER_BREAK.EXTEND}else if(e<6439){if(6435<=e&&e<=6438)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6441){if(6439<=e&&e<=6440)return i.CLUSTER_BREAK.EXTEND}else if(6441<=e&&e<=6443)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6971){if(e<6744)if(e<6681){if(e<6451){if(e<6450){if(6448<=e&&e<=6449)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===6450)return i.CLUSTER_BREAK.EXTEND}else if(e<6457){if(6451<=e&&e<=6456)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6679){if(6457<=e&&e<=6459)return i.CLUSTER_BREAK.EXTEND}else if(6679<=e&&e<=6680)return i.CLUSTER_BREAK.EXTEND}else if(e<6741){if(e<6683){if(6681<=e&&e<=6682)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===6683)return i.CLUSTER_BREAK.EXTEND}else if(e<6742){if(e===6741)return i.CLUSTER_BREAK.SPACINGMARK}else{if(e===6742)return i.CLUSTER_BREAK.EXTEND;if(e===6743)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6771){if(e<6754){if(e<6752){if(6744<=e&&e<=6750)return i.CLUSTER_BREAK.EXTEND}else if(e===6752)return i.CLUSTER_BREAK.EXTEND}else if(e<6757){if(e===6754)return i.CLUSTER_BREAK.EXTEND}else if(e<6765){if(6757<=e&&e<=6764)return i.CLUSTER_BREAK.EXTEND}else if(6765<=e&&e<=6770)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6912){if(e<6783){if(6771<=e&&e<=6780)return i.CLUSTER_BREAK.EXTEND}else if(e<6832){if(e===6783)return i.CLUSTER_BREAK.EXTEND}else if(6832<=e&&e<=6862)return i.CLUSTER_BREAK.EXTEND}else if(e<6916){if(6912<=e&&e<=6915)return i.CLUSTER_BREAK.EXTEND}else if(e<6964){if(e===6916)return i.CLUSTER_BREAK.SPACINGMARK}else if(6964<=e&&e<=6970)return i.CLUSTER_BREAK.EXTEND}else if(e<7080){if(e<7019){if(e<6973){if(e===6971)return i.CLUSTER_BREAK.SPACINGMARK;if(e===6972)return i.CLUSTER_BREAK.EXTEND}else if(e<6978){if(6973<=e&&e<=6977)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<6979){if(e===6978)return i.CLUSTER_BREAK.EXTEND}else if(6979<=e&&e<=6980)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7073){if(e<7040){if(7019<=e&&e<=7027)return i.CLUSTER_BREAK.EXTEND}else if(e<7042){if(7040<=e&&e<=7041)return i.CLUSTER_BREAK.EXTEND}else if(e===7042)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7074){if(e===7073)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7078){if(7074<=e&&e<=7077)return i.CLUSTER_BREAK.EXTEND}else if(7078<=e&&e<=7079)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7144)if(e<7083){if(e<7082){if(7080<=e&&e<=7081)return i.CLUSTER_BREAK.EXTEND}else if(e===7082)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7142){if(7083<=e&&e<=7085)return i.CLUSTER_BREAK.EXTEND}else{if(e===7142)return i.CLUSTER_BREAK.EXTEND;if(e===7143)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7150){if(e<7146){if(7144<=e&&e<=7145)return i.CLUSTER_BREAK.EXTEND}else if(e<7149){if(7146<=e&&e<=7148)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===7149)return i.CLUSTER_BREAK.EXTEND}else if(e<7151){if(e===7150)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7154){if(7151<=e&&e<=7153)return i.CLUSTER_BREAK.EXTEND}else if(7154<=e&&e<=7155)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43346){if(e<11647){if(e<7415){if(e<7380){if(e<7220){if(e<7212){if(7204<=e&&e<=7211)return i.CLUSTER_BREAK.SPACINGMARK}else if(7212<=e&&e<=7219)return i.CLUSTER_BREAK.EXTEND}else if(e<7222){if(7220<=e&&e<=7221)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7376){if(7222<=e&&e<=7223)return i.CLUSTER_BREAK.EXTEND}else if(7376<=e&&e<=7378)return i.CLUSTER_BREAK.EXTEND}else if(e<7394){if(e<7393){if(7380<=e&&e<=7392)return i.CLUSTER_BREAK.EXTEND}else if(e===7393)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<7405){if(7394<=e&&e<=7400)return i.CLUSTER_BREAK.EXTEND}else if(e===7405||e===7412)return i.CLUSTER_BREAK.EXTEND}else if(e<8205)if(e<7616){if(e<7416){if(e===7415)return i.CLUSTER_BREAK.SPACINGMARK}else if(7416<=e&&e<=7417)return i.CLUSTER_BREAK.EXTEND}else if(e<8203){if(7616<=e&&e<=7679)return i.CLUSTER_BREAK.EXTEND}else{if(e===8203)return i.CLUSTER_BREAK.CONTROL;if(e===8204)return i.CLUSTER_BREAK.EXTEND}else if(e<8288){if(e<8206){if(e===8205)return i.CLUSTER_BREAK.ZWJ}else if(e<8232){if(8206<=e&&e<=8207)return i.CLUSTER_BREAK.CONTROL}else if(8232<=e&&e<=8238)return i.CLUSTER_BREAK.CONTROL}else if(e<8400){if(8288<=e&&e<=8303)return i.CLUSTER_BREAK.CONTROL}else if(e<11503){if(8400<=e&&e<=8432)return i.CLUSTER_BREAK.EXTEND}else if(11503<=e&&e<=11505)return i.CLUSTER_BREAK.EXTEND}else if(e<43043){if(e<42612){if(e<12330){if(e<11744){if(e===11647)return i.CLUSTER_BREAK.EXTEND}else if(11744<=e&&e<=11775)return i.CLUSTER_BREAK.EXTEND}else if(e<12441){if(12330<=e&&e<=12335)return i.CLUSTER_BREAK.EXTEND}else if(e<42607){if(12441<=e&&e<=12442)return i.CLUSTER_BREAK.EXTEND}else if(42607<=e&&e<=42610)return i.CLUSTER_BREAK.EXTEND}else if(e<43010){if(e<42654){if(42612<=e&&e<=42621)return i.CLUSTER_BREAK.EXTEND}else if(e<42736){if(42654<=e&&e<=42655)return i.CLUSTER_BREAK.EXTEND}else if(42736<=e&&e<=42737)return i.CLUSTER_BREAK.EXTEND}else if(e<43014){if(e===43010)return i.CLUSTER_BREAK.EXTEND}else if(e===43014||e===43019)return i.CLUSTER_BREAK.EXTEND}else if(e<43188){if(e<43047){if(e<43045){if(43043<=e&&e<=43044)return i.CLUSTER_BREAK.SPACINGMARK}else if(43045<=e&&e<=43046)return i.CLUSTER_BREAK.EXTEND}else if(e<43052){if(e===43047)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43136){if(e===43052)return i.CLUSTER_BREAK.EXTEND}else if(43136<=e&&e<=43137)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43263){if(e<43204){if(43188<=e&&e<=43203)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43232){if(43204<=e&&e<=43205)return i.CLUSTER_BREAK.EXTEND}else if(43232<=e&&e<=43249)return i.CLUSTER_BREAK.EXTEND}else if(e<43302){if(e===43263)return i.CLUSTER_BREAK.EXTEND}else if(e<43335){if(43302<=e&&e<=43309)return i.CLUSTER_BREAK.EXTEND}else if(43335<=e&&e<=43345)return i.CLUSTER_BREAK.EXTEND}else if(e<43698){if(e<43493){if(e<43444)if(e<43392){if(e<43360){if(43346<=e&&e<=43347)return i.CLUSTER_BREAK.SPACINGMARK}else if(43360<=e&&e<=43388)return i.CLUSTER_BREAK.L}else if(e<43395){if(43392<=e&&e<=43394)return i.CLUSTER_BREAK.EXTEND}else{if(e===43395)return i.CLUSTER_BREAK.SPACINGMARK;if(e===43443)return i.CLUSTER_BREAK.EXTEND}else if(e<43450){if(e<43446){if(43444<=e&&e<=43445)return i.CLUSTER_BREAK.SPACINGMARK}else if(43446<=e&&e<=43449)return i.CLUSTER_BREAK.EXTEND}else if(e<43452){if(43450<=e&&e<=43451)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43454){if(43452<=e&&e<=43453)return i.CLUSTER_BREAK.EXTEND}else if(43454<=e&&e<=43456)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43573){if(e<43567){if(e<43561){if(e===43493)return i.CLUSTER_BREAK.EXTEND}else if(43561<=e&&e<=43566)return i.CLUSTER_BREAK.EXTEND}else if(e<43569){if(43567<=e&&e<=43568)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43571){if(43569<=e&&e<=43570)return i.CLUSTER_BREAK.EXTEND}else if(43571<=e&&e<=43572)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43597){if(e<43587){if(43573<=e&&e<=43574)return i.CLUSTER_BREAK.EXTEND}else if(e===43587||e===43596)return i.CLUSTER_BREAK.EXTEND}else if(e<43644){if(e===43597)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===43644||e===43696)return i.CLUSTER_BREAK.EXTEND}else if(e<44006){if(e<43756)if(e<43710){if(e<43703){if(43698<=e&&e<=43700)return i.CLUSTER_BREAK.EXTEND}else if(43703<=e&&e<=43704)return i.CLUSTER_BREAK.EXTEND}else if(e<43713){if(43710<=e&&e<=43711)return i.CLUSTER_BREAK.EXTEND}else{if(e===43713)return i.CLUSTER_BREAK.EXTEND;if(e===43755)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<43766){if(e<43758){if(43756<=e&&e<=43757)return i.CLUSTER_BREAK.EXTEND}else if(e<43765){if(43758<=e&&e<=43759)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===43765)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<44003){if(e===43766)return i.CLUSTER_BREAK.EXTEND}else if(e<44005){if(44003<=e&&e<=44004)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===44005)return i.CLUSTER_BREAK.EXTEND}else if(e<44032)if(e<44009){if(e<44008){if(44006<=e&&e<=44007)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===44008)return i.CLUSTER_BREAK.EXTEND}else if(e<44012){if(44009<=e&&e<=44010)return i.CLUSTER_BREAK.SPACINGMARK}else{if(e===44012)return i.CLUSTER_BREAK.SPACINGMARK;if(e===44013)return i.CLUSTER_BREAK.EXTEND}else if(e<44061){if(e<44033){if(e===44032)return i.CLUSTER_BREAK.LV}else if(e<44060){if(44033<=e&&e<=44059)return i.CLUSTER_BREAK.LVT}else if(e===44060)return i.CLUSTER_BREAK.LV}else if(e<44088){if(44061<=e&&e<=44087)return i.CLUSTER_BREAK.LVT}else if(e<44089){if(e===44088)return i.CLUSTER_BREAK.LV}else if(44089<=e&&e<=44115)return i.CLUSTER_BREAK.LVT}else if(e<46497){if(e<45293){if(e<44704){if(e<44397){if(e<44256){if(e<44173){if(e<44144){if(e<44117){if(e===44116)return i.CLUSTER_BREAK.LV}else if(44117<=e&&e<=44143)return i.CLUSTER_BREAK.LVT}else if(e<44145){if(e===44144)return i.CLUSTER_BREAK.LV}else if(e<44172){if(44145<=e&&e<=44171)return i.CLUSTER_BREAK.LVT}else if(e===44172)return i.CLUSTER_BREAK.LV}else if(e<44201){if(e<44200){if(44173<=e&&e<=44199)return i.CLUSTER_BREAK.LVT}else if(e===44200)return i.CLUSTER_BREAK.LV}else if(e<44228){if(44201<=e&&e<=44227)return i.CLUSTER_BREAK.LVT}else if(e<44229){if(e===44228)return i.CLUSTER_BREAK.LV}else if(44229<=e&&e<=44255)return i.CLUSTER_BREAK.LVT}else if(e<44313){if(e<44284){if(e<44257){if(e===44256)return i.CLUSTER_BREAK.LV}else if(44257<=e&&e<=44283)return i.CLUSTER_BREAK.LVT}else if(e<44285){if(e===44284)return i.CLUSTER_BREAK.LV}else if(e<44312){if(44285<=e&&e<=44311)return i.CLUSTER_BREAK.LVT}else if(e===44312)return i.CLUSTER_BREAK.LV}else if(e<44368){if(e<44340){if(44313<=e&&e<=44339)return i.CLUSTER_BREAK.LVT}else if(e<44341){if(e===44340)return i.CLUSTER_BREAK.LV}else if(44341<=e&&e<=44367)return i.CLUSTER_BREAK.LVT}else if(e<44369){if(e===44368)return i.CLUSTER_BREAK.LV}else if(e<44396){if(44369<=e&&e<=44395)return i.CLUSTER_BREAK.LVT}else if(e===44396)return i.CLUSTER_BREAK.LV}else if(e<44537){if(e<44480){if(e<44425){if(e<44424){if(44397<=e&&e<=44423)return i.CLUSTER_BREAK.LVT}else if(e===44424)return i.CLUSTER_BREAK.LV}else if(e<44452){if(44425<=e&&e<=44451)return i.CLUSTER_BREAK.LVT}else if(e<44453){if(e===44452)return i.CLUSTER_BREAK.LV}else if(44453<=e&&e<=44479)return i.CLUSTER_BREAK.LVT}else if(e<44508){if(e<44481){if(e===44480)return i.CLUSTER_BREAK.LV}else if(44481<=e&&e<=44507)return i.CLUSTER_BREAK.LVT}else if(e<44509){if(e===44508)return i.CLUSTER_BREAK.LV}else if(e<44536){if(44509<=e&&e<=44535)return i.CLUSTER_BREAK.LVT}else if(e===44536)return i.CLUSTER_BREAK.LV}else if(e<44620){if(e<44565){if(e<44564){if(44537<=e&&e<=44563)return i.CLUSTER_BREAK.LVT}else if(e===44564)return i.CLUSTER_BREAK.LV}else if(e<44592){if(44565<=e&&e<=44591)return i.CLUSTER_BREAK.LVT}else if(e<44593){if(e===44592)return i.CLUSTER_BREAK.LV}else if(44593<=e&&e<=44619)return i.CLUSTER_BREAK.LVT}else if(e<44649){if(e<44621){if(e===44620)return i.CLUSTER_BREAK.LV}else if(e<44648){if(44621<=e&&e<=44647)return i.CLUSTER_BREAK.LVT}else if(e===44648)return i.CLUSTER_BREAK.LV}else if(e<44676){if(44649<=e&&e<=44675)return i.CLUSTER_BREAK.LVT}else if(e<44677){if(e===44676)return i.CLUSTER_BREAK.LV}else if(44677<=e&&e<=44703)return i.CLUSTER_BREAK.LVT}else if(e<44985){if(e<44844){if(e<44761){if(e<44732){if(e<44705){if(e===44704)return i.CLUSTER_BREAK.LV}else if(44705<=e&&e<=44731)return i.CLUSTER_BREAK.LVT}else if(e<44733){if(e===44732)return i.CLUSTER_BREAK.LV}else if(e<44760){if(44733<=e&&e<=44759)return i.CLUSTER_BREAK.LVT}else if(e===44760)return i.CLUSTER_BREAK.LV}else if(e<44789){if(e<44788){if(44761<=e&&e<=44787)return i.CLUSTER_BREAK.LVT}else if(e===44788)return i.CLUSTER_BREAK.LV}else if(e<44816){if(44789<=e&&e<=44815)return i.CLUSTER_BREAK.LVT}else if(e<44817){if(e===44816)return i.CLUSTER_BREAK.LV}else if(44817<=e&&e<=44843)return i.CLUSTER_BREAK.LVT}else if(e<44901){if(e<44872){if(e<44845){if(e===44844)return i.CLUSTER_BREAK.LV}else if(44845<=e&&e<=44871)return i.CLUSTER_BREAK.LVT}else if(e<44873){if(e===44872)return i.CLUSTER_BREAK.LV}else if(e<44900){if(44873<=e&&e<=44899)return i.CLUSTER_BREAK.LVT}else if(e===44900)return i.CLUSTER_BREAK.LV}else if(e<44956){if(e<44928){if(44901<=e&&e<=44927)return i.CLUSTER_BREAK.LVT}else if(e<44929){if(e===44928)return i.CLUSTER_BREAK.LV}else if(44929<=e&&e<=44955)return i.CLUSTER_BREAK.LVT}else if(e<44957){if(e===44956)return i.CLUSTER_BREAK.LV}else if(e<44984){if(44957<=e&&e<=44983)return i.CLUSTER_BREAK.LVT}else if(e===44984)return i.CLUSTER_BREAK.LV}else if(e<45152){if(e<45068){if(e<45013){if(e<45012){if(44985<=e&&e<=45011)return i.CLUSTER_BREAK.LVT}else if(e===45012)return i.CLUSTER_BREAK.LV}else if(e<45040){if(45013<=e&&e<=45039)return i.CLUSTER_BREAK.LVT}else if(e<45041){if(e===45040)return i.CLUSTER_BREAK.LV}else if(45041<=e&&e<=45067)return i.CLUSTER_BREAK.LVT}else if(e<45097){if(e<45069){if(e===45068)return i.CLUSTER_BREAK.LV}else if(e<45096){if(45069<=e&&e<=45095)return i.CLUSTER_BREAK.LVT}else if(e===45096)return i.CLUSTER_BREAK.LV}else if(e<45124){if(45097<=e&&e<=45123)return i.CLUSTER_BREAK.LVT}else if(e<45125){if(e===45124)return i.CLUSTER_BREAK.LV}else if(45125<=e&&e<=45151)return i.CLUSTER_BREAK.LVT}else if(e<45209){if(e<45180){if(e<45153){if(e===45152)return i.CLUSTER_BREAK.LV}else if(45153<=e&&e<=45179)return i.CLUSTER_BREAK.LVT}else if(e<45181){if(e===45180)return i.CLUSTER_BREAK.LV}else if(e<45208){if(45181<=e&&e<=45207)return i.CLUSTER_BREAK.LVT}else if(e===45208)return i.CLUSTER_BREAK.LV}else if(e<45264){if(e<45236){if(45209<=e&&e<=45235)return i.CLUSTER_BREAK.LVT}else if(e<45237){if(e===45236)return i.CLUSTER_BREAK.LV}else if(45237<=e&&e<=45263)return i.CLUSTER_BREAK.LVT}else if(e<45265){if(e===45264)return i.CLUSTER_BREAK.LV}else if(e<45292){if(45265<=e&&e<=45291)return i.CLUSTER_BREAK.LVT}else if(e===45292)return i.CLUSTER_BREAK.LV}else if(e<45908){if(e<45600){if(e<45433){if(e<45376){if(e<45321){if(e<45320){if(45293<=e&&e<=45319)return i.CLUSTER_BREAK.LVT}else if(e===45320)return i.CLUSTER_BREAK.LV}else if(e<45348){if(45321<=e&&e<=45347)return i.CLUSTER_BREAK.LVT}else if(e<45349){if(e===45348)return i.CLUSTER_BREAK.LV}else if(45349<=e&&e<=45375)return i.CLUSTER_BREAK.LVT}else if(e<45404){if(e<45377){if(e===45376)return i.CLUSTER_BREAK.LV}else if(45377<=e&&e<=45403)return i.CLUSTER_BREAK.LVT}else if(e<45405){if(e===45404)return i.CLUSTER_BREAK.LV}else if(e<45432){if(45405<=e&&e<=45431)return i.CLUSTER_BREAK.LVT}else if(e===45432)return i.CLUSTER_BREAK.LV}else if(e<45516){if(e<45461){if(e<45460){if(45433<=e&&e<=45459)return i.CLUSTER_BREAK.LVT}else if(e===45460)return i.CLUSTER_BREAK.LV}else if(e<45488){if(45461<=e&&e<=45487)return i.CLUSTER_BREAK.LVT}else if(e<45489){if(e===45488)return i.CLUSTER_BREAK.LV}else if(45489<=e&&e<=45515)return i.CLUSTER_BREAK.LVT}else if(e<45545){if(e<45517){if(e===45516)return i.CLUSTER_BREAK.LV}else if(e<45544){if(45517<=e&&e<=45543)return i.CLUSTER_BREAK.LVT}else if(e===45544)return i.CLUSTER_BREAK.LV}else if(e<45572){if(45545<=e&&e<=45571)return i.CLUSTER_BREAK.LVT}else if(e<45573){if(e===45572)return i.CLUSTER_BREAK.LV}else if(45573<=e&&e<=45599)return i.CLUSTER_BREAK.LVT}else if(e<45741){if(e<45657){if(e<45628){if(e<45601){if(e===45600)return i.CLUSTER_BREAK.LV}else if(45601<=e&&e<=45627)return i.CLUSTER_BREAK.LVT}else if(e<45629){if(e===45628)return i.CLUSTER_BREAK.LV}else if(e<45656){if(45629<=e&&e<=45655)return i.CLUSTER_BREAK.LVT}else if(e===45656)return i.CLUSTER_BREAK.LV}else if(e<45712){if(e<45684){if(45657<=e&&e<=45683)return i.CLUSTER_BREAK.LVT}else if(e<45685){if(e===45684)return i.CLUSTER_BREAK.LV}else if(45685<=e&&e<=45711)return i.CLUSTER_BREAK.LVT}else if(e<45713){if(e===45712)return i.CLUSTER_BREAK.LV}else if(e<45740){if(45713<=e&&e<=45739)return i.CLUSTER_BREAK.LVT}else if(e===45740)return i.CLUSTER_BREAK.LV}else if(e<45824){if(e<45769){if(e<45768){if(45741<=e&&e<=45767)return i.CLUSTER_BREAK.LVT}else if(e===45768)return i.CLUSTER_BREAK.LV}else if(e<45796){if(45769<=e&&e<=45795)return i.CLUSTER_BREAK.LVT}else if(e<45797){if(e===45796)return i.CLUSTER_BREAK.LV}else if(45797<=e&&e<=45823)return i.CLUSTER_BREAK.LVT}else if(e<45853){if(e<45825){if(e===45824)return i.CLUSTER_BREAK.LV}else if(e<45852){if(45825<=e&&e<=45851)return i.CLUSTER_BREAK.LVT}else if(e===45852)return i.CLUSTER_BREAK.LV}else if(e<45880){if(45853<=e&&e<=45879)return i.CLUSTER_BREAK.LVT}else if(e<45881){if(e===45880)return i.CLUSTER_BREAK.LV}else if(45881<=e&&e<=45907)return i.CLUSTER_BREAK.LVT}else if(e<46189){if(e<46048){if(e<45965){if(e<45936){if(e<45909){if(e===45908)return i.CLUSTER_BREAK.LV}else if(45909<=e&&e<=45935)return i.CLUSTER_BREAK.LVT}else if(e<45937){if(e===45936)return i.CLUSTER_BREAK.LV}else if(e<45964){if(45937<=e&&e<=45963)return i.CLUSTER_BREAK.LVT}else if(e===45964)return i.CLUSTER_BREAK.LV}else if(e<45993){if(e<45992){if(45965<=e&&e<=45991)return i.CLUSTER_BREAK.LVT}else if(e===45992)return i.CLUSTER_BREAK.LV}else if(e<46020){if(45993<=e&&e<=46019)return i.CLUSTER_BREAK.LVT}else if(e<46021){if(e===46020)return i.CLUSTER_BREAK.LV}else if(46021<=e&&e<=46047)return i.CLUSTER_BREAK.LVT}else if(e<46105){if(e<46076){if(e<46049){if(e===46048)return i.CLUSTER_BREAK.LV}else if(46049<=e&&e<=46075)return i.CLUSTER_BREAK.LVT}else if(e<46077){if(e===46076)return i.CLUSTER_BREAK.LV}else if(e<46104){if(46077<=e&&e<=46103)return i.CLUSTER_BREAK.LVT}else if(e===46104)return i.CLUSTER_BREAK.LV}else if(e<46160){if(e<46132){if(46105<=e&&e<=46131)return i.CLUSTER_BREAK.LVT}else if(e<46133){if(e===46132)return i.CLUSTER_BREAK.LV}else if(46133<=e&&e<=46159)return i.CLUSTER_BREAK.LVT}else if(e<46161){if(e===46160)return i.CLUSTER_BREAK.LV}else if(e<46188){if(46161<=e&&e<=46187)return i.CLUSTER_BREAK.LVT}else if(e===46188)return i.CLUSTER_BREAK.LV}else if(e<46356){if(e<46272){if(e<46217){if(e<46216){if(46189<=e&&e<=46215)return i.CLUSTER_BREAK.LVT}else if(e===46216)return i.CLUSTER_BREAK.LV}else if(e<46244){if(46217<=e&&e<=46243)return i.CLUSTER_BREAK.LVT}else if(e<46245){if(e===46244)return i.CLUSTER_BREAK.LV}else if(46245<=e&&e<=46271)return i.CLUSTER_BREAK.LVT}else if(e<46301){if(e<46273){if(e===46272)return i.CLUSTER_BREAK.LV}else if(e<46300){if(46273<=e&&e<=46299)return i.CLUSTER_BREAK.LVT}else if(e===46300)return i.CLUSTER_BREAK.LV}else if(e<46328){if(46301<=e&&e<=46327)return i.CLUSTER_BREAK.LVT}else if(e<46329){if(e===46328)return i.CLUSTER_BREAK.LV}else if(46329<=e&&e<=46355)return i.CLUSTER_BREAK.LVT}else if(e<46413){if(e<46384){if(e<46357){if(e===46356)return i.CLUSTER_BREAK.LV}else if(46357<=e&&e<=46383)return i.CLUSTER_BREAK.LVT}else if(e<46385){if(e===46384)return i.CLUSTER_BREAK.LV}else if(e<46412){if(46385<=e&&e<=46411)return i.CLUSTER_BREAK.LVT}else if(e===46412)return i.CLUSTER_BREAK.LV}else if(e<46468){if(e<46440){if(46413<=e&&e<=46439)return i.CLUSTER_BREAK.LVT}else if(e<46441){if(e===46440)return i.CLUSTER_BREAK.LV}else if(46441<=e&&e<=46467)return i.CLUSTER_BREAK.LVT}else if(e<46469){if(e===46468)return i.CLUSTER_BREAK.LV}else if(e<46496){if(46469<=e&&e<=46495)return i.CLUSTER_BREAK.LVT}else if(e===46496)return i.CLUSTER_BREAK.LV}else if(e<47701){if(e<47112){if(e<46804){if(e<46637){if(e<46580){if(e<46525){if(e<46524){if(46497<=e&&e<=46523)return i.CLUSTER_BREAK.LVT}else if(e===46524)return i.CLUSTER_BREAK.LV}else if(e<46552){if(46525<=e&&e<=46551)return i.CLUSTER_BREAK.LVT}else if(e<46553){if(e===46552)return i.CLUSTER_BREAK.LV}else if(46553<=e&&e<=46579)return i.CLUSTER_BREAK.LVT}else if(e<46608){if(e<46581){if(e===46580)return i.CLUSTER_BREAK.LV}else if(46581<=e&&e<=46607)return i.CLUSTER_BREAK.LVT}else if(e<46609){if(e===46608)return i.CLUSTER_BREAK.LV}else if(e<46636){if(46609<=e&&e<=46635)return i.CLUSTER_BREAK.LVT}else if(e===46636)return i.CLUSTER_BREAK.LV}else if(e<46720){if(e<46665){if(e<46664){if(46637<=e&&e<=46663)return i.CLUSTER_BREAK.LVT}else if(e===46664)return i.CLUSTER_BREAK.LV}else if(e<46692){if(46665<=e&&e<=46691)return i.CLUSTER_BREAK.LVT}else if(e<46693){if(e===46692)return i.CLUSTER_BREAK.LV}else if(46693<=e&&e<=46719)return i.CLUSTER_BREAK.LVT}else if(e<46749){if(e<46721){if(e===46720)return i.CLUSTER_BREAK.LV}else if(e<46748){if(46721<=e&&e<=46747)return i.CLUSTER_BREAK.LVT}else if(e===46748)return i.CLUSTER_BREAK.LV}else if(e<46776){if(46749<=e&&e<=46775)return i.CLUSTER_BREAK.LVT}else if(e<46777){if(e===46776)return i.CLUSTER_BREAK.LV}else if(46777<=e&&e<=46803)return i.CLUSTER_BREAK.LVT}else if(e<46945){if(e<46861){if(e<46832){if(e<46805){if(e===46804)return i.CLUSTER_BREAK.LV}else if(46805<=e&&e<=46831)return i.CLUSTER_BREAK.LVT}else if(e<46833){if(e===46832)return i.CLUSTER_BREAK.LV}else if(e<46860){if(46833<=e&&e<=46859)return i.CLUSTER_BREAK.LVT}else if(e===46860)return i.CLUSTER_BREAK.LV}else if(e<46916){if(e<46888){if(46861<=e&&e<=46887)return i.CLUSTER_BREAK.LVT}else if(e<46889){if(e===46888)return i.CLUSTER_BREAK.LV}else if(46889<=e&&e<=46915)return i.CLUSTER_BREAK.LVT}else if(e<46917){if(e===46916)return i.CLUSTER_BREAK.LV}else if(e<46944){if(46917<=e&&e<=46943)return i.CLUSTER_BREAK.LVT}else if(e===46944)return i.CLUSTER_BREAK.LV}else if(e<47028){if(e<46973){if(e<46972){if(46945<=e&&e<=46971)return i.CLUSTER_BREAK.LVT}else if(e===46972)return i.CLUSTER_BREAK.LV}else if(e<47e3){if(46973<=e&&e<=46999)return i.CLUSTER_BREAK.LVT}else if(e<47001){if(e===47e3)return i.CLUSTER_BREAK.LV}else if(47001<=e&&e<=47027)return i.CLUSTER_BREAK.LVT}else if(e<47057){if(e<47029){if(e===47028)return i.CLUSTER_BREAK.LV}else if(e<47056){if(47029<=e&&e<=47055)return i.CLUSTER_BREAK.LVT}else if(e===47056)return i.CLUSTER_BREAK.LV}else if(e<47084){if(47057<=e&&e<=47083)return i.CLUSTER_BREAK.LVT}else if(e<47085){if(e===47084)return i.CLUSTER_BREAK.LV}else if(47085<=e&&e<=47111)return i.CLUSTER_BREAK.LVT}else if(e<47393){if(e<47252){if(e<47169){if(e<47140){if(e<47113){if(e===47112)return i.CLUSTER_BREAK.LV}else if(47113<=e&&e<=47139)return i.CLUSTER_BREAK.LVT}else if(e<47141){if(e===47140)return i.CLUSTER_BREAK.LV}else if(e<47168){if(47141<=e&&e<=47167)return i.CLUSTER_BREAK.LVT}else if(e===47168)return i.CLUSTER_BREAK.LV}else if(e<47197){if(e<47196){if(47169<=e&&e<=47195)return i.CLUSTER_BREAK.LVT}else if(e===47196)return i.CLUSTER_BREAK.LV}else if(e<47224){if(47197<=e&&e<=47223)return i.CLUSTER_BREAK.LVT}else if(e<47225){if(e===47224)return i.CLUSTER_BREAK.LV}else if(47225<=e&&e<=47251)return i.CLUSTER_BREAK.LVT}else if(e<47309){if(e<47280){if(e<47253){if(e===47252)return i.CLUSTER_BREAK.LV}else if(47253<=e&&e<=47279)return i.CLUSTER_BREAK.LVT}else if(e<47281){if(e===47280)return i.CLUSTER_BREAK.LV}else if(e<47308){if(47281<=e&&e<=47307)return i.CLUSTER_BREAK.LVT}else if(e===47308)return i.CLUSTER_BREAK.LV}else if(e<47364){if(e<47336){if(47309<=e&&e<=47335)return i.CLUSTER_BREAK.LVT}else if(e<47337){if(e===47336)return i.CLUSTER_BREAK.LV}else if(47337<=e&&e<=47363)return i.CLUSTER_BREAK.LVT}else if(e<47365){if(e===47364)return i.CLUSTER_BREAK.LV}else if(e<47392){if(47365<=e&&e<=47391)return i.CLUSTER_BREAK.LVT}else if(e===47392)return i.CLUSTER_BREAK.LV}else if(e<47560){if(e<47476){if(e<47421){if(e<47420){if(47393<=e&&e<=47419)return i.CLUSTER_BREAK.LVT}else if(e===47420)return i.CLUSTER_BREAK.LV}else if(e<47448){if(47421<=e&&e<=47447)return i.CLUSTER_BREAK.LVT}else if(e<47449){if(e===47448)return i.CLUSTER_BREAK.LV}else if(47449<=e&&e<=47475)return i.CLUSTER_BREAK.LVT}else if(e<47505){if(e<47477){if(e===47476)return i.CLUSTER_BREAK.LV}else if(e<47504){if(47477<=e&&e<=47503)return i.CLUSTER_BREAK.LVT}else if(e===47504)return i.CLUSTER_BREAK.LV}else if(e<47532){if(47505<=e&&e<=47531)return i.CLUSTER_BREAK.LVT}else if(e<47533){if(e===47532)return i.CLUSTER_BREAK.LV}else if(47533<=e&&e<=47559)return i.CLUSTER_BREAK.LVT}else if(e<47617){if(e<47588){if(e<47561){if(e===47560)return i.CLUSTER_BREAK.LV}else if(47561<=e&&e<=47587)return i.CLUSTER_BREAK.LVT}else if(e<47589){if(e===47588)return i.CLUSTER_BREAK.LV}else if(e<47616){if(47589<=e&&e<=47615)return i.CLUSTER_BREAK.LVT}else if(e===47616)return i.CLUSTER_BREAK.LV}else if(e<47672){if(e<47644){if(47617<=e&&e<=47643)return i.CLUSTER_BREAK.LVT}else if(e<47645){if(e===47644)return i.CLUSTER_BREAK.LV}else if(47645<=e&&e<=47671)return i.CLUSTER_BREAK.LVT}else if(e<47673){if(e===47672)return i.CLUSTER_BREAK.LV}else if(e<47700){if(47673<=e&&e<=47699)return i.CLUSTER_BREAK.LVT}else if(e===47700)return i.CLUSTER_BREAK.LV}else if(e<48316){if(e<48008){if(e<47841){if(e<47784){if(e<47729){if(e<47728){if(47701<=e&&e<=47727)return i.CLUSTER_BREAK.LVT}else if(e===47728)return i.CLUSTER_BREAK.LV}else if(e<47756){if(47729<=e&&e<=47755)return i.CLUSTER_BREAK.LVT}else if(e<47757){if(e===47756)return i.CLUSTER_BREAK.LV}else if(47757<=e&&e<=47783)return i.CLUSTER_BREAK.LVT}else if(e<47812){if(e<47785){if(e===47784)return i.CLUSTER_BREAK.LV}else if(47785<=e&&e<=47811)return i.CLUSTER_BREAK.LVT}else if(e<47813){if(e===47812)return i.CLUSTER_BREAK.LV}else if(e<47840){if(47813<=e&&e<=47839)return i.CLUSTER_BREAK.LVT}else if(e===47840)return i.CLUSTER_BREAK.LV}else if(e<47924){if(e<47869){if(e<47868){if(47841<=e&&e<=47867)return i.CLUSTER_BREAK.LVT}else if(e===47868)return i.CLUSTER_BREAK.LV}else if(e<47896){if(47869<=e&&e<=47895)return i.CLUSTER_BREAK.LVT}else if(e<47897){if(e===47896)return i.CLUSTER_BREAK.LV}else if(47897<=e&&e<=47923)return i.CLUSTER_BREAK.LVT}else if(e<47953){if(e<47925){if(e===47924)return i.CLUSTER_BREAK.LV}else if(e<47952){if(47925<=e&&e<=47951)return i.CLUSTER_BREAK.LVT}else if(e===47952)return i.CLUSTER_BREAK.LV}else if(e<47980){if(47953<=e&&e<=47979)return i.CLUSTER_BREAK.LVT}else if(e<47981){if(e===47980)return i.CLUSTER_BREAK.LV}else if(47981<=e&&e<=48007)return i.CLUSTER_BREAK.LVT}else if(e<48149){if(e<48065){if(e<48036){if(e<48009){if(e===48008)return i.CLUSTER_BREAK.LV}else if(48009<=e&&e<=48035)return i.CLUSTER_BREAK.LVT}else if(e<48037){if(e===48036)return i.CLUSTER_BREAK.LV}else if(e<48064){if(48037<=e&&e<=48063)return i.CLUSTER_BREAK.LVT}else if(e===48064)return i.CLUSTER_BREAK.LV}else if(e<48120){if(e<48092){if(48065<=e&&e<=48091)return i.CLUSTER_BREAK.LVT}else if(e<48093){if(e===48092)return i.CLUSTER_BREAK.LV}else if(48093<=e&&e<=48119)return i.CLUSTER_BREAK.LVT}else if(e<48121){if(e===48120)return i.CLUSTER_BREAK.LV}else if(e<48148){if(48121<=e&&e<=48147)return i.CLUSTER_BREAK.LVT}else if(e===48148)return i.CLUSTER_BREAK.LV}else if(e<48232){if(e<48177){if(e<48176){if(48149<=e&&e<=48175)return i.CLUSTER_BREAK.LVT}else if(e===48176)return i.CLUSTER_BREAK.LV}else if(e<48204){if(48177<=e&&e<=48203)return i.CLUSTER_BREAK.LVT}else if(e<48205){if(e===48204)return i.CLUSTER_BREAK.LV}else if(48205<=e&&e<=48231)return i.CLUSTER_BREAK.LVT}else if(e<48261){if(e<48233){if(e===48232)return i.CLUSTER_BREAK.LV}else if(e<48260){if(48233<=e&&e<=48259)return i.CLUSTER_BREAK.LVT}else if(e===48260)return i.CLUSTER_BREAK.LV}else if(e<48288){if(48261<=e&&e<=48287)return i.CLUSTER_BREAK.LVT}else if(e<48289){if(e===48288)return i.CLUSTER_BREAK.LV}else if(48289<=e&&e<=48315)return i.CLUSTER_BREAK.LVT}else if(e<48597){if(e<48456){if(e<48373){if(e<48344){if(e<48317){if(e===48316)return i.CLUSTER_BREAK.LV}else if(48317<=e&&e<=48343)return i.CLUSTER_BREAK.LVT}else if(e<48345){if(e===48344)return i.CLUSTER_BREAK.LV}else if(e<48372){if(48345<=e&&e<=48371)return i.CLUSTER_BREAK.LVT}else if(e===48372)return i.CLUSTER_BREAK.LV}else if(e<48401){if(e<48400){if(48373<=e&&e<=48399)return i.CLUSTER_BREAK.LVT}else if(e===48400)return i.CLUSTER_BREAK.LV}else if(e<48428){if(48401<=e&&e<=48427)return i.CLUSTER_BREAK.LVT}else if(e<48429){if(e===48428)return i.CLUSTER_BREAK.LV}else if(48429<=e&&e<=48455)return i.CLUSTER_BREAK.LVT}else if(e<48513){if(e<48484){if(e<48457){if(e===48456)return i.CLUSTER_BREAK.LV}else if(48457<=e&&e<=48483)return i.CLUSTER_BREAK.LVT}else if(e<48485){if(e===48484)return i.CLUSTER_BREAK.LV}else if(e<48512){if(48485<=e&&e<=48511)return i.CLUSTER_BREAK.LVT}else if(e===48512)return i.CLUSTER_BREAK.LV}else if(e<48568){if(e<48540){if(48513<=e&&e<=48539)return i.CLUSTER_BREAK.LVT}else if(e<48541){if(e===48540)return i.CLUSTER_BREAK.LV}else if(48541<=e&&e<=48567)return i.CLUSTER_BREAK.LVT}else if(e<48569){if(e===48568)return i.CLUSTER_BREAK.LV}else if(e<48596){if(48569<=e&&e<=48595)return i.CLUSTER_BREAK.LVT}else if(e===48596)return i.CLUSTER_BREAK.LV}else if(e<48764){if(e<48680){if(e<48625){if(e<48624){if(48597<=e&&e<=48623)return i.CLUSTER_BREAK.LVT}else if(e===48624)return i.CLUSTER_BREAK.LV}else if(e<48652){if(48625<=e&&e<=48651)return i.CLUSTER_BREAK.LVT}else if(e<48653){if(e===48652)return i.CLUSTER_BREAK.LV}else if(48653<=e&&e<=48679)return i.CLUSTER_BREAK.LVT}else if(e<48709){if(e<48681){if(e===48680)return i.CLUSTER_BREAK.LV}else if(e<48708){if(48681<=e&&e<=48707)return i.CLUSTER_BREAK.LVT}else if(e===48708)return i.CLUSTER_BREAK.LV}else if(e<48736){if(48709<=e&&e<=48735)return i.CLUSTER_BREAK.LVT}else if(e<48737){if(e===48736)return i.CLUSTER_BREAK.LV}else if(48737<=e&&e<=48763)return i.CLUSTER_BREAK.LVT}else if(e<48821){if(e<48792){if(e<48765){if(e===48764)return i.CLUSTER_BREAK.LV}else if(48765<=e&&e<=48791)return i.CLUSTER_BREAK.LVT}else if(e<48793){if(e===48792)return i.CLUSTER_BREAK.LV}else if(e<48820){if(48793<=e&&e<=48819)return i.CLUSTER_BREAK.LVT}else if(e===48820)return i.CLUSTER_BREAK.LV}else if(e<48876){if(e<48848){if(48821<=e&&e<=48847)return i.CLUSTER_BREAK.LVT}else if(e<48849){if(e===48848)return i.CLUSTER_BREAK.LV}else if(48849<=e&&e<=48875)return i.CLUSTER_BREAK.LVT}else if(e<48877){if(e===48876)return i.CLUSTER_BREAK.LV}else if(e<48904){if(48877<=e&&e<=48903)return i.CLUSTER_BREAK.LVT}else if(e===48904)return i.CLUSTER_BREAK.LV}else if(e<53720){if(e<51312){if(e<50108){if(e<49493){if(e<49212){if(e<49045){if(e<48988){if(e<48933){if(e<48932){if(48905<=e&&e<=48931)return i.CLUSTER_BREAK.LVT}else if(e===48932)return i.CLUSTER_BREAK.LV}else if(e<48960){if(48933<=e&&e<=48959)return i.CLUSTER_BREAK.LVT}else if(e<48961){if(e===48960)return i.CLUSTER_BREAK.LV}else if(48961<=e&&e<=48987)return i.CLUSTER_BREAK.LVT}else if(e<49016){if(e<48989){if(e===48988)return i.CLUSTER_BREAK.LV}else if(48989<=e&&e<=49015)return i.CLUSTER_BREAK.LVT}else if(e<49017){if(e===49016)return i.CLUSTER_BREAK.LV}else if(e<49044){if(49017<=e&&e<=49043)return i.CLUSTER_BREAK.LVT}else if(e===49044)return i.CLUSTER_BREAK.LV}else if(e<49128){if(e<49073){if(e<49072){if(49045<=e&&e<=49071)return i.CLUSTER_BREAK.LVT}else if(e===49072)return i.CLUSTER_BREAK.LV}else if(e<49100){if(49073<=e&&e<=49099)return i.CLUSTER_BREAK.LVT}else if(e<49101){if(e===49100)return i.CLUSTER_BREAK.LV}else if(49101<=e&&e<=49127)return i.CLUSTER_BREAK.LVT}else if(e<49157){if(e<49129){if(e===49128)return i.CLUSTER_BREAK.LV}else if(e<49156){if(49129<=e&&e<=49155)return i.CLUSTER_BREAK.LVT}else if(e===49156)return i.CLUSTER_BREAK.LV}else if(e<49184){if(49157<=e&&e<=49183)return i.CLUSTER_BREAK.LVT}else if(e<49185){if(e===49184)return i.CLUSTER_BREAK.LV}else if(49185<=e&&e<=49211)return i.CLUSTER_BREAK.LVT}else if(e<49352){if(e<49269){if(e<49240){if(e<49213){if(e===49212)return i.CLUSTER_BREAK.LV}else if(49213<=e&&e<=49239)return i.CLUSTER_BREAK.LVT}else if(e<49241){if(e===49240)return i.CLUSTER_BREAK.LV}else if(e<49268){if(49241<=e&&e<=49267)return i.CLUSTER_BREAK.LVT}else if(e===49268)return i.CLUSTER_BREAK.LV}else if(e<49297){if(e<49296){if(49269<=e&&e<=49295)return i.CLUSTER_BREAK.LVT}else if(e===49296)return i.CLUSTER_BREAK.LV}else if(e<49324){if(49297<=e&&e<=49323)return i.CLUSTER_BREAK.LVT}else if(e<49325){if(e===49324)return i.CLUSTER_BREAK.LV}else if(49325<=e&&e<=49351)return i.CLUSTER_BREAK.LVT}else if(e<49409){if(e<49380){if(e<49353){if(e===49352)return i.CLUSTER_BREAK.LV}else if(49353<=e&&e<=49379)return i.CLUSTER_BREAK.LVT}else if(e<49381){if(e===49380)return i.CLUSTER_BREAK.LV}else if(e<49408){if(49381<=e&&e<=49407)return i.CLUSTER_BREAK.LVT}else if(e===49408)return i.CLUSTER_BREAK.LV}else if(e<49464){if(e<49436){if(49409<=e&&e<=49435)return i.CLUSTER_BREAK.LVT}else if(e<49437){if(e===49436)return i.CLUSTER_BREAK.LV}else if(49437<=e&&e<=49463)return i.CLUSTER_BREAK.LVT}else if(e<49465){if(e===49464)return i.CLUSTER_BREAK.LV}else if(e<49492){if(49465<=e&&e<=49491)return i.CLUSTER_BREAK.LVT}else if(e===49492)return i.CLUSTER_BREAK.LV}else if(e<49800){if(e<49633){if(e<49576){if(e<49521){if(e<49520){if(49493<=e&&e<=49519)return i.CLUSTER_BREAK.LVT}else if(e===49520)return i.CLUSTER_BREAK.LV}else if(e<49548){if(49521<=e&&e<=49547)return i.CLUSTER_BREAK.LVT}else if(e<49549){if(e===49548)return i.CLUSTER_BREAK.LV}else if(49549<=e&&e<=49575)return i.CLUSTER_BREAK.LVT}else if(e<49604){if(e<49577){if(e===49576)return i.CLUSTER_BREAK.LV}else if(49577<=e&&e<=49603)return i.CLUSTER_BREAK.LVT}else if(e<49605){if(e===49604)return i.CLUSTER_BREAK.LV}else if(e<49632){if(49605<=e&&e<=49631)return i.CLUSTER_BREAK.LVT}else if(e===49632)return i.CLUSTER_BREAK.LV}else if(e<49716){if(e<49661){if(e<49660){if(49633<=e&&e<=49659)return i.CLUSTER_BREAK.LVT}else if(e===49660)return i.CLUSTER_BREAK.LV}else if(e<49688){if(49661<=e&&e<=49687)return i.CLUSTER_BREAK.LVT}else if(e<49689){if(e===49688)return i.CLUSTER_BREAK.LV}else if(49689<=e&&e<=49715)return i.CLUSTER_BREAK.LVT}else if(e<49745){if(e<49717){if(e===49716)return i.CLUSTER_BREAK.LV}else if(e<49744){if(49717<=e&&e<=49743)return i.CLUSTER_BREAK.LVT}else if(e===49744)return i.CLUSTER_BREAK.LV}else if(e<49772){if(49745<=e&&e<=49771)return i.CLUSTER_BREAK.LVT}else if(e<49773){if(e===49772)return i.CLUSTER_BREAK.LV}else if(49773<=e&&e<=49799)return i.CLUSTER_BREAK.LVT}else if(e<49941){if(e<49857){if(e<49828){if(e<49801){if(e===49800)return i.CLUSTER_BREAK.LV}else if(49801<=e&&e<=49827)return i.CLUSTER_BREAK.LVT}else if(e<49829){if(e===49828)return i.CLUSTER_BREAK.LV}else if(e<49856){if(49829<=e&&e<=49855)return i.CLUSTER_BREAK.LVT}else if(e===49856)return i.CLUSTER_BREAK.LV}else if(e<49912){if(e<49884){if(49857<=e&&e<=49883)return i.CLUSTER_BREAK.LVT}else if(e<49885){if(e===49884)return i.CLUSTER_BREAK.LV}else if(49885<=e&&e<=49911)return i.CLUSTER_BREAK.LVT}else if(e<49913){if(e===49912)return i.CLUSTER_BREAK.LV}else if(e<49940){if(49913<=e&&e<=49939)return i.CLUSTER_BREAK.LVT}else if(e===49940)return i.CLUSTER_BREAK.LV}else if(e<50024){if(e<49969){if(e<49968){if(49941<=e&&e<=49967)return i.CLUSTER_BREAK.LVT}else if(e===49968)return i.CLUSTER_BREAK.LV}else if(e<49996){if(49969<=e&&e<=49995)return i.CLUSTER_BREAK.LVT}else if(e<49997){if(e===49996)return i.CLUSTER_BREAK.LV}else if(49997<=e&&e<=50023)return i.CLUSTER_BREAK.LVT}else if(e<50053){if(e<50025){if(e===50024)return i.CLUSTER_BREAK.LV}else if(e<50052){if(50025<=e&&e<=50051)return i.CLUSTER_BREAK.LVT}else if(e===50052)return i.CLUSTER_BREAK.LV}else if(e<50080){if(50053<=e&&e<=50079)return i.CLUSTER_BREAK.LVT}else if(e<50081){if(e===50080)return i.CLUSTER_BREAK.LV}else if(50081<=e&&e<=50107)return i.CLUSTER_BREAK.LVT}else if(e<50697){if(e<50389){if(e<50248){if(e<50165){if(e<50136){if(e<50109){if(e===50108)return i.CLUSTER_BREAK.LV}else if(50109<=e&&e<=50135)return i.CLUSTER_BREAK.LVT}else if(e<50137){if(e===50136)return i.CLUSTER_BREAK.LV}else if(e<50164){if(50137<=e&&e<=50163)return i.CLUSTER_BREAK.LVT}else if(e===50164)return i.CLUSTER_BREAK.LV}else if(e<50193){if(e<50192){if(50165<=e&&e<=50191)return i.CLUSTER_BREAK.LVT}else if(e===50192)return i.CLUSTER_BREAK.LV}else if(e<50220){if(50193<=e&&e<=50219)return i.CLUSTER_BREAK.LVT}else if(e<50221){if(e===50220)return i.CLUSTER_BREAK.LV}else if(50221<=e&&e<=50247)return i.CLUSTER_BREAK.LVT}else if(e<50305){if(e<50276){if(e<50249){if(e===50248)return i.CLUSTER_BREAK.LV}else if(50249<=e&&e<=50275)return i.CLUSTER_BREAK.LVT}else if(e<50277){if(e===50276)return i.CLUSTER_BREAK.LV}else if(e<50304){if(50277<=e&&e<=50303)return i.CLUSTER_BREAK.LVT}else if(e===50304)return i.CLUSTER_BREAK.LV}else if(e<50360){if(e<50332){if(50305<=e&&e<=50331)return i.CLUSTER_BREAK.LVT}else if(e<50333){if(e===50332)return i.CLUSTER_BREAK.LV}else if(50333<=e&&e<=50359)return i.CLUSTER_BREAK.LVT}else if(e<50361){if(e===50360)return i.CLUSTER_BREAK.LV}else if(e<50388){if(50361<=e&&e<=50387)return i.CLUSTER_BREAK.LVT}else if(e===50388)return i.CLUSTER_BREAK.LV}else if(e<50556){if(e<50472){if(e<50417){if(e<50416){if(50389<=e&&e<=50415)return i.CLUSTER_BREAK.LVT}else if(e===50416)return i.CLUSTER_BREAK.LV}else if(e<50444){if(50417<=e&&e<=50443)return i.CLUSTER_BREAK.LVT}else if(e<50445){if(e===50444)return i.CLUSTER_BREAK.LV}else if(50445<=e&&e<=50471)return i.CLUSTER_BREAK.LVT}else if(e<50501){if(e<50473){if(e===50472)return i.CLUSTER_BREAK.LV}else if(e<50500){if(50473<=e&&e<=50499)return i.CLUSTER_BREAK.LVT}else if(e===50500)return i.CLUSTER_BREAK.LV}else if(e<50528){if(50501<=e&&e<=50527)return i.CLUSTER_BREAK.LVT}else if(e<50529){if(e===50528)return i.CLUSTER_BREAK.LV}else if(50529<=e&&e<=50555)return i.CLUSTER_BREAK.LVT}else if(e<50613){if(e<50584){if(e<50557){if(e===50556)return i.CLUSTER_BREAK.LV}else if(50557<=e&&e<=50583)return i.CLUSTER_BREAK.LVT}else if(e<50585){if(e===50584)return i.CLUSTER_BREAK.LV}else if(e<50612){if(50585<=e&&e<=50611)return i.CLUSTER_BREAK.LVT}else if(e===50612)return i.CLUSTER_BREAK.LV}else if(e<50668){if(e<50640){if(50613<=e&&e<=50639)return i.CLUSTER_BREAK.LVT}else if(e<50641){if(e===50640)return i.CLUSTER_BREAK.LV}else if(50641<=e&&e<=50667)return i.CLUSTER_BREAK.LVT}else if(e<50669){if(e===50668)return i.CLUSTER_BREAK.LV}else if(e<50696){if(50669<=e&&e<=50695)return i.CLUSTER_BREAK.LVT}else if(e===50696)return i.CLUSTER_BREAK.LV}else if(e<51004){if(e<50837){if(e<50780){if(e<50725){if(e<50724){if(50697<=e&&e<=50723)return i.CLUSTER_BREAK.LVT}else if(e===50724)return i.CLUSTER_BREAK.LV}else if(e<50752){if(50725<=e&&e<=50751)return i.CLUSTER_BREAK.LVT}else if(e<50753){if(e===50752)return i.CLUSTER_BREAK.LV}else if(50753<=e&&e<=50779)return i.CLUSTER_BREAK.LVT}else if(e<50808){if(e<50781){if(e===50780)return i.CLUSTER_BREAK.LV}else if(50781<=e&&e<=50807)return i.CLUSTER_BREAK.LVT}else if(e<50809){if(e===50808)return i.CLUSTER_BREAK.LV}else if(e<50836){if(50809<=e&&e<=50835)return i.CLUSTER_BREAK.LVT}else if(e===50836)return i.CLUSTER_BREAK.LV}else if(e<50920){if(e<50865){if(e<50864){if(50837<=e&&e<=50863)return i.CLUSTER_BREAK.LVT}else if(e===50864)return i.CLUSTER_BREAK.LV}else if(e<50892){if(50865<=e&&e<=50891)return i.CLUSTER_BREAK.LVT}else if(e<50893){if(e===50892)return i.CLUSTER_BREAK.LV}else if(50893<=e&&e<=50919)return i.CLUSTER_BREAK.LVT}else if(e<50949){if(e<50921){if(e===50920)return i.CLUSTER_BREAK.LV}else if(e<50948){if(50921<=e&&e<=50947)return i.CLUSTER_BREAK.LVT}else if(e===50948)return i.CLUSTER_BREAK.LV}else if(e<50976){if(50949<=e&&e<=50975)return i.CLUSTER_BREAK.LVT}else if(e<50977){if(e===50976)return i.CLUSTER_BREAK.LV}else if(50977<=e&&e<=51003)return i.CLUSTER_BREAK.LVT}else if(e<51145){if(e<51061){if(e<51032){if(e<51005){if(e===51004)return i.CLUSTER_BREAK.LV}else if(51005<=e&&e<=51031)return i.CLUSTER_BREAK.LVT}else if(e<51033){if(e===51032)return i.CLUSTER_BREAK.LV}else if(e<51060){if(51033<=e&&e<=51059)return i.CLUSTER_BREAK.LVT}else if(e===51060)return i.CLUSTER_BREAK.LV}else if(e<51116){if(e<51088){if(51061<=e&&e<=51087)return i.CLUSTER_BREAK.LVT}else if(e<51089){if(e===51088)return i.CLUSTER_BREAK.LV}else if(51089<=e&&e<=51115)return i.CLUSTER_BREAK.LVT}else if(e<51117){if(e===51116)return i.CLUSTER_BREAK.LV}else if(e<51144){if(51117<=e&&e<=51143)return i.CLUSTER_BREAK.LVT}else if(e===51144)return i.CLUSTER_BREAK.LV}else if(e<51228){if(e<51173){if(e<51172){if(51145<=e&&e<=51171)return i.CLUSTER_BREAK.LVT}else if(e===51172)return i.CLUSTER_BREAK.LV}else if(e<51200){if(51173<=e&&e<=51199)return i.CLUSTER_BREAK.LVT}else if(e<51201){if(e===51200)return i.CLUSTER_BREAK.LV}else if(51201<=e&&e<=51227)return i.CLUSTER_BREAK.LVT}else if(e<51257){if(e<51229){if(e===51228)return i.CLUSTER_BREAK.LV}else if(e<51256){if(51229<=e&&e<=51255)return i.CLUSTER_BREAK.LVT}else if(e===51256)return i.CLUSTER_BREAK.LV}else if(e<51284){if(51257<=e&&e<=51283)return i.CLUSTER_BREAK.LVT}else if(e<51285){if(e===51284)return i.CLUSTER_BREAK.LV}else if(51285<=e&&e<=51311)return i.CLUSTER_BREAK.LVT}else if(e<52516){if(e<51901){if(e<51593){if(e<51452){if(e<51369){if(e<51340){if(e<51313){if(e===51312)return i.CLUSTER_BREAK.LV}else if(51313<=e&&e<=51339)return i.CLUSTER_BREAK.LVT}else if(e<51341){if(e===51340)return i.CLUSTER_BREAK.LV}else if(e<51368){if(51341<=e&&e<=51367)return i.CLUSTER_BREAK.LVT}else if(e===51368)return i.CLUSTER_BREAK.LV}else if(e<51397){if(e<51396){if(51369<=e&&e<=51395)return i.CLUSTER_BREAK.LVT}else if(e===51396)return i.CLUSTER_BREAK.LV}else if(e<51424){if(51397<=e&&e<=51423)return i.CLUSTER_BREAK.LVT}else if(e<51425){if(e===51424)return i.CLUSTER_BREAK.LV}else if(51425<=e&&e<=51451)return i.CLUSTER_BREAK.LVT}else if(e<51509){if(e<51480){if(e<51453){if(e===51452)return i.CLUSTER_BREAK.LV}else if(51453<=e&&e<=51479)return i.CLUSTER_BREAK.LVT}else if(e<51481){if(e===51480)return i.CLUSTER_BREAK.LV}else if(e<51508){if(51481<=e&&e<=51507)return i.CLUSTER_BREAK.LVT}else if(e===51508)return i.CLUSTER_BREAK.LV}else if(e<51564){if(e<51536){if(51509<=e&&e<=51535)return i.CLUSTER_BREAK.LVT}else if(e<51537){if(e===51536)return i.CLUSTER_BREAK.LV}else if(51537<=e&&e<=51563)return i.CLUSTER_BREAK.LVT}else if(e<51565){if(e===51564)return i.CLUSTER_BREAK.LV}else if(e<51592){if(51565<=e&&e<=51591)return i.CLUSTER_BREAK.LVT}else if(e===51592)return i.CLUSTER_BREAK.LV}else if(e<51760){if(e<51676){if(e<51621){if(e<51620){if(51593<=e&&e<=51619)return i.CLUSTER_BREAK.LVT}else if(e===51620)return i.CLUSTER_BREAK.LV}else if(e<51648){if(51621<=e&&e<=51647)return i.CLUSTER_BREAK.LVT}else if(e<51649){if(e===51648)return i.CLUSTER_BREAK.LV}else if(51649<=e&&e<=51675)return i.CLUSTER_BREAK.LVT}else if(e<51705){if(e<51677){if(e===51676)return i.CLUSTER_BREAK.LV}else if(e<51704){if(51677<=e&&e<=51703)return i.CLUSTER_BREAK.LVT}else if(e===51704)return i.CLUSTER_BREAK.LV}else if(e<51732){if(51705<=e&&e<=51731)return i.CLUSTER_BREAK.LVT}else if(e<51733){if(e===51732)return i.CLUSTER_BREAK.LV}else if(51733<=e&&e<=51759)return i.CLUSTER_BREAK.LVT}else if(e<51817){if(e<51788){if(e<51761){if(e===51760)return i.CLUSTER_BREAK.LV}else if(51761<=e&&e<=51787)return i.CLUSTER_BREAK.LVT}else if(e<51789){if(e===51788)return i.CLUSTER_BREAK.LV}else if(e<51816){if(51789<=e&&e<=51815)return i.CLUSTER_BREAK.LVT}else if(e===51816)return i.CLUSTER_BREAK.LV}else if(e<51872){if(e<51844){if(51817<=e&&e<=51843)return i.CLUSTER_BREAK.LVT}else if(e<51845){if(e===51844)return i.CLUSTER_BREAK.LV}else if(51845<=e&&e<=51871)return i.CLUSTER_BREAK.LVT}else if(e<51873){if(e===51872)return i.CLUSTER_BREAK.LV}else if(e<51900){if(51873<=e&&e<=51899)return i.CLUSTER_BREAK.LVT}else if(e===51900)return i.CLUSTER_BREAK.LV}else if(e<52208){if(e<52041){if(e<51984){if(e<51929){if(e<51928){if(51901<=e&&e<=51927)return i.CLUSTER_BREAK.LVT}else if(e===51928)return i.CLUSTER_BREAK.LV}else if(e<51956){if(51929<=e&&e<=51955)return i.CLUSTER_BREAK.LVT}else if(e<51957){if(e===51956)return i.CLUSTER_BREAK.LV}else if(51957<=e&&e<=51983)return i.CLUSTER_BREAK.LVT}else if(e<52012){if(e<51985){if(e===51984)return i.CLUSTER_BREAK.LV}else if(51985<=e&&e<=52011)return i.CLUSTER_BREAK.LVT}else if(e<52013){if(e===52012)return i.CLUSTER_BREAK.LV}else if(e<52040){if(52013<=e&&e<=52039)return i.CLUSTER_BREAK.LVT}else if(e===52040)return i.CLUSTER_BREAK.LV}else if(e<52124){if(e<52069){if(e<52068){if(52041<=e&&e<=52067)return i.CLUSTER_BREAK.LVT}else if(e===52068)return i.CLUSTER_BREAK.LV}else if(e<52096){if(52069<=e&&e<=52095)return i.CLUSTER_BREAK.LVT}else if(e<52097){if(e===52096)return i.CLUSTER_BREAK.LV}else if(52097<=e&&e<=52123)return i.CLUSTER_BREAK.LVT}else if(e<52153){if(e<52125){if(e===52124)return i.CLUSTER_BREAK.LV}else if(e<52152){if(52125<=e&&e<=52151)return i.CLUSTER_BREAK.LVT}else if(e===52152)return i.CLUSTER_BREAK.LV}else if(e<52180){if(52153<=e&&e<=52179)return i.CLUSTER_BREAK.LVT}else if(e<52181){if(e===52180)return i.CLUSTER_BREAK.LV}else if(52181<=e&&e<=52207)return i.CLUSTER_BREAK.LVT}else if(e<52349){if(e<52265){if(e<52236){if(e<52209){if(e===52208)return i.CLUSTER_BREAK.LV}else if(52209<=e&&e<=52235)return i.CLUSTER_BREAK.LVT}else if(e<52237){if(e===52236)return i.CLUSTER_BREAK.LV}else if(e<52264){if(52237<=e&&e<=52263)return i.CLUSTER_BREAK.LVT}else if(e===52264)return i.CLUSTER_BREAK.LV}else if(e<52320){if(e<52292){if(52265<=e&&e<=52291)return i.CLUSTER_BREAK.LVT}else if(e<52293){if(e===52292)return i.CLUSTER_BREAK.LV}else if(52293<=e&&e<=52319)return i.CLUSTER_BREAK.LVT}else if(e<52321){if(e===52320)return i.CLUSTER_BREAK.LV}else if(e<52348){if(52321<=e&&e<=52347)return i.CLUSTER_BREAK.LVT}else if(e===52348)return i.CLUSTER_BREAK.LV}else if(e<52432){if(e<52377){if(e<52376){if(52349<=e&&e<=52375)return i.CLUSTER_BREAK.LVT}else if(e===52376)return i.CLUSTER_BREAK.LV}else if(e<52404){if(52377<=e&&e<=52403)return i.CLUSTER_BREAK.LVT}else if(e<52405){if(e===52404)return i.CLUSTER_BREAK.LV}else if(52405<=e&&e<=52431)return i.CLUSTER_BREAK.LVT}else if(e<52461){if(e<52433){if(e===52432)return i.CLUSTER_BREAK.LV}else if(e<52460){if(52433<=e&&e<=52459)return i.CLUSTER_BREAK.LVT}else if(e===52460)return i.CLUSTER_BREAK.LV}else if(e<52488){if(52461<=e&&e<=52487)return i.CLUSTER_BREAK.LVT}else if(e<52489){if(e===52488)return i.CLUSTER_BREAK.LV}else if(52489<=e&&e<=52515)return i.CLUSTER_BREAK.LVT}else if(e<53105){if(e<52797){if(e<52656){if(e<52573){if(e<52544){if(e<52517){if(e===52516)return i.CLUSTER_BREAK.LV}else if(52517<=e&&e<=52543)return i.CLUSTER_BREAK.LVT}else if(e<52545){if(e===52544)return i.CLUSTER_BREAK.LV}else if(e<52572){if(52545<=e&&e<=52571)return i.CLUSTER_BREAK.LVT}else if(e===52572)return i.CLUSTER_BREAK.LV}else if(e<52601){if(e<52600){if(52573<=e&&e<=52599)return i.CLUSTER_BREAK.LVT}else if(e===52600)return i.CLUSTER_BREAK.LV}else if(e<52628){if(52601<=e&&e<=52627)return i.CLUSTER_BREAK.LVT}else if(e<52629){if(e===52628)return i.CLUSTER_BREAK.LV}else if(52629<=e&&e<=52655)return i.CLUSTER_BREAK.LVT}else if(e<52713){if(e<52684){if(e<52657){if(e===52656)return i.CLUSTER_BREAK.LV}else if(52657<=e&&e<=52683)return i.CLUSTER_BREAK.LVT}else if(e<52685){if(e===52684)return i.CLUSTER_BREAK.LV}else if(e<52712){if(52685<=e&&e<=52711)return i.CLUSTER_BREAK.LVT}else if(e===52712)return i.CLUSTER_BREAK.LV}else if(e<52768){if(e<52740){if(52713<=e&&e<=52739)return i.CLUSTER_BREAK.LVT}else if(e<52741){if(e===52740)return i.CLUSTER_BREAK.LV}else if(52741<=e&&e<=52767)return i.CLUSTER_BREAK.LVT}else if(e<52769){if(e===52768)return i.CLUSTER_BREAK.LV}else if(e<52796){if(52769<=e&&e<=52795)return i.CLUSTER_BREAK.LVT}else if(e===52796)return i.CLUSTER_BREAK.LV}else if(e<52964){if(e<52880){if(e<52825){if(e<52824){if(52797<=e&&e<=52823)return i.CLUSTER_BREAK.LVT}else if(e===52824)return i.CLUSTER_BREAK.LV}else if(e<52852){if(52825<=e&&e<=52851)return i.CLUSTER_BREAK.LVT}else if(e<52853){if(e===52852)return i.CLUSTER_BREAK.LV}else if(52853<=e&&e<=52879)return i.CLUSTER_BREAK.LVT}else if(e<52909){if(e<52881){if(e===52880)return i.CLUSTER_BREAK.LV}else if(e<52908){if(52881<=e&&e<=52907)return i.CLUSTER_BREAK.LVT}else if(e===52908)return i.CLUSTER_BREAK.LV}else if(e<52936){if(52909<=e&&e<=52935)return i.CLUSTER_BREAK.LVT}else if(e<52937){if(e===52936)return i.CLUSTER_BREAK.LV}else if(52937<=e&&e<=52963)return i.CLUSTER_BREAK.LVT}else if(e<53021){if(e<52992){if(e<52965){if(e===52964)return i.CLUSTER_BREAK.LV}else if(52965<=e&&e<=52991)return i.CLUSTER_BREAK.LVT}else if(e<52993){if(e===52992)return i.CLUSTER_BREAK.LV}else if(e<53020){if(52993<=e&&e<=53019)return i.CLUSTER_BREAK.LVT}else if(e===53020)return i.CLUSTER_BREAK.LV}else if(e<53076){if(e<53048){if(53021<=e&&e<=53047)return i.CLUSTER_BREAK.LVT}else if(e<53049){if(e===53048)return i.CLUSTER_BREAK.LV}else if(53049<=e&&e<=53075)return i.CLUSTER_BREAK.LVT}else if(e<53077){if(e===53076)return i.CLUSTER_BREAK.LV}else if(e<53104){if(53077<=e&&e<=53103)return i.CLUSTER_BREAK.LVT}else if(e===53104)return i.CLUSTER_BREAK.LV}else if(e<53412){if(e<53245){if(e<53188){if(e<53133){if(e<53132){if(53105<=e&&e<=53131)return i.CLUSTER_BREAK.LVT}else if(e===53132)return i.CLUSTER_BREAK.LV}else if(e<53160){if(53133<=e&&e<=53159)return i.CLUSTER_BREAK.LVT}else if(e<53161){if(e===53160)return i.CLUSTER_BREAK.LV}else if(53161<=e&&e<=53187)return i.CLUSTER_BREAK.LVT}else if(e<53216){if(e<53189){if(e===53188)return i.CLUSTER_BREAK.LV}else if(53189<=e&&e<=53215)return i.CLUSTER_BREAK.LVT}else if(e<53217){if(e===53216)return i.CLUSTER_BREAK.LV}else if(e<53244){if(53217<=e&&e<=53243)return i.CLUSTER_BREAK.LVT}else if(e===53244)return i.CLUSTER_BREAK.LV}else if(e<53328){if(e<53273){if(e<53272){if(53245<=e&&e<=53271)return i.CLUSTER_BREAK.LVT}else if(e===53272)return i.CLUSTER_BREAK.LV}else if(e<53300){if(53273<=e&&e<=53299)return i.CLUSTER_BREAK.LVT}else if(e<53301){if(e===53300)return i.CLUSTER_BREAK.LV}else if(53301<=e&&e<=53327)return i.CLUSTER_BREAK.LVT}else if(e<53357){if(e<53329){if(e===53328)return i.CLUSTER_BREAK.LV}else if(e<53356){if(53329<=e&&e<=53355)return i.CLUSTER_BREAK.LVT}else if(e===53356)return i.CLUSTER_BREAK.LV}else if(e<53384){if(53357<=e&&e<=53383)return i.CLUSTER_BREAK.LVT}else if(e<53385){if(e===53384)return i.CLUSTER_BREAK.LV}else if(53385<=e&&e<=53411)return i.CLUSTER_BREAK.LVT}else if(e<53553){if(e<53469){if(e<53440){if(e<53413){if(e===53412)return i.CLUSTER_BREAK.LV}else if(53413<=e&&e<=53439)return i.CLUSTER_BREAK.LVT}else if(e<53441){if(e===53440)return i.CLUSTER_BREAK.LV}else if(e<53468){if(53441<=e&&e<=53467)return i.CLUSTER_BREAK.LVT}else if(e===53468)return i.CLUSTER_BREAK.LV}else if(e<53524){if(e<53496){if(53469<=e&&e<=53495)return i.CLUSTER_BREAK.LVT}else if(e<53497){if(e===53496)return i.CLUSTER_BREAK.LV}else if(53497<=e&&e<=53523)return i.CLUSTER_BREAK.LVT}else if(e<53525){if(e===53524)return i.CLUSTER_BREAK.LV}else if(e<53552){if(53525<=e&&e<=53551)return i.CLUSTER_BREAK.LVT}else if(e===53552)return i.CLUSTER_BREAK.LV}else if(e<53636){if(e<53581){if(e<53580){if(53553<=e&&e<=53579)return i.CLUSTER_BREAK.LVT}else if(e===53580)return i.CLUSTER_BREAK.LV}else if(e<53608){if(53581<=e&&e<=53607)return i.CLUSTER_BREAK.LVT}else if(e<53609){if(e===53608)return i.CLUSTER_BREAK.LV}else if(53609<=e&&e<=53635)return i.CLUSTER_BREAK.LVT}else if(e<53665){if(e<53637){if(e===53636)return i.CLUSTER_BREAK.LV}else if(e<53664){if(53637<=e&&e<=53663)return i.CLUSTER_BREAK.LVT}else if(e===53664)return i.CLUSTER_BREAK.LV}else if(e<53692){if(53665<=e&&e<=53691)return i.CLUSTER_BREAK.LVT}else if(e<53693){if(e===53692)return i.CLUSTER_BREAK.LV}else if(53693<=e&&e<=53719)return i.CLUSTER_BREAK.LVT}else if(e<70459){if(e<54897){if(e<54308){if(e<54001){if(e<53860){if(e<53777){if(e<53748){if(e<53721){if(e===53720)return i.CLUSTER_BREAK.LV}else if(53721<=e&&e<=53747)return i.CLUSTER_BREAK.LVT}else if(e<53749){if(e===53748)return i.CLUSTER_BREAK.LV}else if(e<53776){if(53749<=e&&e<=53775)return i.CLUSTER_BREAK.LVT}else if(e===53776)return i.CLUSTER_BREAK.LV}else if(e<53805){if(e<53804){if(53777<=e&&e<=53803)return i.CLUSTER_BREAK.LVT}else if(e===53804)return i.CLUSTER_BREAK.LV}else if(e<53832){if(53805<=e&&e<=53831)return i.CLUSTER_BREAK.LVT}else if(e<53833){if(e===53832)return i.CLUSTER_BREAK.LV}else if(53833<=e&&e<=53859)return i.CLUSTER_BREAK.LVT}else if(e<53917){if(e<53888){if(e<53861){if(e===53860)return i.CLUSTER_BREAK.LV}else if(53861<=e&&e<=53887)return i.CLUSTER_BREAK.LVT}else if(e<53889){if(e===53888)return i.CLUSTER_BREAK.LV}else if(e<53916){if(53889<=e&&e<=53915)return i.CLUSTER_BREAK.LVT}else if(e===53916)return i.CLUSTER_BREAK.LV}else if(e<53972){if(e<53944){if(53917<=e&&e<=53943)return i.CLUSTER_BREAK.LVT}else if(e<53945){if(e===53944)return i.CLUSTER_BREAK.LV}else if(53945<=e&&e<=53971)return i.CLUSTER_BREAK.LVT}else if(e<53973){if(e===53972)return i.CLUSTER_BREAK.LV}else if(e<54e3){if(53973<=e&&e<=53999)return i.CLUSTER_BREAK.LVT}else if(e===54e3)return i.CLUSTER_BREAK.LV}else if(e<54141){if(e<54084){if(e<54029){if(e<54028){if(54001<=e&&e<=54027)return i.CLUSTER_BREAK.LVT}else if(e===54028)return i.CLUSTER_BREAK.LV}else if(e<54056){if(54029<=e&&e<=54055)return i.CLUSTER_BREAK.LVT}else if(e<54057){if(e===54056)return i.CLUSTER_BREAK.LV}else if(54057<=e&&e<=54083)return i.CLUSTER_BREAK.LVT}else if(e<54112){if(e<54085){if(e===54084)return i.CLUSTER_BREAK.LV}else if(54085<=e&&e<=54111)return i.CLUSTER_BREAK.LVT}else if(e<54113){if(e===54112)return i.CLUSTER_BREAK.LV}else if(e<54140){if(54113<=e&&e<=54139)return i.CLUSTER_BREAK.LVT}else if(e===54140)return i.CLUSTER_BREAK.LV}else if(e<54224){if(e<54169){if(e<54168){if(54141<=e&&e<=54167)return i.CLUSTER_BREAK.LVT}else if(e===54168)return i.CLUSTER_BREAK.LV}else if(e<54196){if(54169<=e&&e<=54195)return i.CLUSTER_BREAK.LVT}else if(e<54197){if(e===54196)return i.CLUSTER_BREAK.LV}else if(54197<=e&&e<=54223)return i.CLUSTER_BREAK.LVT}else if(e<54253){if(e<54225){if(e===54224)return i.CLUSTER_BREAK.LV}else if(e<54252){if(54225<=e&&e<=54251)return i.CLUSTER_BREAK.LVT}else if(e===54252)return i.CLUSTER_BREAK.LV}else if(e<54280){if(54253<=e&&e<=54279)return i.CLUSTER_BREAK.LVT}else if(e<54281){if(e===54280)return i.CLUSTER_BREAK.LV}else if(54281<=e&&e<=54307)return i.CLUSTER_BREAK.LVT}else if(e<54589){if(e<54448){if(e<54365){if(e<54336){if(e<54309){if(e===54308)return i.CLUSTER_BREAK.LV}else if(54309<=e&&e<=54335)return i.CLUSTER_BREAK.LVT}else if(e<54337){if(e===54336)return i.CLUSTER_BREAK.LV}else if(e<54364){if(54337<=e&&e<=54363)return i.CLUSTER_BREAK.LVT}else if(e===54364)return i.CLUSTER_BREAK.LV}else if(e<54393){if(e<54392){if(54365<=e&&e<=54391)return i.CLUSTER_BREAK.LVT}else if(e===54392)return i.CLUSTER_BREAK.LV}else if(e<54420){if(54393<=e&&e<=54419)return i.CLUSTER_BREAK.LVT}else if(e<54421){if(e===54420)return i.CLUSTER_BREAK.LV}else if(54421<=e&&e<=54447)return i.CLUSTER_BREAK.LVT}else if(e<54505){if(e<54476){if(e<54449){if(e===54448)return i.CLUSTER_BREAK.LV}else if(54449<=e&&e<=54475)return i.CLUSTER_BREAK.LVT}else if(e<54477){if(e===54476)return i.CLUSTER_BREAK.LV}else if(e<54504){if(54477<=e&&e<=54503)return i.CLUSTER_BREAK.LVT}else if(e===54504)return i.CLUSTER_BREAK.LV}else if(e<54560){if(e<54532){if(54505<=e&&e<=54531)return i.CLUSTER_BREAK.LVT}else if(e<54533){if(e===54532)return i.CLUSTER_BREAK.LV}else if(54533<=e&&e<=54559)return i.CLUSTER_BREAK.LVT}else if(e<54561){if(e===54560)return i.CLUSTER_BREAK.LV}else if(e<54588){if(54561<=e&&e<=54587)return i.CLUSTER_BREAK.LVT}else if(e===54588)return i.CLUSTER_BREAK.LV}else if(e<54756){if(e<54672){if(e<54617){if(e<54616){if(54589<=e&&e<=54615)return i.CLUSTER_BREAK.LVT}else if(e===54616)return i.CLUSTER_BREAK.LV}else if(e<54644){if(54617<=e&&e<=54643)return i.CLUSTER_BREAK.LVT}else if(e<54645){if(e===54644)return i.CLUSTER_BREAK.LV}else if(54645<=e&&e<=54671)return i.CLUSTER_BREAK.LVT}else if(e<54701){if(e<54673){if(e===54672)return i.CLUSTER_BREAK.LV}else if(e<54700){if(54673<=e&&e<=54699)return i.CLUSTER_BREAK.LVT}else if(e===54700)return i.CLUSTER_BREAK.LV}else if(e<54728){if(54701<=e&&e<=54727)return i.CLUSTER_BREAK.LVT}else if(e<54729){if(e===54728)return i.CLUSTER_BREAK.LV}else if(54729<=e&&e<=54755)return i.CLUSTER_BREAK.LVT}else if(e<54813){if(e<54784){if(e<54757){if(e===54756)return i.CLUSTER_BREAK.LV}else if(54757<=e&&e<=54783)return i.CLUSTER_BREAK.LVT}else if(e<54785){if(e===54784)return i.CLUSTER_BREAK.LV}else if(e<54812){if(54785<=e&&e<=54811)return i.CLUSTER_BREAK.LVT}else if(e===54812)return i.CLUSTER_BREAK.LV}else if(e<54868){if(e<54840){if(54813<=e&&e<=54839)return i.CLUSTER_BREAK.LVT}else if(e<54841){if(e===54840)return i.CLUSTER_BREAK.LV}else if(54841<=e&&e<=54867)return i.CLUSTER_BREAK.LVT}else if(e<54869){if(e===54868)return i.CLUSTER_BREAK.LV}else if(e<54896){if(54869<=e&&e<=54895)return i.CLUSTER_BREAK.LVT}else if(e===54896)return i.CLUSTER_BREAK.LV}else if(e<69632){if(e<55216){if(e<55037){if(e<54980){if(e<54925){if(e<54924){if(54897<=e&&e<=54923)return i.CLUSTER_BREAK.LVT}else if(e===54924)return i.CLUSTER_BREAK.LV}else if(e<54952){if(54925<=e&&e<=54951)return i.CLUSTER_BREAK.LVT}else if(e<54953){if(e===54952)return i.CLUSTER_BREAK.LV}else if(54953<=e&&e<=54979)return i.CLUSTER_BREAK.LVT}else if(e<55008){if(e<54981){if(e===54980)return i.CLUSTER_BREAK.LV}else if(54981<=e&&e<=55007)return i.CLUSTER_BREAK.LVT}else if(e<55009){if(e===55008)return i.CLUSTER_BREAK.LV}else if(e<55036){if(55009<=e&&e<=55035)return i.CLUSTER_BREAK.LVT}else if(e===55036)return i.CLUSTER_BREAK.LV}else if(e<55120){if(e<55065){if(e<55064){if(55037<=e&&e<=55063)return i.CLUSTER_BREAK.LVT}else if(e===55064)return i.CLUSTER_BREAK.LV}else if(e<55092){if(55065<=e&&e<=55091)return i.CLUSTER_BREAK.LVT}else if(e<55093){if(e===55092)return i.CLUSTER_BREAK.LV}else if(55093<=e&&e<=55119)return i.CLUSTER_BREAK.LVT}else if(e<55149){if(e<55121){if(e===55120)return i.CLUSTER_BREAK.LV}else if(e<55148){if(55121<=e&&e<=55147)return i.CLUSTER_BREAK.LVT}else if(e===55148)return i.CLUSTER_BREAK.LV}else if(e<55176){if(55149<=e&&e<=55175)return i.CLUSTER_BREAK.LVT}else if(e<55177){if(e===55176)return i.CLUSTER_BREAK.LV}else if(55177<=e&&e<=55203)return i.CLUSTER_BREAK.LVT}else if(e<68097){if(e<65279){if(e<64286){if(e<55243){if(55216<=e&&e<=55238)return i.CLUSTER_BREAK.V}else if(55243<=e&&e<=55291)return i.CLUSTER_BREAK.T}else if(e<65024){if(e===64286)return i.CLUSTER_BREAK.EXTEND}else if(e<65056){if(65024<=e&&e<=65039)return i.CLUSTER_BREAK.EXTEND}else if(65056<=e&&e<=65071)return i.CLUSTER_BREAK.EXTEND}else if(e<66045){if(e<65438){if(e===65279)return i.CLUSTER_BREAK.CONTROL}else if(e<65520){if(65438<=e&&e<=65439)return i.CLUSTER_BREAK.EXTEND}else if(65520<=e&&e<=65531)return i.CLUSTER_BREAK.CONTROL}else if(e<66272){if(e===66045)return i.CLUSTER_BREAK.EXTEND}else if(e<66422){if(e===66272)return i.CLUSTER_BREAK.EXTEND}else if(66422<=e&&e<=66426)return i.CLUSTER_BREAK.EXTEND}else if(e<68325){if(e<68108){if(e<68101){if(68097<=e&&e<=68099)return i.CLUSTER_BREAK.EXTEND}else if(68101<=e&&e<=68102)return i.CLUSTER_BREAK.EXTEND}else if(e<68152){if(68108<=e&&e<=68111)return i.CLUSTER_BREAK.EXTEND}else if(e<68159){if(68152<=e&&e<=68154)return i.CLUSTER_BREAK.EXTEND}else if(e===68159)return i.CLUSTER_BREAK.EXTEND}else if(e<69373){if(e<68900){if(68325<=e&&e<=68326)return i.CLUSTER_BREAK.EXTEND}else if(e<69291){if(68900<=e&&e<=68903)return i.CLUSTER_BREAK.EXTEND}else if(69291<=e&&e<=69292)return i.CLUSTER_BREAK.EXTEND}else if(e<69446){if(69373<=e&&e<=69375)return i.CLUSTER_BREAK.EXTEND}else if(e<69506){if(69446<=e&&e<=69456)return i.CLUSTER_BREAK.EXTEND}else if(69506<=e&&e<=69509)return i.CLUSTER_BREAK.EXTEND}else if(e<70016){if(e<69815){if(e<69747){if(e<69634){if(e===69632)return i.CLUSTER_BREAK.SPACINGMARK;if(e===69633)return i.CLUSTER_BREAK.EXTEND}else if(e<69688){if(e===69634)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<69744){if(69688<=e&&e<=69702)return i.CLUSTER_BREAK.EXTEND}else if(e===69744)return i.CLUSTER_BREAK.EXTEND}else if(e<69762){if(e<69759){if(69747<=e&&e<=69748)return i.CLUSTER_BREAK.EXTEND}else if(69759<=e&&e<=69761)return i.CLUSTER_BREAK.EXTEND}else if(e<69808){if(e===69762)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<69811){if(69808<=e&&e<=69810)return i.CLUSTER_BREAK.SPACINGMARK}else if(69811<=e&&e<=69814)return i.CLUSTER_BREAK.EXTEND}else if(e<69888)if(e<69821){if(e<69817){if(69815<=e&&e<=69816)return i.CLUSTER_BREAK.SPACINGMARK}else if(69817<=e&&e<=69818)return i.CLUSTER_BREAK.EXTEND}else if(e<69826){if(e===69821)return i.CLUSTER_BREAK.PREPEND}else{if(e===69826)return i.CLUSTER_BREAK.EXTEND;if(e===69837)return i.CLUSTER_BREAK.PREPEND}else if(e<69933){if(e<69927){if(69888<=e&&e<=69890)return i.CLUSTER_BREAK.EXTEND}else if(e<69932){if(69927<=e&&e<=69931)return i.CLUSTER_BREAK.EXTEND}else if(e===69932)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<69957){if(69933<=e&&e<=69940)return i.CLUSTER_BREAK.EXTEND}else if(e<70003){if(69957<=e&&e<=69958)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===70003)return i.CLUSTER_BREAK.EXTEND}else if(e<70194){if(e<70082){if(e<70067){if(e<70018){if(70016<=e&&e<=70017)return i.CLUSTER_BREAK.EXTEND}else if(e===70018)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70070){if(70067<=e&&e<=70069)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70079){if(70070<=e&&e<=70078)return i.CLUSTER_BREAK.EXTEND}else if(70079<=e&&e<=70080)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70095){if(e<70089){if(70082<=e&&e<=70083)return i.CLUSTER_BREAK.PREPEND}else if(e<70094){if(70089<=e&&e<=70092)return i.CLUSTER_BREAK.EXTEND}else if(e===70094)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70188){if(e===70095)return i.CLUSTER_BREAK.EXTEND}else if(e<70191){if(70188<=e&&e<=70190)return i.CLUSTER_BREAK.SPACINGMARK}else if(70191<=e&&e<=70193)return i.CLUSTER_BREAK.EXTEND}else if(e<70209){if(e<70197){if(e<70196){if(70194<=e&&e<=70195)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===70196)return i.CLUSTER_BREAK.EXTEND}else if(e<70198){if(e===70197)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70206){if(70198<=e&&e<=70199)return i.CLUSTER_BREAK.EXTEND}else if(e===70206)return i.CLUSTER_BREAK.EXTEND}else if(e<70371){if(e<70367){if(e===70209)return i.CLUSTER_BREAK.EXTEND}else if(e<70368){if(e===70367)return i.CLUSTER_BREAK.EXTEND}else if(70368<=e&&e<=70370)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70400){if(70371<=e&&e<=70378)return i.CLUSTER_BREAK.EXTEND}else if(e<70402){if(70400<=e&&e<=70401)return i.CLUSTER_BREAK.EXTEND}else if(70402<=e&&e<=70403)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72343){if(e<71339){if(e<70841){if(e<70512){if(e<70471){if(e<70463){if(e<70462){if(70459<=e&&e<=70460)return i.CLUSTER_BREAK.EXTEND}else if(e===70462)return i.CLUSTER_BREAK.EXTEND}else if(e<70464){if(e===70463)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70465){if(e===70464)return i.CLUSTER_BREAK.EXTEND}else if(70465<=e&&e<=70468)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70487){if(e<70475){if(70471<=e&&e<=70472)return i.CLUSTER_BREAK.SPACINGMARK}else if(70475<=e&&e<=70477)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70498){if(e===70487)return i.CLUSTER_BREAK.EXTEND}else if(e<70502){if(70498<=e&&e<=70499)return i.CLUSTER_BREAK.SPACINGMARK}else if(70502<=e&&e<=70508)return i.CLUSTER_BREAK.EXTEND}else if(e<70725){if(e<70712){if(e<70709){if(70512<=e&&e<=70516)return i.CLUSTER_BREAK.EXTEND}else if(70709<=e&&e<=70711)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<70720){if(70712<=e&&e<=70719)return i.CLUSTER_BREAK.EXTEND}else if(e<70722){if(70720<=e&&e<=70721)return i.CLUSTER_BREAK.SPACINGMARK}else if(70722<=e&&e<=70724)return i.CLUSTER_BREAK.EXTEND}else if(e<70832){if(e<70726){if(e===70725)return i.CLUSTER_BREAK.SPACINGMARK}else if(e===70726||e===70750)return i.CLUSTER_BREAK.EXTEND}else if(e<70833){if(e===70832)return i.CLUSTER_BREAK.EXTEND}else if(e<70835){if(70833<=e&&e<=70834)return i.CLUSTER_BREAK.SPACINGMARK}else if(70835<=e&&e<=70840)return i.CLUSTER_BREAK.EXTEND}else if(e<71096){if(e<70847)if(e<70843){if(e===70841)return i.CLUSTER_BREAK.SPACINGMARK;if(e===70842)return i.CLUSTER_BREAK.EXTEND}else if(e<70845){if(70843<=e&&e<=70844)return i.CLUSTER_BREAK.SPACINGMARK}else{if(e===70845)return i.CLUSTER_BREAK.EXTEND;if(e===70846)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71087){if(e<70849){if(70847<=e&&e<=70848)return i.CLUSTER_BREAK.EXTEND}else if(e<70850){if(e===70849)return i.CLUSTER_BREAK.SPACINGMARK}else if(70850<=e&&e<=70851)return i.CLUSTER_BREAK.EXTEND}else if(e<71088){if(e===71087)return i.CLUSTER_BREAK.EXTEND}else if(e<71090){if(71088<=e&&e<=71089)return i.CLUSTER_BREAK.SPACINGMARK}else if(71090<=e&&e<=71093)return i.CLUSTER_BREAK.EXTEND}else if(e<71216){if(e<71102){if(e<71100){if(71096<=e&&e<=71099)return i.CLUSTER_BREAK.SPACINGMARK}else if(71100<=e&&e<=71101)return i.CLUSTER_BREAK.EXTEND}else if(e<71103){if(e===71102)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71132){if(71103<=e&&e<=71104)return i.CLUSTER_BREAK.EXTEND}else if(71132<=e&&e<=71133)return i.CLUSTER_BREAK.EXTEND}else if(e<71229){if(e<71219){if(71216<=e&&e<=71218)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71227){if(71219<=e&&e<=71226)return i.CLUSTER_BREAK.EXTEND}else if(71227<=e&&e<=71228)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71230){if(e===71229)return i.CLUSTER_BREAK.EXTEND}else if(e<71231){if(e===71230)return i.CLUSTER_BREAK.SPACINGMARK}else if(71231<=e&&e<=71232)return i.CLUSTER_BREAK.EXTEND}else if(e<71999)if(e<71463){if(e<71350){if(e<71341){if(e===71339)return i.CLUSTER_BREAK.EXTEND;if(e===71340)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71342){if(e===71341)return i.CLUSTER_BREAK.EXTEND}else if(e<71344){if(71342<=e&&e<=71343)return i.CLUSTER_BREAK.SPACINGMARK}else if(71344<=e&&e<=71349)return i.CLUSTER_BREAK.EXTEND}else if(e<71453){if(e===71350)return i.CLUSTER_BREAK.SPACINGMARK;if(e===71351)return i.CLUSTER_BREAK.EXTEND}else if(e<71458){if(71453<=e&&e<=71455)return i.CLUSTER_BREAK.EXTEND}else if(e<71462){if(71458<=e&&e<=71461)return i.CLUSTER_BREAK.EXTEND}else if(e===71462)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71984){if(e<71727){if(e<71724){if(71463<=e&&e<=71467)return i.CLUSTER_BREAK.EXTEND}else if(71724<=e&&e<=71726)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71736){if(71727<=e&&e<=71735)return i.CLUSTER_BREAK.EXTEND}else if(e<71737){if(e===71736)return i.CLUSTER_BREAK.SPACINGMARK}else if(71737<=e&&e<=71738)return i.CLUSTER_BREAK.EXTEND}else if(e<71995){if(e<71985){if(e===71984)return i.CLUSTER_BREAK.EXTEND}else if(e<71991){if(71985<=e&&e<=71989)return i.CLUSTER_BREAK.SPACINGMARK}else if(71991<=e&&e<=71992)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<71997){if(71995<=e&&e<=71996)return i.CLUSTER_BREAK.EXTEND}else{if(e===71997)return i.CLUSTER_BREAK.SPACINGMARK;if(e===71998)return i.CLUSTER_BREAK.EXTEND}else if(e<72193)if(e<72145)if(e<72001){if(e===71999)return i.CLUSTER_BREAK.PREPEND;if(e===72e3)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72002){if(e===72001)return i.CLUSTER_BREAK.PREPEND}else{if(e===72002)return i.CLUSTER_BREAK.SPACINGMARK;if(e===72003)return i.CLUSTER_BREAK.EXTEND}else if(e<72156){if(e<72148){if(72145<=e&&e<=72147)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72154){if(72148<=e&&e<=72151)return i.CLUSTER_BREAK.EXTEND}else if(72154<=e&&e<=72155)return i.CLUSTER_BREAK.EXTEND}else if(e<72160){if(72156<=e&&e<=72159)return i.CLUSTER_BREAK.SPACINGMARK}else{if(e===72160)return i.CLUSTER_BREAK.EXTEND;if(e===72164)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72263){if(e<72249){if(e<72243){if(72193<=e&&e<=72202)return i.CLUSTER_BREAK.EXTEND}else if(72243<=e&&e<=72248)return i.CLUSTER_BREAK.EXTEND}else if(e<72250){if(e===72249)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72251){if(e===72250)return i.CLUSTER_BREAK.PREPEND}else if(72251<=e&&e<=72254)return i.CLUSTER_BREAK.EXTEND}else if(e<72281){if(e<72273){if(e===72263)return i.CLUSTER_BREAK.EXTEND}else if(e<72279){if(72273<=e&&e<=72278)return i.CLUSTER_BREAK.EXTEND}else if(72279<=e&&e<=72280)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72324){if(72281<=e&&e<=72283)return i.CLUSTER_BREAK.EXTEND}else if(e<72330){if(72324<=e&&e<=72329)return i.CLUSTER_BREAK.PREPEND}else if(72330<=e&&e<=72342)return i.CLUSTER_BREAK.EXTEND}else if(e<94033){if(e<73104){if(e<72881){if(e<72766){if(e<72751){if(e<72344){if(e===72343)return i.CLUSTER_BREAK.SPACINGMARK}else if(72344<=e&&e<=72345)return i.CLUSTER_BREAK.EXTEND}else if(e<72752){if(e===72751)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<72760){if(72752<=e&&e<=72758)return i.CLUSTER_BREAK.EXTEND}else if(72760<=e&&e<=72765)return i.CLUSTER_BREAK.EXTEND}else if(e<72850){if(e===72766)return i.CLUSTER_BREAK.SPACINGMARK;if(e===72767)return i.CLUSTER_BREAK.EXTEND}else if(e<72873){if(72850<=e&&e<=72871)return i.CLUSTER_BREAK.EXTEND}else if(e<72874){if(e===72873)return i.CLUSTER_BREAK.SPACINGMARK}else if(72874<=e&&e<=72880)return i.CLUSTER_BREAK.EXTEND}else if(e<73018){if(e<72884){if(e<72882){if(e===72881)return i.CLUSTER_BREAK.SPACINGMARK}else if(72882<=e&&e<=72883)return i.CLUSTER_BREAK.EXTEND}else if(e<72885){if(e===72884)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<73009){if(72885<=e&&e<=72886)return i.CLUSTER_BREAK.EXTEND}else if(73009<=e&&e<=73014)return i.CLUSTER_BREAK.EXTEND}else if(e<73030){if(e<73020){if(e===73018)return i.CLUSTER_BREAK.EXTEND}else if(e<73023){if(73020<=e&&e<=73021)return i.CLUSTER_BREAK.EXTEND}else if(73023<=e&&e<=73029)return i.CLUSTER_BREAK.EXTEND}else if(e<73031){if(e===73030)return i.CLUSTER_BREAK.PREPEND}else if(e<73098){if(e===73031)return i.CLUSTER_BREAK.EXTEND}else if(73098<=e&&e<=73102)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<73526){if(e<73459)if(e<73109){if(e<73107){if(73104<=e&&e<=73105)return i.CLUSTER_BREAK.EXTEND}else if(73107<=e&&e<=73108)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<73110){if(e===73109)return i.CLUSTER_BREAK.EXTEND}else{if(e===73110)return i.CLUSTER_BREAK.SPACINGMARK;if(e===73111)return i.CLUSTER_BREAK.EXTEND}else if(e<73474){if(e<73461){if(73459<=e&&e<=73460)return i.CLUSTER_BREAK.EXTEND}else if(e<73472){if(73461<=e&&e<=73462)return i.CLUSTER_BREAK.SPACINGMARK}else if(73472<=e&&e<=73473)return i.CLUSTER_BREAK.EXTEND}else if(e<73475){if(e===73474)return i.CLUSTER_BREAK.PREPEND}else if(e<73524){if(e===73475)return i.CLUSTER_BREAK.SPACINGMARK}else if(73524<=e&&e<=73525)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<78896)if(e<73536){if(e<73534){if(73526<=e&&e<=73530)return i.CLUSTER_BREAK.EXTEND}else if(73534<=e&&e<=73535)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<73537){if(e===73536)return i.CLUSTER_BREAK.EXTEND}else{if(e===73537)return i.CLUSTER_BREAK.SPACINGMARK;if(e===73538)return i.CLUSTER_BREAK.EXTEND}else if(e<92912){if(e<78912){if(78896<=e&&e<=78911)return i.CLUSTER_BREAK.CONTROL}else if(e<78919){if(e===78912)return i.CLUSTER_BREAK.EXTEND}else if(78919<=e&&e<=78933)return i.CLUSTER_BREAK.EXTEND}else if(e<92976){if(92912<=e&&e<=92916)return i.CLUSTER_BREAK.EXTEND}else if(e<94031){if(92976<=e&&e<=92982)return i.CLUSTER_BREAK.EXTEND}else if(e===94031)return i.CLUSTER_BREAK.EXTEND}else if(e<121476){if(e<119143)if(e<113824){if(e<94180){if(e<94095){if(94033<=e&&e<=94087)return i.CLUSTER_BREAK.SPACINGMARK}else if(94095<=e&&e<=94098)return i.CLUSTER_BREAK.EXTEND}else if(e<94192){if(e===94180)return i.CLUSTER_BREAK.EXTEND}else if(e<113821){if(94192<=e&&e<=94193)return i.CLUSTER_BREAK.SPACINGMARK}else if(113821<=e&&e<=113822)return i.CLUSTER_BREAK.EXTEND}else if(e<118576){if(e<118528){if(113824<=e&&e<=113827)return i.CLUSTER_BREAK.CONTROL}else if(118528<=e&&e<=118573)return i.CLUSTER_BREAK.EXTEND}else if(e<119141){if(118576<=e&&e<=118598)return i.CLUSTER_BREAK.EXTEND}else{if(e===119141)return i.CLUSTER_BREAK.EXTEND;if(e===119142)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<119173){if(e<119150){if(e<119149){if(119143<=e&&e<=119145)return i.CLUSTER_BREAK.EXTEND}else if(e===119149)return i.CLUSTER_BREAK.SPACINGMARK}else if(e<119155){if(119150<=e&&e<=119154)return i.CLUSTER_BREAK.EXTEND}else if(e<119163){if(119155<=e&&e<=119162)return i.CLUSTER_BREAK.CONTROL}else if(119163<=e&&e<=119170)return i.CLUSTER_BREAK.EXTEND}else if(e<121344){if(e<119210){if(119173<=e&&e<=119179)return i.CLUSTER_BREAK.EXTEND}else if(e<119362){if(119210<=e&&e<=119213)return i.CLUSTER_BREAK.EXTEND}else if(119362<=e&&e<=119364)return i.CLUSTER_BREAK.EXTEND}else if(e<121403){if(121344<=e&&e<=121398)return i.CLUSTER_BREAK.EXTEND}else if(e<121461){if(121403<=e&&e<=121452)return i.CLUSTER_BREAK.EXTEND}else if(e===121461)return i.CLUSTER_BREAK.EXTEND}else if(e<123628){if(e<122907){if(e<121505){if(e<121499){if(e===121476)return i.CLUSTER_BREAK.EXTEND}else if(121499<=e&&e<=121503)return i.CLUSTER_BREAK.EXTEND}else if(e<122880){if(121505<=e&&e<=121519)return i.CLUSTER_BREAK.EXTEND}else if(e<122888){if(122880<=e&&e<=122886)return i.CLUSTER_BREAK.EXTEND}else if(122888<=e&&e<=122904)return i.CLUSTER_BREAK.EXTEND}else if(e<123023){if(e<122915){if(122907<=e&&e<=122913)return i.CLUSTER_BREAK.EXTEND}else if(e<122918){if(122915<=e&&e<=122916)return i.CLUSTER_BREAK.EXTEND}else if(122918<=e&&e<=122922)return i.CLUSTER_BREAK.EXTEND}else if(e<123184){if(e===123023)return i.CLUSTER_BREAK.EXTEND}else if(e<123566){if(123184<=e&&e<=123190)return i.CLUSTER_BREAK.EXTEND}else if(e===123566)return i.CLUSTER_BREAK.EXTEND}else if(e<127995){if(e<125136){if(e<124140){if(123628<=e&&e<=123631)return i.CLUSTER_BREAK.EXTEND}else if(124140<=e&&e<=124143)return i.CLUSTER_BREAK.EXTEND}else if(e<125252){if(125136<=e&&e<=125142)return i.CLUSTER_BREAK.EXTEND}else if(e<127462){if(125252<=e&&e<=125258)return i.CLUSTER_BREAK.EXTEND}else if(127462<=e&&e<=127487)return i.CLUSTER_BREAK.REGIONAL_INDICATOR}else if(e<917632){if(e<917504){if(127995<=e&&e<=127999)return i.CLUSTER_BREAK.EXTEND}else if(e<917536){if(917504<=e&&e<=917535)return i.CLUSTER_BREAK.CONTROL}else if(917536<=e&&e<=917631)return i.CLUSTER_BREAK.EXTEND}else if(e<917760){if(917632<=e&&e<=917759)return i.CLUSTER_BREAK.CONTROL}else if(e<918e3){if(917760<=e&&e<=917999)return i.CLUSTER_BREAK.EXTEND}else if(918e3<=e&&e<=921599)return i.CLUSTER_BREAK.CONTROL;return i.CLUSTER_BREAK.OTHER}static getEmojiProperty(e){if(e<10160){if(e<9728){if(e<9e3){if(e<8482){if(e<8252){if(e===169||e===174)return i.EXTENDED_PICTOGRAPHIC}else if(e===8252||e===8265)return i.EXTENDED_PICTOGRAPHIC}else if(e<8596){if(e===8482||e===8505)return i.EXTENDED_PICTOGRAPHIC}else if(e<8617){if(8596<=e&&e<=8601)return i.EXTENDED_PICTOGRAPHIC}else if(e<8986){if(8617<=e&&e<=8618)return i.EXTENDED_PICTOGRAPHIC}else if(8986<=e&&e<=8987)return i.EXTENDED_PICTOGRAPHIC}else if(e<9410){if(e<9167){if(e===9e3||e===9096)return i.EXTENDED_PICTOGRAPHIC}else if(e<9193){if(e===9167)return i.EXTENDED_PICTOGRAPHIC}else if(e<9208){if(9193<=e&&e<=9203)return i.EXTENDED_PICTOGRAPHIC}else if(9208<=e&&e<=9210)return i.EXTENDED_PICTOGRAPHIC}else if(e<9654){if(e<9642){if(e===9410)return i.EXTENDED_PICTOGRAPHIC}else if(9642<=e&&e<=9643)return i.EXTENDED_PICTOGRAPHIC}else if(e<9664){if(e===9654)return i.EXTENDED_PICTOGRAPHIC}else if(e<9723){if(e===9664)return i.EXTENDED_PICTOGRAPHIC}else if(9723<=e&&e<=9726)return i.EXTENDED_PICTOGRAPHIC}else if(e<10035){if(e<10004){if(e<9748){if(e<9735){if(9728<=e&&e<=9733)return i.EXTENDED_PICTOGRAPHIC}else if(9735<=e&&e<=9746)return i.EXTENDED_PICTOGRAPHIC}else if(e<9872){if(9748<=e&&e<=9861)return i.EXTENDED_PICTOGRAPHIC}else if(e<9992){if(9872<=e&&e<=9989)return i.EXTENDED_PICTOGRAPHIC}else if(9992<=e&&e<=10002)return i.EXTENDED_PICTOGRAPHIC}else if(e<10013){if(e===10004||e===10006)return i.EXTENDED_PICTOGRAPHIC}else if(e<10017){if(e===10013)return i.EXTENDED_PICTOGRAPHIC}else if(e===10017||e===10024)return i.EXTENDED_PICTOGRAPHIC}else if(e<10067){if(e<10055){if(e<10052){if(10035<=e&&e<=10036)return i.EXTENDED_PICTOGRAPHIC}else if(e===10052)return i.EXTENDED_PICTOGRAPHIC}else if(e<10060){if(e===10055)return i.EXTENDED_PICTOGRAPHIC}else if(e===10060||e===10062)return i.EXTENDED_PICTOGRAPHIC}else if(e<10083){if(e<10071){if(10067<=e&&e<=10069)return i.EXTENDED_PICTOGRAPHIC}else if(e===10071)return i.EXTENDED_PICTOGRAPHIC}else if(e<10133){if(10083<=e&&e<=10087)return i.EXTENDED_PICTOGRAPHIC}else if(e<10145){if(10133<=e&&e<=10135)return i.EXTENDED_PICTOGRAPHIC}else if(e===10145)return i.EXTENDED_PICTOGRAPHIC}else if(e<127489){if(e<12951){if(e<11035){if(e<10548){if(e===10160||e===10175)return i.EXTENDED_PICTOGRAPHIC}else if(e<11013){if(10548<=e&&e<=10549)return i.EXTENDED_PICTOGRAPHIC}else if(11013<=e&&e<=11015)return i.EXTENDED_PICTOGRAPHIC}else if(e<11093){if(e<11088){if(11035<=e&&e<=11036)return i.EXTENDED_PICTOGRAPHIC}else if(e===11088)return i.EXTENDED_PICTOGRAPHIC}else if(e<12336){if(e===11093)return i.EXTENDED_PICTOGRAPHIC}else if(e===12336||e===12349)return i.EXTENDED_PICTOGRAPHIC}else if(e<127340){if(e<126976){if(e===12951||e===12953)return i.EXTENDED_PICTOGRAPHIC}else if(e<127245){if(126976<=e&&e<=127231)return i.EXTENDED_PICTOGRAPHIC}else if(e<127279){if(127245<=e&&e<=127247)return i.EXTENDED_PICTOGRAPHIC}else if(e===127279)return i.EXTENDED_PICTOGRAPHIC}else if(e<127374){if(e<127358){if(127340<=e&&e<=127345)return i.EXTENDED_PICTOGRAPHIC}else if(127358<=e&&e<=127359)return i.EXTENDED_PICTOGRAPHIC}else if(e<127377){if(e===127374)return i.EXTENDED_PICTOGRAPHIC}else if(e<127405){if(127377<=e&&e<=127386)return i.EXTENDED_PICTOGRAPHIC}else if(127405<=e&&e<=127461)return i.EXTENDED_PICTOGRAPHIC}else if(e<128981){if(e<127561){if(e<127535){if(e<127514){if(127489<=e&&e<=127503)return i.EXTENDED_PICTOGRAPHIC}else if(e===127514)return i.EXTENDED_PICTOGRAPHIC}else if(e<127538){if(e===127535)return i.EXTENDED_PICTOGRAPHIC}else if(e<127548){if(127538<=e&&e<=127546)return i.EXTENDED_PICTOGRAPHIC}else if(127548<=e&&e<=127551)return i.EXTENDED_PICTOGRAPHIC}else if(e<128326){if(e<128e3){if(127561<=e&&e<=127994)return i.EXTENDED_PICTOGRAPHIC}else if(128e3<=e&&e<=128317)return i.EXTENDED_PICTOGRAPHIC}else if(e<128640){if(128326<=e&&e<=128591)return i.EXTENDED_PICTOGRAPHIC}else if(e<128884){if(128640<=e&&e<=128767)return i.EXTENDED_PICTOGRAPHIC}else if(128884<=e&&e<=128895)return i.EXTENDED_PICTOGRAPHIC}else if(e<129198){if(e<129096){if(e<129036){if(128981<=e&&e<=129023)return i.EXTENDED_PICTOGRAPHIC}else if(129036<=e&&e<=129039)return i.EXTENDED_PICTOGRAPHIC}else if(e<129114){if(129096<=e&&e<=129103)return i.EXTENDED_PICTOGRAPHIC}else if(e<129160){if(129114<=e&&e<=129119)return i.EXTENDED_PICTOGRAPHIC}else if(129160<=e&&e<=129167)return i.EXTENDED_PICTOGRAPHIC}else if(e<129340){if(e<129292){if(129198<=e&&e<=129279)return i.EXTENDED_PICTOGRAPHIC}else if(129292<=e&&e<=129338)return i.EXTENDED_PICTOGRAPHIC}else if(e<129351){if(129340<=e&&e<=129349)return i.EXTENDED_PICTOGRAPHIC}else if(e<130048){if(129351<=e&&e<=129791)return i.EXTENDED_PICTOGRAPHIC}else if(130048<=e&&e<=131069)return i.EXTENDED_PICTOGRAPHIC;return i.CLUSTER_BREAK.OTHER}};return tp.default=d,tp}var eS;function L6(){if(eS)return ep;eS=1;var r=ep&&ep.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ep,"__esModule",{value:!0});const i=r(P6());return ep.default=i.default,ep}var tS;function D6(){if(tS)return Ki;tS=1;var r=Ki&&Ki.__createBinding||(Object.create?(function(k,B,F,K){K===void 0&&(K=F);var U=Object.getOwnPropertyDescriptor(B,F);(!U||("get"in U?!B.__esModule:U.writable||U.configurable))&&(U={enumerable:!0,get:function(){return B[F]}}),Object.defineProperty(k,K,U)}):(function(k,B,F,K){K===void 0&&(K=F),k[K]=B[F]})),i=Ki&&Ki.__setModuleDefault||(Object.create?(function(k,B){Object.defineProperty(k,"default",{enumerable:!0,value:B})}):function(k,B){k.default=B}),s=Ki&&Ki.__importStar||(function(){var k=function(B){return k=Object.getOwnPropertyNames||function(F){var K=[];for(var U in F)Object.prototype.hasOwnProperty.call(F,U)&&(K[K.length]=U);return K},k(B)};return function(B){if(B&&B.__esModule)return B;var F={};if(B!=null)for(var K=k(B),U=0;U<K.length;U++)K[U]!=="default"&&r(F,B,K[U]);return i(F,B),F}})(),c=Ki&&Ki.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.validateLanguage=Ki.parseLanguage=Ki.b64UrlToUtf8=Ki.utf8ToB64Url=Ki.graphemeLen=Ki.utf8Len=void 0;const d=c(L6()),m=s(fM),e=k=>new TextEncoder().encode(k).byteLength;Ki.utf8Len=e;const a=k=>new d.default().countGraphemes(k);Ki.graphemeLen=a;const g=k=>m.toString(m.fromString(k,"utf8"),"base64url");Ki.utf8ToB64Url=g;const w=k=>m.toString(m.fromString(k,"base64url"),"utf8");Ki.b64UrlToUtf8=w;const R=k=>{const B=k.match(D);if(!B?.groups)return null;const F=B.groups;return{grandfathered:F.grandfathered,language:F.language,extlang:F.extlang,script:F.script,region:F.region,variant:F.variant,extension:F.extension,privateUse:F.privateUseA||F.privateUseB}};Ki.parseLanguage=R;const S=k=>D.test(k);Ki.validateLanguage=S;const D=/^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUseA>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUseB>x(-[A-Za-z0-9]{1,8})+))$/;return Ki}var Yx={},rS;function I6(){return rS||(rS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.didDocument=r.getServiceEndpoint=r.getNotifEndpoint=r.getFeedGenEndpoint=r.getPdsEndpoint=r.getSigningDidKey=r.getVerificationMaterial=r.getSigningKey=r.getHandle=r.getDid=r.isValidDidDoc=void 0;const i=Fc(),s=U=>r.didDocument.safeParse(U).success;r.isValidDidDoc=s;const c=U=>{const ee=U.id;if(typeof ee!="string")throw new Error("No `id` on document");return ee};r.getDid=c;const d=U=>{const ee=U.alsoKnownAs;if(ee)for(let le=0;le<ee.length;le++){const Q=ee[le];if(Q.startsWith("at://"))return Q.slice(5)}};r.getHandle=d;const m=U=>(0,r.getVerificationMaterial)(U,"atproto");r.getSigningKey=m;const e=(U,ee)=>{const le=D(U,"verificationMethod",`#${ee}`);if(le&&le.publicKeyMultibase)return{type:le.type,publicKeyMultibase:le.publicKeyMultibase}};r.getVerificationMaterial=e;const a=U=>{const ee=(0,r.getSigningKey)(U);if(ee)return`did:key:${ee.publicKeyMultibase}`};r.getSigningDidKey=a;const g=U=>(0,r.getServiceEndpoint)(U,{id:"#atproto_pds",type:"AtprotoPersonalDataServer"});r.getPdsEndpoint=g;const w=U=>(0,r.getServiceEndpoint)(U,{id:"#bsky_fg",type:"BskyFeedGenerator"});r.getFeedGenEndpoint=w;const R=U=>(0,r.getServiceEndpoint)(U,{id:"#bsky_notif",type:"BskyNotificationService"});r.getNotifEndpoint=R;const S=(U,ee)=>{const le=D(U,"service",ee.id);if(le&&!(ee.type&&le.type!==ee.type)&&typeof le.serviceEndpoint=="string")return k(le.serviceEndpoint)};r.getServiceEndpoint=S;function D(U,ee,le){const Q=U[ee];if(Q)for(let Te=0;Te<Q.length;Te++){const pe=Q[Te],_e=pe.id;if(_e[0]==="#"?_e===le:_e.length===U.id.length+le.length&&_e[U.id.length]==="#"&&_e.endsWith(le)&&_e.startsWith(U.id))return pe}}const k=U=>{if(!(!U.startsWith("http://")&&!U.startsWith("https://"))&&B(U))return U},B=URL.canParse??(U=>{try{return new URL(U),!0}catch{return!1}}),F=i.z.object({id:i.z.string(),type:i.z.string(),controller:i.z.string(),publicKeyMultibase:i.z.string().optional()}),K=i.z.object({id:i.z.string(),type:i.z.string(),serviceEndpoint:i.z.union([i.z.string(),i.z.record(i.z.unknown())])});r.didDocument=i.z.object({id:i.z.string(),alsoKnownAs:i.z.array(i.z.string()).optional(),verificationMethod:i.z.array(F).optional(),service:i.z.array(K).optional()})})(Yx)),Yx}var iS;function fl(){return iS||(iS=1,(function(r){var i=zo&&zo.__createBinding||(Object.create?(function(m,e,a,g){g===void 0&&(g=a);var w=Object.getOwnPropertyDescriptor(e,a);(!w||("get"in w?!e.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(m,g,w)}):(function(m,e,a,g){g===void 0&&(g=a),m[g]=e[a]})),s=zo&&zo.__setModuleDefault||(Object.create?(function(m,e){Object.defineProperty(m,"default",{enumerable:!0,value:e})}):function(m,e){m.default=e}),c=zo&&zo.__importStar||(function(){var m=function(e){return m=Object.getOwnPropertyNames||function(a){var g=[];for(var w in a)Object.prototype.hasOwnProperty.call(a,w)&&(g[g.length]=w);return g},m(e)};return function(e){if(e&&e.__esModule)return e;var a={};if(e!=null)for(var g=m(e),w=0;w<g.length;w++)g[w]!=="default"&&i(a,e,g[w]);return s(a,e),a}})(),d=zo&&zo.__exportStar||function(m,e){for(var a in m)a!=="default"&&!Object.prototype.hasOwnProperty.call(e,a)&&i(e,m,a)};Object.defineProperty(r,"__esModule",{value:!0}),r.util=r.check=void 0,r.check=c($F()),r.util=c(Km()),d(ZF(),r),d(HF(),r),d(Km(),r),d(XF(),r),d(A6(),r),d(R6(),r),d(S6(),r),d(T6(),r),d(D6(),r),d(I6(),r)})(zo)),zo}var nc={},Jx={},nS;function mM(){return nS||(nS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DisallowedDomainError=r.UnsupportedDomainError=r.ReservedHandleError=r.InvalidHandleError=r.isValidTld=r.isValidHandle=r.normalizeAndEnsureValidHandle=r.normalizeHandle=r.ensureValidHandleRegex=r.ensureValidHandle=r.DISALLOWED_TLDS=r.INVALID_HANDLE=void 0,r.INVALID_HANDLE="handle.invalid",r.DISALLOWED_TLDS=[".local",".arpa",".invalid",".localhost",".internal",".example",".alt",".onion"];const i=S=>{if(!/^[a-zA-Z0-9.-]*$/.test(S))throw new a("Disallowed characters in handle (ASCII letters, digits, dashes, periods only)");if(S.length>253)throw new a("Handle is too long (253 chars max)");const D=S.split(".");if(D.length<2)throw new a("Handle domain needs at least two parts");for(let k=0;k<D.length;k++){const B=D[k];if(B.length<1)throw new a("Handle parts can not be empty");if(B.length>63)throw new a("Handle part too long (max 63 chars)");if(B.endsWith("-")||B.startsWith("-"))throw new a("Handle parts can not start or end with hyphens");if(k+1===D.length&&!/^[a-zA-Z]/.test(B))throw new a("Handle final component (TLD) must start with ASCII letter")}};r.ensureValidHandle=i;const s=S=>{if(!/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$/.test(S))throw new a("Handle didn't validate via regex");if(S.length>253)throw new a("Handle is too long (253 chars max)")};r.ensureValidHandleRegex=s;const c=S=>S.toLowerCase();r.normalizeHandle=c;const d=S=>{const D=(0,r.normalizeHandle)(S);return(0,r.ensureValidHandle)(D),D};r.normalizeAndEnsureValidHandle=d;const m=S=>{try{(0,r.ensureValidHandle)(S)}catch(D){if(D instanceof a)return!1;throw D}return!0};r.isValidHandle=m;const e=S=>!r.DISALLOWED_TLDS.some(D=>S.endsWith(D));r.isValidTld=e;class a extends Error{}r.InvalidHandleError=a;class g extends Error{}r.ReservedHandleError=g;class w extends Error{}r.UnsupportedDomainError=w;class R extends Error{}r.DisallowedDomainError=R})(Jx)),Jx}var Ya={},sS;function yM(){if(sS)return Ya;sS=1,Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.InvalidDidError=Ya.ensureValidDidRegex=Ya.ensureValidDid=void 0;const r=c=>{if(!c.startsWith("did:"))throw new s('DID requires "did:" prefix');if(!/^[a-zA-Z0-9._:%-]*$/.test(c))throw new s("Disallowed characters in DID (ASCII letters, digits, and a couple other characters only)");const{length:d,1:m}=c.split(":");if(d<3)throw new s("DID requires prefix, method, and method-specific content");if(!/^[a-z]+$/.test(m))throw new s("DID method must be lower-case letters");if(c.endsWith(":")||c.endsWith("%"))throw new s('DID can not end with ":" or "%"');if(c.length>2*1024)throw new s("DID is too long (2048 chars max)")};Ya.ensureValidDid=r;const i=c=>{if(!/^did:[a-z]+:[a-zA-Z0-9._:%-]*[a-zA-Z0-9._-]$/.test(c))throw new s("DID didn't validate via regex");if(c.length>2*1024)throw new s("DID is too long (2048 chars max)")};Ya.ensureValidDidRegex=i;class s extends Error{}return Ya.InvalidDidError=s,Ya}var Zs={},oS;function gM(){if(oS)return Zs;oS=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.InvalidNsidError=Zs.NSID=void 0,Zs.ensureValidNsid=i,Zs.parseNsid=s,Zs.isValidNsid=c,Zs.validateNsid=d,Zs.ensureValidNsidRegex=R,Zs.validateNsidRegex=S;class r{static parse(B){return new r(B)}static create(B,F){const K=[...B.split(".").reverse(),F].join(".");return new r(K)}static isValid(B){return c(B)}static from(B){return B instanceof r?B:Array.isArray(B)?new r(B.join(".")):new r(String(B))}constructor(B){Object.defineProperty(this,"segments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.segments=s(B)}get authority(){return this.segments.slice(0,this.segments.length-1).reverse().join(".")}get name(){return this.segments.at(this.segments.length-1)}toString(){return this.segments.join(".")}}Zs.NSID=r;function i(k){const B=d(k);if(!B.success)throw new D(B.message)}function s(k){const B=d(k);if(!B.success)throw new D(B.message);return B.value}function c(k){return S(k).success}function d(k){if(k.length>317)return{success:!1,message:"NSID is too long (317 chars max)"};if(m(k))return{success:!1,message:"Disallowed characters in NSID (ASCII letters, digits, dashes, periods only)"};const B=k.split(".");if(B.length<3)return{success:!1,message:"NSID needs at least three parts"};for(const F of B){if(F.length<1)return{success:!1,message:"NSID parts can not be empty"};if(F.length>63)return{success:!1,message:"NSID part too long (max 63 chars)"};if(a(F)||g(F))return{success:!1,message:"NSID parts can not start or end with hyphen"}}return e(B[0])?{success:!1,message:"NSID first part may not start with a digit"}:w(B[B.length-1])?{success:!0,value:B}:{success:!1,message:"NSID name part must be only letters and digits (and no leading digit)"}}function m(k){return!/^[a-zA-Z0-9.-]*$/.test(k)}function e(k){const B=k.charCodeAt(0);return B>=48&&B<=57}function a(k){return k.charCodeAt(0)===45}function g(k){return k.charCodeAt(k.length-1)===45}function w(k){return!e(k)&&!k.includes("-")}function R(k){const B=S(k);if(!B.success)throw new D(B.message)}function S(k){return k.length>317?{success:!1,message:"NSID is too long (317 chars max)"}:/^[a-zA-Z](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?:\.[a-zA-Z](?:[a-zA-Z0-9]{0,62})?)$/.test(k)?{success:!0,value:k}:{success:!1,message:"NSID didn't validate via regex"}}class D extends Error{}return Zs.InvalidNsidError=D,Zs}var sc={},oc={},aS;function B6(){if(aS)return oc;aS=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.ensureValidAtUriRegex=oc.ensureValidAtUri=void 0;const r=yM(),i=mM(),s=gM(),c=m=>{const e=m.split("#");if(e.length>2)throw new Error('ATURI can have at most one "#", separating fragment out');const a=e[1]||null;if(m=e[0],!/^[a-zA-Z0-9._~:@!$&')(*+,;=%/-]*$/.test(m))throw new Error("Disallowed characters in ATURI (ASCII)");const g=m.split("/");if(g.length>=3&&(g[0]!=="at:"||g[1].length!==0))throw new Error('ATURI must start with "at://"');if(g.length<3)throw new Error("ATURI requires at least method and authority sections");try{g[2].startsWith("did:")?(0,r.ensureValidDid)(g[2]):(0,i.ensureValidHandle)(g[2])}catch{throw new Error("ATURI authority must be a valid handle or DID")}if(g.length>=4){if(g[3].length===0)throw new Error("ATURI can not have a slash after authority without a path segment");if(!(0,s.isValidNsid)(g[3]))throw new Error("ATURI requires first path segment (if supplied) to be valid NSID")}if(g.length>=5&&g[4].length===0)throw new Error("ATURI can not have a slash after collection, unless record key is provided");if(g.length>=6)throw new Error("ATURI path can have at most two parts, and no trailing slash");if(e.length>=2&&a==null)throw new Error("ATURI fragment must be non-empty and start with slash");if(a!=null){if(a.length===0||a[0]!=="/")throw new Error("ATURI fragment must be non-empty and start with slash");if(!/^\/[a-zA-Z0-9._~:@!$&')(*+,;=%[\]/-]*$/.test(a))throw new Error("Disallowed characters in ATURI fragment (ASCII)")}if(m.length>8*1024)throw new Error("ATURI is far too long")};oc.ensureValidAtUri=c;const d=m=>{const e=/^at:\/\/(?<authority>[a-zA-Z0-9._:%-]+)(\/(?<collection>[a-zA-Z0-9-.]+)(\/(?<rkey>[a-zA-Z0-9._~:@!$&%')(*+,;=-]+))?)?(#(?<fragment>\/[a-zA-Z0-9._~:@!$&%')(*+,;=\-[\]/\\]*))?$/,a=m.match(e);if(!a||!a.groups)throw new Error("ATURI didn't validate via regex");const g=a.groups;try{(0,i.ensureValidHandleRegex)(g.authority)}catch{try{(0,r.ensureValidDidRegex)(g.authority)}catch{throw new Error("ATURI authority must be a valid handle or DID")}}if(g.collection&&!(0,s.isValidNsid)(g.collection))throw new Error("ATURI collection path segment must be a valid NSID");if(m.length>8*1024)throw new Error("ATURI is far too long")};return oc.ensureValidAtUriRegex=d,oc}var lS;function M6(){return lS||(lS=1,(function(r){var i=sc&&sc.__createBinding||(Object.create?(function(a,g,w,R){R===void 0&&(R=w);var S=Object.getOwnPropertyDescriptor(g,w);(!S||("get"in S?!g.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return g[w]}}),Object.defineProperty(a,R,S)}):(function(a,g,w,R){R===void 0&&(R=w),a[R]=g[w]})),s=sc&&sc.__exportStar||function(a,g){for(var w in a)w!=="default"&&!Object.prototype.hasOwnProperty.call(g,w)&&i(g,a,w)};Object.defineProperty(r,"__esModule",{value:!0}),r.AtUri=r.ATP_URI_REGEX=void 0,s(B6(),r),r.ATP_URI_REGEX=/^(at:\/\/)?((?:did:[a-z0-9:%-]+)|(?:[a-z0-9][a-z0-9.:-]*))(\/[^?#\s]*)?(\?[^#\s]+)?(#[^\s]+)?$/i;const c=/^(\/[^?#\s]*)?(\?[^#\s]+)?(#[^\s]+)?$/i;class d{constructor(g,w){Object.defineProperty(this,"hash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"host",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pathname",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"searchParams",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let R;if(w){if(R=m(w),!R)throw new Error(`Invalid at uri: ${w}`);const S=e(g);if(!S)throw new Error(`Invalid path: ${g}`);Object.assign(R,S)}else if(R=m(g),!R)throw new Error(`Invalid at uri: ${g}`);this.hash=R.hash,this.host=R.host,this.pathname=R.pathname,this.searchParams=R.searchParams}static make(g,w,R){let S=g;return w&&(S+="/"+w),R&&(S+="/"+R),new d(S)}get protocol(){return"at:"}get origin(){return`at://${this.host}`}get hostname(){return this.host}set hostname(g){this.host=g}get search(){return this.searchParams.toString()}set search(g){this.searchParams=new URLSearchParams(g)}get collection(){return this.pathname.split("/").filter(Boolean)[0]||""}set collection(g){const w=this.pathname.split("/").filter(Boolean);w[0]=g,this.pathname=w.join("/")}get rkey(){return this.pathname.split("/").filter(Boolean)[1]||""}set rkey(g){const w=this.pathname.split("/").filter(Boolean);w[0]||(w[0]="undefined"),w[1]=g,this.pathname=w.join("/")}get href(){return this.toString()}toString(){let g=this.pathname||"/";g.startsWith("/")||(g=`/${g}`);let w=this.searchParams.toString();w&&!w.startsWith("?")&&(w=`?${w}`);let R=this.hash;return R&&!R.startsWith("#")&&(R=`#${R}`),`at://${this.host}${g}${w}${R}`}}r.AtUri=d;function m(a){const g=r.ATP_URI_REGEX.exec(a);if(g)return{hash:g[5]||"",host:g[2]||"",pathname:g[3]||"",searchParams:new URLSearchParams(g[4]||"")}}function e(a){const g=c.exec(a);if(g)return{hash:g[3]||"",pathname:g[1]||"",searchParams:new URLSearchParams(g[2]||"")}}})(sc)),sc}var Ja={},uS;function z6(){if(uS)return Ja;uS=1,Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.InvalidTidError=Ja.isValidTid=Ja.ensureValidTid=void 0;const r=13,i=/^[234567abcdefghij][234567abcdefghijklmnopqrstuvwxyz]{12}$/,s=m=>{if(m.length!==r)throw new d(`TID must be ${r} characters`);if(!i.test(m))throw new d("TID syntax not valid (regex)")};Ja.ensureValidTid=s;const c=m=>m.length===r&&i.test(m);Ja.isValidTid=c;class d extends Error{}return Ja.InvalidTidError=d,Ja}var Qx={},cS;function O6(){return cS||(cS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.InvalidRecordKeyError=r.isValidRecordKey=r.ensureValidRecordKey=void 0;const i=d=>{if(d.length>512||d.length<1)throw new c("record key must be 1 to 512 characters");if(!/^[a-zA-Z0-9_~.:-]{1,512}$/.test(d))throw new c("record key syntax not valid (regex)");if(d==="."||d==="..")throw new c('record key can not be "." or ".."')};r.ensureValidRecordKey=i;const s=d=>{try{(0,r.ensureValidRecordKey)(d)}catch(m){if(m instanceof c)return!1;throw m}return!0};r.isValidRecordKey=s;class c extends Error{}r.InvalidRecordKeyError=c})(Qx)),Qx}var e1={},dS;function V6(){return dS||(dS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.InvalidDatetimeError=r.normalizeDatetimeAlways=r.normalizeDatetime=r.isValidDatetime=r.ensureValidDatetime=void 0;const i=e=>{const a=new Date(e);if(isNaN(a.getTime()))throw new m("datetime did not parse as ISO 8601");if(a.toISOString().startsWith("-"))throw new m("datetime normalized to a negative time");if(!/^[0-9]{4}-[01][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](.[0-9]{1,20})?(Z|([+-][0-2][0-9]:[0-5][0-9]))$/.test(e))throw new m("datetime didn't validate via regex");if(e.length>64)throw new m("datetime is too long (64 chars max)");if(e.endsWith("-00:00"))throw new m('datetime can not use "-00:00" for UTC timezone');if(e.startsWith("000"))throw new m("datetime so close to year zero not allowed")};r.ensureValidDatetime=i;const s=e=>{try{(0,r.ensureValidDatetime)(e)}catch(a){if(a instanceof m)return!1;throw a}return!0};r.isValidDatetime=s;const c=e=>{if((0,r.isValidDatetime)(e)){const w=new Date(e).toISOString();if((0,r.isValidDatetime)(w))return w}if(!/.*(([+-]\d\d:?\d\d)|[a-zA-Z])$/.test(e)){const w=new Date(e+"Z");if(!isNaN(w.getTime())){const R=w.toISOString();if((0,r.isValidDatetime)(R))return R}}const a=new Date(e);if(isNaN(a.getTime()))throw new m("datetime did not parse as any timestamp format");const g=a.toISOString();if((0,r.isValidDatetime)(g))return g;throw new m("datetime normalized to invalid timestamp string")};r.normalizeDatetime=c;const d=e=>{try{return(0,r.normalizeDatetime)(e)}catch(a){if(a instanceof m)return new Date(0).toISOString();throw a}};r.normalizeDatetimeAlways=d;class m extends Error{}r.InvalidDatetimeError=m})(e1)),e1}var pS;function Rf(){return pS||(pS=1,(function(r){var i=nc&&nc.__createBinding||(Object.create?(function(c,d,m,e){e===void 0&&(e=m);var a=Object.getOwnPropertyDescriptor(d,m);(!a||("get"in a?!d.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return d[m]}}),Object.defineProperty(c,e,a)}):(function(c,d,m,e){e===void 0&&(e=m),c[e]=d[m]})),s=nc&&nc.__exportStar||function(c,d){for(var m in c)m!=="default"&&!Object.prototype.hasOwnProperty.call(d,m)&&i(d,c,m)};Object.defineProperty(r,"__esModule",{value:!0}),s(mM(),r),s(yM(),r),s(gM(),r),s(M6(),r),s(z6(),r),s(O6(),r),s(V6(),r)})(nc)),nc}var Fh={},fS;function Iw(){if(fS)return Fh;fS=1,Object.defineProperty(Fh,"__esModule",{value:!0}),Fh.toLexUri=i,Fh.requiredPropertiesRefinement=s;const r=Fc();function i(c,d){if(c.split("#").length>2)throw new Error("Uri can only have one hash segment");if(c.startsWith("lex:"))return c;if(c.startsWith("#")){if(!d)throw new Error(`Unable to resolve uri without anchor: ${c}`);return`${d}${c}`}return`lex:${c}`}function s(c,d){if(c.required!==void 0){if(!Array.isArray(c.required)){d.addIssue({code:r.z.ZodIssueCode.invalid_type,received:typeof c.required,expected:"array"});return}if(c.properties===void 0){c.required.length>0&&d.addIssue({code:r.z.ZodIssueCode.custom,message:"Required fields defined but no properties defined"});return}for(const m of c.required)c.properties[m]===void 0&&d.addIssue({code:r.z.ZodIssueCode.custom,message:`Required field "${m}" not defined`})}}return Fh}var hS;function qc(){return hS||(hS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.LexiconDefNotFoundError=r.InvalidLexiconError=r.ValidationError=r.lexiconDoc=r.lexUserType=r.lexRecord=r.lexXrpcSubscription=r.lexXrpcProcedure=r.lexXrpcQuery=r.lexXrpcError=r.lexXrpcSubscriptionMessage=r.lexXrpcBody=r.lexXrpcParameters=r.lexPermissionSet=r.lexObject=r.lexToken=r.lexPrimitiveArray=r.lexArray=r.lexBlob=r.lexRefVariant=r.lexRefUnion=r.lexRef=r.lexIpldType=r.lexCidLink=r.lexBytes=r.lexPrimitive=r.lexUnknown=r.lexString=r.lexStringFormat=r.lexInteger=r.lexBoolean=r.lexLang=r.languageSchema=void 0,r.isValidLexiconDoc=e,r.isObj=a,r.isDiscriminatedObject=g,r.parseLexiconDoc=w;const i=Fc(),s=fl(),c=Rf(),d=Iw();r.languageSchema=i.z.string().refine(s.validateLanguage,"Invalid BCP47 language tag"),r.lexLang=i.z.record(r.languageSchema,i.z.string().optional()),r.lexBoolean=i.z.object({type:i.z.literal("boolean"),description:i.z.string().optional(),default:i.z.boolean().optional(),const:i.z.boolean().optional()}),r.lexInteger=i.z.object({type:i.z.literal("integer"),description:i.z.string().optional(),default:i.z.number().int().optional(),minimum:i.z.number().int().optional(),maximum:i.z.number().int().optional(),enum:i.z.number().int().array().optional(),const:i.z.number().int().optional()}),r.lexStringFormat=i.z.enum(["datetime","uri","at-uri","did","handle","at-identifier","nsid","cid","language","tid","record-key"]),r.lexString=i.z.object({type:i.z.literal("string"),format:r.lexStringFormat.optional(),description:i.z.string().optional(),default:i.z.string().optional(),minLength:i.z.number().int().optional(),maxLength:i.z.number().int().optional(),minGraphemes:i.z.number().int().optional(),maxGraphemes:i.z.number().int().optional(),enum:i.z.string().array().optional(),const:i.z.string().optional(),knownValues:i.z.string().array().optional()}),r.lexUnknown=i.z.object({type:i.z.literal("unknown"),description:i.z.string().optional()}),r.lexPrimitive=i.z.discriminatedUnion("type",[r.lexBoolean,r.lexInteger,r.lexString,r.lexUnknown]),r.lexBytes=i.z.object({type:i.z.literal("bytes"),description:i.z.string().optional(),maxLength:i.z.number().optional(),minLength:i.z.number().optional()}),r.lexCidLink=i.z.object({type:i.z.literal("cid-link"),description:i.z.string().optional()}),r.lexIpldType=i.z.discriminatedUnion("type",[r.lexBytes,r.lexCidLink]),r.lexRef=i.z.object({type:i.z.literal("ref"),description:i.z.string().optional(),ref:i.z.string()}),r.lexRefUnion=i.z.object({type:i.z.literal("union"),description:i.z.string().optional(),refs:i.z.string().array(),closed:i.z.boolean().optional()}),r.lexRefVariant=i.z.discriminatedUnion("type",[r.lexRef,r.lexRefUnion]),r.lexBlob=i.z.object({type:i.z.literal("blob"),description:i.z.string().optional(),accept:i.z.string().array().optional(),maxSize:i.z.number().optional()}),r.lexArray=i.z.object({type:i.z.literal("array"),description:i.z.string().optional(),items:i.z.discriminatedUnion("type",[r.lexBoolean,r.lexInteger,r.lexString,r.lexUnknown,r.lexBytes,r.lexCidLink,r.lexRef,r.lexRefUnion,r.lexBlob]),minLength:i.z.number().int().optional(),maxLength:i.z.number().int().optional()}),r.lexPrimitiveArray=r.lexArray.merge(i.z.object({items:r.lexPrimitive})),r.lexToken=i.z.object({type:i.z.literal("token"),description:i.z.string().optional()}),r.lexObject=i.z.object({type:i.z.literal("object"),description:i.z.string().optional(),required:i.z.string().array().optional(),nullable:i.z.string().array().optional(),properties:i.z.record(i.z.string(),i.z.discriminatedUnion("type",[r.lexArray,r.lexBoolean,r.lexInteger,r.lexString,r.lexUnknown,r.lexBytes,r.lexCidLink,r.lexRef,r.lexRefUnion,r.lexBlob]))}).superRefine(d.requiredPropertiesRefinement);const m=i.z.intersection(i.z.object({type:i.z.literal("permission"),resource:i.z.string().nonempty()}),i.z.record(i.z.string(),i.z.union([i.z.array(i.z.union([i.z.string(),i.z.number().int(),i.z.boolean()])),i.z.boolean(),i.z.number().int(),i.z.string()]).optional()));r.lexPermissionSet=i.z.object({type:i.z.literal("permission-set"),description:i.z.string().optional(),title:i.z.string().optional(),"title:lang":r.lexLang.optional(),detail:i.z.string().optional(),"detail:lang":r.lexLang.optional(),permissions:i.z.array(m)}),r.lexXrpcParameters=i.z.object({type:i.z.literal("params"),description:i.z.string().optional(),required:i.z.string().array().optional(),properties:i.z.record(i.z.string(),i.z.discriminatedUnion("type",[r.lexPrimitiveArray,r.lexBoolean,r.lexInteger,r.lexString,r.lexUnknown]))}).superRefine(d.requiredPropertiesRefinement),r.lexXrpcBody=i.z.object({description:i.z.string().optional(),encoding:i.z.string(),schema:i.z.union([r.lexRefVariant,r.lexObject]).optional()}),r.lexXrpcSubscriptionMessage=i.z.object({description:i.z.string().optional(),schema:i.z.union([r.lexRefVariant,r.lexObject]).optional()}),r.lexXrpcError=i.z.object({name:i.z.string(),description:i.z.string().optional()}),r.lexXrpcQuery=i.z.object({type:i.z.literal("query"),description:i.z.string().optional(),parameters:r.lexXrpcParameters.optional(),output:r.lexXrpcBody.optional(),errors:r.lexXrpcError.array().optional()}),r.lexXrpcProcedure=i.z.object({type:i.z.literal("procedure"),description:i.z.string().optional(),parameters:r.lexXrpcParameters.optional(),input:r.lexXrpcBody.optional(),output:r.lexXrpcBody.optional(),errors:r.lexXrpcError.array().optional()}),r.lexXrpcSubscription=i.z.object({type:i.z.literal("subscription"),description:i.z.string().optional(),parameters:r.lexXrpcParameters.optional(),message:r.lexXrpcSubscriptionMessage.optional(),errors:r.lexXrpcError.array().optional()}),r.lexRecord=i.z.object({type:i.z.literal("record"),description:i.z.string().optional(),key:i.z.string().optional(),record:r.lexObject}),r.lexUserType=i.z.custom(k=>{if(!(!k||typeof k!="object")&&k.type!==void 0)switch(k.type){case"record":return r.lexRecord.parse(k);case"permission-set":return r.lexPermissionSet.parse(k);case"query":return r.lexXrpcQuery.parse(k);case"procedure":return r.lexXrpcProcedure.parse(k);case"subscription":return r.lexXrpcSubscription.parse(k);case"blob":return r.lexBlob.parse(k);case"array":return r.lexArray.parse(k);case"token":return r.lexToken.parse(k);case"object":return r.lexObject.parse(k);case"boolean":return r.lexBoolean.parse(k);case"integer":return r.lexInteger.parse(k);case"string":return r.lexString.parse(k);case"bytes":return r.lexBytes.parse(k);case"cid-link":return r.lexCidLink.parse(k);case"unknown":return r.lexUnknown.parse(k)}},k=>!k||typeof k!="object"?{message:"Must be an object",fatal:!0}:k.type===void 0?{message:"Must have a type",fatal:!0}:typeof k.type!="string"?{message:"Type property must be a string",fatal:!0}:{message:`Invalid type: ${k.type} must be one of: record, query, procedure, subscription, blob, array, token, object, boolean, integer, string, bytes, cid-link, unknown`,fatal:!0}),r.lexiconDoc=i.z.object({lexicon:i.z.literal(1),id:i.z.string().refine(c.isValidNsid,{message:"Must be a valid NSID"}),revision:i.z.number().optional(),description:i.z.string().optional(),defs:i.z.record(i.z.string(),r.lexUserType)}).refine(k=>{for(const[B,F]of Object.entries(k.defs))if(B!=="main"&&(F.type==="record"||F.type==="permission-set"||F.type==="procedure"||F.type==="query"||F.type==="subscription"))return!1;return!0},{message:"Records, permission sets, procedures, queries, and subscriptions must be the main definition."});function e(k){return r.lexiconDoc.safeParse(k).success}function a(k){return k!=null&&typeof k=="object"}function g(k){return a(k)&&"$type"in k&&typeof k.$type=="string"}function w(k){return r.lexiconDoc.parse(k),k}class R extends Error{}r.ValidationError=R;class S extends Error{}r.InvalidLexiconError=S;class D extends Error{}r.LexiconDefNotFoundError=D})(Fx)),Fx}var qh={},Fl={},ac={},Ag={},t1={},mS;function Bw(){return mS||(mS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.BlobRef=r.jsonBlobRef=r.untypedJsonBlobRef=r.typedJsonBlobRef=void 0;const i=Af,s=Fc(),c=fl();r.typedJsonBlobRef=s.z.object({$type:s.z.literal("blob"),ref:c.schema.cid,mimeType:s.z.string(),size:s.z.number()}).strict(),r.untypedJsonBlobRef=s.z.object({cid:s.z.string(),mimeType:s.z.string()}).strict(),r.jsonBlobRef=s.z.union([r.typedJsonBlobRef,r.untypedJsonBlobRef]);class d{constructor(e,a,g,w){Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"mimeType",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:g}),Object.defineProperty(this,"original",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.original=w??{$type:"blob",ref:e,mimeType:a,size:g}}static asBlobRef(e){return c.check.is(e,r.jsonBlobRef)?d.fromJsonRef(e):null}static fromJsonRef(e){return c.check.is(e,r.typedJsonBlobRef)?new d(e.ref,e.mimeType,e.size):new d(i.CID.parse(e.cid),e.mimeType,-1,e)}ipld(){return{$type:"blob",ref:this.ref,mimeType:this.mimeType,size:this.size}}toJSON(){return(0,c.ipldToJson)(this.ipld())}}r.BlobRef=d})(t1)),t1}var yS;function U6(){if(yS)return Ag;yS=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.blob=s;const r=Bw(),i=qc();function s(c,d,m,e){return!e||!(e instanceof r.BlobRef)?{success:!1,error:new i.ValidationError(`${d} should be a blob ref`)}:{success:!0,value:e}}return Ag}var la={},Ts={},r1={},gS;function j6(){return gS||(gS=1,(function(r){(()=>{var i={d:(R,S)=>{for(var D in S)i.o(S,D)&&!i.o(R,D)&&Object.defineProperty(R,D,{enumerable:!0,get:S[D]})},o:(R,S)=>Object.prototype.hasOwnProperty.call(R,S),r:R=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(R,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(R,"__esModule",{value:!0})}},s={};function c(R,S){return S===void 0&&(S="-"),new RegExp("^(?!0{4}"+S+"0{2}"+S+"0{2})((?=[0-9]{4}"+S+"(((0[^2])|1[0-2])|02(?="+S+"(([0-1][0-9])|2[0-8])))"+S+"[0-9]{2})|(?=((([13579][26])|([2468][048])|(0[48]))0{2})|([0-9]{2}((((0|[2468])[48])|[2468][048])|([13579][26])))"+S+"02"+S+"29))([0-9]{4})"+S+"(?!((0[469])|11)"+S+"31)((0[1,3-9]|1[0-2])|(02(?!"+S+"3)))"+S+"(0[1-9]|[1-2][0-9]|3[0-1])$").test(R)}function d(R){var S=/\D/.exec(R);return S?S[0]:""}function m(R,S,D){S===void 0&&(S=":"),D===void 0&&(D=!1);var k=new RegExp("^([0-1]|2(?=([0-3])|4"+S+"00))[0-9]"+S+"[0-5][0-9]("+S+"([0-5]|6(?=0))[0-9])?(.[0-9]{1,9})?$");if(!D||!/[Z+\-]/.test(R))return k.test(R);if(/Z$/.test(R))return k.test(R.replace("Z",""));var B=R.includes("+"),F=R.split(/[+-]/),K=F[0],U=F[1];return k.test(K)&&(function(ee,le,Q){return Q===void 0&&(Q=":"),new RegExp(le?"^(0(?!(2"+Q+"4)|0"+Q+"3)|1(?=([0-1]|2(?="+Q+"[04])|[34](?="+Q+"0))))([03469](?="+Q+"[03])|[17](?="+Q+"0)|2(?="+Q+"[04])|5(?="+Q+"[034])|8(?="+Q+"[04]))"+Q+"([03](?=0)|4(?=5))[05]$":"^(0(?=[^0])|1(?=[0-2]))([39](?="+Q+"[03])|[0-24-8](?="+Q+"00))"+Q+"[03]0$").test(ee)})(U,B,d(U))}function e(R){var S=R.split("T"),D=S[0],k=S[1],B=c(D,d(D));if(!k)return!1;var F,K=(F=k.match(/([^Z+\-\d])(?=\d+\1)/),Array.isArray(F)?F[0]:"");return B&&m(k,K,!0)}function a(R,S){return S===void 0&&(S="-"),new RegExp("^[0-9]{4}"+S+"(0(?=[^0])|1(?=[0-2]))[0-9]$").test(R)}i.r(s),i.d(s,{isValidDate:()=>c,isValidISODateString:()=>e,isValidTime:()=>m,isValidYearMonth:()=>a});var g=r;for(var w in s)g[w]=s[w];s.__esModule&&Object.defineProperty(g,"__esModule",{value:!0})})()})(r1)),r1}var _S;function N6(){if(_S)return Ts;_S=1,Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.datetime=m,Ts.uri=e,Ts.atUri=a,Ts.did=g,Ts.handle=w,Ts.atIdentifier=R,Ts.nsid=S,Ts.cid=D,Ts.language=k,Ts.tid=B,Ts.recordKey=F;const r=j6(),i=Af,s=fl(),c=Rf(),d=qc();function m(K,U){try{if(!(0,r.isValidISODateString)(U))throw new Error}catch{return{success:!1,error:new d.ValidationError(`${K} must be an valid atproto datetime (both RFC-3339 and ISO-8601)`)}}return{success:!0,value:U}}function e(K,U){return U.match(/^\w+:(?:\/\/)?[^\s/][^\s]*$/)!==null?{success:!0,value:U}:{success:!1,error:new d.ValidationError(`${K} must be a uri`)}}function a(K,U){try{(0,c.ensureValidAtUri)(U)}catch{return{success:!1,error:new d.ValidationError(`${K} must be a valid at-uri`)}}return{success:!0,value:U}}function g(K,U){try{(0,c.ensureValidDid)(U)}catch{return{success:!1,error:new d.ValidationError(`${K} must be a valid did`)}}return{success:!0,value:U}}function w(K,U){try{(0,c.ensureValidHandle)(U)}catch{return{success:!1,error:new d.ValidationError(`${K} must be a valid handle`)}}return{success:!0,value:U}}function R(K,U){if(U.startsWith("did:")){const ee=g(K,U);if(ee.success)return ee}else{const ee=w(K,U);if(ee.success)return ee}return{success:!1,error:new d.ValidationError(`${K} must be a valid did or a handle`)}}function S(K,U){return(0,c.isValidNsid)(U)?{success:!0,value:U}:{success:!1,error:new d.ValidationError(`${K} must be a valid nsid`)}}function D(K,U){try{i.CID.parse(U)}catch{return{success:!1,error:new d.ValidationError(`${K} must be a cid string`)}}return{success:!0,value:U}}function k(K,U){return(0,s.validateLanguage)(U)?{success:!0,value:U}:{success:!1,error:new d.ValidationError(`${K} must be a well-formed BCP 47 language tag`)}}function B(K,U){return(0,c.isValidTid)(U)?{success:!0,value:U}:{success:!1,error:new d.ValidationError(`${K} must be a valid TID`)}}function F(K,U){try{(0,c.ensureValidRecordKey)(U)}catch{return{success:!1,error:new d.ValidationError(`${K} must be a valid Record Key`)}}return{success:!0,value:U}}return Ts}var bS;function _M(){if(bS)return la;bS=1;var r=la&&la.__createBinding||(Object.create?(function(B,F,K,U){U===void 0&&(U=K);var ee=Object.getOwnPropertyDescriptor(F,K);(!ee||("get"in ee?!F.__esModule:ee.writable||ee.configurable))&&(ee={enumerable:!0,get:function(){return F[K]}}),Object.defineProperty(B,U,ee)}):(function(B,F,K,U){U===void 0&&(U=K),B[U]=F[K]})),i=la&&la.__setModuleDefault||(Object.create?(function(B,F){Object.defineProperty(B,"default",{enumerable:!0,value:F})}):function(B,F){B.default=F}),s=la&&la.__importStar||(function(){var B=function(F){return B=Object.getOwnPropertyNames||function(K){var U=[];for(var ee in K)Object.prototype.hasOwnProperty.call(K,ee)&&(U[U.length]=ee);return U},B(F)};return function(F){if(F&&F.__esModule)return F;var K={};if(F!=null)for(var U=B(F),ee=0;ee<U.length;ee++)U[ee]!=="default"&&r(K,F,U[ee]);return i(K,F),K}})();Object.defineProperty(la,"__esModule",{value:!0}),la.validate=a;const c=Af,d=fl(),m=qc(),e=s(N6());function a(B,F,K,U){switch(K.type){case"boolean":return g(B,F,K,U);case"integer":return w(B,F,K,U);case"string":return R(B,F,K,U);case"bytes":return S(B,F,K,U);case"cid-link":return D(B,F,K,U);case"unknown":return k(B,F,K,U);default:return{success:!1,error:new m.ValidationError(`Unexpected lexicon type: ${K.type}`)}}}function g(B,F,K,U){K=K;const ee=typeof U;return ee==="undefined"?typeof K.default=="boolean"?{success:!0,value:K.default}:{success:!1,error:new m.ValidationError(`${F} must be a boolean`)}:ee!=="boolean"?{success:!1,error:new m.ValidationError(`${F} must be a boolean`)}:typeof K.const=="boolean"&&U!==K.const?{success:!1,error:new m.ValidationError(`${F} must be ${K.const}`)}:{success:!0,value:U}}function w(B,F,K,U){return K=K,typeof U==="undefined"?typeof K.default=="number"?{success:!0,value:K.default}:{success:!1,error:new m.ValidationError(`${F} must be an integer`)}:Number.isInteger(U)?typeof K.const=="number"&&U!==K.const?{success:!1,error:new m.ValidationError(`${F} must be ${K.const}`)}:Array.isArray(K.enum)&&!K.enum.includes(U)?{success:!1,error:new m.ValidationError(`${F} must be one of (${K.enum.join("|")})`)}:typeof K.maximum=="number"&&U>K.maximum?{success:!1,error:new m.ValidationError(`${F} can not be greater than ${K.maximum}`)}:typeof K.minimum=="number"&&U<K.minimum?{success:!1,error:new m.ValidationError(`${F} can not be less than ${K.minimum}`)}:{success:!0,value:U}:{success:!1,error:new m.ValidationError(`${F} must be an integer`)}}function R(B,F,K,U){if(K=K,typeof U>"u")return typeof K.default=="string"?{success:!0,value:K.default}:{success:!1,error:new m.ValidationError(`${F} must be a string`)};if(typeof U!="string")return{success:!1,error:new m.ValidationError(`${F} must be a string`)};if(typeof K.const=="string"&&U!==K.const)return{success:!1,error:new m.ValidationError(`${F} must be ${K.const}`)};if(Array.isArray(K.enum)&&!K.enum.includes(U))return{success:!1,error:new m.ValidationError(`${F} must be one of (${K.enum.join("|")})`)};if(typeof K.minLength=="number"||typeof K.maxLength=="number"){if(typeof K.minLength=="number"&&U.length*3<K.minLength)return{success:!1,error:new m.ValidationError(`${F} must not be shorter than ${K.minLength} characters`)};let ee=!1;if(typeof K.minLength>"u"&&typeof K.maxLength=="number"&&U.length*3<=K.maxLength&&(ee=!0),!ee){const le=(0,d.utf8Len)(U);if(typeof K.maxLength=="number"&&le>K.maxLength)return{success:!1,error:new m.ValidationError(`${F} must not be longer than ${K.maxLength} characters`)};if(typeof K.minLength=="number"&&le<K.minLength)return{success:!1,error:new m.ValidationError(`${F} must not be shorter than ${K.minLength} characters`)}}}if(typeof K.maxGraphemes=="number"||typeof K.minGraphemes=="number"){let ee=!1,le=!1;if(typeof K.maxGraphemes=="number"&&(U.length<=K.maxGraphemes?ee=!1:ee=!0),typeof K.minGraphemes=="number"){if(U.length<K.minGraphemes)return{success:!1,error:new m.ValidationError(`${F} must not be shorter than ${K.minGraphemes} graphemes`)};le=!0}if(ee||le){const Q=(0,d.graphemeLen)(U);if(typeof K.maxGraphemes=="number"&&Q>K.maxGraphemes)return{success:!1,error:new m.ValidationError(`${F} must not be longer than ${K.maxGraphemes} graphemes`)};if(typeof K.minGraphemes=="number"&&Q<K.minGraphemes)return{success:!1,error:new m.ValidationError(`${F} must not be shorter than ${K.minGraphemes} graphemes`)}}}if(typeof K.format=="string")switch(K.format){case"datetime":return e.datetime(F,U);case"uri":return e.uri(F,U);case"at-uri":return e.atUri(F,U);case"did":return e.did(F,U);case"handle":return e.handle(F,U);case"at-identifier":return e.atIdentifier(F,U);case"nsid":return e.nsid(F,U);case"cid":return e.cid(F,U);case"language":return e.language(F,U);case"tid":return e.tid(F,U);case"record-key":return e.recordKey(F,U)}return{success:!0,value:U}}function S(B,F,K,U){return K=K,!U||!(U instanceof Uint8Array)?{success:!1,error:new m.ValidationError(`${F} must be a byte array`)}:typeof K.maxLength=="number"&&U.byteLength>K.maxLength?{success:!1,error:new m.ValidationError(`${F} must not be larger than ${K.maxLength} bytes`)}:typeof K.minLength=="number"&&U.byteLength<K.minLength?{success:!1,error:new m.ValidationError(`${F} must not be smaller than ${K.minLength} bytes`)}:{success:!0,value:U}}function D(B,F,K,U){return c.CID.asCID(U)===null?{success:!1,error:new m.ValidationError(`${F} must be a CID`)}:{success:!0,value:U}}function k(B,F,K,U){return!U||typeof U!="object"?{success:!1,error:new m.ValidationError(`${F} must be an object`)}:{success:!0,value:U}}return la}var vS;function Mw(){if(vS)return ac;vS=1,Object.defineProperty(ac,"__esModule",{value:!0}),ac.validate=d,ac.array=m,ac.object=e,ac.validateOneOf=a;const r=qc(),i=Iw(),s=U6(),c=_M();function d(w,R,S,D){switch(S.type){case"object":return e(w,R,S,D);case"array":return m(w,R,S,D);case"blob":return(0,s.blob)(w,R,S,D);default:return(0,c.validate)(w,R,S,D)}}function m(w,R,S,D){if(!Array.isArray(D))return{success:!1,error:new r.ValidationError(`${R} must be an array`)};if(typeof S.maxLength=="number"&&D.length>S.maxLength)return{success:!1,error:new r.ValidationError(`${R} must not have more than ${S.maxLength} elements`)};if(typeof S.minLength=="number"&&D.length<S.minLength)return{success:!1,error:new r.ValidationError(`${R} must not have fewer than ${S.minLength} elements`)};const k=S.items;for(let B=0;B<D.length;B++){const F=D[B],K=`${R}/${B}`,U=a(w,K,k,F);if(!U.success)return U}return{success:!0,value:D}}function e(w,R,S,D){if(!(0,r.isObj)(D))return{success:!1,error:new r.ValidationError(`${R} must be an object`)};let k=D;if("properties"in S&&S.properties!=null)for(const B in S.properties){const F=D[B];if(F===null&&S.nullable?.includes(B))continue;const K=S.properties[B];if(F===void 0&&!S.required?.includes(B))if(K.type==="integer"||K.type==="boolean"||K.type==="string"){if(K.default===void 0)continue}else continue;const U=`${R}/${B}`,ee=a(w,U,K,F),le=ee.success?ee.value:F;if(le===void 0){if(S.required?.includes(B))return{success:!1,error:new r.ValidationError(`${R} must have the property "${B}"`)}}else if(!ee.success)return ee;le!==F&&(k===D&&(k={...D}),k[B]=le)}return{success:!0,value:k}}function a(w,R,S,D,k=!1){let B;if(S.type==="union"){if(!(0,r.isDiscriminatedObject)(D))return{success:!1,error:new r.ValidationError(`${R} must be an object which includes the "$type" property`)};if(g(S.refs,D.$type))B=w.getDefOrThrow(D.$type);else return S.closed?{success:!1,error:new r.ValidationError(`${R} $type must be one of ${S.refs.join(", ")}`)}:{success:!0,value:D}}else S.type==="ref"?B=w.getDefOrThrow(S.ref):B=S;return k?e(w,R,B,D):d(w,R,B,D)}const g=(w,R)=>{const S=(0,i.toLexUri)(R);return w.includes(S)?!0:S.endsWith("#main")?w.includes(S.slice(0,-5)):!S.includes("#")&&w.includes(`${S}#main`)};return ac}var ua={},xS;function F6(){if(xS)return ua;xS=1;var r=ua&&ua.__createBinding||(Object.create?(function(a,g,w,R){R===void 0&&(R=w);var S=Object.getOwnPropertyDescriptor(g,w);(!S||("get"in S?!g.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return g[w]}}),Object.defineProperty(a,R,S)}):(function(a,g,w,R){R===void 0&&(R=w),a[R]=g[w]})),i=ua&&ua.__setModuleDefault||(Object.create?(function(a,g){Object.defineProperty(a,"default",{enumerable:!0,value:g})}):function(a,g){a.default=g}),s=ua&&ua.__importStar||(function(){var a=function(g){return a=Object.getOwnPropertyNames||function(w){var R=[];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(R[R.length]=S);return R},a(g)};return function(g){if(g&&g.__esModule)return g;var w={};if(g!=null)for(var R=a(g),S=0;S<R.length;S++)R[S]!=="default"&&r(w,g,R[S]);return i(w,g),w}})();Object.defineProperty(ua,"__esModule",{value:!0}),ua.params=e;const c=qc(),d=Mw(),m=s(_M());function e(a,g,w,R){const S=R&&typeof R=="object"?R:{},D=new Set(w.required??[]);let k=S;if(typeof w.properties=="object")for(const B in w.properties){const F=w.properties[B],K=F.type==="array"?(0,d.array)(a,B,F,S[B]):m.validate(a,B,F,S[B]),U=K.success?K.value:S[B],ee=typeof U>"u";if(ee&&D.has(B))return{success:!1,error:new c.ValidationError(`${g} must have the property "${B}"`)};if(!ee&&!K.success)return K;U!==S[B]&&(k===S&&(k={...S}),k[B]=U)}return{success:!0,value:k}}return ua}var wS;function q6(){if(wS)return Fl;wS=1,Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.assertValidRecord=s,Fl.assertValidXrpcParams=c,Fl.assertValidXrpcInput=d,Fl.assertValidXrpcOutput=m,Fl.assertValidXrpcMessage=e;const r=Mw(),i=F6();function s(g,w,R){const S=(0,r.object)(g,"Record",w.record,R);if(!S.success)throw S.error;return S.value}function c(g,w,R){if(w.parameters){const S=(0,i.params)(g,"Params",w.parameters,R);if(!S.success)throw S.error;return S.value}}function d(g,w,R){if(w.input?.schema)return a(g,"Input",w.input.schema,R,!0)}function m(g,w,R){if(w.output?.schema)return a(g,"Output",w.output.schema,R,!0)}function e(g,w,R){if(w.message?.schema)return a(g,"Message",w.message.schema,R,!0)}function a(g,w,R,S,D=!1){const k=(0,r.validateOneOf)(g,w,R,S,D);if(!k.success)throw k.error;return k.value}return Fl}var ES;function K6(){if(ES)return qh;ES=1,Object.defineProperty(qh,"__esModule",{value:!0}),qh.Lexicons=void 0;const r=qc(),i=Iw(),s=q6(),c=Mw();class d{constructor(g){if(Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"defs",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),g)for(const w of g)this.add(w)}[Symbol.iterator](){return this.docs.values()}add(g){const w=(0,i.toLexUri)(g.id);if(this.docs.has(w))throw new Error(`${w} has already been registered`);e(g,w),this.docs.set(w,g);for(const[R,S]of m(g))this.defs.set(R,S)}remove(g){g=(0,i.toLexUri)(g);const w=this.docs.get(g);if(!w)throw new Error(`Unable to remove "${g}": does not exist`);for(const[R,S]of m(w))this.defs.delete(R);this.docs.delete(g)}get(g){return g=(0,i.toLexUri)(g),this.docs.get(g)}getDef(g){return g=(0,i.toLexUri)(g),this.defs.get(g)}getDefOrThrow(g,w){const R=this.getDef(g);if(!R)throw new r.LexiconDefNotFoundError(`Lexicon not found: ${g}`);if(w&&!w.includes(R.type))throw new r.InvalidLexiconError(`Not a ${w.join(" or ")} lexicon: ${g}`);return R}validate(g,w){if(!(0,r.isObj)(w))throw new r.ValidationError("Value must be an object");const R=(0,i.toLexUri)(g),S=this.getDefOrThrow(R,["record","object"]);if(S.type==="record")return(0,c.object)(this,"Record",S.record,w);if(S.type==="object")return(0,c.object)(this,"Object",S,w);throw new r.InvalidLexiconError("Definition must be a record or object")}assertValidRecord(g,w){if(!(0,r.isObj)(w))throw new r.ValidationError("Record must be an object");if(!("$type"in w))throw new r.ValidationError("Record/$type must be a string");const{$type:R}=w;if(typeof R!="string")throw new r.ValidationError("Record/$type must be a string");const S=(0,i.toLexUri)(g);if((0,i.toLexUri)(R)!==S)throw new r.ValidationError(`Invalid $type: must be ${S}, got ${R}`);const D=this.getDefOrThrow(S,["record"]);return(0,s.assertValidRecord)(this,D,w)}assertValidXrpcParams(g,w){g=(0,i.toLexUri)(g);const R=this.getDefOrThrow(g,["query","procedure","subscription"]);return(0,s.assertValidXrpcParams)(this,R,w)}assertValidXrpcInput(g,w){g=(0,i.toLexUri)(g);const R=this.getDefOrThrow(g,["procedure"]);return(0,s.assertValidXrpcInput)(this,R,w)}assertValidXrpcOutput(g,w){g=(0,i.toLexUri)(g);const R=this.getDefOrThrow(g,["query","procedure"]);return(0,s.assertValidXrpcOutput)(this,R,w)}assertValidXrpcMessage(g,w){g=(0,i.toLexUri)(g);const R=this.getDefOrThrow(g,["subscription"]);return(0,s.assertValidXrpcMessage)(this,R,w)}resolveLexUri(g,w){return g=(0,i.toLexUri)(g),(0,i.toLexUri)(w,g)}}qh.Lexicons=d;function*m(a){for(const g in a.defs)yield[`lex:${a.id}#${g}`,a.defs[g]],g==="main"&&(yield[`lex:${a.id}`,a.defs[g]])}function e(a,g){for(const w in a)a.type==="ref"?a.ref=(0,i.toLexUri)(a.ref,g):a.type==="union"?a.refs=a.refs.map(R=>(0,i.toLexUri)(R,g)):Array.isArray(a[w])?a[w]=a[w].map(R=>typeof R=="string"?R.startsWith("#")?(0,i.toLexUri)(R,g):R:R&&typeof R=="object"?e(R,g):R):a[w]&&typeof a[w]=="object"&&(a[w]=e(a[w],g));return a}return qh}var i1={},AS;function G6(){return AS||(AS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.jsonStringToLex=r.jsonToLex=r.stringifyLex=r.lexToJson=r.ipldToLex=r.lexToIpld=void 0;const i=Af,s=fl(),c=Bw(),d=R=>{if(Array.isArray(R))return R.map(S=>(0,r.lexToIpld)(S));if(R&&typeof R=="object"){if(R instanceof c.BlobRef)return R.original;if(i.CID.asCID(R)||R instanceof Uint8Array)return R;const S={};for(const D of Object.keys(R))S[D]=(0,r.lexToIpld)(R[D]);return S}return R};r.lexToIpld=d;const m=R=>{if(Array.isArray(R))return R.map(S=>(0,r.ipldToLex)(S));if(R&&typeof R=="object"){if((R.$type==="blob"||typeof R.cid=="string"&&typeof R.mimeType=="string")&&s.check.is(R,c.jsonBlobRef))return c.BlobRef.fromJsonRef(R);if(i.CID.asCID(R)||R instanceof Uint8Array)return R;const S={};for(const D of Object.keys(R))S[D]=(0,r.ipldToLex)(R[D]);return S}return R};r.ipldToLex=m;const e=R=>(0,s.ipldToJson)((0,r.lexToIpld)(R));r.lexToJson=e;const a=R=>JSON.stringify((0,r.lexToJson)(R));r.stringifyLex=a;const g=R=>(0,r.ipldToLex)((0,s.jsonToIpld)(R));r.jsonToLex=g;const w=R=>(0,r.jsonToLex)(JSON.parse(R));r.jsonStringToLex=w})(i1)),i1}var RS;function yf(){return RS||(RS=1,(function(r){var i=rc&&rc.__createBinding||(Object.create?(function(c,d,m,e){e===void 0&&(e=m);var a=Object.getOwnPropertyDescriptor(d,m);(!a||("get"in a?!d.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return d[m]}}),Object.defineProperty(c,e,a)}):(function(c,d,m,e){e===void 0&&(e=m),c[e]=d[m]})),s=rc&&rc.__exportStar||function(c,d){for(var m in c)m!=="default"&&!Object.prototype.hasOwnProperty.call(d,m)&&i(d,c,m)};Object.defineProperty(r,"__esModule",{value:!0}),s(qc(),r),s(K6(),r),s(Bw(),r),s(G6(),r)})(rc)),rc}var n1={},rp={},SS;function me(){if(SS)return rp;SS=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.is$typed=s,rp.maybe$typed=c,rp.asPredicate=d;function r(m){return m!=null&&typeof m=="object"}function i(m,e,a){return a==="main"?m===e:typeof m=="string"&&m.length===e.length+1+a.length&&m.charCodeAt(e.length)===35&&m.startsWith(e)&&m.endsWith(a)}function s(m,e,a){return r(m)&&"$type"in m&&i(m.$type,e,a)}function c(m,e,a){return r(m)&&("$type"in m?m.$type===void 0||i(m.$type,e,a):!0)}function d(m){return function(e){return m(e).success}}return rp}var TS;function he(){return TS||(TS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ids=r.lexicons=r.schemas=r.schemaDict=void 0,r.validate=c;const i=yf(),s=me();r.schemaDict={AppBskyActorDefs:{lexicon:1,id:"app.bsky.actor.defs",defs:{profileViewBasic:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},pronouns:{type:"string"},avatar:{type:"string",format:"uri"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},createdAt:{type:"string",format:"datetime"},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"},status:{type:"ref",ref:"lex:app.bsky.actor.defs#statusView"}}},profileView:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},pronouns:{type:"string"},description:{type:"string",maxGraphemes:256,maxLength:2560},avatar:{type:"string",format:"uri"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},indexedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"},status:{type:"ref",ref:"lex:app.bsky.actor.defs#statusView"}}},profileViewDetailed:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},description:{type:"string",maxGraphemes:256,maxLength:2560},pronouns:{type:"string"},website:{type:"string",format:"uri"},avatar:{type:"string",format:"uri"},banner:{type:"string",format:"uri"},followersCount:{type:"integer"},followsCount:{type:"integer"},postsCount:{type:"integer"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},joinedViaStarterPack:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"},indexedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},pinnedPost:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"},status:{type:"ref",ref:"lex:app.bsky.actor.defs#statusView"}}},profileAssociated:{type:"object",properties:{lists:{type:"integer"},feedgens:{type:"integer"},starterPacks:{type:"integer"},labeler:{type:"boolean"},chat:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociatedChat"},activitySubscription:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociatedActivitySubscription"}}},profileAssociatedChat:{type:"object",required:["allowIncoming"],properties:{allowIncoming:{type:"string",knownValues:["all","none","following"]}}},profileAssociatedActivitySubscription:{type:"object",required:["allowSubscriptions"],properties:{allowSubscriptions:{type:"string",knownValues:["followers","mutuals","none"]}}},viewerState:{type:"object",description:"Metadata about the requesting account's relationship with the subject account. Only has meaningful content for authed requests.",properties:{muted:{type:"boolean"},mutedByList:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"},blockedBy:{type:"boolean"},blocking:{type:"string",format:"at-uri"},blockingByList:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"},following:{type:"string",format:"at-uri"},followedBy:{type:"string",format:"at-uri"},knownFollowers:{description:"This property is present only in selected cases, as an optimization.",type:"ref",ref:"lex:app.bsky.actor.defs#knownFollowers"},activitySubscription:{description:"This property is present only in selected cases, as an optimization.",type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}},knownFollowers:{type:"object",description:"The subject's followers whom you also follow",required:["count","followers"],properties:{count:{type:"integer"},followers:{type:"array",minLength:0,maxLength:5,items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"}}}},verificationState:{type:"object",description:"Represents the verification information about the user this object is attached to.",required:["verifications","verifiedStatus","trustedVerifierStatus"],properties:{verifications:{type:"array",description:"All verifications issued by trusted verifiers on behalf of this user. Verifications by untrusted verifiers are not included.",items:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationView"}},verifiedStatus:{type:"string",description:"The user's status as a verified account.",knownValues:["valid","invalid","none"]},trustedVerifierStatus:{type:"string",description:"The user's status as a trusted verifier.",knownValues:["valid","invalid","none"]}}},verificationView:{type:"object",description:"An individual verification for an associated subject.",required:["issuer","uri","isValid","createdAt"],properties:{issuer:{type:"string",description:"The user who issued this verification.",format:"did"},uri:{type:"string",description:"The AT-URI of the verification record.",format:"at-uri"},isValid:{type:"boolean",description:"True if the verification passes validation, otherwise false."},createdAt:{type:"string",description:"Timestamp when the verification was created.",format:"datetime"}}},preferences:{type:"array",items:{type:"union",refs:["lex:app.bsky.actor.defs#adultContentPref","lex:app.bsky.actor.defs#contentLabelPref","lex:app.bsky.actor.defs#savedFeedsPref","lex:app.bsky.actor.defs#savedFeedsPrefV2","lex:app.bsky.actor.defs#personalDetailsPref","lex:app.bsky.actor.defs#feedViewPref","lex:app.bsky.actor.defs#threadViewPref","lex:app.bsky.actor.defs#interestsPref","lex:app.bsky.actor.defs#mutedWordsPref","lex:app.bsky.actor.defs#hiddenPostsPref","lex:app.bsky.actor.defs#bskyAppStatePref","lex:app.bsky.actor.defs#labelersPref","lex:app.bsky.actor.defs#postInteractionSettingsPref","lex:app.bsky.actor.defs#verificationPrefs"]}},adultContentPref:{type:"object",required:["enabled"],properties:{enabled:{type:"boolean",default:!1}}},contentLabelPref:{type:"object",required:["label","visibility"],properties:{labelerDid:{type:"string",description:"Which labeler does this preference apply to? If undefined, applies globally.",format:"did"},label:{type:"string"},visibility:{type:"string",knownValues:["ignore","show","warn","hide"]}}},savedFeed:{type:"object",required:["id","type","value","pinned"],properties:{id:{type:"string"},type:{type:"string",knownValues:["feed","list","timeline"]},value:{type:"string"},pinned:{type:"boolean"}}},savedFeedsPrefV2:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#savedFeed"}}}},savedFeedsPref:{type:"object",required:["pinned","saved"],properties:{pinned:{type:"array",items:{type:"string",format:"at-uri"}},saved:{type:"array",items:{type:"string",format:"at-uri"}},timelineIndex:{type:"integer"}}},personalDetailsPref:{type:"object",properties:{birthDate:{type:"string",format:"datetime",description:"The birth date of account owner."}}},feedViewPref:{type:"object",required:["feed"],properties:{feed:{type:"string",description:"The URI of the feed, or an identifier which describes the feed."},hideReplies:{type:"boolean",description:"Hide replies in the feed."},hideRepliesByUnfollowed:{type:"boolean",description:"Hide replies in the feed if they are not by followed users.",default:!0},hideRepliesByLikeCount:{type:"integer",description:"Hide replies in the feed if they do not have this number of likes."},hideReposts:{type:"boolean",description:"Hide reposts in the feed."},hideQuotePosts:{type:"boolean",description:"Hide quote posts in the feed."}}},threadViewPref:{type:"object",properties:{sort:{type:"string",description:"Sorting mode for threads.",knownValues:["oldest","newest","most-likes","random","hotness"]},prioritizeFollowedUsers:{type:"boolean",description:"Show followed users at the top of all replies."}}},interestsPref:{type:"object",required:["tags"],properties:{tags:{type:"array",maxLength:100,items:{type:"string",maxLength:640,maxGraphemes:64},description:"A list of tags which describe the account owner's interests gathered during onboarding."}}},mutedWordTarget:{type:"string",knownValues:["content","tag"],maxLength:640,maxGraphemes:64},mutedWord:{type:"object",description:"A word that the account owner has muted.",required:["value","targets"],properties:{id:{type:"string"},value:{type:"string",description:"The muted word itself.",maxLength:1e4,maxGraphemes:1e3},targets:{type:"array",description:"The intended targets of the muted word.",items:{type:"ref",ref:"lex:app.bsky.actor.defs#mutedWordTarget"}},actorTarget:{type:"string",description:"Groups of users to apply the muted word to. If undefined, applies to all users.",knownValues:["all","exclude-following"],default:"all"},expiresAt:{type:"string",format:"datetime",description:"The date and time at which the muted word will expire and no longer be applied."}}},mutedWordsPref:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#mutedWord"},description:"A list of words the account owner has muted."}}},hiddenPostsPref:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"string",format:"at-uri"},description:"A list of URIs of posts the account owner has hidden."}}},labelersPref:{type:"object",required:["labelers"],properties:{labelers:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#labelerPrefItem"}}}},labelerPrefItem:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},bskyAppStatePref:{description:"A grab bag of state that's specific to the bsky.app program. Third-party apps shouldn't use this.",type:"object",properties:{activeProgressGuide:{type:"ref",ref:"lex:app.bsky.actor.defs#bskyAppProgressGuide"},queuedNudges:{description:"An array of tokens which identify nudges (modals, popups, tours, highlight dots) that should be shown to the user.",type:"array",maxLength:1e3,items:{type:"string",maxLength:100}},nuxs:{description:"Storage for NUXs the user has encountered.",type:"array",maxLength:100,items:{type:"ref",ref:"lex:app.bsky.actor.defs#nux"}}}},bskyAppProgressGuide:{description:"If set, an active progress guide. Once completed, can be set to undefined. Should have unspecced fields tracking progress.",type:"object",required:["guide"],properties:{guide:{type:"string",maxLength:100}}},nux:{type:"object",description:"A new user experiences (NUX) storage object",required:["id","completed"],properties:{id:{type:"string",maxLength:100},completed:{type:"boolean",default:!1},data:{description:"Arbitrary data for the NUX. The structure is defined by the NUX itself. Limited to 300 characters.",type:"string",maxLength:3e3,maxGraphemes:300},expiresAt:{type:"string",format:"datetime",description:"The date and time at which the NUX will expire and should be considered completed."}}},verificationPrefs:{type:"object",description:"Preferences for how verified accounts appear in the app.",required:[],properties:{hideBadges:{description:"Hide the blue check badges for verified accounts and trusted verifiers.",type:"boolean",default:!1}}},postInteractionSettingsPref:{type:"object",description:"Default post interaction settings for the account. These values should be applied as default values when creating new posts. These refs should mirror the threadgate and postgate records exactly.",required:[],properties:{threadgateAllowRules:{description:"Matches threadgate record. List of rules defining who can reply to this users posts. If value is an empty array, no one can reply. If value is undefined, anyone can reply.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.threadgate#mentionRule","lex:app.bsky.feed.threadgate#followerRule","lex:app.bsky.feed.threadgate#followingRule","lex:app.bsky.feed.threadgate#listRule"]}},postgateEmbeddingRules:{description:"Matches postgate record. List of rules defining who can embed this users posts. If value is an empty array or is undefined, no particular rules apply and anyone can embed.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.postgate#disableRule"]}}}},statusView:{type:"object",required:["status","record"],properties:{status:{type:"string",description:"The status for the account.",knownValues:["app.bsky.actor.status#live"]},record:{type:"unknown"},embed:{type:"union",description:"An optional embed associated with the status.",refs:["lex:app.bsky.embed.external#view"]},expiresAt:{type:"string",description:"The date when this status will expire. The application might choose to no longer return the status after expiration.",format:"datetime"},isActive:{type:"boolean",description:"True if the status is not expired, false if it is expired. Only present if expiration was set."}}}}},AppBskyActorGetPreferences:{lexicon:1,id:"app.bsky.actor.getPreferences",defs:{main:{type:"query",description:"Get private preferences attached to the current account. Expected use is synchronization between multiple devices, and import/export during account migration. Requires auth.",parameters:{type:"params",properties:{}},output:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.actor.defs#preferences"}}}}}}},AppBskyActorGetProfile:{lexicon:1,id:"app.bsky.actor.getProfile",defs:{main:{type:"query",description:"Get detailed profile view of an actor. Does not require auth, but contains relevant metadata with auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"Handle or DID of account to fetch profile of."}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewDetailed"}}}}},AppBskyActorGetProfiles:{lexicon:1,id:"app.bsky.actor.getProfiles",defs:{main:{type:"query",description:"Get detailed profile views of multiple actors.",parameters:{type:"params",required:["actors"],properties:{actors:{type:"array",items:{type:"string",format:"at-identifier"},maxLength:25}}},output:{encoding:"application/json",schema:{type:"object",required:["profiles"],properties:{profiles:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewDetailed"}}}}}}}},AppBskyActorGetSuggestions:{lexicon:1,id:"app.bsky.actor.getSuggestions",defs:{main:{type:"query",description:"Get a list of suggested actors. Expected use is discovery of accounts to follow during new account onboarding.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}},recId:{type:"integer",description:"Snowflake for this recommendation, use when submitting recommendation events."}}}}}}},AppBskyActorProfile:{lexicon:1,id:"app.bsky.actor.profile",defs:{main:{type:"record",description:"A declaration of a Bluesky account profile.",key:"literal:self",record:{type:"object",properties:{displayName:{type:"string",maxGraphemes:64,maxLength:640},description:{type:"string",description:"Free-form profile description text.",maxGraphemes:256,maxLength:2560},pronouns:{type:"string",description:"Free-form pronouns text.",maxGraphemes:20,maxLength:200},website:{type:"string",format:"uri"},avatar:{type:"blob",description:"Small image to be displayed next to posts from account. AKA, 'profile picture'",accept:["image/png","image/jpeg"],maxSize:1e6},banner:{type:"blob",description:"Larger horizontal image to display behind profile view.",accept:["image/png","image/jpeg"],maxSize:1e6},labels:{type:"union",description:"Self-label values, specific to the Bluesky application, on the overall account.",refs:["lex:com.atproto.label.defs#selfLabels"]},joinedViaStarterPack:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},pinnedPost:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyActorPutPreferences:{lexicon:1,id:"app.bsky.actor.putPreferences",defs:{main:{type:"procedure",description:"Set the private preferences attached to the account.",input:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.actor.defs#preferences"}}}}}}},AppBskyActorSearchActors:{lexicon:1,id:"app.bsky.actor.searchActors",defs:{main:{type:"query",description:"Find actors (profiles) matching search criteria. Does not require auth.",parameters:{type:"params",properties:{term:{type:"string",description:"DEPRECATED: use 'q' instead."},q:{type:"string",description:"Search query string. Syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyActorSearchActorsTypeahead:{lexicon:1,id:"app.bsky.actor.searchActorsTypeahead",defs:{main:{type:"query",description:"Find actor suggestions for a prefix search term. Expected use is for auto-completion during text field entry. Does not require auth.",parameters:{type:"params",properties:{term:{type:"string",description:"DEPRECATED: use 'q' instead."},q:{type:"string",description:"Search query prefix; not a full query string."},limit:{type:"integer",minimum:1,maximum:100,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"}}}}}}}},AppBskyActorStatus:{lexicon:1,id:"app.bsky.actor.status",defs:{main:{type:"record",description:"A declaration of a Bluesky account status.",key:"literal:self",record:{type:"object",required:["status","createdAt"],properties:{status:{type:"string",description:"The status for the account.",knownValues:["app.bsky.actor.status#live"]},embed:{type:"union",description:"An optional embed associated with the status.",refs:["lex:app.bsky.embed.external"]},durationMinutes:{type:"integer",description:"The duration of the status in minutes. Applications can choose to impose minimum and maximum limits.",minimum:1},createdAt:{type:"string",format:"datetime"}}}},live:{type:"token",description:"Advertises an account as currently offering live content."}}},AppBskyBookmarkCreateBookmark:{lexicon:1,id:"app.bsky.bookmark.createBookmark",defs:{main:{type:"procedure",description:"Creates a private bookmark for the specified record. Currently, only `app.bsky.feed.post` records are supported. Requires authentication.",input:{encoding:"application/json",schema:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"}}}},errors:[{name:"UnsupportedCollection",description:"The URI to be bookmarked is for an unsupported collection."}]}}},AppBskyBookmarkDefs:{lexicon:1,id:"app.bsky.bookmark.defs",defs:{bookmark:{description:"Object used to store bookmark data in stash.",type:"object",required:["subject"],properties:{subject:{description:"A strong ref to the record to be bookmarked. Currently, only `app.bsky.feed.post` records are supported.",type:"ref",ref:"lex:com.atproto.repo.strongRef"}}},bookmarkView:{type:"object",required:["subject","item"],properties:{subject:{description:"A strong ref to the bookmarked record.",type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"},item:{type:"union",refs:["lex:app.bsky.feed.defs#blockedPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#postView"]}}}}},AppBskyBookmarkDeleteBookmark:{lexicon:1,id:"app.bsky.bookmark.deleteBookmark",defs:{main:{type:"procedure",description:"Deletes a private bookmark for the specified record. Currently, only `app.bsky.feed.post` records are supported. Requires authentication.",input:{encoding:"application/json",schema:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}}},errors:[{name:"UnsupportedCollection",description:"The URI to be bookmarked is for an unsupported collection."}]}}},AppBskyBookmarkGetBookmarks:{lexicon:1,id:"app.bsky.bookmark.getBookmarks",defs:{main:{type:"query",description:"Gets views of records bookmarked by the authenticated user. Requires authentication.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["bookmarks"],properties:{cursor:{type:"string"},bookmarks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.bookmark.defs#bookmarkView"}}}}}}}},AppBskyEmbedDefs:{lexicon:1,id:"app.bsky.embed.defs",defs:{aspectRatio:{type:"object",description:"width:height represents an aspect ratio. It may be approximate, and may not correspond to absolute dimensions in any given unit.",required:["width","height"],properties:{width:{type:"integer",minimum:1},height:{type:"integer",minimum:1}}}}},AppBskyEmbedExternal:{lexicon:1,id:"app.bsky.embed.external",defs:{main:{type:"object",description:"A representation of some externally linked content (eg, a URL and 'card'), embedded in a Bluesky record (eg, a post).",required:["external"],properties:{external:{type:"ref",ref:"lex:app.bsky.embed.external#external"}}},external:{type:"object",required:["uri","title","description"],properties:{uri:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},thumb:{type:"blob",accept:["image/*"],maxSize:1e6}}},view:{type:"object",required:["external"],properties:{external:{type:"ref",ref:"lex:app.bsky.embed.external#viewExternal"}}},viewExternal:{type:"object",required:["uri","title","description"],properties:{uri:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},thumb:{type:"string",format:"uri"}}}}},AppBskyEmbedImages:{lexicon:1,id:"app.bsky.embed.images",description:"A set of images embedded in a Bluesky record (eg, a post).",defs:{main:{type:"object",required:["images"],properties:{images:{type:"array",items:{type:"ref",ref:"lex:app.bsky.embed.images#image"},maxLength:4}}},image:{type:"object",required:["image","alt"],properties:{image:{type:"blob",accept:["image/*"],maxSize:1e6},alt:{type:"string",description:"Alt text description of the image, for accessibility."},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}},view:{type:"object",required:["images"],properties:{images:{type:"array",items:{type:"ref",ref:"lex:app.bsky.embed.images#viewImage"},maxLength:4}}},viewImage:{type:"object",required:["thumb","fullsize","alt"],properties:{thumb:{type:"string",format:"uri",description:"Fully-qualified URL where a thumbnail of the image can be fetched. For example, CDN location provided by the App View."},fullsize:{type:"string",format:"uri",description:"Fully-qualified URL where a large version of the image can be fetched. May or may not be the exact original blob. For example, CDN location provided by the App View."},alt:{type:"string",description:"Alt text description of the image, for accessibility."},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}}}},AppBskyEmbedRecord:{lexicon:1,id:"app.bsky.embed.record",description:"A representation of a record embedded in a Bluesky record (eg, a post). For example, a quote-post, or sharing a feed generator record.",defs:{main:{type:"object",required:["record"],properties:{record:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}},view:{type:"object",required:["record"],properties:{record:{type:"union",refs:["lex:app.bsky.embed.record#viewRecord","lex:app.bsky.embed.record#viewNotFound","lex:app.bsky.embed.record#viewBlocked","lex:app.bsky.embed.record#viewDetached","lex:app.bsky.feed.defs#generatorView","lex:app.bsky.graph.defs#listView","lex:app.bsky.labeler.defs#labelerView","lex:app.bsky.graph.defs#starterPackViewBasic"]}}},viewRecord:{type:"object",required:["uri","cid","author","value","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},author:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},value:{type:"unknown",description:"The record data itself."},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},replyCount:{type:"integer"},repostCount:{type:"integer"},likeCount:{type:"integer"},quoteCount:{type:"integer"},embeds:{type:"array",items:{type:"union",refs:["lex:app.bsky.embed.images#view","lex:app.bsky.embed.video#view","lex:app.bsky.embed.external#view","lex:app.bsky.embed.record#view","lex:app.bsky.embed.recordWithMedia#view"]}},indexedAt:{type:"string",format:"datetime"}}},viewNotFound:{type:"object",required:["uri","notFound"],properties:{uri:{type:"string",format:"at-uri"},notFound:{type:"boolean",const:!0}}},viewBlocked:{type:"object",required:["uri","blocked","author"],properties:{uri:{type:"string",format:"at-uri"},blocked:{type:"boolean",const:!0},author:{type:"ref",ref:"lex:app.bsky.feed.defs#blockedAuthor"}}},viewDetached:{type:"object",required:["uri","detached"],properties:{uri:{type:"string",format:"at-uri"},detached:{type:"boolean",const:!0}}}}},AppBskyEmbedRecordWithMedia:{lexicon:1,id:"app.bsky.embed.recordWithMedia",description:"A representation of a record embedded in a Bluesky record (eg, a post), alongside other compatible embeds. For example, a quote post and image, or a quote post and external URL card.",defs:{main:{type:"object",required:["record","media"],properties:{record:{type:"ref",ref:"lex:app.bsky.embed.record"},media:{type:"union",refs:["lex:app.bsky.embed.images","lex:app.bsky.embed.video","lex:app.bsky.embed.external"]}}},view:{type:"object",required:["record","media"],properties:{record:{type:"ref",ref:"lex:app.bsky.embed.record#view"},media:{type:"union",refs:["lex:app.bsky.embed.images#view","lex:app.bsky.embed.video#view","lex:app.bsky.embed.external#view"]}}}}},AppBskyEmbedVideo:{lexicon:1,id:"app.bsky.embed.video",description:"A video embedded in a Bluesky record (eg, a post).",defs:{main:{type:"object",required:["video"],properties:{video:{type:"blob",description:"The mp4 video file. May be up to 100mb, formerly limited to 50mb.",accept:["video/mp4"],maxSize:1e8},captions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.embed.video#caption"},maxLength:20},alt:{type:"string",description:"Alt text description of the video, for accessibility.",maxGraphemes:1e3,maxLength:1e4},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}},caption:{type:"object",required:["lang","file"],properties:{lang:{type:"string",format:"language"},file:{type:"blob",accept:["text/vtt"],maxSize:2e4}}},view:{type:"object",required:["cid","playlist"],properties:{cid:{type:"string",format:"cid"},playlist:{type:"string",format:"uri"},thumbnail:{type:"string",format:"uri"},alt:{type:"string",maxGraphemes:1e3,maxLength:1e4},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}}}},AppBskyFeedDefs:{lexicon:1,id:"app.bsky.feed.defs",defs:{postView:{type:"object",required:["uri","cid","author","record","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},author:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},record:{type:"unknown"},embed:{type:"union",refs:["lex:app.bsky.embed.images#view","lex:app.bsky.embed.video#view","lex:app.bsky.embed.external#view","lex:app.bsky.embed.record#view","lex:app.bsky.embed.recordWithMedia#view"]},bookmarkCount:{type:"integer"},replyCount:{type:"integer"},repostCount:{type:"integer"},likeCount:{type:"integer"},quoteCount:{type:"integer"},indexedAt:{type:"string",format:"datetime"},viewer:{type:"ref",ref:"lex:app.bsky.feed.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},threadgate:{type:"ref",ref:"lex:app.bsky.feed.defs#threadgateView"}}},viewerState:{type:"object",description:"Metadata about the requesting account's relationship with the subject content. Only has meaningful content for authed requests.",properties:{repost:{type:"string",format:"at-uri"},like:{type:"string",format:"at-uri"},bookmarked:{type:"boolean"},threadMuted:{type:"boolean"},replyDisabled:{type:"boolean"},embeddingDisabled:{type:"boolean"},pinned:{type:"boolean"}}},threadContext:{type:"object",description:"Metadata about this post within the context of the thread it is in.",properties:{rootAuthorLike:{type:"string",format:"at-uri"}}},feedViewPost:{type:"object",required:["post"],properties:{post:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"},reply:{type:"ref",ref:"lex:app.bsky.feed.defs#replyRef"},reason:{type:"union",refs:["lex:app.bsky.feed.defs#reasonRepost","lex:app.bsky.feed.defs#reasonPin"]},feedContext:{type:"string",description:"Context provided by feed generator that may be passed back alongside interactions.",maxLength:2e3},reqId:{type:"string",description:"Unique identifier per request that may be passed back alongside interactions.",maxLength:100}}},replyRef:{type:"object",required:["root","parent"],properties:{root:{type:"union",refs:["lex:app.bsky.feed.defs#postView","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},parent:{type:"union",refs:["lex:app.bsky.feed.defs#postView","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},grandparentAuthor:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic",description:"When parent is a reply to another post, this is the author of that post."}}},reasonRepost:{type:"object",required:["by","indexedAt"],properties:{by:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},indexedAt:{type:"string",format:"datetime"}}},reasonPin:{type:"object",properties:{}},threadViewPost:{type:"object",required:["post"],properties:{post:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"},parent:{type:"union",refs:["lex:app.bsky.feed.defs#threadViewPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},replies:{type:"array",items:{type:"union",refs:["lex:app.bsky.feed.defs#threadViewPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]}},threadContext:{type:"ref",ref:"lex:app.bsky.feed.defs#threadContext"}}},notFoundPost:{type:"object",required:["uri","notFound"],properties:{uri:{type:"string",format:"at-uri"},notFound:{type:"boolean",const:!0}}},blockedPost:{type:"object",required:["uri","blocked","author"],properties:{uri:{type:"string",format:"at-uri"},blocked:{type:"boolean",const:!0},author:{type:"ref",ref:"lex:app.bsky.feed.defs#blockedAuthor"}}},blockedAuthor:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"}}},generatorView:{type:"object",required:["uri","cid","did","creator","displayName","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},did:{type:"string",format:"did"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},displayName:{type:"string"},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"string",format:"uri"},likeCount:{type:"integer",minimum:0},acceptsInteractions:{type:"boolean"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},viewer:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorViewerState"},contentMode:{type:"string",knownValues:["app.bsky.feed.defs#contentModeUnspecified","app.bsky.feed.defs#contentModeVideo"]},indexedAt:{type:"string",format:"datetime"}}},generatorViewerState:{type:"object",properties:{like:{type:"string",format:"at-uri"}}},skeletonFeedPost:{type:"object",required:["post"],properties:{post:{type:"string",format:"at-uri"},reason:{type:"union",refs:["lex:app.bsky.feed.defs#skeletonReasonRepost","lex:app.bsky.feed.defs#skeletonReasonPin"]},feedContext:{type:"string",description:"Context that will be passed through to client and may be passed to feed generator back alongside interactions.",maxLength:2e3}}},skeletonReasonRepost:{type:"object",required:["repost"],properties:{repost:{type:"string",format:"at-uri"}}},skeletonReasonPin:{type:"object",properties:{}},threadgateView:{type:"object",properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},record:{type:"unknown"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"}}}},interaction:{type:"object",properties:{item:{type:"string",format:"at-uri"},event:{type:"string",knownValues:["app.bsky.feed.defs#requestLess","app.bsky.feed.defs#requestMore","app.bsky.feed.defs#clickthroughItem","app.bsky.feed.defs#clickthroughAuthor","app.bsky.feed.defs#clickthroughReposter","app.bsky.feed.defs#clickthroughEmbed","app.bsky.feed.defs#interactionSeen","app.bsky.feed.defs#interactionLike","app.bsky.feed.defs#interactionRepost","app.bsky.feed.defs#interactionReply","app.bsky.feed.defs#interactionQuote","app.bsky.feed.defs#interactionShare"]},feedContext:{type:"string",description:"Context on a feed item that was originally supplied by the feed generator on getFeedSkeleton.",maxLength:2e3},reqId:{type:"string",description:"Unique identifier per request that may be passed back alongside interactions.",maxLength:100}}},requestLess:{type:"token",description:"Request that less content like the given feed item be shown in the feed"},requestMore:{type:"token",description:"Request that more content like the given feed item be shown in the feed"},clickthroughItem:{type:"token",description:"User clicked through to the feed item"},clickthroughAuthor:{type:"token",description:"User clicked through to the author of the feed item"},clickthroughReposter:{type:"token",description:"User clicked through to the reposter of the feed item"},clickthroughEmbed:{type:"token",description:"User clicked through to the embedded content of the feed item"},contentModeUnspecified:{type:"token",description:"Declares the feed generator returns any types of posts."},contentModeVideo:{type:"token",description:"Declares the feed generator returns posts containing app.bsky.embed.video embeds."},interactionSeen:{type:"token",description:"Feed item was seen by user"},interactionLike:{type:"token",description:"User liked the feed item"},interactionRepost:{type:"token",description:"User reposted the feed item"},interactionReply:{type:"token",description:"User replied to the feed item"},interactionQuote:{type:"token",description:"User quoted the feed item"},interactionShare:{type:"token",description:"User shared the feed item"}}},AppBskyFeedDescribeFeedGenerator:{lexicon:1,id:"app.bsky.feed.describeFeedGenerator",defs:{main:{type:"query",description:"Get information about a feed generator, including policies and offered feed URIs. Does not require auth; implemented by Feed Generator services (not App View).",output:{encoding:"application/json",schema:{type:"object",required:["did","feeds"],properties:{did:{type:"string",format:"did"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.describeFeedGenerator#feed"}},links:{type:"ref",ref:"lex:app.bsky.feed.describeFeedGenerator#links"}}}}},feed:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},links:{type:"object",properties:{privacyPolicy:{type:"string"},termsOfService:{type:"string"}}}}},AppBskyFeedGenerator:{lexicon:1,id:"app.bsky.feed.generator",defs:{main:{type:"record",description:"Record declaring of the existence of a feed generator, and containing metadata about it. The record can exist in any repository.",key:"any",record:{type:"object",required:["did","displayName","createdAt"],properties:{did:{type:"string",format:"did"},displayName:{type:"string",maxGraphemes:24,maxLength:240},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"blob",accept:["image/png","image/jpeg"],maxSize:1e6},acceptsInteractions:{type:"boolean",description:"Declaration that a feed accepts feedback interactions from a client through app.bsky.feed.sendInteractions"},labels:{type:"union",description:"Self-label values",refs:["lex:com.atproto.label.defs#selfLabels"]},contentMode:{type:"string",knownValues:["app.bsky.feed.defs#contentModeUnspecified","app.bsky.feed.defs#contentModeVideo"]},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyFeedGetActorFeeds:{lexicon:1,id:"app.bsky.feed.getActorFeeds",defs:{main:{type:"query",description:"Get a list of feeds (feed generator records) created by the actor (in the actor's repo).",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{cursor:{type:"string"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyFeedGetActorLikes:{lexicon:1,id:"app.bsky.feed.getActorLikes",defs:{main:{type:"query",description:"Get a list of posts liked by an actor. Requires auth, actor must be the requesting account.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"BlockedActor"},{name:"BlockedByActor"}]}}},AppBskyFeedGetAuthorFeed:{lexicon:1,id:"app.bsky.feed.getAuthorFeed",defs:{main:{type:"query",description:"Get a view of an actor's 'author feed' (post and reposts by the author). Does not require auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},filter:{type:"string",description:"Combinations of post/repost types to include in response.",knownValues:["posts_with_replies","posts_no_replies","posts_with_media","posts_and_author_threads","posts_with_video"],default:"posts_with_replies"},includePins:{type:"boolean",default:!1}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"BlockedActor"},{name:"BlockedByActor"}]}}},AppBskyFeedGetFeed:{lexicon:1,id:"app.bsky.feed.getFeed",defs:{main:{type:"query",description:"Get a hydrated feed from an actor's selected feed generator. Implemented by App View.",parameters:{type:"params",required:["feed"],properties:{feed:{type:"string",format:"at-uri"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"UnknownFeed"}]}}},AppBskyFeedGetFeedGenerator:{lexicon:1,id:"app.bsky.feed.getFeedGenerator",defs:{main:{type:"query",description:"Get information about a feed generator. Implemented by AppView.",parameters:{type:"params",required:["feed"],properties:{feed:{type:"string",format:"at-uri",description:"AT-URI of the feed generator record."}}},output:{encoding:"application/json",schema:{type:"object",required:["view","isOnline","isValid"],properties:{view:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"},isOnline:{type:"boolean",description:"Indicates whether the feed generator service has been online recently, or else seems to be inactive."},isValid:{type:"boolean",description:"Indicates whether the feed generator service is compatible with the record declaration."}}}}}}},AppBskyFeedGetFeedGenerators:{lexicon:1,id:"app.bsky.feed.getFeedGenerators",defs:{main:{type:"query",description:"Get information about a list of feed generators.",parameters:{type:"params",required:["feeds"],properties:{feeds:{type:"array",items:{type:"string",format:"at-uri"}}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyFeedGetFeedSkeleton:{lexicon:1,id:"app.bsky.feed.getFeedSkeleton",defs:{main:{type:"query",description:"Get a skeleton of a feed provided by a feed generator. Auth is optional, depending on provider requirements, and provides the DID of the requester. Implemented by Feed Generator Service.",parameters:{type:"params",required:["feed"],properties:{feed:{type:"string",format:"at-uri",description:"Reference to feed generator record describing the specific feed being requested."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#skeletonFeedPost"}},reqId:{type:"string",description:"Unique identifier per request that may be passed back alongside interactions.",maxLength:100}}}},errors:[{name:"UnknownFeed"}]}}},AppBskyFeedGetLikes:{lexicon:1,id:"app.bsky.feed.getLikes",defs:{main:{type:"query",description:"Get like records which reference a subject (by AT-URI and CID).",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"AT-URI of the subject (eg, a post record)."},cid:{type:"string",format:"cid",description:"CID of the subject record (aka, specific version of record), to filter likes."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","likes"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},cursor:{type:"string"},likes:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.getLikes#like"}}}}}},like:{type:"object",required:["indexedAt","createdAt","actor"],properties:{indexedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},actor:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}},AppBskyFeedGetListFeed:{lexicon:1,id:"app.bsky.feed.getListFeed",defs:{main:{type:"query",description:"Get a feed of recent posts from a list (posts and reposts from any actors on the list). Does not require auth.",parameters:{type:"params",required:["list"],properties:{list:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the list record."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"UnknownList"}]}}},AppBskyFeedGetPostThread:{lexicon:1,id:"app.bsky.feed.getPostThread",defs:{main:{type:"query",description:"Get posts in a thread. Does not require auth, but additional metadata and filtering will be applied for authed requests.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"Reference (AT-URI) to post record."},depth:{type:"integer",description:"How many levels of reply depth should be included in response.",default:6,minimum:0,maximum:1e3},parentHeight:{type:"integer",description:"How many levels of parent (and grandparent, etc) post to include.",default:80,minimum:0,maximum:1e3}}},output:{encoding:"application/json",schema:{type:"object",required:["thread"],properties:{thread:{type:"union",refs:["lex:app.bsky.feed.defs#threadViewPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},threadgate:{type:"ref",ref:"lex:app.bsky.feed.defs#threadgateView"}}}},errors:[{name:"NotFound"}]}}},AppBskyFeedGetPosts:{lexicon:1,id:"app.bsky.feed.getPosts",defs:{main:{type:"query",description:"Gets post views for a specified list of posts (by AT-URI). This is sometimes referred to as 'hydrating' a 'feed skeleton'.",parameters:{type:"params",required:["uris"],properties:{uris:{type:"array",description:"List of post AT-URIs to return hydrated views for.",items:{type:"string",format:"at-uri"},maxLength:25}}},output:{encoding:"application/json",schema:{type:"object",required:["posts"],properties:{posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"}}}}}}}},AppBskyFeedGetQuotes:{lexicon:1,id:"app.bsky.feed.getQuotes",defs:{main:{type:"query",description:"Get a list of quotes for a given post.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"Reference (AT-URI) of post record"},cid:{type:"string",format:"cid",description:"If supplied, filters to quotes of specific version (by CID) of the post record."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","posts"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},cursor:{type:"string"},posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"}}}}}}}},AppBskyFeedGetRepostedBy:{lexicon:1,id:"app.bsky.feed.getRepostedBy",defs:{main:{type:"query",description:"Get a list of reposts for a given post.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"Reference (AT-URI) of post record"},cid:{type:"string",format:"cid",description:"If supplied, filters to reposts of specific version (by CID) of the post record."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","repostedBy"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},cursor:{type:"string"},repostedBy:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyFeedGetSuggestedFeeds:{lexicon:1,id:"app.bsky.feed.getSuggestedFeeds",defs:{main:{type:"query",description:"Get a list of suggested feeds (feed generators) for the requesting account.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{cursor:{type:"string"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyFeedGetTimeline:{lexicon:1,id:"app.bsky.feed.getTimeline",defs:{main:{type:"query",description:"Get a view of the requesting account's home timeline. This is expected to be some form of reverse-chronological feed.",parameters:{type:"params",properties:{algorithm:{type:"string",description:"Variant 'algorithm' for timeline. Implementation-specific. NOTE: most feed flexibility has been moved to feed generator mechanism."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}}}}},AppBskyFeedLike:{lexicon:1,id:"app.bsky.feed.like",defs:{main:{type:"record",description:"Record declaring a 'like' of a piece of subject content.",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"},via:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}}}}},AppBskyFeedPost:{lexicon:1,id:"app.bsky.feed.post",defs:{main:{type:"record",description:"Record containing a Bluesky post.",key:"tid",record:{type:"object",required:["text","createdAt"],properties:{text:{type:"string",maxLength:3e3,maxGraphemes:300,description:"The primary post content. May be an empty string, if there are embeds."},entities:{type:"array",description:"DEPRECATED: replaced by app.bsky.richtext.facet.",items:{type:"ref",ref:"lex:app.bsky.feed.post#entity"}},facets:{type:"array",description:"Annotations of text (mentions, URLs, hashtags, etc)",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},reply:{type:"ref",ref:"lex:app.bsky.feed.post#replyRef"},embed:{type:"union",refs:["lex:app.bsky.embed.images","lex:app.bsky.embed.video","lex:app.bsky.embed.external","lex:app.bsky.embed.record","lex:app.bsky.embed.recordWithMedia"]},langs:{type:"array",description:"Indicates human language of post primary text content.",maxLength:3,items:{type:"string",format:"language"}},labels:{type:"union",description:"Self-label values for this post. Effectively content warnings.",refs:["lex:com.atproto.label.defs#selfLabels"]},tags:{type:"array",description:"Additional hashtags, in addition to any included in post text and facets.",maxLength:8,items:{type:"string",maxLength:640,maxGraphemes:64}},createdAt:{type:"string",format:"datetime",description:"Client-declared timestamp when this post was originally created."}}}},replyRef:{type:"object",required:["root","parent"],properties:{root:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},parent:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}},entity:{type:"object",description:"Deprecated: use facets instead.",required:["index","type","value"],properties:{index:{type:"ref",ref:"lex:app.bsky.feed.post#textSlice"},type:{type:"string",description:"Expected values are 'mention' and 'link'."},value:{type:"string"}}},textSlice:{type:"object",description:"Deprecated. Use app.bsky.richtext instead -- A text segment. Start is inclusive, end is exclusive. Indices are for utf16-encoded strings.",required:["start","end"],properties:{start:{type:"integer",minimum:0},end:{type:"integer",minimum:0}}}}},AppBskyFeedPostgate:{lexicon:1,id:"app.bsky.feed.postgate",defs:{main:{type:"record",key:"tid",description:"Record defining interaction rules for a post. The record key (rkey) of the postgate record must match the record key of the post, and that record must be in the same repository.",record:{type:"object",required:["post","createdAt"],properties:{createdAt:{type:"string",format:"datetime"},post:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the post record."},detachedEmbeddingUris:{type:"array",maxLength:50,items:{type:"string",format:"at-uri"},description:"List of AT-URIs embedding this post that the author has detached from."},embeddingRules:{description:"List of rules defining who can embed this post. If value is an empty array or is undefined, no particular rules apply and anyone can embed.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.postgate#disableRule"]}}}}},disableRule:{type:"object",description:"Disables embedding of this post.",properties:{}}}},AppBskyFeedRepost:{lexicon:1,id:"app.bsky.feed.repost",defs:{main:{description:"Record representing a 'repost' of an existing Bluesky post.",type:"record",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"},via:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}}}}},AppBskyFeedSearchPosts:{lexicon:1,id:"app.bsky.feed.searchPosts",defs:{main:{type:"query",description:"Find posts matching search criteria, returning views of those posts. Note that this API endpoint may require authentication (eg, not public) for some service providers and implementations.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},sort:{type:"string",knownValues:["top","latest"],default:"latest",description:"Specifies the ranking order of results."},since:{type:"string",description:"Filter results for posts after the indicated datetime (inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYYY-MM-DD)."},until:{type:"string",description:"Filter results for posts before the indicated datetime (not inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYY-MM-DD)."},mentions:{type:"string",format:"at-identifier",description:"Filter to posts which mention the given account. Handles are resolved to DID before query-time. Only matches rich-text facet mentions."},author:{type:"string",format:"at-identifier",description:"Filter to posts by the given account. Handles are resolved to DID before query-time."},lang:{type:"string",format:"language",description:"Filter to posts in the given language. Expected to be based on post language field, though server may override language detection."},domain:{type:"string",description:"Filter to posts with URLs (facet links or embeds) linking to the given domain (hostname). Server may apply hostname normalization."},url:{type:"string",format:"uri",description:"Filter to posts with links (facet links or embeds) pointing to this URL. Server may apply URL normalization or fuzzy matching."},tag:{type:"array",items:{type:"string",maxLength:640,maxGraphemes:64},description:"Filter to posts with the given tag (hashtag), based on rich-text facet or tag field. Do not include the hash (#) prefix. Multiple tags can be specified, with 'AND' matching."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["posts"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyFeedSendInteractions:{lexicon:1,id:"app.bsky.feed.sendInteractions",defs:{main:{type:"procedure",description:"Send information about interactions with feed items back to the feed generator that served them.",input:{encoding:"application/json",schema:{type:"object",required:["interactions"],properties:{interactions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#interaction"}}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},AppBskyFeedThreadgate:{lexicon:1,id:"app.bsky.feed.threadgate",defs:{main:{type:"record",key:"tid",description:"Record defining interaction gating rules for a thread (aka, reply controls). The record key (rkey) of the threadgate record must match the record key of the thread's root post, and that record must be in the same repository.",record:{type:"object",required:["post","createdAt"],properties:{post:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the post record."},allow:{description:"List of rules defining who can reply to this post. If value is an empty array, no one can reply. If value is undefined, anyone can reply.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.threadgate#mentionRule","lex:app.bsky.feed.threadgate#followerRule","lex:app.bsky.feed.threadgate#followingRule","lex:app.bsky.feed.threadgate#listRule"]}},createdAt:{type:"string",format:"datetime"},hiddenReplies:{type:"array",maxLength:300,items:{type:"string",format:"at-uri"},description:"List of hidden reply URIs."}}}},mentionRule:{type:"object",description:"Allow replies from actors mentioned in your post.",properties:{}},followerRule:{type:"object",description:"Allow replies from actors who follow you.",properties:{}},followingRule:{type:"object",description:"Allow replies from actors you follow.",properties:{}},listRule:{type:"object",description:"Allow replies from actors on a list.",required:["list"],properties:{list:{type:"string",format:"at-uri"}}}}},AppBskyGraphBlock:{lexicon:1,id:"app.bsky.graph.block",defs:{main:{type:"record",description:"Record declaring a 'block' relationship against another account. NOTE: blocks are public in Bluesky; see blog posts for details.",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"string",format:"did",description:"DID of the account to be blocked."},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphDefs:{lexicon:1,id:"app.bsky.graph.defs",defs:{listViewBasic:{type:"object",required:["uri","cid","name","purpose"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},name:{type:"string",maxLength:64,minLength:1},purpose:{type:"ref",ref:"lex:app.bsky.graph.defs#listPurpose"},avatar:{type:"string",format:"uri"},listItemCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},viewer:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewerState"},indexedAt:{type:"string",format:"datetime"}}},listView:{type:"object",required:["uri","cid","creator","name","purpose","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},name:{type:"string",maxLength:64,minLength:1},purpose:{type:"ref",ref:"lex:app.bsky.graph.defs#listPurpose"},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"string",format:"uri"},listItemCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},viewer:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewerState"},indexedAt:{type:"string",format:"datetime"}}},listItemView:{type:"object",required:["uri","subject"],properties:{uri:{type:"string",format:"at-uri"},subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}},starterPackView:{type:"object",required:["uri","cid","record","creator","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},record:{type:"unknown"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},list:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"},listItemsSample:{type:"array",maxLength:12,items:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}},feeds:{type:"array",maxLength:3,items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}},joinedWeekCount:{type:"integer",minimum:0},joinedAllTimeCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},indexedAt:{type:"string",format:"datetime"}}},starterPackViewBasic:{type:"object",required:["uri","cid","record","creator","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},record:{type:"unknown"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},listItemCount:{type:"integer",minimum:0},joinedWeekCount:{type:"integer",minimum:0},joinedAllTimeCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},indexedAt:{type:"string",format:"datetime"}}},listPurpose:{type:"string",knownValues:["app.bsky.graph.defs#modlist","app.bsky.graph.defs#curatelist","app.bsky.graph.defs#referencelist"]},modlist:{type:"token",description:"A list of actors to apply an aggregate moderation action (mute/block) on."},curatelist:{type:"token",description:"A list of actors used for curation purposes such as list feeds or interaction gating."},referencelist:{type:"token",description:"A list of actors used for only for reference purposes such as within a starter pack."},listViewerState:{type:"object",properties:{muted:{type:"boolean"},blocked:{type:"string",format:"at-uri"}}},notFoundActor:{type:"object",description:"indicates that a handle or DID could not be resolved",required:["actor","notFound"],properties:{actor:{type:"string",format:"at-identifier"},notFound:{type:"boolean",const:!0}}},relationship:{type:"object",description:"lists the bi-directional graph relationships between one actor (not indicated in the object), and the target actors (the DID included in the object)",required:["did"],properties:{did:{type:"string",format:"did"},following:{type:"string",format:"at-uri",description:"if the actor follows this DID, this is the AT-URI of the follow record"},followedBy:{type:"string",format:"at-uri",description:"if the actor is followed by this DID, contains the AT-URI of the follow record"}}}}},AppBskyGraphFollow:{lexicon:1,id:"app.bsky.graph.follow",defs:{main:{type:"record",description:"Record declaring a social 'follow' relationship of another account. Duplicate follows will be ignored by the AppView.",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphGetActorStarterPacks:{lexicon:1,id:"app.bsky.graph.getActorStarterPacks",defs:{main:{type:"query",description:"Get a list of starter packs created by the actor.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{cursor:{type:"string"},starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"}}}}}}}},AppBskyGraphGetBlocks:{lexicon:1,id:"app.bsky.graph.getBlocks",defs:{main:{type:"query",description:"Enumerates which accounts the requesting account is currently blocking. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["blocks"],properties:{cursor:{type:"string"},blocks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetFollowers:{lexicon:1,id:"app.bsky.graph.getFollowers",defs:{main:{type:"query",description:"Enumerates accounts which follow a specified account (actor).",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject","followers"],properties:{subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},cursor:{type:"string"},followers:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetFollows:{lexicon:1,id:"app.bsky.graph.getFollows",defs:{main:{type:"query",description:"Enumerates accounts which a specified account (actor) follows.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject","follows"],properties:{subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},cursor:{type:"string"},follows:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetKnownFollowers:{lexicon:1,id:"app.bsky.graph.getKnownFollowers",defs:{main:{type:"query",description:"Enumerates accounts which follow a specified account (actor) and are followed by the viewer.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject","followers"],properties:{subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},cursor:{type:"string"},followers:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetList:{lexicon:1,id:"app.bsky.graph.getList",defs:{main:{type:"query",description:"Gets a 'view' (with additional context) of a specified list.",parameters:{type:"params",required:["list"],properties:{list:{type:"string",format:"at-uri",description:"Reference (AT-URI) of the list record to hydrate."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["list","items"],properties:{cursor:{type:"string"},list:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"},items:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}}}}}}}},AppBskyGraphGetListBlocks:{lexicon:1,id:"app.bsky.graph.getListBlocks",defs:{main:{type:"query",description:"Get mod lists that the requesting account (actor) is blocking. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["lists"],properties:{cursor:{type:"string"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"}}}}}}}},AppBskyGraphGetListMutes:{lexicon:1,id:"app.bsky.graph.getListMutes",defs:{main:{type:"query",description:"Enumerates mod lists that the requesting account (actor) currently has muted. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["lists"],properties:{cursor:{type:"string"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"}}}}}}}},AppBskyGraphGetLists:{lexicon:1,id:"app.bsky.graph.getLists",defs:{main:{type:"query",description:"Enumerates the lists created by a specified account (actor).",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"The account (actor) to enumerate lists from."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},purposes:{type:"array",description:"Optional filter by list purpose. If not specified, all supported types are returned.",items:{type:"string",knownValues:["modlist","curatelist"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["lists"],properties:{cursor:{type:"string"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"}}}}}}}},AppBskyGraphGetListsWithMembership:{lexicon:1,id:"app.bsky.graph.getListsWithMembership",defs:{main:{type:"query",description:"Enumerates the lists created by the session user, and includes membership information about `actor` in those lists. Only supports curation and moderation lists (no reference lists, used in starter packs). Requires auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"The account (actor) to check for membership."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},purposes:{type:"array",description:"Optional filter by list purpose. If not specified, all supported types are returned.",items:{type:"string",knownValues:["modlist","curatelist"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["listsWithMembership"],properties:{cursor:{type:"string"},listsWithMembership:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.getListsWithMembership#listWithMembership"}}}}}},listWithMembership:{description:"A list and an optional list item indicating membership of a target user to that list.",type:"object",required:["list"],properties:{list:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"},listItem:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}}}}},AppBskyGraphGetMutes:{lexicon:1,id:"app.bsky.graph.getMutes",defs:{main:{type:"query",description:"Enumerates accounts that the requesting account (actor) currently has muted. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["mutes"],properties:{cursor:{type:"string"},mutes:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetRelationships:{lexicon:1,id:"app.bsky.graph.getRelationships",defs:{main:{type:"query",description:"Enumerates public relationships between one account, and a list of other accounts. Does not require auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"Primary account requesting relationships for."},others:{type:"array",description:"List of 'other' accounts to be related back to the primary.",maxLength:30,items:{type:"string",format:"at-identifier"}}}},output:{encoding:"application/json",schema:{type:"object",required:["relationships"],properties:{actor:{type:"string",format:"did"},relationships:{type:"array",items:{type:"union",refs:["lex:app.bsky.graph.defs#relationship","lex:app.bsky.graph.defs#notFoundActor"]}}}}},errors:[{name:"ActorNotFound",description:"the primary actor at-identifier could not be resolved"}]}}},AppBskyGraphGetStarterPack:{lexicon:1,id:"app.bsky.graph.getStarterPack",defs:{main:{type:"query",description:"Gets a view of a starter pack.",parameters:{type:"params",required:["starterPack"],properties:{starterPack:{type:"string",format:"at-uri",description:"Reference (AT-URI) of the starter pack record."}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPack"],properties:{starterPack:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"}}}}}}},AppBskyGraphGetStarterPacks:{lexicon:1,id:"app.bsky.graph.getStarterPacks",defs:{main:{type:"query",description:"Get views for a list of starter packs.",parameters:{type:"params",required:["uris"],properties:{uris:{type:"array",items:{type:"string",format:"at-uri"},maxLength:25}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"}}}}}}}},AppBskyGraphGetStarterPacksWithMembership:{lexicon:1,id:"app.bsky.graph.getStarterPacksWithMembership",defs:{main:{type:"query",description:"Enumerates the starter packs created by the session user, and includes membership information about `actor` in those starter packs. Requires auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"The account (actor) to check for membership."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacksWithMembership"],properties:{cursor:{type:"string"},starterPacksWithMembership:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.getStarterPacksWithMembership#starterPackWithMembership"}}}}}},starterPackWithMembership:{description:"A starter pack and an optional list item indicating membership of a target user to that starter pack.",type:"object",required:["starterPack"],properties:{starterPack:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"},listItem:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}}}}},AppBskyGraphGetSuggestedFollowsByActor:{lexicon:1,id:"app.bsky.graph.getSuggestedFollowsByActor",defs:{main:{type:"query",description:"Enumerates follows similar to a given account (actor). Expected use is to recommend additional accounts immediately after following one account.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"}}},output:{encoding:"application/json",schema:{type:"object",required:["suggestions"],properties:{suggestions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}},isFallback:{type:"boolean",description:"If true, response has fallen-back to generic results, and is not scoped using relativeToDid",default:!1},recId:{type:"integer",description:"Snowflake for this recommendation, use when submitting recommendation events."}}}}}}},AppBskyGraphList:{lexicon:1,id:"app.bsky.graph.list",defs:{main:{type:"record",description:"Record representing a list of accounts (actors). Scope includes both moderation-oriented lists and curration-oriented lists.",key:"tid",record:{type:"object",required:["name","purpose","createdAt"],properties:{purpose:{type:"ref",description:"Defines the purpose of the list (aka, moderation-oriented or curration-oriented)",ref:"lex:app.bsky.graph.defs#listPurpose"},name:{type:"string",maxLength:64,minLength:1,description:"Display name for list; can not be empty."},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"blob",accept:["image/png","image/jpeg"],maxSize:1e6},labels:{type:"union",refs:["lex:com.atproto.label.defs#selfLabels"]},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphListblock:{lexicon:1,id:"app.bsky.graph.listblock",defs:{main:{type:"record",description:"Record representing a block relationship against an entire an entire list of accounts (actors).",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the mod list record."},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphListitem:{lexicon:1,id:"app.bsky.graph.listitem",defs:{main:{type:"record",description:"Record representing an account's inclusion on a specific list. The AppView will ignore duplicate listitem records.",key:"tid",record:{type:"object",required:["subject","list","createdAt"],properties:{subject:{type:"string",format:"did",description:"The account which is included on the list."},list:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the list record (app.bsky.graph.list)."},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphMuteActor:{lexicon:1,id:"app.bsky.graph.muteActor",defs:{main:{type:"procedure",description:"Creates a mute relationship for the specified account. Mutes are private in Bluesky. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"}}}}}}},AppBskyGraphMuteActorList:{lexicon:1,id:"app.bsky.graph.muteActorList",defs:{main:{type:"procedure",description:"Creates a mute relationship for the specified list of accounts. Mutes are private in Bluesky. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["list"],properties:{list:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphMuteThread:{lexicon:1,id:"app.bsky.graph.muteThread",defs:{main:{type:"procedure",description:"Mutes a thread preventing notifications from the thread and any of its children. Mutes are private in Bluesky. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["root"],properties:{root:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphSearchStarterPacks:{lexicon:1,id:"app.bsky.graph.searchStarterPacks",defs:{main:{type:"query",description:"Find starter packs matching search criteria. Does not require auth.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string. Syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{cursor:{type:"string"},starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"}}}}}}}},AppBskyGraphStarterpack:{lexicon:1,id:"app.bsky.graph.starterpack",defs:{main:{type:"record",description:"Record defining a starter pack of actors and feeds for new users.",key:"tid",record:{type:"object",required:["name","list","createdAt"],properties:{name:{type:"string",maxGraphemes:50,maxLength:500,minLength:1,description:"Display name for starter pack; can not be empty."},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},list:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the list record."},feeds:{type:"array",maxLength:3,items:{type:"ref",ref:"lex:app.bsky.graph.starterpack#feedItem"}},createdAt:{type:"string",format:"datetime"}}}},feedItem:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}}}},AppBskyGraphUnmuteActor:{lexicon:1,id:"app.bsky.graph.unmuteActor",defs:{main:{type:"procedure",description:"Unmutes the specified account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"}}}}}}},AppBskyGraphUnmuteActorList:{lexicon:1,id:"app.bsky.graph.unmuteActorList",defs:{main:{type:"procedure",description:"Unmutes the specified list of accounts. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["list"],properties:{list:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphUnmuteThread:{lexicon:1,id:"app.bsky.graph.unmuteThread",defs:{main:{type:"procedure",description:"Unmutes the specified thread. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["root"],properties:{root:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphVerification:{lexicon:1,id:"app.bsky.graph.verification",defs:{main:{type:"record",description:"Record declaring a verification relationship between two accounts. Verifications are only considered valid by an app if issued by an account the app considers trusted.",key:"tid",record:{type:"object",required:["subject","handle","displayName","createdAt"],properties:{subject:{description:"DID of the subject the verification applies to.",type:"string",format:"did"},handle:{description:"Handle of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current handle matches the one at the time of verifying.",type:"string",format:"handle"},displayName:{description:"Display name of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current displayName matches the one at the time of verifying.",type:"string"},createdAt:{description:"Date of when the verification was created.",type:"string",format:"datetime"}}}}}},AppBskyLabelerDefs:{lexicon:1,id:"app.bsky.labeler.defs",defs:{labelerView:{type:"object",required:["uri","cid","creator","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},likeCount:{type:"integer",minimum:0},viewer:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerViewerState"},indexedAt:{type:"string",format:"datetime"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}},labelerViewDetailed:{type:"object",required:["uri","cid","creator","policies","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},policies:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerPolicies"},likeCount:{type:"integer",minimum:0},viewer:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerViewerState"},indexedAt:{type:"string",format:"datetime"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},reasonTypes:{description:"The set of report reason 'codes' which are in-scope for this service to review and action. These usually align to policy categories. If not defined (distinct from empty array), all reason types are allowed.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"}},subjectTypes:{description:"The set of subject types (account, record, etc) this service accepts reports on.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#subjectType"}},subjectCollections:{type:"array",description:"Set of record types (collection NSIDs) which can be reported to this service. If not defined (distinct from empty array), default is any record type.",items:{type:"string",format:"nsid"}}}},labelerViewerState:{type:"object",properties:{like:{type:"string",format:"at-uri"}}},labelerPolicies:{type:"object",required:["labelValues"],properties:{labelValues:{type:"array",description:"The label values which this labeler publishes. May include global or custom labels.",items:{type:"ref",ref:"lex:com.atproto.label.defs#labelValue"}},labelValueDefinitions:{type:"array",description:"Label values created by this labeler and scoped exclusively to it. Labels defined here will override global label definitions for this labeler.",items:{type:"ref",ref:"lex:com.atproto.label.defs#labelValueDefinition"}}}}}},AppBskyLabelerGetServices:{lexicon:1,id:"app.bsky.labeler.getServices",defs:{main:{type:"query",description:"Get information about a list of labeler services.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}},detailed:{type:"boolean",default:!1}}},output:{encoding:"application/json",schema:{type:"object",required:["views"],properties:{views:{type:"array",items:{type:"union",refs:["lex:app.bsky.labeler.defs#labelerView","lex:app.bsky.labeler.defs#labelerViewDetailed"]}}}}}}}},AppBskyLabelerService:{lexicon:1,id:"app.bsky.labeler.service",defs:{main:{type:"record",description:"A declaration of the existence of labeler service.",key:"literal:self",record:{type:"object",required:["policies","createdAt"],properties:{policies:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerPolicies"},labels:{type:"union",refs:["lex:com.atproto.label.defs#selfLabels"]},createdAt:{type:"string",format:"datetime"},reasonTypes:{description:"The set of report reason 'codes' which are in-scope for this service to review and action. These usually align to policy categories. If not defined (distinct from empty array), all reason types are allowed.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"}},subjectTypes:{description:"The set of subject types (account, record, etc) this service accepts reports on.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#subjectType"}},subjectCollections:{type:"array",description:"Set of record types (collection NSIDs) which can be reported to this service. If not defined (distinct from empty array), default is any record type.",items:{type:"string",format:"nsid"}}}}}}},AppBskyNotificationDeclaration:{lexicon:1,id:"app.bsky.notification.declaration",defs:{main:{type:"record",description:"A declaration of the user's choices related to notifications that can be produced by them.",key:"literal:self",record:{type:"object",required:["allowSubscriptions"],properties:{allowSubscriptions:{type:"string",description:"A declaration of the user's preference for allowing activity subscriptions from other users. Absence of a record implies 'followers'.",knownValues:["followers","mutuals","none"]}}}}}},AppBskyNotificationDefs:{lexicon:1,id:"app.bsky.notification.defs",defs:{recordDeleted:{type:"object",properties:{}},chatPreference:{type:"object",required:["include","push"],properties:{include:{type:"string",knownValues:["all","accepted"]},push:{type:"boolean"}}},filterablePreference:{type:"object",required:["include","list","push"],properties:{include:{type:"string",knownValues:["all","follows"]},list:{type:"boolean"},push:{type:"boolean"}}},preference:{type:"object",required:["list","push"],properties:{list:{type:"boolean"},push:{type:"boolean"}}},preferences:{type:"object",required:["chat","follow","like","likeViaRepost","mention","quote","reply","repost","repostViaRepost","starterpackJoined","subscribedPost","unverified","verified"],properties:{chat:{type:"ref",ref:"lex:app.bsky.notification.defs#chatPreference"},follow:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},like:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},likeViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},mention:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},quote:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},reply:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repostViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},starterpackJoined:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},subscribedPost:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},unverified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},verified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"}}},activitySubscription:{type:"object",required:["post","reply"],properties:{post:{type:"boolean"},reply:{type:"boolean"}}},subjectActivitySubscription:{description:"Object used to store activity subscription data in stash.",type:"object",required:["subject","activitySubscription"],properties:{subject:{type:"string",format:"did"},activitySubscription:{type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}}}},AppBskyNotificationGetPreferences:{lexicon:1,id:"app.bsky.notification.getPreferences",defs:{main:{type:"query",description:"Get notification-related preferences for an account. Requires auth.",parameters:{type:"params",properties:{}},output:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.notification.defs#preferences"}}}}}}},AppBskyNotificationGetUnreadCount:{lexicon:1,id:"app.bsky.notification.getUnreadCount",defs:{main:{type:"query",description:"Count the number of unread notifications for the requesting account. Requires auth.",parameters:{type:"params",properties:{priority:{type:"boolean"},seenAt:{type:"string",format:"datetime"}}},output:{encoding:"application/json",schema:{type:"object",required:["count"],properties:{count:{type:"integer"}}}}}}},AppBskyNotificationListActivitySubscriptions:{lexicon:1,id:"app.bsky.notification.listActivitySubscriptions",defs:{main:{type:"query",description:"Enumerate all accounts to which the requesting account is subscribed to receive notifications for. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subscriptions"],properties:{cursor:{type:"string"},subscriptions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyNotificationListNotifications:{lexicon:1,id:"app.bsky.notification.listNotifications",defs:{main:{type:"query",description:"Enumerate notifications for the requesting account. Requires auth.",parameters:{type:"params",properties:{reasons:{description:"Notification reasons to include in response.",type:"array",items:{type:"string",description:"A reason that matches the reason property of #notification."}},limit:{type:"integer",minimum:1,maximum:100,default:50},priority:{type:"boolean"},cursor:{type:"string"},seenAt:{type:"string",format:"datetime"}}},output:{encoding:"application/json",schema:{type:"object",required:["notifications"],properties:{cursor:{type:"string"},notifications:{type:"array",items:{type:"ref",ref:"lex:app.bsky.notification.listNotifications#notification"}},priority:{type:"boolean"},seenAt:{type:"string",format:"datetime"}}}}},notification:{type:"object",required:["uri","cid","author","reason","record","isRead","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},author:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},reason:{type:"string",description:"The reason why this notification was delivered - e.g. your post was liked, or you received a new follower.",knownValues:["like","repost","follow","mention","reply","quote","starterpack-joined","verified","unverified","like-via-repost","repost-via-repost","subscribed-post"]},reasonSubject:{type:"string",format:"at-uri"},record:{type:"unknown"},isRead:{type:"boolean"},indexedAt:{type:"string",format:"datetime"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}}}},AppBskyNotificationPutActivitySubscription:{lexicon:1,id:"app.bsky.notification.putActivitySubscription",defs:{main:{type:"procedure",description:"Puts an activity subscription entry. The key should be omitted for creation and provided for updates. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["subject","activitySubscription"],properties:{subject:{type:"string",format:"did"},activitySubscription:{type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}}},output:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"string",format:"did"},activitySubscription:{type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}}}}}},AppBskyNotificationPutPreferences:{lexicon:1,id:"app.bsky.notification.putPreferences",defs:{main:{type:"procedure",description:"Set notification-related preferences for an account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["priority"],properties:{priority:{type:"boolean"}}}}}}},AppBskyNotificationPutPreferencesV2:{lexicon:1,id:"app.bsky.notification.putPreferencesV2",defs:{main:{type:"procedure",description:"Set notification-related preferences for an account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",properties:{chat:{type:"ref",ref:"lex:app.bsky.notification.defs#chatPreference"},follow:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},like:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},likeViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},mention:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},quote:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},reply:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repostViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},starterpackJoined:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},subscribedPost:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},unverified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},verified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"}}}},output:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.notification.defs#preferences"}}}}}}},AppBskyNotificationRegisterPush:{lexicon:1,id:"app.bsky.notification.registerPush",defs:{main:{type:"procedure",description:"Register to receive push notifications, via a specified service, for the requesting account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["serviceDid","token","platform","appId"],properties:{serviceDid:{type:"string",format:"did"},token:{type:"string"},platform:{type:"string",knownValues:["ios","android","web"]},appId:{type:"string"},ageRestricted:{type:"boolean",description:"Set to true when the actor is age restricted"}}}}}}},AppBskyNotificationUnregisterPush:{lexicon:1,id:"app.bsky.notification.unregisterPush",defs:{main:{type:"procedure",description:"The inverse of registerPush - inform a specified service that push notifications should no longer be sent to the given token for the requesting account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["serviceDid","token","platform","appId"],properties:{serviceDid:{type:"string",format:"did"},token:{type:"string"},platform:{type:"string",knownValues:["ios","android","web"]},appId:{type:"string"}}}}}}},AppBskyNotificationUpdateSeen:{lexicon:1,id:"app.bsky.notification.updateSeen",defs:{main:{type:"procedure",description:"Notify server that the requesting account has seen notifications. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["seenAt"],properties:{seenAt:{type:"string",format:"datetime"}}}}}}},AppBskyRichtextFacet:{lexicon:1,id:"app.bsky.richtext.facet",defs:{main:{type:"object",description:"Annotation of a sub-string within rich text.",required:["index","features"],properties:{index:{type:"ref",ref:"lex:app.bsky.richtext.facet#byteSlice"},features:{type:"array",items:{type:"union",refs:["lex:app.bsky.richtext.facet#mention","lex:app.bsky.richtext.facet#link","lex:app.bsky.richtext.facet#tag"]}}}},mention:{type:"object",description:"Facet feature for mention of another account. The text is usually a handle, including a '@' prefix, but the facet reference is a DID.",required:["did"],properties:{did:{type:"string",format:"did"}}},link:{type:"object",description:"Facet feature for a URL. The text URL may have been simplified or truncated, but the facet reference should be a complete URL.",required:["uri"],properties:{uri:{type:"string",format:"uri"}}},tag:{type:"object",description:"Facet feature for a hashtag. The text usually includes a '#' prefix, but the facet reference should not (except in the case of 'double hash tags').",required:["tag"],properties:{tag:{type:"string",maxLength:640,maxGraphemes:64}}},byteSlice:{type:"object",description:"Specifies the sub-string range a facet feature applies to. Start index is inclusive, end index is exclusive. Indices are zero-indexed, counting bytes of the UTF-8 encoded text. NOTE: some languages, like Javascript, use UTF-16 or Unicode codepoints for string slice indexing; in these languages, convert to byte arrays before working with facets.",required:["byteStart","byteEnd"],properties:{byteStart:{type:"integer",minimum:0},byteEnd:{type:"integer",minimum:0}}}}},AppBskyUnspeccedDefs:{lexicon:1,id:"app.bsky.unspecced.defs",defs:{skeletonSearchPost:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},skeletonSearchActor:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},skeletonSearchStarterPack:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},trendingTopic:{type:"object",required:["topic","link"],properties:{topic:{type:"string"},displayName:{type:"string"},description:{type:"string"},link:{type:"string"}}},skeletonTrend:{type:"object",required:["topic","displayName","link","startedAt","postCount","dids"],properties:{topic:{type:"string"},displayName:{type:"string"},link:{type:"string"},startedAt:{type:"string",format:"datetime"},postCount:{type:"integer"},status:{type:"string",knownValues:["hot"]},category:{type:"string"},dids:{type:"array",items:{type:"string",format:"did"}}}},trendView:{type:"object",required:["topic","displayName","link","startedAt","postCount","actors"],properties:{topic:{type:"string"},displayName:{type:"string"},link:{type:"string"},startedAt:{type:"string",format:"datetime"},postCount:{type:"integer"},status:{type:"string",knownValues:["hot"]},category:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"}}}},threadItemPost:{type:"object",required:["post","moreParents","moreReplies","opThread","hiddenByThreadgate","mutedByViewer"],properties:{post:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"},moreParents:{type:"boolean",description:"This post has more parents that were not present in the response. This is just a boolean, without the number of parents."},moreReplies:{type:"integer",description:"This post has more replies that were not present in the response. This is a numeric value, which is best-effort and might not be accurate."},opThread:{type:"boolean",description:"This post is part of a contiguous thread by the OP from the thread root. Many different OP threads can happen in the same thread."},hiddenByThreadgate:{type:"boolean",description:"The threadgate created by the author indicates this post as a reply to be hidden for everyone consuming the thread."},mutedByViewer:{type:"boolean",description:"This is by an account muted by the viewer requesting it."}}},threadItemNoUnauthenticated:{type:"object",properties:{}},threadItemNotFound:{type:"object",properties:{}},threadItemBlocked:{type:"object",required:["author"],properties:{author:{type:"ref",ref:"lex:app.bsky.feed.defs#blockedAuthor"}}},ageAssuranceState:{type:"object",description:"The computed state of the age assurance process, returned to the user in question on certain authenticated requests.",required:["status"],properties:{lastInitiatedAt:{type:"string",format:"datetime",description:"The timestamp when this state was last updated."},status:{type:"string",description:"The status of the age assurance process.",knownValues:["unknown","pending","assured","blocked"]}}},ageAssuranceEvent:{type:"object",description:"Object used to store age assurance data in stash.",required:["createdAt","status","attemptId"],properties:{createdAt:{type:"string",format:"datetime",description:"The date and time of this write operation."},status:{type:"string",description:"The status of the age assurance process.",knownValues:["unknown","pending","assured"]},attemptId:{type:"string",description:"The unique identifier for this instance of the age assurance flow, in UUID format."},email:{type:"string",description:"The email used for AA."},initIp:{type:"string",description:"The IP address used when initiating the AA flow."},initUa:{type:"string",description:"The user agent used when initiating the AA flow."},completeIp:{type:"string",description:"The IP address used when completing the AA flow."},completeUa:{type:"string",description:"The user agent used when completing the AA flow."}}}}},AppBskyUnspeccedGetAgeAssuranceState:{lexicon:1,id:"app.bsky.unspecced.getAgeAssuranceState",defs:{main:{type:"query",description:"Returns the current state of the age assurance process for an account. This is used to check if the user has completed age assurance or if further action is required.",output:{encoding:"application/json",schema:{type:"ref",ref:"lex:app.bsky.unspecced.defs#ageAssuranceState"}}}}},AppBskyUnspeccedGetConfig:{lexicon:1,id:"app.bsky.unspecced.getConfig",defs:{main:{type:"query",description:"Get miscellaneous runtime configuration.",output:{encoding:"application/json",schema:{type:"object",required:[],properties:{checkEmailConfirmed:{type:"boolean"},liveNow:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.getConfig#liveNowConfig"}}}}}},liveNowConfig:{type:"object",required:["did","domains"],properties:{did:{type:"string",format:"did"},domains:{type:"array",items:{type:"string"}}}}}},AppBskyUnspeccedGetOnboardingSuggestedStarterPacks:{lexicon:1,id:"app.bsky.unspecced.getOnboardingSuggestedStarterPacks",defs:{main:{type:"query",description:"Get a list of suggested starterpacks for onboarding",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"}}}}}}}},AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton:{lexicon:1,id:"app.bsky.unspecced.getOnboardingSuggestedStarterPacksSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested starterpacks for onboarding. Intended to be called and hydrated by app.bsky.unspecced.getOnboardingSuggestedStarterPacks",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"string",format:"at-uri"}}}}}}}},AppBskyUnspeccedGetPopularFeedGenerators:{lexicon:1,id:"app.bsky.unspecced.getPopularFeedGenerators",defs:{main:{type:"query",description:"An unspecced view of globally popular feed generators.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},query:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{cursor:{type:"string"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyUnspeccedGetPostThreadOtherV2:{lexicon:1,id:"app.bsky.unspecced.getPostThreadOtherV2",defs:{main:{type:"query",description:"(NOTE: this endpoint is under development and WILL change without notice. Don't use it until it is moved out of `unspecced` or your application WILL break) Get additional posts under a thread e.g. replies hidden by threadgate. Based on an anchor post at any depth of the tree, returns top-level replies below that anchor. It does not include ancestors nor the anchor itself. This should be called after exhausting `app.bsky.unspecced.getPostThreadV2`. Does not require auth, but additional metadata and filtering will be applied for authed requests.",parameters:{type:"params",required:["anchor"],properties:{anchor:{type:"string",format:"at-uri",description:"Reference (AT-URI) to post record. This is the anchor post."},prioritizeFollowedUsers:{type:"boolean",description:"Whether to prioritize posts from followed users. It only has effect when the user is authenticated.",default:!1}}},output:{encoding:"application/json",schema:{type:"object",required:["thread"],properties:{thread:{type:"array",description:"A flat list of other thread items. The depth of each item is indicated by the depth property inside the item.",items:{type:"ref",ref:"lex:app.bsky.unspecced.getPostThreadOtherV2#threadItem"}}}}}},threadItem:{type:"object",required:["uri","depth","value"],properties:{uri:{type:"string",format:"at-uri"},depth:{type:"integer",description:"The nesting level of this item in the thread. Depth 0 means the anchor item. Items above have negative depths, items below have positive depths."},value:{type:"union",refs:["lex:app.bsky.unspecced.defs#threadItemPost"]}}}}},AppBskyUnspeccedGetPostThreadV2:{lexicon:1,id:"app.bsky.unspecced.getPostThreadV2",defs:{main:{type:"query",description:"(NOTE: this endpoint is under development and WILL change without notice. Don't use it until it is moved out of `unspecced` or your application WILL break) Get posts in a thread. It is based in an anchor post at any depth of the tree, and returns posts above it (recursively resolving the parent, without further branching to their replies) and below it (recursive replies, with branching to their replies). Does not require auth, but additional metadata and filtering will be applied for authed requests.",parameters:{type:"params",required:["anchor"],properties:{anchor:{type:"string",format:"at-uri",description:"Reference (AT-URI) to post record. This is the anchor post, and the thread will be built around it. It can be any post in the tree, not necessarily a root post."},above:{type:"boolean",description:"Whether to include parents above the anchor.",default:!0},below:{type:"integer",description:"How many levels of replies to include below the anchor.",default:6,minimum:0,maximum:20},branchingFactor:{type:"integer",description:"Maximum of replies to include at each level of the thread, except for the direct replies to the anchor, which are (NOTE: currently, during unspecced phase) all returned (NOTE: later they might be paginated).",default:10,minimum:0,maximum:100},prioritizeFollowedUsers:{type:"boolean",description:"Whether to prioritize posts from followed users. It only has effect when the user is authenticated.",default:!1},sort:{type:"string",description:"Sorting for the thread replies.",knownValues:["newest","oldest","top"],default:"oldest"}}},output:{encoding:"application/json",schema:{type:"object",required:["thread","hasOtherReplies"],properties:{thread:{type:"array",description:"A flat list of thread items. The depth of each item is indicated by the depth property inside the item.",items:{type:"ref",ref:"lex:app.bsky.unspecced.getPostThreadV2#threadItem"}},threadgate:{type:"ref",ref:"lex:app.bsky.feed.defs#threadgateView"},hasOtherReplies:{type:"boolean",description:"Whether this thread has additional replies. If true, a call can be made to the `getPostThreadOtherV2` endpoint to retrieve them."}}}}},threadItem:{type:"object",required:["uri","depth","value"],properties:{uri:{type:"string",format:"at-uri"},depth:{type:"integer",description:"The nesting level of this item in the thread. Depth 0 means the anchor item. Items above have negative depths, items below have positive depths."},value:{type:"union",refs:["lex:app.bsky.unspecced.defs#threadItemPost","lex:app.bsky.unspecced.defs#threadItemNoUnauthenticated","lex:app.bsky.unspecced.defs#threadItemNotFound","lex:app.bsky.unspecced.defs#threadItemBlocked"]}}}}},AppBskyUnspeccedGetSuggestedFeeds:{lexicon:1,id:"app.bsky.unspecced.getSuggestedFeeds",defs:{main:{type:"query",description:"Get a list of suggested feeds",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyUnspeccedGetSuggestedFeedsSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestedFeedsSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested feeds. Intended to be called and hydrated by app.bsky.unspecced.getSuggestedFeeds",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{feeds:{type:"array",items:{type:"string",format:"at-uri"}}}}}}}},AppBskyUnspeccedGetSuggestedStarterPacks:{lexicon:1,id:"app.bsky.unspecced.getSuggestedStarterPacks",defs:{main:{type:"query",description:"Get a list of suggested starterpacks",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"}}}}}}}},AppBskyUnspeccedGetSuggestedStarterPacksSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestedStarterPacksSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested starterpacks. Intended to be called and hydrated by app.bsky.unspecced.getSuggestedStarterpacks",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"string",format:"at-uri"}}}}}}}},AppBskyUnspeccedGetSuggestedUsers:{lexicon:1,id:"app.bsky.unspecced.getSuggestedUsers",defs:{main:{type:"query",description:"Get a list of suggested users",parameters:{type:"params",properties:{category:{type:"string",description:"Category of users to get suggestions for."},limit:{type:"integer",minimum:1,maximum:50,default:25}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyUnspeccedGetSuggestedUsersSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestedUsersSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested users. Intended to be called and hydrated by app.bsky.unspecced.getSuggestedUsers",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},category:{type:"string",description:"Category of users to get suggestions for."},limit:{type:"integer",minimum:1,maximum:50,default:25}}},output:{encoding:"application/json",schema:{type:"object",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}}}}}}}},AppBskyUnspeccedGetSuggestionsSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestionsSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested actors. Intended to be called and then hydrated through app.bsky.actor.getSuggestions",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used to boost followed accounts in ranking."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},relativeToDid:{type:"string",format:"did",description:"DID of the account to get suggestions relative to. If not provided, suggestions will be based on the viewer."}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchActor"}},relativeToDid:{type:"string",format:"did",description:"DID of the account these suggestions are relative to. If this is returned undefined, suggestions are based on the viewer."},recId:{type:"integer",description:"Snowflake for this recommendation, use when submitting recommendation events."}}}}}}},AppBskyUnspeccedGetTaggedSuggestions:{lexicon:1,id:"app.bsky.unspecced.getTaggedSuggestions",defs:{main:{type:"query",description:"Get a list of suggestions (feeds and users) tagged with categories",parameters:{type:"params",properties:{}},output:{encoding:"application/json",schema:{type:"object",required:["suggestions"],properties:{suggestions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.getTaggedSuggestions#suggestion"}}}}}},suggestion:{type:"object",required:["tag","subjectType","subject"],properties:{tag:{type:"string"},subjectType:{type:"string",knownValues:["actor","feed"]},subject:{type:"string",format:"uri"}}}}},AppBskyUnspeccedGetTrendingTopics:{lexicon:1,id:"app.bsky.unspecced.getTrendingTopics",defs:{main:{type:"query",description:"Get a list of trending topics",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used to boost followed accounts in ranking."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["topics","suggested"],properties:{topics:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#trendingTopic"}},suggested:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#trendingTopic"}}}}}}}},AppBskyUnspeccedGetTrends:{lexicon:1,id:"app.bsky.unspecced.getTrends",defs:{main:{type:"query",description:"Get the current trends on the network",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["trends"],properties:{trends:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#trendView"}}}}}}}},AppBskyUnspeccedGetTrendsSkeleton:{lexicon:1,id:"app.bsky.unspecced.getTrendsSkeleton",defs:{main:{type:"query",description:"Get the skeleton of trends on the network. Intended to be called and then hydrated through app.bsky.unspecced.getTrends",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["trends"],properties:{trends:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonTrend"}}}}}}}},AppBskyUnspeccedInitAgeAssurance:{lexicon:1,id:"app.bsky.unspecced.initAgeAssurance",defs:{main:{type:"procedure",description:"Initiate age assurance for an account. This is a one-time action that will start the process of verifying the user's age.",input:{encoding:"application/json",schema:{type:"object",required:["email","language","countryCode"],properties:{email:{type:"string",description:"The user's email address to receive assurance instructions."},language:{type:"string",description:"The user's preferred language for communication during the assurance process."},countryCode:{type:"string",description:"An ISO 3166-1 alpha-2 code of the user's location."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:app.bsky.unspecced.defs#ageAssuranceState"}},errors:[{name:"InvalidEmail"},{name:"DidTooLong"},{name:"InvalidInitiation"}]}}},AppBskyUnspeccedSearchActorsSkeleton:{lexicon:1,id:"app.bsky.unspecced.searchActorsSkeleton",defs:{main:{type:"query",description:"Backend Actors (profile) search, returns only skeleton.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended. For typeahead search, only simple term match is supported, not full syntax."},viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used to boost followed accounts in ranking."},typeahead:{type:"boolean",description:"If true, acts as fast/simple 'typeahead' query."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchActor"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyUnspeccedSearchPostsSkeleton:{lexicon:1,id:"app.bsky.unspecced.searchPostsSkeleton",defs:{main:{type:"query",description:"Backend Posts search, returns only skeleton",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},sort:{type:"string",knownValues:["top","latest"],default:"latest",description:"Specifies the ranking order of results."},since:{type:"string",description:"Filter results for posts after the indicated datetime (inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYYY-MM-DD)."},until:{type:"string",description:"Filter results for posts before the indicated datetime (not inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYY-MM-DD)."},mentions:{type:"string",format:"at-identifier",description:"Filter to posts which mention the given account. Handles are resolved to DID before query-time. Only matches rich-text facet mentions."},author:{type:"string",format:"at-identifier",description:"Filter to posts by the given account. Handles are resolved to DID before query-time."},lang:{type:"string",format:"language",description:"Filter to posts in the given language. Expected to be based on post language field, though server may override language detection."},domain:{type:"string",description:"Filter to posts with URLs (facet links or embeds) linking to the given domain (hostname). Server may apply hostname normalization."},url:{type:"string",format:"uri",description:"Filter to posts with links (facet links or embeds) pointing to this URL. Server may apply URL normalization or fuzzy matching."},tag:{type:"array",items:{type:"string",maxLength:640,maxGraphemes:64},description:"Filter to posts with the given tag (hashtag), based on rich-text facet or tag field. Do not include the hash (#) prefix. Multiple tags can be specified, with 'AND' matching."},viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used for 'from:me' queries."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["posts"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchPost"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyUnspeccedSearchStarterPacksSkeleton:{lexicon:1,id:"app.bsky.unspecced.searchStarterPacksSkeleton",defs:{main:{type:"query",description:"Backend Starter Pack search, returns only skeleton.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchStarterPack"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyVideoDefs:{lexicon:1,id:"app.bsky.video.defs",defs:{jobStatus:{type:"object",required:["jobId","did","state"],properties:{jobId:{type:"string"},did:{type:"string",format:"did"},state:{type:"string",description:"The state of the video processing job. All values not listed as a known value indicate that the job is in process.",knownValues:["JOB_STATE_COMPLETED","JOB_STATE_FAILED"]},progress:{type:"integer",minimum:0,maximum:100,description:"Progress within the current processing state."},blob:{type:"blob"},error:{type:"string"},message:{type:"string"}}}}},AppBskyVideoGetJobStatus:{lexicon:1,id:"app.bsky.video.getJobStatus",defs:{main:{type:"query",description:"Get status details for a video processing job.",parameters:{type:"params",required:["jobId"],properties:{jobId:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["jobStatus"],properties:{jobStatus:{type:"ref",ref:"lex:app.bsky.video.defs#jobStatus"}}}}}}},AppBskyVideoGetUploadLimits:{lexicon:1,id:"app.bsky.video.getUploadLimits",defs:{main:{type:"query",description:"Get video upload limits for the authenticated user.",output:{encoding:"application/json",schema:{type:"object",required:["canUpload"],properties:{canUpload:{type:"boolean"},remainingDailyVideos:{type:"integer"},remainingDailyBytes:{type:"integer"},message:{type:"string"},error:{type:"string"}}}}}}},AppBskyVideoUploadVideo:{lexicon:1,id:"app.bsky.video.uploadVideo",defs:{main:{type:"procedure",description:"Upload a video to be processed then stored on the PDS.",input:{encoding:"video/mp4"},output:{encoding:"application/json",schema:{type:"object",required:["jobStatus"],properties:{jobStatus:{type:"ref",ref:"lex:app.bsky.video.defs#jobStatus"}}}}}}},ChatBskyActorDeclaration:{lexicon:1,id:"chat.bsky.actor.declaration",defs:{main:{type:"record",description:"A declaration of a Bluesky chat account.",key:"literal:self",record:{type:"object",required:["allowIncoming"],properties:{allowIncoming:{type:"string",knownValues:["all","none","following"]}}}}}},ChatBskyActorDefs:{lexicon:1,id:"chat.bsky.actor.defs",defs:{profileViewBasic:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},avatar:{type:"string",format:"uri"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},chatDisabled:{type:"boolean",description:"Set to true when the actor cannot actively participate in conversations"},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"}}}}},ChatBskyActorDeleteAccount:{lexicon:1,id:"chat.bsky.actor.deleteAccount",defs:{main:{type:"procedure",output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},ChatBskyActorExportAccountData:{lexicon:1,id:"chat.bsky.actor.exportAccountData",defs:{main:{type:"query",output:{encoding:"application/jsonl"}}}},ChatBskyConvoAcceptConvo:{lexicon:1,id:"chat.bsky.convo.acceptConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",properties:{rev:{description:"Rev when the convo was accepted. If not present, the convo was already accepted.",type:"string"}}}}}}},ChatBskyConvoAddReaction:{lexicon:1,id:"chat.bsky.convo.addReaction",defs:{main:{type:"procedure",description:"Adds an emoji reaction to a message. Requires authentication. It is idempotent, so multiple calls from the same user with the same emoji result in a single reaction.",input:{encoding:"application/json",schema:{type:"object",required:["convoId","messageId","value"],properties:{convoId:{type:"string"},messageId:{type:"string"},value:{type:"string",minLength:1,maxLength:64,minGraphemes:1,maxGraphemes:1}}}},output:{encoding:"application/json",schema:{type:"object",required:["message"],properties:{message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}},errors:[{name:"ReactionMessageDeleted",description:"Indicates that the message has been deleted and reactions can no longer be added/removed."},{name:"ReactionLimitReached",description:"Indicates that the message has the maximum number of reactions allowed for a single user, and the requested reaction wasn't yet present. If it was already present, the request will not fail since it is idempotent."},{name:"ReactionInvalidValue",description:"Indicates the value for the reaction is not acceptable. In general, this means it is not an emoji."}]}}},ChatBskyConvoDefs:{lexicon:1,id:"chat.bsky.convo.defs",defs:{messageRef:{type:"object",required:["did","messageId","convoId"],properties:{did:{type:"string",format:"did"},convoId:{type:"string"},messageId:{type:"string"}}},messageInput:{type:"object",required:["text"],properties:{text:{type:"string",maxLength:1e4,maxGraphemes:1e3},facets:{type:"array",description:"Annotations of text (mentions, URLs, hashtags, etc)",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},embed:{type:"union",refs:["lex:app.bsky.embed.record"]}}},messageView:{type:"object",required:["id","rev","text","sender","sentAt"],properties:{id:{type:"string"},rev:{type:"string"},text:{type:"string",maxLength:1e4,maxGraphemes:1e3},facets:{type:"array",description:"Annotations of text (mentions, URLs, hashtags, etc)",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},embed:{type:"union",refs:["lex:app.bsky.embed.record#view"]},reactions:{type:"array",description:"Reactions to this message, in ascending order of creation time.",items:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}},sender:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageViewSender"},sentAt:{type:"string",format:"datetime"}}},deletedMessageView:{type:"object",required:["id","rev","sender","sentAt"],properties:{id:{type:"string"},rev:{type:"string"},sender:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageViewSender"},sentAt:{type:"string",format:"datetime"}}},messageViewSender:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},reactionView:{type:"object",required:["value","sender","createdAt"],properties:{value:{type:"string"},sender:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionViewSender"},createdAt:{type:"string",format:"datetime"}}},reactionViewSender:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},messageAndReactionView:{type:"object",required:["message","reaction"],properties:{message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"},reaction:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}}},convoView:{type:"object",required:["id","rev","members","muted","unreadCount"],properties:{id:{type:"string"},rev:{type:"string"},members:{type:"array",items:{type:"ref",ref:"lex:chat.bsky.actor.defs#profileViewBasic"}},lastMessage:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]},lastReaction:{type:"union",refs:["lex:chat.bsky.convo.defs#messageAndReactionView"]},muted:{type:"boolean"},status:{type:"string",knownValues:["request","accepted"]},unreadCount:{type:"integer"}}},logBeginConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logAcceptConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logLeaveConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logMuteConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logUnmuteConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logCreateMessage:{type:"object",required:["rev","convoId","message"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}},logDeleteMessage:{type:"object",required:["rev","convoId","message"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}},logReadMessage:{type:"object",required:["rev","convoId","message"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}},logAddReaction:{type:"object",required:["rev","convoId","message","reaction"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]},reaction:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}}},logRemoveReaction:{type:"object",required:["rev","convoId","message","reaction"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]},reaction:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}}}}},ChatBskyConvoDeleteMessageForSelf:{lexicon:1,id:"chat.bsky.convo.deleteMessageForSelf",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId","messageId"],properties:{convoId:{type:"string"},messageId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:chat.bsky.convo.defs#deletedMessageView"}}}}},ChatBskyConvoGetConvo:{lexicon:1,id:"chat.bsky.convo.getConvo",defs:{main:{type:"query",parameters:{type:"params",required:["convoId"],properties:{convoId:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoGetConvoAvailability:{lexicon:1,id:"chat.bsky.convo.getConvoAvailability",defs:{main:{type:"query",description:"Get whether the requester and the other members can chat. If an existing convo is found for these members, it is returned.",parameters:{type:"params",required:["members"],properties:{members:{type:"array",minLength:1,maxLength:10,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["canChat"],properties:{canChat:{type:"boolean"},convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoGetConvoForMembers:{lexicon:1,id:"chat.bsky.convo.getConvoForMembers",defs:{main:{type:"query",parameters:{type:"params",required:["members"],properties:{members:{type:"array",minLength:1,maxLength:10,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoGetLog:{lexicon:1,id:"chat.bsky.convo.getLog",defs:{main:{type:"query",parameters:{type:"params",required:[],properties:{cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["logs"],properties:{cursor:{type:"string"},logs:{type:"array",items:{type:"union",refs:["lex:chat.bsky.convo.defs#logBeginConvo","lex:chat.bsky.convo.defs#logAcceptConvo","lex:chat.bsky.convo.defs#logLeaveConvo","lex:chat.bsky.convo.defs#logMuteConvo","lex:chat.bsky.convo.defs#logUnmuteConvo","lex:chat.bsky.convo.defs#logCreateMessage","lex:chat.bsky.convo.defs#logDeleteMessage","lex:chat.bsky.convo.defs#logReadMessage","lex:chat.bsky.convo.defs#logAddReaction","lex:chat.bsky.convo.defs#logRemoveReaction"]}}}}}}}},ChatBskyConvoGetMessages:{lexicon:1,id:"chat.bsky.convo.getMessages",defs:{main:{type:"query",parameters:{type:"params",required:["convoId"],properties:{convoId:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["messages"],properties:{cursor:{type:"string"},messages:{type:"array",items:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}}}}}}},ChatBskyConvoLeaveConvo:{lexicon:1,id:"chat.bsky.convo.leaveConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convoId","rev"],properties:{convoId:{type:"string"},rev:{type:"string"}}}}}}},ChatBskyConvoListConvos:{lexicon:1,id:"chat.bsky.convo.listConvos",defs:{main:{type:"query",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},readState:{type:"string",knownValues:["unread"]},status:{type:"string",knownValues:["request","accepted"]}}},output:{encoding:"application/json",schema:{type:"object",required:["convos"],properties:{cursor:{type:"string"},convos:{type:"array",items:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}}},ChatBskyConvoMuteConvo:{lexicon:1,id:"chat.bsky.convo.muteConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoRemoveReaction:{lexicon:1,id:"chat.bsky.convo.removeReaction",defs:{main:{type:"procedure",description:"Removes an emoji reaction from a message. Requires authentication. It is idempotent, so multiple calls from the same user with the same emoji result in that reaction not being present, even if it already wasn't.",input:{encoding:"application/json",schema:{type:"object",required:["convoId","messageId","value"],properties:{convoId:{type:"string"},messageId:{type:"string"},value:{type:"string",minLength:1,maxLength:64,minGraphemes:1,maxGraphemes:1}}}},output:{encoding:"application/json",schema:{type:"object",required:["message"],properties:{message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}},errors:[{name:"ReactionMessageDeleted",description:"Indicates that the message has been deleted and reactions can no longer be added/removed."},{name:"ReactionInvalidValue",description:"Indicates the value for the reaction is not acceptable. In general, this means it is not an emoji."}]}}},ChatBskyConvoSendMessage:{lexicon:1,id:"chat.bsky.convo.sendMessage",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId","message"],properties:{convoId:{type:"string"},message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageInput"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}}},ChatBskyConvoSendMessageBatch:{lexicon:1,id:"chat.bsky.convo.sendMessageBatch",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["items"],properties:{items:{type:"array",maxLength:100,items:{type:"ref",ref:"lex:chat.bsky.convo.sendMessageBatch#batchItem"}}}}},output:{encoding:"application/json",schema:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}}}},batchItem:{type:"object",required:["convoId","message"],properties:{convoId:{type:"string"},message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageInput"}}}}},ChatBskyConvoUnmuteConvo:{lexicon:1,id:"chat.bsky.convo.unmuteConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoUpdateAllRead:{lexicon:1,id:"chat.bsky.convo.updateAllRead",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",properties:{status:{type:"string",knownValues:["request","accepted"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["updatedCount"],properties:{updatedCount:{description:"The count of updated convos.",type:"integer"}}}}}}},ChatBskyConvoUpdateRead:{lexicon:1,id:"chat.bsky.convo.updateRead",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"},messageId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyModerationGetActorMetadata:{lexicon:1,id:"chat.bsky.moderation.getActorMetadata",defs:{main:{type:"query",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"object",required:["day","month","all"],properties:{day:{type:"ref",ref:"lex:chat.bsky.moderation.getActorMetadata#metadata"},month:{type:"ref",ref:"lex:chat.bsky.moderation.getActorMetadata#metadata"},all:{type:"ref",ref:"lex:chat.bsky.moderation.getActorMetadata#metadata"}}}}},metadata:{type:"object",required:["messagesSent","messagesReceived","convos","convosStarted"],properties:{messagesSent:{type:"integer"},messagesReceived:{type:"integer"},convos:{type:"integer"},convosStarted:{type:"integer"}}}}},ChatBskyModerationGetMessageContext:{lexicon:1,id:"chat.bsky.moderation.getMessageContext",defs:{main:{type:"query",parameters:{type:"params",required:["messageId"],properties:{convoId:{type:"string",description:"Conversation that the message is from. NOTE: this field will eventually be required."},messageId:{type:"string"},before:{type:"integer",default:5},after:{type:"integer",default:5}}},output:{encoding:"application/json",schema:{type:"object",required:["messages"],properties:{messages:{type:"array",items:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}}}}}}},ChatBskyModerationUpdateActorAccess:{lexicon:1,id:"chat.bsky.moderation.updateActorAccess",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["actor","allowAccess"],properties:{actor:{type:"string",format:"did"},allowAccess:{type:"boolean"},ref:{type:"string"}}}}}}},ComAtprotoAdminDefs:{lexicon:1,id:"com.atproto.admin.defs",defs:{statusAttr:{type:"object",required:["applied"],properties:{applied:{type:"boolean"},ref:{type:"string"}}},accountView:{type:"object",required:["did","handle","indexedAt"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},email:{type:"string"},relatedRecords:{type:"array",items:{type:"unknown"}},indexedAt:{type:"string",format:"datetime"},invitedBy:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"},invites:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}},invitesDisabled:{type:"boolean"},emailConfirmedAt:{type:"string",format:"datetime"},inviteNote:{type:"string"},deactivatedAt:{type:"string",format:"datetime"},threatSignatures:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#threatSignature"}}}},repoRef:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},repoBlobRef:{type:"object",required:["did","cid"],properties:{did:{type:"string",format:"did"},cid:{type:"string",format:"cid"},recordUri:{type:"string",format:"at-uri"}}},threatSignature:{type:"object",required:["property","value"],properties:{property:{type:"string"},value:{type:"string"}}}}},ComAtprotoAdminDeleteAccount:{lexicon:1,id:"com.atproto.admin.deleteAccount",defs:{main:{type:"procedure",description:"Delete a user account as an administrator.",input:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}}}}},ComAtprotoAdminDisableAccountInvites:{lexicon:1,id:"com.atproto.admin.disableAccountInvites",defs:{main:{type:"procedure",description:"Disable an account from receiving new invite codes, but does not invalidate existing codes.",input:{encoding:"application/json",schema:{type:"object",required:["account"],properties:{account:{type:"string",format:"did"},note:{type:"string",description:"Optional reason for disabled invites."}}}}}}},ComAtprotoAdminDisableInviteCodes:{lexicon:1,id:"com.atproto.admin.disableInviteCodes",defs:{main:{type:"procedure",description:"Disable some set of codes and/or all codes associated with a set of users.",input:{encoding:"application/json",schema:{type:"object",properties:{codes:{type:"array",items:{type:"string"}},accounts:{type:"array",items:{type:"string"}}}}}}}},ComAtprotoAdminEnableAccountInvites:{lexicon:1,id:"com.atproto.admin.enableAccountInvites",defs:{main:{type:"procedure",description:"Re-enable an account's ability to receive invite codes.",input:{encoding:"application/json",schema:{type:"object",required:["account"],properties:{account:{type:"string",format:"did"},note:{type:"string",description:"Optional reason for enabled invites."}}}}}}},ComAtprotoAdminGetAccountInfo:{lexicon:1,id:"com.atproto.admin.getAccountInfo",defs:{main:{type:"query",description:"Get details about an account.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}},ComAtprotoAdminGetAccountInfos:{lexicon:1,id:"com.atproto.admin.getAccountInfos",defs:{main:{type:"query",description:"Get details about some accounts.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["infos"],properties:{infos:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}}}}},ComAtprotoAdminGetInviteCodes:{lexicon:1,id:"com.atproto.admin.getInviteCodes",defs:{main:{type:"query",description:"Get an admin view of invite codes.",parameters:{type:"params",properties:{sort:{type:"string",knownValues:["recent","usage"],default:"recent"},limit:{type:"integer",minimum:1,maximum:500,default:100},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["codes"],properties:{cursor:{type:"string"},codes:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}}}}}}}},ComAtprotoAdminGetSubjectStatus:{lexicon:1,id:"com.atproto.admin.getSubjectStatus",defs:{main:{type:"query",description:"Get the service-specific admin status of a subject (account, record, or blob).",parameters:{type:"params",properties:{did:{type:"string",format:"did"},uri:{type:"string",format:"at-uri"},blob:{type:"string",format:"cid"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:com.atproto.admin.defs#repoBlobRef"]},takedown:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"},deactivated:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"}}}}}}},ComAtprotoAdminSearchAccounts:{lexicon:1,id:"com.atproto.admin.searchAccounts",defs:{main:{type:"query",description:"Get list of accounts that matches your search query.",parameters:{type:"params",properties:{email:{type:"string"},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["accounts"],properties:{cursor:{type:"string"},accounts:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}}}}},ComAtprotoAdminSendEmail:{lexicon:1,id:"com.atproto.admin.sendEmail",defs:{main:{type:"procedure",description:"Send email to a user's account email address.",input:{encoding:"application/json",schema:{type:"object",required:["recipientDid","content","senderDid"],properties:{recipientDid:{type:"string",format:"did"},content:{type:"string"},subject:{type:"string"},senderDid:{type:"string",format:"did"},comment:{type:"string",description:"Additional comment by the sender that won't be used in the email itself but helpful to provide more context for moderators/reviewers"}}}},output:{encoding:"application/json",schema:{type:"object",required:["sent"],properties:{sent:{type:"boolean"}}}}}}},ComAtprotoAdminUpdateAccountEmail:{lexicon:1,id:"com.atproto.admin.updateAccountEmail",defs:{main:{type:"procedure",description:"Administrative action to update an account's email.",input:{encoding:"application/json",schema:{type:"object",required:["account","email"],properties:{account:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."},email:{type:"string"}}}}}}},ComAtprotoAdminUpdateAccountHandle:{lexicon:1,id:"com.atproto.admin.updateAccountHandle",defs:{main:{type:"procedure",description:"Administrative action to update an account's handle.",input:{encoding:"application/json",schema:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"}}}}}}},ComAtprotoAdminUpdateAccountPassword:{lexicon:1,id:"com.atproto.admin.updateAccountPassword",defs:{main:{type:"procedure",description:"Update the password for a user account as an administrator.",input:{encoding:"application/json",schema:{type:"object",required:["did","password"],properties:{did:{type:"string",format:"did"},password:{type:"string"}}}}}}},ComAtprotoAdminUpdateAccountSigningKey:{lexicon:1,id:"com.atproto.admin.updateAccountSigningKey",defs:{main:{type:"procedure",description:"Administrative action to update an account's signing key in their Did document.",input:{encoding:"application/json",schema:{type:"object",required:["did","signingKey"],properties:{did:{type:"string",format:"did"},signingKey:{type:"string",format:"did",description:"Did-key formatted public key"}}}}}}},ComAtprotoAdminUpdateSubjectStatus:{lexicon:1,id:"com.atproto.admin.updateSubjectStatus",defs:{main:{type:"procedure",description:"Update the service-specific admin status of a subject (account, record, or blob).",input:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:com.atproto.admin.defs#repoBlobRef"]},takedown:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"},deactivated:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"}}}},output:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:com.atproto.admin.defs#repoBlobRef"]},takedown:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"}}}}}}},ComAtprotoIdentityDefs:{lexicon:1,id:"com.atproto.identity.defs",defs:{identityInfo:{type:"object",required:["did","handle","didDoc"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle",description:"The validated handle of the account; or 'handle.invalid' if the handle did not bi-directionally match the DID document."},didDoc:{type:"unknown",description:"The complete DID document for the identity."}}}}},ComAtprotoIdentityGetRecommendedDidCredentials:{lexicon:1,id:"com.atproto.identity.getRecommendedDidCredentials",defs:{main:{type:"query",description:"Describe the credentials that should be included in the DID doc of an account that is migrating to this service.",output:{encoding:"application/json",schema:{type:"object",properties:{rotationKeys:{description:"Recommended rotation keys for PLC dids. Should be undefined (or ignored) for did:webs.",type:"array",items:{type:"string"}},alsoKnownAs:{type:"array",items:{type:"string"}},verificationMethods:{type:"unknown"},services:{type:"unknown"}}}}}}},ComAtprotoIdentityRefreshIdentity:{lexicon:1,id:"com.atproto.identity.refreshIdentity",defs:{main:{type:"procedure",description:"Request that the server re-resolve an identity (DID and handle). The server may ignore this request, or require authentication, depending on the role, implementation, and policy of the server.",input:{encoding:"application/json",schema:{type:"object",required:["identifier"],properties:{identifier:{type:"string",format:"at-identifier"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.identity.defs#identityInfo"}},errors:[{name:"HandleNotFound",description:"The resolution process confirmed that the handle does not resolve to any DID."},{name:"DidNotFound",description:"The DID resolution process confirmed that there is no current DID."},{name:"DidDeactivated",description:"The DID previously existed, but has been deactivated."}]}}},ComAtprotoIdentityRequestPlcOperationSignature:{lexicon:1,id:"com.atproto.identity.requestPlcOperationSignature",defs:{main:{type:"procedure",description:"Request an email with a code to in order to request a signed PLC operation. Requires Auth."}}},ComAtprotoIdentityResolveDid:{lexicon:1,id:"com.atproto.identity.resolveDid",defs:{main:{type:"query",description:"Resolves DID to DID document. Does not bi-directionally verify handle.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"DID to resolve."}}},output:{encoding:"application/json",schema:{type:"object",required:["didDoc"],properties:{didDoc:{type:"unknown",description:"The complete DID document for the identity."}}}},errors:[{name:"DidNotFound",description:"The DID resolution process confirmed that there is no current DID."},{name:"DidDeactivated",description:"The DID previously existed, but has been deactivated."}]}}},ComAtprotoIdentityResolveHandle:{lexicon:1,id:"com.atproto.identity.resolveHandle",defs:{main:{type:"query",description:"Resolves an atproto handle (hostname) to a DID. Does not necessarily bi-directionally verify against the the DID document.",parameters:{type:"params",required:["handle"],properties:{handle:{type:"string",format:"handle",description:"The handle to resolve."}}},output:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}},errors:[{name:"HandleNotFound",description:"The resolution process confirmed that the handle does not resolve to any DID."}]}}},ComAtprotoIdentityResolveIdentity:{lexicon:1,id:"com.atproto.identity.resolveIdentity",defs:{main:{type:"query",description:"Resolves an identity (DID or Handle) to a full identity (DID document and verified handle).",parameters:{type:"params",required:["identifier"],properties:{identifier:{type:"string",format:"at-identifier",description:"Handle or DID to resolve."}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.identity.defs#identityInfo"}},errors:[{name:"HandleNotFound",description:"The resolution process confirmed that the handle does not resolve to any DID."},{name:"DidNotFound",description:"The DID resolution process confirmed that there is no current DID."},{name:"DidDeactivated",description:"The DID previously existed, but has been deactivated."}]}}},ComAtprotoIdentitySignPlcOperation:{lexicon:1,id:"com.atproto.identity.signPlcOperation",defs:{main:{type:"procedure",description:"Signs a PLC operation to update some value(s) in the requesting DID's document.",input:{encoding:"application/json",schema:{type:"object",properties:{token:{description:"A token received through com.atproto.identity.requestPlcOperationSignature",type:"string"},rotationKeys:{type:"array",items:{type:"string"}},alsoKnownAs:{type:"array",items:{type:"string"}},verificationMethods:{type:"unknown"},services:{type:"unknown"}}}},output:{encoding:"application/json",schema:{type:"object",required:["operation"],properties:{operation:{type:"unknown",description:"A signed DID PLC operation."}}}}}}},ComAtprotoIdentitySubmitPlcOperation:{lexicon:1,id:"com.atproto.identity.submitPlcOperation",defs:{main:{type:"procedure",description:"Validates a PLC operation to ensure that it doesn't violate a service's constraints or get the identity into a bad state, then submits it to the PLC registry",input:{encoding:"application/json",schema:{type:"object",required:["operation"],properties:{operation:{type:"unknown"}}}}}}},ComAtprotoIdentityUpdateHandle:{lexicon:1,id:"com.atproto.identity.updateHandle",defs:{main:{type:"procedure",description:"Updates the current account's handle. Verifies handle validity, and updates did:plc document if necessary. Implemented by PDS, and requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["handle"],properties:{handle:{type:"string",format:"handle",description:"The new handle."}}}}}}},ComAtprotoLabelDefs:{lexicon:1,id:"com.atproto.label.defs",defs:{label:{type:"object",description:"Metadata tag on an atproto resource (eg, repo or record).",required:["src","uri","val","cts"],properties:{ver:{type:"integer",description:"The AT Protocol version of the label object."},src:{type:"string",format:"did",description:"DID of the actor who created this label."},uri:{type:"string",format:"uri",description:"AT URI of the record, repository (account), or other resource that this label applies to."},cid:{type:"string",format:"cid",description:"Optionally, CID specifying the specific version of 'uri' resource this label applies to."},val:{type:"string",maxLength:128,description:"The short string name of the value or type of this label."},neg:{type:"boolean",description:"If true, this is a negation label, overwriting a previous label."},cts:{type:"string",format:"datetime",description:"Timestamp when this label was created."},exp:{type:"string",format:"datetime",description:"Timestamp at which this label expires (no longer applies)."},sig:{type:"bytes",description:"Signature of dag-cbor encoded label."}}},selfLabels:{type:"object",description:"Metadata tags on an atproto record, published by the author within the record.",required:["values"],properties:{values:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#selfLabel"},maxLength:10}}},selfLabel:{type:"object",description:"Metadata tag on an atproto record, published by the author within the record. Note that schemas should use #selfLabels, not #selfLabel.",required:["val"],properties:{val:{type:"string",maxLength:128,description:"The short string name of the value or type of this label."}}},labelValueDefinition:{type:"object",description:"Declares a label value and its expected interpretations and behaviors.",required:["identifier","severity","blurs","locales"],properties:{identifier:{type:"string",description:"The value of the label being defined. Must only include lowercase ascii and the '-' character ([a-z-]+).",maxLength:100,maxGraphemes:100},severity:{type:"string",description:"How should a client visually convey this label? 'inform' means neutral and informational; 'alert' means negative and warning; 'none' means show nothing.",knownValues:["inform","alert","none"]},blurs:{type:"string",description:"What should this label hide in the UI, if applied? 'content' hides all of the target; 'media' hides the images/video/audio; 'none' hides nothing.",knownValues:["content","media","none"]},defaultSetting:{type:"string",description:"The default setting for this label.",knownValues:["ignore","warn","hide"],default:"warn"},adultOnly:{type:"boolean",description:"Does the user need to have adult content enabled in order to configure this label?"},locales:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#labelValueDefinitionStrings"}}}},labelValueDefinitionStrings:{type:"object",description:"Strings which describe the label in the UI, localized into a specific language.",required:["lang","name","description"],properties:{lang:{type:"string",description:"The code of the language these strings are written in.",format:"language"},name:{type:"string",description:"A short human-readable name for the label.",maxGraphemes:64,maxLength:640},description:{type:"string",description:"A longer description of what the label means and why it might be applied.",maxGraphemes:1e4,maxLength:1e5}}},labelValue:{type:"string",knownValues:["!hide","!no-promote","!warn","!no-unauthenticated","dmca-violation","doxxing","porn","sexual","nudity","nsfl","gore"]}}},ComAtprotoLabelQueryLabels:{lexicon:1,id:"com.atproto.label.queryLabels",defs:{main:{type:"query",description:"Find labels relevant to the provided AT-URI patterns. Public endpoint for moderation services, though may return different or additional results with auth.",parameters:{type:"params",required:["uriPatterns"],properties:{uriPatterns:{type:"array",items:{type:"string"},description:"List of AT URI patterns to match (boolean 'OR'). Each may be a prefix (ending with '*'; will match inclusive of the string leading to '*'), or a full URI."},sources:{type:"array",items:{type:"string",format:"did"},description:"Optional list of label sources (DIDs) to filter on."},limit:{type:"integer",minimum:1,maximum:250,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["labels"],properties:{cursor:{type:"string"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}}}}}},ComAtprotoLabelSubscribeLabels:{lexicon:1,id:"com.atproto.label.subscribeLabels",defs:{main:{type:"subscription",description:"Subscribe to stream of labels (and negations). Public endpoint implemented by mod services. Uses same sequencing scheme as repo event stream.",parameters:{type:"params",properties:{cursor:{type:"integer",description:"The last known event seq number to backfill from."}}},message:{schema:{type:"union",refs:["lex:com.atproto.label.subscribeLabels#labels","lex:com.atproto.label.subscribeLabels#info"]}},errors:[{name:"FutureCursor"}]},labels:{type:"object",required:["seq","labels"],properties:{seq:{type:"integer"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}},info:{type:"object",required:["name"],properties:{name:{type:"string",knownValues:["OutdatedCursor"]},message:{type:"string"}}}}},ComAtprotoLexiconSchema:{lexicon:1,id:"com.atproto.lexicon.schema",defs:{main:{type:"record",description:"Representation of Lexicon schemas themselves, when published as atproto records. Note that the schema language is not defined in Lexicon; this meta schema currently only includes a single version field ('lexicon'). See the atproto specifications for description of the other expected top-level fields ('id', 'defs', etc).",key:"nsid",record:{type:"object",required:["lexicon"],properties:{lexicon:{type:"integer",description:"Indicates the 'version' of the Lexicon language. Must be '1' for the current atproto/Lexicon schema system."}}}}}},ComAtprotoModerationCreateReport:{lexicon:1,id:"com.atproto.moderation.createReport",defs:{main:{type:"procedure",description:"Submit a moderation report regarding an atproto account or record. Implemented by moderation services (with PDS proxying), and requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["reasonType","subject"],properties:{reasonType:{type:"ref",description:"Indicates the broad category of violation the report is for.",ref:"lex:com.atproto.moderation.defs#reasonType"},reason:{type:"string",maxGraphemes:2e3,maxLength:2e4,description:"Additional context about the content and violation."},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef"]},modTool:{type:"ref",ref:"lex:com.atproto.moderation.createReport#modTool"}}}},output:{encoding:"application/json",schema:{type:"object",required:["id","reasonType","subject","reportedBy","createdAt"],properties:{id:{type:"integer"},reasonType:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"},reason:{type:"string",maxGraphemes:2e3,maxLength:2e4},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef"]},reportedBy:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"}}}}},modTool:{type:"object",description:"Moderation tool information for tracing the source of the action",required:["name"],properties:{name:{type:"string",description:"Name/identifier of the source (e.g., 'bsky-app/android', 'bsky-web/chrome')"},meta:{type:"unknown",description:"Additional arbitrary metadata about the source"}}}}},ComAtprotoModerationDefs:{lexicon:1,id:"com.atproto.moderation.defs",defs:{reasonType:{type:"string",knownValues:["com.atproto.moderation.defs#reasonSpam","com.atproto.moderation.defs#reasonViolation","com.atproto.moderation.defs#reasonMisleading","com.atproto.moderation.defs#reasonSexual","com.atproto.moderation.defs#reasonRude","com.atproto.moderation.defs#reasonOther","com.atproto.moderation.defs#reasonAppeal","tools.ozone.report.defs#reasonAppeal","tools.ozone.report.defs#reasonOther","tools.ozone.report.defs#reasonViolenceAnimal","tools.ozone.report.defs#reasonViolenceThreats","tools.ozone.report.defs#reasonViolenceGraphicContent","tools.ozone.report.defs#reasonViolenceGlorification","tools.ozone.report.defs#reasonViolenceExtremistContent","tools.ozone.report.defs#reasonViolenceTrafficking","tools.ozone.report.defs#reasonViolenceOther","tools.ozone.report.defs#reasonSexualAbuseContent","tools.ozone.report.defs#reasonSexualNCII","tools.ozone.report.defs#reasonSexualDeepfake","tools.ozone.report.defs#reasonSexualAnimal","tools.ozone.report.defs#reasonSexualUnlabeled","tools.ozone.report.defs#reasonSexualOther","tools.ozone.report.defs#reasonChildSafetyCSAM","tools.ozone.report.defs#reasonChildSafetyGroom","tools.ozone.report.defs#reasonChildSafetyPrivacy","tools.ozone.report.defs#reasonChildSafetyHarassment","tools.ozone.report.defs#reasonChildSafetyOther","tools.ozone.report.defs#reasonHarassmentTroll","tools.ozone.report.defs#reasonHarassmentTargeted","tools.ozone.report.defs#reasonHarassmentHateSpeech","tools.ozone.report.defs#reasonHarassmentDoxxing","tools.ozone.report.defs#reasonHarassmentOther","tools.ozone.report.defs#reasonMisleadingBot","tools.ozone.report.defs#reasonMisleadingImpersonation","tools.ozone.report.defs#reasonMisleadingSpam","tools.ozone.report.defs#reasonMisleadingScam","tools.ozone.report.defs#reasonMisleadingElections","tools.ozone.report.defs#reasonMisleadingOther","tools.ozone.report.defs#reasonRuleSiteSecurity","tools.ozone.report.defs#reasonRuleProhibitedSales","tools.ozone.report.defs#reasonRuleBanEvasion","tools.ozone.report.defs#reasonRuleOther","tools.ozone.report.defs#reasonSelfHarmContent","tools.ozone.report.defs#reasonSelfHarmED","tools.ozone.report.defs#reasonSelfHarmStunts","tools.ozone.report.defs#reasonSelfHarmSubstances","tools.ozone.report.defs#reasonSelfHarmOther"]},reasonSpam:{type:"token",description:"Spam: frequent unwanted promotion, replies, mentions. Prefer new lexicon definition `tools.ozone.report.defs#reasonMisleadingSpam`."},reasonViolation:{type:"token",description:"Direct violation of server rules, laws, terms of service. Prefer new lexicon definition `tools.ozone.report.defs#reasonRuleOther`."},reasonMisleading:{type:"token",description:"Misleading identity, affiliation, or content. Prefer new lexicon definition `tools.ozone.report.defs#reasonMisleadingOther`."},reasonSexual:{type:"token",description:"Unwanted or mislabeled sexual content. Prefer new lexicon definition `tools.ozone.report.defs#reasonSexualUnlabeled`."},reasonRude:{type:"token",description:"Rude, harassing, explicit, or otherwise unwelcoming behavior. Prefer new lexicon definition `tools.ozone.report.defs#reasonHarassmentOther`."},reasonOther:{type:"token",description:"Reports not falling under another report category. Prefer new lexicon definition `tools.ozone.report.defs#reasonOther`."},reasonAppeal:{type:"token",description:"Appeal a previously taken moderation action"},subjectType:{type:"string",description:"Tag describing a type of subject that might be reported.",knownValues:["account","record","chat"]}}},ComAtprotoRepoApplyWrites:{lexicon:1,id:"com.atproto.repo.applyWrites",defs:{main:{type:"procedure",description:"Apply a batch transaction of repository creates, updates, and deletes. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","writes"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},validate:{type:"boolean",description:"Can be set to 'false' to skip Lexicon schema validation of record data across all operations, 'true' to require it, or leave unset to validate only for known Lexicons."},writes:{type:"array",items:{type:"union",refs:["lex:com.atproto.repo.applyWrites#create","lex:com.atproto.repo.applyWrites#update","lex:com.atproto.repo.applyWrites#delete"],closed:!0}},swapCommit:{type:"string",description:"If provided, the entire operation will fail if the current repo commit CID does not match this value. Used to prevent conflicting repo mutations.",format:"cid"}}}},output:{encoding:"application/json",schema:{type:"object",required:[],properties:{commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"},results:{type:"array",items:{type:"union",refs:["lex:com.atproto.repo.applyWrites#createResult","lex:com.atproto.repo.applyWrites#updateResult","lex:com.atproto.repo.applyWrites#deleteResult"],closed:!0}}}}},errors:[{name:"InvalidSwap",description:"Indicates that the 'swapCommit' parameter did not match current commit."}]},create:{type:"object",description:"Operation which creates a new record.",required:["collection","value"],properties:{collection:{type:"string",format:"nsid"},rkey:{type:"string",maxLength:512,format:"record-key",description:"NOTE: maxLength is redundant with record-key format. Keeping it temporarily to ensure backwards compatibility."},value:{type:"unknown"}}},update:{type:"object",description:"Operation which updates an existing record.",required:["collection","rkey","value"],properties:{collection:{type:"string",format:"nsid"},rkey:{type:"string",format:"record-key"},value:{type:"unknown"}}},delete:{type:"object",description:"Operation which deletes an existing record.",required:["collection","rkey"],properties:{collection:{type:"string",format:"nsid"},rkey:{type:"string",format:"record-key"}}},createResult:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}},updateResult:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}},deleteResult:{type:"object",required:[],properties:{}}}},ComAtprotoRepoCreateRecord:{lexicon:1,id:"com.atproto.repo.createRecord",defs:{main:{type:"procedure",description:"Create a single new repository record. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","collection","record"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",format:"record-key",description:"The Record Key.",maxLength:512},validate:{type:"boolean",description:"Can be set to 'false' to skip Lexicon schema validation of record data, 'true' to require it, or leave unset to validate only for known Lexicons."},record:{type:"unknown",description:"The record itself. Must contain a $type field."},swapCommit:{type:"string",format:"cid",description:"Compare and swap with the previous commit by CID."}}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}}},errors:[{name:"InvalidSwap",description:"Indicates that 'swapCommit' didn't match current repo commit."}]}}},ComAtprotoRepoDefs:{lexicon:1,id:"com.atproto.repo.defs",defs:{commitMeta:{type:"object",required:["cid","rev"],properties:{cid:{type:"string",format:"cid"},rev:{type:"string",format:"tid"}}}}},ComAtprotoRepoDeleteRecord:{lexicon:1,id:"com.atproto.repo.deleteRecord",defs:{main:{type:"procedure",description:"Delete a repository record, or ensure it doesn't exist. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","collection","rkey"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",format:"record-key",description:"The Record Key."},swapRecord:{type:"string",format:"cid",description:"Compare and swap with the previous record by CID."},swapCommit:{type:"string",format:"cid",description:"Compare and swap with the previous commit by CID."}}}},output:{encoding:"application/json",schema:{type:"object",properties:{commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"}}}},errors:[{name:"InvalidSwap"}]}}},ComAtprotoRepoDescribeRepo:{lexicon:1,id:"com.atproto.repo.describeRepo",defs:{main:{type:"query",description:"Get information about an account and repository, including the list of collections. Does not require auth.",parameters:{type:"params",required:["repo"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["handle","did","didDoc","collections","handleIsCorrect"],properties:{handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},didDoc:{type:"unknown",description:"The complete DID document for this account."},collections:{type:"array",description:"List of all the collections (NSIDs) for which this repo contains at least one record.",items:{type:"string",format:"nsid"}},handleIsCorrect:{type:"boolean",description:"Indicates if handle is currently valid (resolves bi-directionally)"}}}}}}},ComAtprotoRepoGetRecord:{lexicon:1,id:"com.atproto.repo.getRecord",defs:{main:{type:"query",description:"Get a single record from a repository. Does not require auth.",parameters:{type:"params",required:["repo","collection","rkey"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",description:"The Record Key.",format:"record-key"},cid:{type:"string",format:"cid",description:"The CID of the version of the record. If not specified, then return the most recent version."}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","value"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"}}}},errors:[{name:"RecordNotFound"}]}}},ComAtprotoRepoImportRepo:{lexicon:1,id:"com.atproto.repo.importRepo",defs:{main:{type:"procedure",description:"Import a repo in the form of a CAR file. Requires Content-Length HTTP header to be set.",input:{encoding:"application/vnd.ipld.car"}}}},ComAtprotoRepoListMissingBlobs:{lexicon:1,id:"com.atproto.repo.listMissingBlobs",defs:{main:{type:"query",description:"Returns a list of missing blobs for the requesting account. Intended to be used in the account migration flow.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:1e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["blobs"],properties:{cursor:{type:"string"},blobs:{type:"array",items:{type:"ref",ref:"lex:com.atproto.repo.listMissingBlobs#recordBlob"}}}}}},recordBlob:{type:"object",required:["cid","recordUri"],properties:{cid:{type:"string",format:"cid"},recordUri:{type:"string",format:"at-uri"}}}}},ComAtprotoRepoListRecords:{lexicon:1,id:"com.atproto.repo.listRecords",defs:{main:{type:"query",description:"List a range of records in a repository, matching a specific collection. Does not require auth.",parameters:{type:"params",required:["repo","collection"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."},collection:{type:"string",format:"nsid",description:"The NSID of the record type."},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"The number of records to return."},cursor:{type:"string"},reverse:{type:"boolean",description:"Flag to reverse the order of the returned records."}}},output:{encoding:"application/json",schema:{type:"object",required:["records"],properties:{cursor:{type:"string"},records:{type:"array",items:{type:"ref",ref:"lex:com.atproto.repo.listRecords#record"}}}}}},record:{type:"object",required:["uri","cid","value"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"}}}}},ComAtprotoRepoPutRecord:{lexicon:1,id:"com.atproto.repo.putRecord",defs:{main:{type:"procedure",description:"Write a repository record, creating or updating it as needed. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","collection","rkey","record"],nullable:["swapRecord"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",format:"record-key",description:"The Record Key.",maxLength:512},validate:{type:"boolean",description:"Can be set to 'false' to skip Lexicon schema validation of record data, 'true' to require it, or leave unset to validate only for known Lexicons."},record:{type:"unknown",description:"The record to write."},swapRecord:{type:"string",format:"cid",description:"Compare and swap with the previous record by CID. WARNING: nullable and optional field; may cause problems with golang implementation"},swapCommit:{type:"string",format:"cid",description:"Compare and swap with the previous commit by CID."}}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}}},errors:[{name:"InvalidSwap"}]}}},ComAtprotoRepoStrongRef:{lexicon:1,id:"com.atproto.repo.strongRef",description:"A URI with a content-hash fingerprint.",defs:{main:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"}}}}},ComAtprotoRepoUploadBlob:{lexicon:1,id:"com.atproto.repo.uploadBlob",defs:{main:{type:"procedure",description:"Upload a new blob, to be referenced from a repository record. The blob will be deleted if it is not referenced within a time window (eg, minutes). Blob restrictions (mimetype, size, etc) are enforced when the reference is created. Requires auth, implemented by PDS.",input:{encoding:"*/*"},output:{encoding:"application/json",schema:{type:"object",required:["blob"],properties:{blob:{type:"blob"}}}}}}},ComAtprotoServerActivateAccount:{lexicon:1,id:"com.atproto.server.activateAccount",defs:{main:{type:"procedure",description:"Activates a currently deactivated account. Used to finalize account migration after the account's repo is imported and identity is setup."}}},ComAtprotoServerCheckAccountStatus:{lexicon:1,id:"com.atproto.server.checkAccountStatus",defs:{main:{type:"query",description:"Returns the status of an account, especially as pertaining to import or recovery. Can be called many times over the course of an account migration. Requires auth and can only be called pertaining to oneself.",output:{encoding:"application/json",schema:{type:"object",required:["activated","validDid","repoCommit","repoRev","repoBlocks","indexedRecords","privateStateValues","expectedBlobs","importedBlobs"],properties:{activated:{type:"boolean"},validDid:{type:"boolean"},repoCommit:{type:"string",format:"cid"},repoRev:{type:"string"},repoBlocks:{type:"integer"},indexedRecords:{type:"integer"},privateStateValues:{type:"integer"},expectedBlobs:{type:"integer"},importedBlobs:{type:"integer"}}}}}}},ComAtprotoServerConfirmEmail:{lexicon:1,id:"com.atproto.server.confirmEmail",defs:{main:{type:"procedure",description:"Confirm an email using a token from com.atproto.server.requestEmailConfirmation.",input:{encoding:"application/json",schema:{type:"object",required:["email","token"],properties:{email:{type:"string"},token:{type:"string"}}}},errors:[{name:"AccountNotFound"},{name:"ExpiredToken"},{name:"InvalidToken"},{name:"InvalidEmail"}]}}},ComAtprotoServerCreateAccount:{lexicon:1,id:"com.atproto.server.createAccount",defs:{main:{type:"procedure",description:"Create an account. Implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["handle"],properties:{email:{type:"string"},handle:{type:"string",format:"handle",description:"Requested handle for the account."},did:{type:"string",format:"did",description:"Pre-existing atproto DID, being imported to a new account."},inviteCode:{type:"string"},verificationCode:{type:"string"},verificationPhone:{type:"string"},password:{type:"string",description:"Initial account password. May need to meet instance-specific password strength requirements."},recoveryKey:{type:"string",description:"DID PLC rotation key (aka, recovery key) to be included in PLC creation operation."},plcOp:{type:"unknown",description:"A signed DID PLC operation to be submitted as part of importing an existing account to this instance. NOTE: this optional field may be updated when full account migration is implemented."}}}},output:{encoding:"application/json",schema:{type:"object",description:"Account login session returned on successful account creation.",required:["accessJwt","refreshJwt","handle","did"],properties:{accessJwt:{type:"string"},refreshJwt:{type:"string"},handle:{type:"string",format:"handle"},did:{type:"string",format:"did",description:"The DID of the new account."},didDoc:{type:"unknown",description:"Complete DID document."}}}},errors:[{name:"InvalidHandle"},{name:"InvalidPassword"},{name:"InvalidInviteCode"},{name:"HandleNotAvailable"},{name:"UnsupportedDomain"},{name:"UnresolvableDid"},{name:"IncompatibleDidDoc"}]}}},ComAtprotoServerCreateAppPassword:{lexicon:1,id:"com.atproto.server.createAppPassword",defs:{main:{type:"procedure",description:"Create an App Password.",input:{encoding:"application/json",schema:{type:"object",required:["name"],properties:{name:{type:"string",description:"A short name for the App Password, to help distinguish them."},privileged:{type:"boolean",description:"If an app password has 'privileged' access to possibly sensitive account state. Meant for use with trusted clients."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.server.createAppPassword#appPassword"}},errors:[{name:"AccountTakedown"}]},appPassword:{type:"object",required:["name","password","createdAt"],properties:{name:{type:"string"},password:{type:"string"},createdAt:{type:"string",format:"datetime"},privileged:{type:"boolean"}}}}},ComAtprotoServerCreateInviteCode:{lexicon:1,id:"com.atproto.server.createInviteCode",defs:{main:{type:"procedure",description:"Create an invite code.",input:{encoding:"application/json",schema:{type:"object",required:["useCount"],properties:{useCount:{type:"integer"},forAccount:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["code"],properties:{code:{type:"string"}}}}}}},ComAtprotoServerCreateInviteCodes:{lexicon:1,id:"com.atproto.server.createInviteCodes",defs:{main:{type:"procedure",description:"Create invite codes.",input:{encoding:"application/json",schema:{type:"object",required:["codeCount","useCount"],properties:{codeCount:{type:"integer",default:1},useCount:{type:"integer"},forAccounts:{type:"array",items:{type:"string",format:"did"}}}}},output:{encoding:"application/json",schema:{type:"object",required:["codes"],properties:{codes:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.createInviteCodes#accountCodes"}}}}}},accountCodes:{type:"object",required:["account","codes"],properties:{account:{type:"string"},codes:{type:"array",items:{type:"string"}}}}}},ComAtprotoServerCreateSession:{lexicon:1,id:"com.atproto.server.createSession",defs:{main:{type:"procedure",description:"Create an authentication session.",input:{encoding:"application/json",schema:{type:"object",required:["identifier","password"],properties:{identifier:{type:"string",description:"Handle or other identifier supported by the server for the authenticating user."},password:{type:"string"},authFactorToken:{type:"string"},allowTakendown:{type:"boolean",description:"When true, instead of throwing error for takendown accounts, a valid response with a narrow scoped token will be returned"}}}},output:{encoding:"application/json",schema:{type:"object",required:["accessJwt","refreshJwt","handle","did"],properties:{accessJwt:{type:"string"},refreshJwt:{type:"string"},handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},didDoc:{type:"unknown"},email:{type:"string"},emailConfirmed:{type:"boolean"},emailAuthFactor:{type:"boolean"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deactivated"]}}}},errors:[{name:"AccountTakedown"},{name:"AuthFactorTokenRequired"}]}}},ComAtprotoServerDeactivateAccount:{lexicon:1,id:"com.atproto.server.deactivateAccount",defs:{main:{type:"procedure",description:"Deactivates a currently active account. Stops serving of repo, and future writes to repo until reactivated. Used to finalize account migration with the old host after the account has been activated on the new host.",input:{encoding:"application/json",schema:{type:"object",properties:{deleteAfter:{type:"string",format:"datetime",description:"A recommendation to server as to how long they should hold onto the deactivated account before deleting."}}}}}}},ComAtprotoServerDefs:{lexicon:1,id:"com.atproto.server.defs",defs:{inviteCode:{type:"object",required:["code","available","disabled","forAccount","createdBy","createdAt","uses"],properties:{code:{type:"string"},available:{type:"integer"},disabled:{type:"boolean"},forAccount:{type:"string"},createdBy:{type:"string"},createdAt:{type:"string",format:"datetime"},uses:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCodeUse"}}}},inviteCodeUse:{type:"object",required:["usedBy","usedAt"],properties:{usedBy:{type:"string",format:"did"},usedAt:{type:"string",format:"datetime"}}}}},ComAtprotoServerDeleteAccount:{lexicon:1,id:"com.atproto.server.deleteAccount",defs:{main:{type:"procedure",description:"Delete an actor's account with a token and password. Can only be called after requesting a deletion token. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["did","password","token"],properties:{did:{type:"string",format:"did"},password:{type:"string"},token:{type:"string"}}}},errors:[{name:"ExpiredToken"},{name:"InvalidToken"}]}}},ComAtprotoServerDeleteSession:{lexicon:1,id:"com.atproto.server.deleteSession",defs:{main:{type:"procedure",description:"Delete the current session. Requires auth."}}},ComAtprotoServerDescribeServer:{lexicon:1,id:"com.atproto.server.describeServer",defs:{main:{type:"query",description:"Describes the server's account creation requirements and capabilities. Implemented by PDS.",output:{encoding:"application/json",schema:{type:"object",required:["did","availableUserDomains"],properties:{inviteCodeRequired:{type:"boolean",description:"If true, an invite code must be supplied to create an account on this instance."},phoneVerificationRequired:{type:"boolean",description:"If true, a phone verification token must be supplied to create an account on this instance."},availableUserDomains:{type:"array",description:"List of domain suffixes that can be used in account handles.",items:{type:"string"}},links:{type:"ref",description:"URLs of service policy documents.",ref:"lex:com.atproto.server.describeServer#links"},contact:{type:"ref",description:"Contact information",ref:"lex:com.atproto.server.describeServer#contact"},did:{type:"string",format:"did"}}}}},links:{type:"object",properties:{privacyPolicy:{type:"string",format:"uri"},termsOfService:{type:"string",format:"uri"}}},contact:{type:"object",properties:{email:{type:"string"}}}}},ComAtprotoServerGetAccountInviteCodes:{lexicon:1,id:"com.atproto.server.getAccountInviteCodes",defs:{main:{type:"query",description:"Get all invite codes for the current account. Requires auth.",parameters:{type:"params",properties:{includeUsed:{type:"boolean",default:!0},createAvailable:{type:"boolean",default:!0,description:"Controls whether any new 'earned' but not 'created' invites should be created."}}},output:{encoding:"application/json",schema:{type:"object",required:["codes"],properties:{codes:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}}}}},errors:[{name:"DuplicateCreate"}]}}},ComAtprotoServerGetServiceAuth:{lexicon:1,id:"com.atproto.server.getServiceAuth",defs:{main:{type:"query",description:"Get a signed token on behalf of the requesting DID for the requested service.",parameters:{type:"params",required:["aud"],properties:{aud:{type:"string",format:"did",description:"The DID of the service that the token will be used to authenticate with"},exp:{type:"integer",description:"The time in Unix Epoch seconds that the JWT expires. Defaults to 60 seconds in the future. The service may enforce certain time bounds on tokens depending on the requested scope."},lxm:{type:"string",format:"nsid",description:"Lexicon (XRPC) method to bind the requested token to"}}},output:{encoding:"application/json",schema:{type:"object",required:["token"],properties:{token:{type:"string"}}}},errors:[{name:"BadExpiration",description:"Indicates that the requested expiration date is not a valid. May be in the past or may be reliant on the requested scopes."}]}}},ComAtprotoServerGetSession:{lexicon:1,id:"com.atproto.server.getSession",defs:{main:{type:"query",description:"Get information about the current auth session. Requires auth.",output:{encoding:"application/json",schema:{type:"object",required:["handle","did"],properties:{handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},email:{type:"string"},emailConfirmed:{type:"boolean"},emailAuthFactor:{type:"boolean"},didDoc:{type:"unknown"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deactivated"]}}}}}}},ComAtprotoServerListAppPasswords:{lexicon:1,id:"com.atproto.server.listAppPasswords",defs:{main:{type:"query",description:"List all App Passwords.",output:{encoding:"application/json",schema:{type:"object",required:["passwords"],properties:{passwords:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.listAppPasswords#appPassword"}}}}},errors:[{name:"AccountTakedown"}]},appPassword:{type:"object",required:["name","createdAt"],properties:{name:{type:"string"},createdAt:{type:"string",format:"datetime"},privileged:{type:"boolean"}}}}},ComAtprotoServerRefreshSession:{lexicon:1,id:"com.atproto.server.refreshSession",defs:{main:{type:"procedure",description:"Refresh an authentication session. Requires auth using the 'refreshJwt' (not the 'accessJwt').",output:{encoding:"application/json",schema:{type:"object",required:["accessJwt","refreshJwt","handle","did"],properties:{accessJwt:{type:"string"},refreshJwt:{type:"string"},handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},didDoc:{type:"unknown"},active:{type:"boolean"},status:{type:"string",description:"Hosting status of the account. If not specified, then assume 'active'.",knownValues:["takendown","suspended","deactivated"]}}}},errors:[{name:"AccountTakedown"}]}}},ComAtprotoServerRequestAccountDelete:{lexicon:1,id:"com.atproto.server.requestAccountDelete",defs:{main:{type:"procedure",description:"Initiate a user account deletion via email."}}},ComAtprotoServerRequestEmailConfirmation:{lexicon:1,id:"com.atproto.server.requestEmailConfirmation",defs:{main:{type:"procedure",description:"Request an email with a code to confirm ownership of email."}}},ComAtprotoServerRequestEmailUpdate:{lexicon:1,id:"com.atproto.server.requestEmailUpdate",defs:{main:{type:"procedure",description:"Request a token in order to update email.",output:{encoding:"application/json",schema:{type:"object",required:["tokenRequired"],properties:{tokenRequired:{type:"boolean"}}}}}}},ComAtprotoServerRequestPasswordReset:{lexicon:1,id:"com.atproto.server.requestPasswordReset",defs:{main:{type:"procedure",description:"Initiate a user account password reset via email.",input:{encoding:"application/json",schema:{type:"object",required:["email"],properties:{email:{type:"string"}}}}}}},ComAtprotoServerReserveSigningKey:{lexicon:1,id:"com.atproto.server.reserveSigningKey",defs:{main:{type:"procedure",description:"Reserve a repo signing key, for use with account creation. Necessary so that a DID PLC update operation can be constructed during an account migraiton. Public and does not require auth; implemented by PDS. NOTE: this endpoint may change when full account migration is implemented.",input:{encoding:"application/json",schema:{type:"object",properties:{did:{type:"string",format:"did",description:"The DID to reserve a key for."}}}},output:{encoding:"application/json",schema:{type:"object",required:["signingKey"],properties:{signingKey:{type:"string",description:"The public key for the reserved signing key, in did:key serialization."}}}}}}},ComAtprotoServerResetPassword:{lexicon:1,id:"com.atproto.server.resetPassword",defs:{main:{type:"procedure",description:"Reset a user account password using a token.",input:{encoding:"application/json",schema:{type:"object",required:["token","password"],properties:{token:{type:"string"},password:{type:"string"}}}},errors:[{name:"ExpiredToken"},{name:"InvalidToken"}]}}},ComAtprotoServerRevokeAppPassword:{lexicon:1,id:"com.atproto.server.revokeAppPassword",defs:{main:{type:"procedure",description:"Revoke an App Password by name.",input:{encoding:"application/json",schema:{type:"object",required:["name"],properties:{name:{type:"string"}}}}}}},ComAtprotoServerUpdateEmail:{lexicon:1,id:"com.atproto.server.updateEmail",defs:{main:{type:"procedure",description:"Update an account's email.",input:{encoding:"application/json",schema:{type:"object",required:["email"],properties:{email:{type:"string"},emailAuthFactor:{type:"boolean"},token:{type:"string",description:"Requires a token from com.atproto.sever.requestEmailUpdate if the account's email has been confirmed."}}}},errors:[{name:"ExpiredToken"},{name:"InvalidToken"},{name:"TokenRequired"}]}}},ComAtprotoSyncDefs:{lexicon:1,id:"com.atproto.sync.defs",defs:{hostStatus:{type:"string",knownValues:["active","idle","offline","throttled","banned"]}}},ComAtprotoSyncGetBlob:{lexicon:1,id:"com.atproto.sync.getBlob",defs:{main:{type:"query",description:"Get a blob associated with a given account. Returns the full blob as originally uploaded. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did","cid"],properties:{did:{type:"string",format:"did",description:"The DID of the account."},cid:{type:"string",format:"cid",description:"The CID of the blob to fetch"}}},output:{encoding:"*/*"},errors:[{name:"BlobNotFound"},{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetBlocks:{lexicon:1,id:"com.atproto.sync.getBlocks",defs:{main:{type:"query",description:"Get data blocks from a given repo, by CID. For example, intermediate MST nodes, or records. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did","cids"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},cids:{type:"array",items:{type:"string",format:"cid"}}}},output:{encoding:"application/vnd.ipld.car"},errors:[{name:"BlockNotFound"},{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetCheckout:{lexicon:1,id:"com.atproto.sync.getCheckout",defs:{main:{type:"query",description:"DEPRECATED - please use com.atproto.sync.getRepo instead",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/vnd.ipld.car"}}}},ComAtprotoSyncGetHead:{lexicon:1,id:"com.atproto.sync.getHead",defs:{main:{type:"query",description:"DEPRECATED - please use com.atproto.sync.getLatestCommit instead",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["root"],properties:{root:{type:"string",format:"cid"}}}},errors:[{name:"HeadNotFound"}]}}},ComAtprotoSyncGetHostStatus:{lexicon:1,id:"com.atproto.sync.getHostStatus",defs:{main:{type:"query",description:"Returns information about a specified upstream host, as consumed by the server. Implemented by relays.",parameters:{type:"params",required:["hostname"],properties:{hostname:{type:"string",description:"Hostname of the host (eg, PDS or relay) being queried."}}},output:{encoding:"application/json",schema:{type:"object",required:["hostname"],properties:{hostname:{type:"string"},seq:{type:"integer",description:"Recent repo stream event sequence number. May be delayed from actual stream processing (eg, persisted cursor not in-memory cursor)."},accountCount:{type:"integer",description:"Number of accounts on the server which are associated with the upstream host. Note that the upstream may actually have more accounts."},status:{type:"ref",ref:"lex:com.atproto.sync.defs#hostStatus"}}}},errors:[{name:"HostNotFound"}]}}},ComAtprotoSyncGetLatestCommit:{lexicon:1,id:"com.atproto.sync.getLatestCommit",defs:{main:{type:"query",description:"Get the current commit CID & revision of the specified repo. Does not require auth.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["cid","rev"],properties:{cid:{type:"string",format:"cid"},rev:{type:"string",format:"tid"}}}},errors:[{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetRecord:{lexicon:1,id:"com.atproto.sync.getRecord",defs:{main:{type:"query",description:"Get data blocks needed to prove the existence or non-existence of record in the current version of repo. Does not require auth.",parameters:{type:"params",required:["did","collection","rkey"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},collection:{type:"string",format:"nsid"},rkey:{type:"string",description:"Record Key",format:"record-key"}}},output:{encoding:"application/vnd.ipld.car"},errors:[{name:"RecordNotFound"},{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetRepo:{lexicon:1,id:"com.atproto.sync.getRepo",defs:{main:{type:"query",description:"Download a repository export as CAR file. Optionally only a 'diff' since a previous revision. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},since:{type:"string",format:"tid",description:"The revision ('rev') of the repo to create a diff from."}}},output:{encoding:"application/vnd.ipld.car"},errors:[{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetRepoStatus:{lexicon:1,id:"com.atproto.sync.getRepoStatus",defs:{main:{type:"query",description:"Get the hosting status for a repository, on this server. Expected to be implemented by PDS and Relay.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["did","active"],properties:{did:{type:"string",format:"did"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deleted","deactivated","desynchronized","throttled"]},rev:{type:"string",format:"tid",description:"Optional field, the current rev of the repo, if active=true"}}}},errors:[{name:"RepoNotFound"}]}}},ComAtprotoSyncListBlobs:{lexicon:1,id:"com.atproto.sync.listBlobs",defs:{main:{type:"query",description:"List blob CIDs for an account, since some repo revision. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},since:{type:"string",format:"tid",description:"Optional revision of the repo to list blobs since."},limit:{type:"integer",minimum:1,maximum:1e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["cids"],properties:{cursor:{type:"string"},cids:{type:"array",items:{type:"string",format:"cid"}}}}},errors:[{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncListHosts:{lexicon:1,id:"com.atproto.sync.listHosts",defs:{main:{type:"query",description:"Enumerates upstream hosts (eg, PDS or relay instances) that this service consumes from. Implemented by relays.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:1e3,default:200},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["hosts"],properties:{cursor:{type:"string"},hosts:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.listHosts#host"},description:"Sort order is not formally specified. Recommended order is by time host was first seen by the server, with oldest first."}}}}},host:{type:"object",required:["hostname"],properties:{hostname:{type:"string",description:"hostname of server; not a URL (no scheme)"},seq:{type:"integer",description:"Recent repo stream event sequence number. May be delayed from actual stream processing (eg, persisted cursor not in-memory cursor)."},accountCount:{type:"integer"},status:{type:"ref",ref:"lex:com.atproto.sync.defs#hostStatus"}}}}},ComAtprotoSyncListRepos:{lexicon:1,id:"com.atproto.sync.listRepos",defs:{main:{type:"query",description:"Enumerates all the DID, rev, and commit CID for all repos hosted by this service. Does not require auth; implemented by PDS and Relay.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:1e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{cursor:{type:"string"},repos:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.listRepos#repo"}}}}}},repo:{type:"object",required:["did","head","rev"],properties:{did:{type:"string",format:"did"},head:{type:"string",format:"cid",description:"Current repo commit CID"},rev:{type:"string",format:"tid"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deleted","deactivated","desynchronized","throttled"]}}}}},ComAtprotoSyncListReposByCollection:{lexicon:1,id:"com.atproto.sync.listReposByCollection",defs:{main:{type:"query",description:"Enumerates all the DIDs which have records with the given collection NSID.",parameters:{type:"params",required:["collection"],properties:{collection:{type:"string",format:"nsid"},limit:{type:"integer",description:"Maximum size of response set. Recommend setting a large maximum (1000+) when enumerating large DID lists.",minimum:1,maximum:2e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{cursor:{type:"string"},repos:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.listReposByCollection#repo"}}}}}},repo:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}}},ComAtprotoSyncNotifyOfUpdate:{lexicon:1,id:"com.atproto.sync.notifyOfUpdate",defs:{main:{type:"procedure",description:"Notify a crawling service of a recent update, and that crawling should resume. Intended use is after a gap between repo stream events caused the crawling service to disconnect. Does not require auth; implemented by Relay. DEPRECATED: just use com.atproto.sync.requestCrawl",input:{encoding:"application/json",schema:{type:"object",required:["hostname"],properties:{hostname:{type:"string",description:"Hostname of the current service (usually a PDS) that is notifying of update."}}}}}}},ComAtprotoSyncRequestCrawl:{lexicon:1,id:"com.atproto.sync.requestCrawl",defs:{main:{type:"procedure",description:"Request a service to persistently crawl hosted repos. Expected use is new PDS instances declaring their existence to Relays. Does not require auth.",input:{encoding:"application/json",schema:{type:"object",required:["hostname"],properties:{hostname:{type:"string",description:"Hostname of the current service (eg, PDS) that is requesting to be crawled."}}}},errors:[{name:"HostBanned"}]}}},ComAtprotoSyncSubscribeRepos:{lexicon:1,id:"com.atproto.sync.subscribeRepos",defs:{main:{type:"subscription",description:"Repository event stream, aka Firehose endpoint. Outputs repo commits with diff data, and identity update events, for all repositories on the current server. See the atproto specifications for details around stream sequencing, repo versioning, CAR diff format, and more. Public and does not require auth; implemented by PDS and Relay.",parameters:{type:"params",properties:{cursor:{type:"integer",description:"The last known event seq number to backfill from."}}},message:{schema:{type:"union",refs:["lex:com.atproto.sync.subscribeRepos#commit","lex:com.atproto.sync.subscribeRepos#sync","lex:com.atproto.sync.subscribeRepos#identity","lex:com.atproto.sync.subscribeRepos#account","lex:com.atproto.sync.subscribeRepos#info"]}},errors:[{name:"FutureCursor"},{name:"ConsumerTooSlow",description:"If the consumer of the stream can not keep up with events, and a backlog gets too large, the server will drop the connection."}]},commit:{type:"object",description:"Represents an update of repository state. Note that empty commits are allowed, which include no repo data changes, but an update to rev and signature.",required:["seq","rebase","tooBig","repo","commit","rev","since","blocks","ops","blobs","time"],nullable:["since"],properties:{seq:{type:"integer",description:"The stream sequence number of this message."},rebase:{type:"boolean",description:"DEPRECATED -- unused"},tooBig:{type:"boolean",description:"DEPRECATED -- replaced by #sync event and data limits. Indicates that this commit contained too many ops, or data size was too large. Consumers will need to make a separate request to get missing data."},repo:{type:"string",format:"did",description:"The repo this event comes from. Note that all other message types name this field 'did'."},commit:{type:"cid-link",description:"Repo commit object CID."},rev:{type:"string",format:"tid",description:"The rev of the emitted commit. Note that this information is also in the commit object included in blocks, unless this is a tooBig event."},since:{type:"string",format:"tid",description:"The rev of the last emitted commit from this repo (if any)."},blocks:{type:"bytes",description:"CAR file containing relevant blocks, as a diff since the previous repo state. The commit must be included as a block, and the commit block CID must be the first entry in the CAR header 'roots' list.",maxLength:2e6},ops:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.subscribeRepos#repoOp",description:"List of repo mutation operations in this commit (eg, records created, updated, or deleted)."},maxLength:200},blobs:{type:"array",items:{type:"cid-link",description:"DEPRECATED -- will soon always be empty. List of new blobs (by CID) referenced by records in this commit."}},prevData:{type:"cid-link",description:"The root CID of the MST tree for the previous commit from this repo (indicated by the 'since' revision field in this message). Corresponds to the 'data' field in the repo commit object. NOTE: this field is effectively required for the 'inductive' version of firehose."},time:{type:"string",format:"datetime",description:"Timestamp of when this message was originally broadcast."}}},sync:{type:"object",description:"Updates the repo to a new state, without necessarily including that state on the firehose. Used to recover from broken commit streams, data loss incidents, or in situations where upstream host does not know recent state of the repository.",required:["seq","did","blocks","rev","time"],properties:{seq:{type:"integer",description:"The stream sequence number of this message."},did:{type:"string",format:"did",description:"The account this repo event corresponds to. Must match that in the commit object."},blocks:{type:"bytes",description:"CAR file containing the commit, as a block. The CAR header must include the commit block CID as the first 'root'.",maxLength:1e4},rev:{type:"string",description:"The rev of the commit. This value must match that in the commit object."},time:{type:"string",format:"datetime",description:"Timestamp of when this message was originally broadcast."}}},identity:{type:"object",description:"Represents a change to an account's identity. Could be an updated handle, signing key, or pds hosting endpoint. Serves as a prod to all downstream services to refresh their identity cache.",required:["seq","did","time"],properties:{seq:{type:"integer"},did:{type:"string",format:"did"},time:{type:"string",format:"datetime"},handle:{type:"string",format:"handle",description:"The current handle for the account, or 'handle.invalid' if validation fails. This field is optional, might have been validated or passed-through from an upstream source. Semantics and behaviors for PDS vs Relay may evolve in the future; see atproto specs for more details."}}},account:{type:"object",description:"Represents a change to an account's status on a host (eg, PDS or Relay). The semantics of this event are that the status is at the host which emitted the event, not necessarily that at the currently active PDS. Eg, a Relay takedown would emit a takedown with active=false, even if the PDS is still active.",required:["seq","did","time","active"],properties:{seq:{type:"integer"},did:{type:"string",format:"did"},time:{type:"string",format:"datetime"},active:{type:"boolean",description:"Indicates that the account has a repository which can be fetched from the host that emitted this event."},status:{type:"string",description:"If active=false, this optional field indicates a reason for why the account is not active.",knownValues:["takendown","suspended","deleted","deactivated","desynchronized","throttled"]}}},info:{type:"object",required:["name"],properties:{name:{type:"string",knownValues:["OutdatedCursor"]},message:{type:"string"}}},repoOp:{type:"object",description:"A repo operation, ie a mutation of a single record.",required:["action","path","cid"],nullable:["cid"],properties:{action:{type:"string",knownValues:["create","update","delete"]},path:{type:"string"},cid:{type:"cid-link",description:"For creates and updates, the new record CID. For deletions, null."},prev:{type:"cid-link",description:"For updates and deletes, the previous record CID (required for inductive firehose). For creations, field should not be defined."}}}}},ComAtprotoTempAddReservedHandle:{lexicon:1,id:"com.atproto.temp.addReservedHandle",defs:{main:{type:"procedure",description:"Add a handle to the set of reserved handles.",input:{encoding:"application/json",schema:{type:"object",required:["handle"],properties:{handle:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},ComAtprotoTempCheckHandleAvailability:{lexicon:1,id:"com.atproto.temp.checkHandleAvailability",defs:{main:{type:"query",description:"Checks whether the provided handle is available. If the handle is not available, available suggestions will be returned. Optional inputs will be used to generate suggestions.",parameters:{type:"params",required:["handle"],properties:{handle:{type:"string",format:"handle",description:"Tentative handle. Will be checked for availability or used to build handle suggestions."},email:{type:"string",description:"User-provided email. Might be used to build handle suggestions."},birthDate:{type:"string",format:"datetime",description:"User-provided birth date. Might be used to build handle suggestions."}}},output:{encoding:"application/json",schema:{type:"object",required:["handle","result"],properties:{handle:{type:"string",format:"handle",description:"Echo of the input handle."},result:{type:"union",refs:["lex:com.atproto.temp.checkHandleAvailability#resultAvailable","lex:com.atproto.temp.checkHandleAvailability#resultUnavailable"]}}}},errors:[{name:"InvalidEmail",description:"An invalid email was provided."}]},resultAvailable:{type:"object",description:"Indicates the provided handle is available.",properties:{}},resultUnavailable:{type:"object",description:"Indicates the provided handle is unavailable and gives suggestions of available handles.",required:["suggestions"],properties:{suggestions:{type:"array",description:"List of suggested handles based on the provided inputs.",items:{type:"ref",ref:"lex:com.atproto.temp.checkHandleAvailability#suggestion"}}}},suggestion:{type:"object",required:["handle","method"],properties:{handle:{type:"string",format:"handle"},method:{type:"string",description:"Method used to build this suggestion. Should be considered opaque to clients. Can be used for metrics."}}}}},ComAtprotoTempCheckSignupQueue:{lexicon:1,id:"com.atproto.temp.checkSignupQueue",defs:{main:{type:"query",description:"Check accounts location in signup queue.",output:{encoding:"application/json",schema:{type:"object",required:["activated"],properties:{activated:{type:"boolean"},placeInQueue:{type:"integer"},estimatedTimeMs:{type:"integer"}}}}}}},ComAtprotoTempDereferenceScope:{lexicon:1,id:"com.atproto.temp.dereferenceScope",defs:{main:{type:"query",description:"Allows finding the oauth permission scope from a reference",parameters:{type:"params",required:["scope"],properties:{scope:{type:"string",description:"The scope reference (starts with 'ref:')"}}},output:{encoding:"application/json",schema:{type:"object",required:["scope"],properties:{scope:{type:"string",description:"The full oauth permission scope"}}}},errors:[{name:"InvalidScopeReference",description:"An invalid scope reference was provided."}]}}},ComAtprotoTempFetchLabels:{lexicon:1,id:"com.atproto.temp.fetchLabels",defs:{main:{type:"query",description:"DEPRECATED: use queryLabels or subscribeLabels instead -- Fetch all labels from a labeler created after a certain date.",parameters:{type:"params",properties:{since:{type:"integer"},limit:{type:"integer",minimum:1,maximum:250,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["labels"],properties:{labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}}}}}},ComAtprotoTempRequestPhoneVerification:{lexicon:1,id:"com.atproto.temp.requestPhoneVerification",defs:{main:{type:"procedure",description:"Request a verification code to be sent to the supplied phone number",input:{encoding:"application/json",schema:{type:"object",required:["phoneNumber"],properties:{phoneNumber:{type:"string"}}}}}}},ComAtprotoTempRevokeAccountCredentials:{lexicon:1,id:"com.atproto.temp.revokeAccountCredentials",defs:{main:{type:"procedure",description:"Revoke sessions, password, and app passwords associated with account. May be resolved by a password reset.",input:{encoding:"application/json",schema:{type:"object",required:["account"],properties:{account:{type:"string",format:"at-identifier"}}}}}}},ToolsOzoneCommunicationCreateTemplate:{lexicon:1,id:"tools.ozone.communication.createTemplate",defs:{main:{type:"procedure",description:"Administrative action to create a new, re-usable communication (email for now) template.",input:{encoding:"application/json",schema:{type:"object",required:["subject","contentMarkdown","name"],properties:{name:{type:"string",description:"Name of the template."},contentMarkdown:{type:"string",description:"Content of the template, markdown supported, can contain variable placeholders."},subject:{type:"string",description:"Subject of the message, used in emails."},lang:{type:"string",format:"language",description:"Message language."},createdBy:{type:"string",format:"did",description:"DID of the user who is creating the template."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.communication.defs#templateView"}},errors:[{name:"DuplicateTemplateName"}]}}},ToolsOzoneCommunicationDefs:{lexicon:1,id:"tools.ozone.communication.defs",defs:{templateView:{type:"object",required:["id","name","contentMarkdown","disabled","lastUpdatedBy","createdAt","updatedAt"],properties:{id:{type:"string"},name:{type:"string",description:"Name of the template."},subject:{type:"string",description:"Content of the template, can contain markdown and variable placeholders."},contentMarkdown:{type:"string",description:"Subject of the message, used in emails."},disabled:{type:"boolean"},lang:{type:"string",format:"language",description:"Message language."},lastUpdatedBy:{type:"string",format:"did",description:"DID of the user who last updated the template."},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"}}}}},ToolsOzoneCommunicationDeleteTemplate:{lexicon:1,id:"tools.ozone.communication.deleteTemplate",defs:{main:{type:"procedure",description:"Delete a communication template.",input:{encoding:"application/json",schema:{type:"object",required:["id"],properties:{id:{type:"string"}}}}}}},ToolsOzoneCommunicationListTemplates:{lexicon:1,id:"tools.ozone.communication.listTemplates",defs:{main:{type:"query",description:"Get list of all communication templates.",output:{encoding:"application/json",schema:{type:"object",required:["communicationTemplates"],properties:{communicationTemplates:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.communication.defs#templateView"}}}}}}}},ToolsOzoneCommunicationUpdateTemplate:{lexicon:1,id:"tools.ozone.communication.updateTemplate",defs:{main:{type:"procedure",description:"Administrative action to update an existing communication template. Allows passing partial fields to patch specific fields only.",input:{encoding:"application/json",schema:{type:"object",required:["id"],properties:{id:{type:"string",description:"ID of the template to be updated."},name:{type:"string",description:"Name of the template."},lang:{type:"string",format:"language",description:"Message language."},contentMarkdown:{type:"string",description:"Content of the template, markdown supported, can contain variable placeholders."},subject:{type:"string",description:"Subject of the message, used in emails."},updatedBy:{type:"string",format:"did",description:"DID of the user who is updating the template."},disabled:{type:"boolean"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.communication.defs#templateView"}},errors:[{name:"DuplicateTemplateName"}]}}},ToolsOzoneHostingGetAccountHistory:{lexicon:1,id:"tools.ozone.hosting.getAccountHistory",defs:{main:{type:"query",description:"Get account history, e.g. log of updated email addresses or other identity information.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"},events:{type:"array",items:{type:"string",knownValues:["accountCreated","emailUpdated","emailConfirmed","passwordUpdated","handleUpdated"]}},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["events"],properties:{cursor:{type:"string"},events:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.hosting.getAccountHistory#event"}}}}}},event:{type:"object",required:["details","createdBy","createdAt"],properties:{details:{type:"union",refs:["lex:tools.ozone.hosting.getAccountHistory#accountCreated","lex:tools.ozone.hosting.getAccountHistory#emailUpdated","lex:tools.ozone.hosting.getAccountHistory#emailConfirmed","lex:tools.ozone.hosting.getAccountHistory#passwordUpdated","lex:tools.ozone.hosting.getAccountHistory#handleUpdated"]},createdBy:{type:"string"},createdAt:{type:"string",format:"datetime"}}},accountCreated:{type:"object",required:[],properties:{email:{type:"string"},handle:{type:"string",format:"handle"}}},emailUpdated:{type:"object",required:["email"],properties:{email:{type:"string"}}},emailConfirmed:{type:"object",required:["email"],properties:{email:{type:"string"}}},passwordUpdated:{type:"object",required:[],properties:{}},handleUpdated:{type:"object",required:["handle"],properties:{handle:{type:"string",format:"handle"}}}}},ToolsOzoneModerationCancelScheduledActions:{lexicon:1,id:"tools.ozone.moderation.cancelScheduledActions",defs:{main:{type:"procedure",description:"Cancel all pending scheduled moderation actions for specified subjects",input:{encoding:"application/json",schema:{type:"object",required:["subjects"],properties:{subjects:{type:"array",maxLength:100,items:{type:"string",format:"did"},description:"Array of DID subjects to cancel scheduled actions for"},comment:{type:"string",description:"Optional comment describing the reason for cancellation"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.cancelScheduledActions#cancellationResults"}}},cancellationResults:{type:"object",required:["succeeded","failed"],properties:{succeeded:{type:"array",items:{type:"string",format:"did"},description:"DIDs for which all pending scheduled actions were successfully cancelled"},failed:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.cancelScheduledActions#failedCancellation"},description:"DIDs for which cancellation failed with error details"}}},failedCancellation:{type:"object",required:["did","error"],properties:{did:{type:"string",format:"did"},error:{type:"string"},errorCode:{type:"string"}}}}},ToolsOzoneModerationDefs:{lexicon:1,id:"tools.ozone.moderation.defs",defs:{modEventView:{type:"object",required:["id","event","subject","subjectBlobCids","createdBy","createdAt"],properties:{id:{type:"integer"},event:{type:"union",refs:["lex:tools.ozone.moderation.defs#modEventTakedown","lex:tools.ozone.moderation.defs#modEventReverseTakedown","lex:tools.ozone.moderation.defs#modEventComment","lex:tools.ozone.moderation.defs#modEventReport","lex:tools.ozone.moderation.defs#modEventLabel","lex:tools.ozone.moderation.defs#modEventAcknowledge","lex:tools.ozone.moderation.defs#modEventEscalate","lex:tools.ozone.moderation.defs#modEventMute","lex:tools.ozone.moderation.defs#modEventUnmute","lex:tools.ozone.moderation.defs#modEventMuteReporter","lex:tools.ozone.moderation.defs#modEventUnmuteReporter","lex:tools.ozone.moderation.defs#modEventEmail","lex:tools.ozone.moderation.defs#modEventResolveAppeal","lex:tools.ozone.moderation.defs#modEventDivert","lex:tools.ozone.moderation.defs#modEventTag","lex:tools.ozone.moderation.defs#accountEvent","lex:tools.ozone.moderation.defs#identityEvent","lex:tools.ozone.moderation.defs#recordEvent","lex:tools.ozone.moderation.defs#modEventPriorityScore","lex:tools.ozone.moderation.defs#ageAssuranceEvent","lex:tools.ozone.moderation.defs#ageAssuranceOverrideEvent","lex:tools.ozone.moderation.defs#revokeAccountCredentialsEvent","lex:tools.ozone.moderation.defs#scheduleTakedownEvent","lex:tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:chat.bsky.convo.defs#messageRef"]},subjectBlobCids:{type:"array",items:{type:"string"}},createdBy:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"},creatorHandle:{type:"string"},subjectHandle:{type:"string"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool"}}},modEventViewDetail:{type:"object",required:["id","event","subject","subjectBlobs","createdBy","createdAt"],properties:{id:{type:"integer"},event:{type:"union",refs:["lex:tools.ozone.moderation.defs#modEventTakedown","lex:tools.ozone.moderation.defs#modEventReverseTakedown","lex:tools.ozone.moderation.defs#modEventComment","lex:tools.ozone.moderation.defs#modEventReport","lex:tools.ozone.moderation.defs#modEventLabel","lex:tools.ozone.moderation.defs#modEventAcknowledge","lex:tools.ozone.moderation.defs#modEventEscalate","lex:tools.ozone.moderation.defs#modEventMute","lex:tools.ozone.moderation.defs#modEventUnmute","lex:tools.ozone.moderation.defs#modEventMuteReporter","lex:tools.ozone.moderation.defs#modEventUnmuteReporter","lex:tools.ozone.moderation.defs#modEventEmail","lex:tools.ozone.moderation.defs#modEventResolveAppeal","lex:tools.ozone.moderation.defs#modEventDivert","lex:tools.ozone.moderation.defs#modEventTag","lex:tools.ozone.moderation.defs#accountEvent","lex:tools.ozone.moderation.defs#identityEvent","lex:tools.ozone.moderation.defs#recordEvent","lex:tools.ozone.moderation.defs#modEventPriorityScore","lex:tools.ozone.moderation.defs#ageAssuranceEvent","lex:tools.ozone.moderation.defs#ageAssuranceOverrideEvent","lex:tools.ozone.moderation.defs#revokeAccountCredentialsEvent","lex:tools.ozone.moderation.defs#scheduleTakedownEvent","lex:tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},subject:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoView","lex:tools.ozone.moderation.defs#repoViewNotFound","lex:tools.ozone.moderation.defs#recordView","lex:tools.ozone.moderation.defs#recordViewNotFound"]},subjectBlobs:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#blobView"}},createdBy:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool"}}},subjectStatusView:{type:"object",required:["id","subject","createdAt","updatedAt","reviewState"],properties:{id:{type:"integer"},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:chat.bsky.convo.defs#messageRef"]},hosting:{type:"union",refs:["lex:tools.ozone.moderation.defs#accountHosting","lex:tools.ozone.moderation.defs#recordHosting"]},subjectBlobCids:{type:"array",items:{type:"string",format:"cid"}},subjectRepoHandle:{type:"string"},updatedAt:{type:"string",format:"datetime",description:"Timestamp referencing when the last update was made to the moderation status of the subject"},createdAt:{type:"string",format:"datetime",description:"Timestamp referencing the first moderation status impacting event was emitted on the subject"},reviewState:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectReviewState"},comment:{type:"string",description:"Sticky comment on the subject."},priorityScore:{type:"integer",description:"Numeric value representing the level of priority. Higher score means higher priority.",minimum:0,maximum:100},muteUntil:{type:"string",format:"datetime"},muteReportingUntil:{type:"string",format:"datetime"},lastReviewedBy:{type:"string",format:"did"},lastReviewedAt:{type:"string",format:"datetime"},lastReportedAt:{type:"string",format:"datetime"},lastAppealedAt:{type:"string",format:"datetime",description:"Timestamp referencing when the author of the subject appealed a moderation action"},takendown:{type:"boolean"},appealed:{type:"boolean",description:"True indicates that the a previously taken moderator action was appealed against, by the author of the content. False indicates last appeal was resolved by moderators."},suspendUntil:{type:"string",format:"datetime"},tags:{type:"array",items:{type:"string"}},accountStats:{description:"Statistics related to the account subject",type:"ref",ref:"lex:tools.ozone.moderation.defs#accountStats"},recordsStats:{description:"Statistics related to the record subjects authored by the subject's account",type:"ref",ref:"lex:tools.ozone.moderation.defs#recordsStats"},ageAssuranceState:{type:"string",description:"Current age assurance state of the subject.",knownValues:["pending","assured","unknown","reset","blocked"]},ageAssuranceUpdatedBy:{type:"string",description:"Whether or not the last successful update to age assurance was made by the user or admin.",knownValues:["admin","user"]}}},subjectView:{description:"Detailed view of a subject. For record subjects, the author's repo and profile will be returned.",type:"object",required:["type","subject"],properties:{type:{type:"ref",ref:"lex:com.atproto.moderation.defs#subjectType"},subject:{type:"string"},status:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"},repo:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoViewDetail"},profile:{type:"union",refs:[]},record:{type:"ref",ref:"lex:tools.ozone.moderation.defs#recordViewDetail"}}},accountStats:{description:"Statistics about a particular account subject",type:"object",properties:{reportCount:{description:"Total number of reports on the account",type:"integer"},appealCount:{description:"Total number of appeals against a moderation action on the account",type:"integer"},suspendCount:{description:"Number of times the account was suspended",type:"integer"},escalateCount:{description:"Number of times the account was escalated",type:"integer"},takedownCount:{description:"Number of times the account was taken down",type:"integer"}}},recordsStats:{description:"Statistics about a set of record subject items",type:"object",properties:{totalReports:{description:"Cumulative sum of the number of reports on the items in the set",type:"integer"},reportedCount:{description:"Number of items that were reported at least once",type:"integer"},escalatedCount:{description:"Number of items that were escalated at least once",type:"integer"},appealedCount:{description:"Number of items that were appealed at least once",type:"integer"},subjectCount:{description:"Total number of item in the set",type:"integer"},pendingCount:{description:'Number of item currently in "reviewOpen" or "reviewEscalated" state',type:"integer"},processedCount:{description:'Number of item currently in "reviewNone" or "reviewClosed" state',type:"integer"},takendownCount:{description:"Number of item currently taken down",type:"integer"}}},subjectReviewState:{type:"string",knownValues:["lex:tools.ozone.moderation.defs#reviewOpen","lex:tools.ozone.moderation.defs#reviewEscalated","lex:tools.ozone.moderation.defs#reviewClosed","lex:tools.ozone.moderation.defs#reviewNone"]},reviewOpen:{type:"token",description:"Moderator review status of a subject: Open. Indicates that the subject needs to be reviewed by a moderator"},reviewEscalated:{type:"token",description:"Moderator review status of a subject: Escalated. Indicates that the subject was escalated for review by a moderator"},reviewClosed:{type:"token",description:"Moderator review status of a subject: Closed. Indicates that the subject was already reviewed and resolved by a moderator"},reviewNone:{type:"token",description:"Moderator review status of a subject: Unnecessary. Indicates that the subject does not need a review at the moment but there is probably some moderation related metadata available for it"},modEventTakedown:{type:"object",description:"Take down a subject permanently or temporarily",properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the takedown should be in effect before automatically expiring."},acknowledgeAccountSubjects:{type:"boolean",description:"If true, all other reports on content authored by this account will be resolved (acknowledged)."},policies:{type:"array",maxLength:5,items:{type:"string"},description:"Names/Keywords of the policies that drove the decision."}}},modEventReverseTakedown:{type:"object",description:"Revert take down action on a subject",properties:{comment:{type:"string",description:"Describe reasoning behind the reversal."}}},modEventResolveAppeal:{type:"object",description:"Resolve appeal on a subject",properties:{comment:{type:"string",description:"Describe resolution."}}},modEventComment:{type:"object",description:"Add a comment to a subject. An empty comment will clear any previously set sticky comment.",properties:{comment:{type:"string"},sticky:{type:"boolean",description:"Make the comment persistent on the subject"}}},modEventReport:{type:"object",description:"Report a subject",required:["reportType"],properties:{comment:{type:"string"},isReporterMuted:{type:"boolean",description:"Set to true if the reporter was muted from reporting at the time of the event. These reports won't impact the reviewState of the subject."},reportType:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"}}},modEventLabel:{type:"object",description:"Apply/Negate labels on a subject",required:["createLabelVals","negateLabelVals"],properties:{comment:{type:"string"},createLabelVals:{type:"array",items:{type:"string"}},negateLabelVals:{type:"array",items:{type:"string"}},durationInHours:{type:"integer",description:"Indicates how long the label will remain on the subject. Only applies on labels that are being added."}}},modEventPriorityScore:{type:"object",description:"Set priority score of the subject. Higher score means higher priority.",required:["score"],properties:{comment:{type:"string"},score:{type:"integer",minimum:0,maximum:100}}},ageAssuranceEvent:{type:"object",description:"Age assurance info coming directly from users. Only works on DID subjects.",required:["createdAt","status","attemptId"],properties:{createdAt:{type:"string",format:"datetime",description:"The date and time of this write operation."},status:{type:"string",description:"The status of the age assurance process.",knownValues:["unknown","pending","assured"]},attemptId:{type:"string",description:"The unique identifier for this instance of the age assurance flow, in UUID format."},initIp:{type:"string",description:"The IP address used when initiating the AA flow."},initUa:{type:"string",description:"The user agent used when initiating the AA flow."},completeIp:{type:"string",description:"The IP address used when completing the AA flow."},completeUa:{type:"string",description:"The user agent used when completing the AA flow."}}},ageAssuranceOverrideEvent:{type:"object",description:"Age assurance status override by moderators. Only works on DID subjects.",required:["comment","status"],properties:{status:{type:"string",description:"The status to be set for the user decided by a moderator, overriding whatever value the user had previously. Use reset to default to original state.",knownValues:["assured","reset","blocked"]},comment:{type:"string",description:"Comment describing the reason for the override."}}},revokeAccountCredentialsEvent:{type:"object",description:"Account credentials revocation by moderators. Only works on DID subjects.",required:["comment"],properties:{comment:{type:"string",description:"Comment describing the reason for the revocation."}}},modEventAcknowledge:{type:"object",properties:{comment:{type:"string"},acknowledgeAccountSubjects:{type:"boolean",description:"If true, all other reports on content authored by this account will be resolved (acknowledged)."}}},modEventEscalate:{type:"object",properties:{comment:{type:"string"}}},modEventMute:{type:"object",description:"Mute incoming reports on a subject",required:["durationInHours"],properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the subject should remain muted."}}},modEventUnmute:{type:"object",description:"Unmute action on a subject",properties:{comment:{type:"string",description:"Describe reasoning behind the reversal."}}},modEventMuteReporter:{type:"object",description:"Mute incoming reports from an account",properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the account should remain muted. Falsy value here means a permanent mute."}}},modEventUnmuteReporter:{type:"object",description:"Unmute incoming reports from an account",properties:{comment:{type:"string",description:"Describe reasoning behind the reversal."}}},modEventEmail:{type:"object",description:"Keep a log of outgoing email to a user",required:["subjectLine"],properties:{subjectLine:{type:"string",description:"The subject line of the email sent to the user."},content:{type:"string",description:"The content of the email sent to the user."},comment:{type:"string",description:"Additional comment about the outgoing comm."}}},modEventDivert:{type:"object",description:"Divert a record's blobs to a 3rd party service for further scanning/tagging",properties:{comment:{type:"string"}}},modEventTag:{type:"object",description:"Add/Remove a tag on a subject",required:["add","remove"],properties:{add:{type:"array",items:{type:"string"},description:"Tags to be added to the subject. If already exists, won't be duplicated."},remove:{type:"array",items:{type:"string"},description:"Tags to be removed to the subject. Ignores a tag If it doesn't exist, won't be duplicated."},comment:{type:"string",description:"Additional comment about added/removed tags."}}},accountEvent:{type:"object",description:"Logs account status related events on a repo subject. Normally captured by automod from the firehose and emitted to ozone for historical tracking.",required:["timestamp","active"],properties:{comment:{type:"string"},active:{type:"boolean",description:"Indicates that the account has a repository which can be fetched from the host that emitted this event."},status:{type:"string",knownValues:["unknown","deactivated","deleted","takendown","suspended","tombstoned"]},timestamp:{type:"string",format:"datetime"}}},identityEvent:{type:"object",description:"Logs identity related events on a repo subject. Normally captured by automod from the firehose and emitted to ozone for historical tracking.",required:["timestamp"],properties:{comment:{type:"string"},handle:{type:"string",format:"handle"},pdsHost:{type:"string",format:"uri"},tombstone:{type:"boolean"},timestamp:{type:"string",format:"datetime"}}},recordEvent:{type:"object",description:"Logs lifecycle event on a record subject. Normally captured by automod from the firehose and emitted to ozone for historical tracking.",required:["timestamp","op"],properties:{comment:{type:"string"},op:{type:"string",knownValues:["create","update","delete"]},cid:{type:"string",format:"cid"},timestamp:{type:"string",format:"datetime"}}},scheduleTakedownEvent:{type:"object",description:"Logs a scheduled takedown action for an account.",properties:{comment:{type:"string"},executeAt:{type:"string",format:"datetime"},executeAfter:{type:"string",format:"datetime"},executeUntil:{type:"string",format:"datetime"}}},cancelScheduledTakedownEvent:{type:"object",description:"Logs cancellation of a scheduled takedown action for an account.",properties:{comment:{type:"string"}}},repoView:{type:"object",required:["did","handle","relatedRecords","indexedAt","moderation"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},email:{type:"string"},relatedRecords:{type:"array",items:{type:"unknown"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderation"},invitedBy:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"},invitesDisabled:{type:"boolean"},inviteNote:{type:"string"},deactivatedAt:{type:"string",format:"datetime"},threatSignatures:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#threatSignature"}}}},repoViewDetail:{type:"object",required:["did","handle","relatedRecords","indexedAt","moderation"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},email:{type:"string"},relatedRecords:{type:"array",items:{type:"unknown"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderationDetail"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},invitedBy:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"},invites:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}},invitesDisabled:{type:"boolean"},inviteNote:{type:"string"},emailConfirmedAt:{type:"string",format:"datetime"},deactivatedAt:{type:"string",format:"datetime"},threatSignatures:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#threatSignature"}}}},repoViewNotFound:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},recordView:{type:"object",required:["uri","cid","value","blobCids","indexedAt","moderation","repo"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"},blobCids:{type:"array",items:{type:"string",format:"cid"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderation"},repo:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoView"}}},recordViewDetail:{type:"object",required:["uri","cid","value","blobs","indexedAt","moderation","repo"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"},blobs:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#blobView"}},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderationDetail"},repo:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoView"}}},recordViewNotFound:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},moderation:{type:"object",properties:{subjectStatus:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"}}},moderationDetail:{type:"object",properties:{subjectStatus:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"}}},blobView:{type:"object",required:["cid","mimeType","size","createdAt"],properties:{cid:{type:"string",format:"cid"},mimeType:{type:"string"},size:{type:"integer"},createdAt:{type:"string",format:"datetime"},details:{type:"union",refs:["lex:tools.ozone.moderation.defs#imageDetails","lex:tools.ozone.moderation.defs#videoDetails"]},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderation"}}},imageDetails:{type:"object",required:["width","height"],properties:{width:{type:"integer"},height:{type:"integer"}}},videoDetails:{type:"object",required:["width","height","length"],properties:{width:{type:"integer"},height:{type:"integer"},length:{type:"integer"}}},accountHosting:{type:"object",required:["status"],properties:{status:{type:"string",knownValues:["takendown","suspended","deleted","deactivated","unknown"]},updatedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},deletedAt:{type:"string",format:"datetime"},deactivatedAt:{type:"string",format:"datetime"},reactivatedAt:{type:"string",format:"datetime"}}},recordHosting:{type:"object",required:["status"],properties:{status:{type:"string",knownValues:["deleted","unknown"]},updatedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},deletedAt:{type:"string",format:"datetime"}}},reporterStats:{type:"object",required:["did","accountReportCount","recordReportCount","reportedAccountCount","reportedRecordCount","takendownAccountCount","takendownRecordCount","labeledAccountCount","labeledRecordCount"],properties:{did:{type:"string",format:"did"},accountReportCount:{type:"integer",description:"The total number of reports made by the user on accounts."},recordReportCount:{type:"integer",description:"The total number of reports made by the user on records."},reportedAccountCount:{type:"integer",description:"The total number of accounts reported by the user."},reportedRecordCount:{type:"integer",description:"The total number of records reported by the user."},takendownAccountCount:{type:"integer",description:"The total number of accounts taken down as a result of the user's reports."},takendownRecordCount:{type:"integer",description:"The total number of records taken down as a result of the user's reports."},labeledAccountCount:{type:"integer",description:"The total number of accounts labeled as a result of the user's reports."},labeledRecordCount:{type:"integer",description:"The total number of records labeled as a result of the user's reports."}}},modTool:{type:"object",description:"Moderation tool information for tracing the source of the action",required:["name"],properties:{name:{type:"string",description:"Name/identifier of the source (e.g., 'automod', 'ozone/workspace')"},meta:{type:"unknown",description:"Additional arbitrary metadata about the source"}}},timelineEventPlcCreate:{type:"token",description:"Moderation event timeline event for a PLC create operation"},timelineEventPlcOperation:{type:"token",description:"Moderation event timeline event for generic PLC operation"},timelineEventPlcTombstone:{type:"token",description:"Moderation event timeline event for a PLC tombstone operation"},scheduledActionView:{type:"object",description:"View of a scheduled moderation action",required:["id","action","did","createdBy","createdAt","status"],properties:{id:{type:"integer",description:"Auto-incrementing row ID"},action:{type:"string",knownValues:["takedown"],description:"Type of action to be executed"},eventData:{type:"unknown",description:"Serialized event object that will be propagated to the event when performed"},did:{type:"string",format:"did",description:"Subject DID for the action"},executeAt:{type:"string",format:"datetime",description:"Exact time to execute the action"},executeAfter:{type:"string",format:"datetime",description:"Earliest time to execute the action (for randomized scheduling)"},executeUntil:{type:"string",format:"datetime",description:"Latest time to execute the action (for randomized scheduling)"},randomizeExecution:{type:"boolean",description:"Whether execution time should be randomized within the specified range"},createdBy:{type:"string",format:"did",description:"DID of the user who created this scheduled action"},createdAt:{type:"string",format:"datetime",description:"When the scheduled action was created"},updatedAt:{type:"string",format:"datetime",description:"When the scheduled action was last updated"},status:{type:"string",knownValues:["pending","executed","cancelled","failed"],description:"Current status of the scheduled action"},lastExecutedAt:{type:"string",format:"datetime",description:"When the action was last attempted to be executed"},lastFailureReason:{type:"string",description:"Reason for the last execution failure"},executionEventId:{type:"integer",description:"ID of the moderation event created when action was successfully executed"}}}}},ToolsOzoneModerationEmitEvent:{lexicon:1,id:"tools.ozone.moderation.emitEvent",defs:{main:{type:"procedure",description:"Take a moderation action on an actor.",input:{encoding:"application/json",schema:{type:"object",required:["event","subject","createdBy"],properties:{event:{type:"union",refs:["lex:tools.ozone.moderation.defs#modEventTakedown","lex:tools.ozone.moderation.defs#modEventAcknowledge","lex:tools.ozone.moderation.defs#modEventEscalate","lex:tools.ozone.moderation.defs#modEventComment","lex:tools.ozone.moderation.defs#modEventLabel","lex:tools.ozone.moderation.defs#modEventReport","lex:tools.ozone.moderation.defs#modEventMute","lex:tools.ozone.moderation.defs#modEventUnmute","lex:tools.ozone.moderation.defs#modEventMuteReporter","lex:tools.ozone.moderation.defs#modEventUnmuteReporter","lex:tools.ozone.moderation.defs#modEventReverseTakedown","lex:tools.ozone.moderation.defs#modEventResolveAppeal","lex:tools.ozone.moderation.defs#modEventEmail","lex:tools.ozone.moderation.defs#modEventDivert","lex:tools.ozone.moderation.defs#modEventTag","lex:tools.ozone.moderation.defs#accountEvent","lex:tools.ozone.moderation.defs#identityEvent","lex:tools.ozone.moderation.defs#recordEvent","lex:tools.ozone.moderation.defs#modEventPriorityScore","lex:tools.ozone.moderation.defs#ageAssuranceEvent","lex:tools.ozone.moderation.defs#ageAssuranceOverrideEvent","lex:tools.ozone.moderation.defs#revokeAccountCredentialsEvent","lex:tools.ozone.moderation.defs#scheduleTakedownEvent","lex:tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef"]},subjectBlobCids:{type:"array",items:{type:"string",format:"cid"}},createdBy:{type:"string",format:"did"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool"},externalId:{type:"string",description:"An optional external ID for the event, used to deduplicate events from external systems. Fails when an event of same type with the same external ID exists for the same subject."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modEventView"}},errors:[{name:"SubjectHasAction"},{name:"DuplicateExternalId",description:"An event with the same external ID already exists for the subject."}]}}},ToolsOzoneModerationGetAccountTimeline:{lexicon:1,id:"tools.ozone.moderation.getAccountTimeline",defs:{main:{type:"query",description:"Get timeline of all available events of an account. This includes moderation events, account history and did history.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"object",required:["timeline"],properties:{timeline:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.getAccountTimeline#timelineItem"}}}}},errors:[{name:"RepoNotFound"}]},timelineItem:{type:"object",required:["day","summary"],properties:{day:{type:"string"},summary:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.getAccountTimeline#timelineItemSummary"}}}},timelineItemSummary:{type:"object",required:["eventSubjectType","eventType","count"],properties:{eventSubjectType:{type:"string",knownValues:["account","record","chat"]},eventType:{type:"string",knownValues:["tools.ozone.moderation.defs#modEventTakedown","tools.ozone.moderation.defs#modEventReverseTakedown","tools.ozone.moderation.defs#modEventComment","tools.ozone.moderation.defs#modEventReport","tools.ozone.moderation.defs#modEventLabel","tools.ozone.moderation.defs#modEventAcknowledge","tools.ozone.moderation.defs#modEventEscalate","tools.ozone.moderation.defs#modEventMute","tools.ozone.moderation.defs#modEventUnmute","tools.ozone.moderation.defs#modEventMuteReporter","tools.ozone.moderation.defs#modEventUnmuteReporter","tools.ozone.moderation.defs#modEventEmail","tools.ozone.moderation.defs#modEventResolveAppeal","tools.ozone.moderation.defs#modEventDivert","tools.ozone.moderation.defs#modEventTag","tools.ozone.moderation.defs#accountEvent","tools.ozone.moderation.defs#identityEvent","tools.ozone.moderation.defs#recordEvent","tools.ozone.moderation.defs#modEventPriorityScore","tools.ozone.moderation.defs#revokeAccountCredentialsEvent","tools.ozone.moderation.defs#ageAssuranceEvent","tools.ozone.moderation.defs#ageAssuranceOverrideEvent","tools.ozone.moderation.defs#timelineEventPlcCreate","tools.ozone.moderation.defs#timelineEventPlcOperation","tools.ozone.moderation.defs#timelineEventPlcTombstone","tools.ozone.hosting.getAccountHistory#accountCreated","tools.ozone.hosting.getAccountHistory#emailConfirmed","tools.ozone.hosting.getAccountHistory#passwordUpdated","tools.ozone.hosting.getAccountHistory#handleUpdated","tools.ozone.moderation.defs#scheduleTakedownEvent","tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},count:{type:"integer"}}}}},ToolsOzoneModerationGetEvent:{lexicon:1,id:"tools.ozone.moderation.getEvent",defs:{main:{type:"query",description:"Get details about a moderation event.",parameters:{type:"params",required:["id"],properties:{id:{type:"integer"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modEventViewDetail"}}}}},ToolsOzoneModerationGetRecord:{lexicon:1,id:"tools.ozone.moderation.getRecord",defs:{main:{type:"query",description:"Get details about a record.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#recordViewDetail"}},errors:[{name:"RecordNotFound"}]}}},ToolsOzoneModerationGetRecords:{lexicon:1,id:"tools.ozone.moderation.getRecords",defs:{main:{type:"query",description:"Get details about some records.",parameters:{type:"params",required:["uris"],properties:{uris:{type:"array",maxLength:100,items:{type:"string",format:"at-uri"}}}},output:{encoding:"application/json",schema:{type:"object",required:["records"],properties:{records:{type:"array",items:{type:"union",refs:["lex:tools.ozone.moderation.defs#recordViewDetail","lex:tools.ozone.moderation.defs#recordViewNotFound"]}}}}}}}},ToolsOzoneModerationGetRepo:{lexicon:1,id:"tools.ozone.moderation.getRepo",defs:{main:{type:"query",description:"Get details about a repository.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoViewDetail"}},errors:[{name:"RepoNotFound"}]}}},ToolsOzoneModerationGetReporterStats:{lexicon:1,id:"tools.ozone.moderation.getReporterStats",defs:{main:{type:"query",description:"Get reporter stats for a list of users.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",maxLength:100,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["stats"],properties:{stats:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#reporterStats"}}}}}}}},ToolsOzoneModerationGetRepos:{lexicon:1,id:"tools.ozone.moderation.getRepos",defs:{main:{type:"query",description:"Get details about some repositories.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",maxLength:100,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{repos:{type:"array",items:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoViewDetail","lex:tools.ozone.moderation.defs#repoViewNotFound"]}}}}}}}},ToolsOzoneModerationGetSubjects:{lexicon:1,id:"tools.ozone.moderation.getSubjects",defs:{main:{type:"query",description:"Get details about subjects.",parameters:{type:"params",required:["subjects"],properties:{subjects:{type:"array",maxLength:100,minLength:1,items:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["subjects"],properties:{subjects:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectView"}}}}}}}},ToolsOzoneModerationListScheduledActions:{lexicon:1,id:"tools.ozone.moderation.listScheduledActions",defs:{main:{type:"procedure",description:"List scheduled moderation actions with optional filtering",input:{encoding:"application/json",schema:{type:"object",required:["statuses"],properties:{startsAfter:{type:"string",format:"datetime",description:"Filter actions scheduled to execute after this time"},endsBefore:{type:"string",format:"datetime",description:"Filter actions scheduled to execute before this time"},subjects:{type:"array",maxLength:100,items:{type:"string",format:"did"},description:"Filter actions for specific DID subjects"},statuses:{type:"array",minLength:1,items:{type:"string",knownValues:["pending","executed","cancelled","failed"]},description:"Filter actions by status"},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"Maximum number of results to return"},cursor:{type:"string",description:"Cursor for pagination"}}}},output:{encoding:"application/json",schema:{type:"object",required:["actions"],properties:{actions:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#scheduledActionView"}},cursor:{type:"string",description:"Cursor for next page of results"}}}}}}},ToolsOzoneModerationQueryEvents:{lexicon:1,id:"tools.ozone.moderation.queryEvents",defs:{main:{type:"query",description:"List moderation events related to a subject.",parameters:{type:"params",properties:{types:{type:"array",items:{type:"string"},description:"The types of events (fully qualified string in the format of tools.ozone.moderation.defs#modEvent<name>) to filter by. If not specified, all events are returned."},createdBy:{type:"string",format:"did"},sortDirection:{type:"string",default:"desc",enum:["asc","desc"],description:"Sort direction for the events. Defaults to descending order of created at timestamp."},createdAfter:{type:"string",format:"datetime",description:"Retrieve events created after a given timestamp"},createdBefore:{type:"string",format:"datetime",description:"Retrieve events created before a given timestamp"},subject:{type:"string",format:"uri"},collections:{type:"array",maxLength:20,description:"If specified, only events where the subject belongs to the given collections will be returned. When subjectType is set to 'account', this will be ignored.",items:{type:"string",format:"nsid"}},subjectType:{type:"string",description:"If specified, only events where the subject is of the given type (account or record) will be returned. When this is set to 'account' the 'collections' parameter will be ignored. When includeAllUserRecords or subject is set, this will be ignored.",knownValues:["account","record"]},includeAllUserRecords:{type:"boolean",default:!1,description:"If true, events on all record types (posts, lists, profile etc.) or records from given 'collections' param, owned by the did are returned."},limit:{type:"integer",minimum:1,maximum:100,default:50},hasComment:{type:"boolean",description:"If true, only events with comments are returned"},comment:{type:"string",description:"If specified, only events with comments containing the keyword are returned. Apply || separator to use multiple keywords and match using OR condition."},addedLabels:{type:"array",items:{type:"string"},description:"If specified, only events where all of these labels were added are returned"},removedLabels:{type:"array",items:{type:"string"},description:"If specified, only events where all of these labels were removed are returned"},addedTags:{type:"array",items:{type:"string"},description:"If specified, only events where all of these tags were added are returned"},removedTags:{type:"array",items:{type:"string"},description:"If specified, only events where all of these tags were removed are returned"},reportTypes:{type:"array",items:{type:"string"}},policies:{type:"array",items:{type:"string",description:"If specified, only events where the action policies match any of the given policies are returned"}},modTool:{type:"array",items:{type:"string"},description:"If specified, only events where the modTool name matches any of the given values are returned"},batchId:{type:"string",description:"If specified, only events where the batchId matches the given value are returned"},ageAssuranceState:{type:"string",description:"If specified, only events where the age assurance state matches the given value are returned",knownValues:["pending","assured","unknown","reset","blocked"]},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["events"],properties:{cursor:{type:"string"},events:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modEventView"}}}}}}}},ToolsOzoneModerationQueryStatuses:{lexicon:1,id:"tools.ozone.moderation.queryStatuses",defs:{main:{type:"query",description:"View moderation statuses of subjects (record or repo).",parameters:{type:"params",properties:{queueCount:{type:"integer",description:"Number of queues being used by moderators. Subjects will be split among all queues."},queueIndex:{type:"integer",description:"Index of the queue to fetch subjects from. Works only when queueCount value is specified."},queueSeed:{type:"string",description:"A seeder to shuffle/balance the queue items."},includeAllUserRecords:{type:"boolean",description:"All subjects, or subjects from given 'collections' param, belonging to the account specified in the 'subject' param will be returned."},subject:{type:"string",format:"uri",description:"The subject to get the status for."},comment:{type:"string",description:"Search subjects by keyword from comments"},reportedAfter:{type:"string",format:"datetime",description:"Search subjects reported after a given timestamp"},reportedBefore:{type:"string",format:"datetime",description:"Search subjects reported before a given timestamp"},reviewedAfter:{type:"string",format:"datetime",description:"Search subjects reviewed after a given timestamp"},hostingDeletedAfter:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was deleted after a given timestamp"},hostingDeletedBefore:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was deleted before a given timestamp"},hostingUpdatedAfter:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was updated after a given timestamp"},hostingUpdatedBefore:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was updated before a given timestamp"},hostingStatuses:{type:"array",items:{type:"string"},description:"Search subjects by the status of the associated record/account"},reviewedBefore:{type:"string",format:"datetime",description:"Search subjects reviewed before a given timestamp"},includeMuted:{type:"boolean",description:"By default, we don't include muted subjects in the results. Set this to true to include them."},onlyMuted:{type:"boolean",description:"When set to true, only muted subjects and reporters will be returned."},reviewState:{type:"string",description:"Specify when fetching subjects in a certain state"},ignoreSubjects:{type:"array",items:{type:"string",format:"uri"}},lastReviewedBy:{type:"string",format:"did",description:"Get all subject statuses that were reviewed by a specific moderator"},sortField:{type:"string",default:"lastReportedAt",enum:["lastReviewedAt","lastReportedAt","reportedRecordsCount","takendownRecordsCount","priorityScore"]},sortDirection:{type:"string",default:"desc",enum:["asc","desc"]},takendown:{type:"boolean",description:"Get subjects that were taken down"},appealed:{type:"boolean",description:"Get subjects in unresolved appealed status"},limit:{type:"integer",minimum:1,maximum:100,default:50},tags:{type:"array",maxLength:25,items:{type:"string",description:"Items in this array are applied with OR filters. To apply AND filter, put all tags in the same string and separate using && characters"}},excludeTags:{type:"array",items:{type:"string"}},cursor:{type:"string"},collections:{type:"array",maxLength:20,description:"If specified, subjects belonging to the given collections will be returned. When subjectType is set to 'account', this will be ignored.",items:{type:"string",format:"nsid"}},subjectType:{type:"string",description:"If specified, subjects of the given type (account or record) will be returned. When this is set to 'account' the 'collections' parameter will be ignored. When includeAllUserRecords or subject is set, this will be ignored.",knownValues:["account","record"]},minAccountSuspendCount:{type:"integer",description:"If specified, only subjects that belong to an account that has at least this many suspensions will be returned."},minReportedRecordsCount:{type:"integer",description:"If specified, only subjects that belong to an account that has at least this many reported records will be returned."},minTakendownRecordsCount:{type:"integer",description:"If specified, only subjects that belong to an account that has at least this many taken down records will be returned."},minPriorityScore:{minimum:0,maximum:100,type:"integer",description:"If specified, only subjects that have priority score value above the given value will be returned."},ageAssuranceState:{type:"string",description:"If specified, only subjects with the given age assurance state will be returned.",knownValues:["pending","assured","unknown","reset","blocked"]}}},output:{encoding:"application/json",schema:{type:"object",required:["subjectStatuses"],properties:{cursor:{type:"string"},subjectStatuses:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"}}}}}}}},ToolsOzoneModerationScheduleAction:{lexicon:1,id:"tools.ozone.moderation.scheduleAction",defs:{main:{type:"procedure",description:"Schedule a moderation action to be executed at a future time",input:{encoding:"application/json",schema:{type:"object",required:["action","subjects","createdBy","scheduling"],properties:{action:{type:"union",refs:["lex:tools.ozone.moderation.scheduleAction#takedown"]},subjects:{type:"array",maxLength:100,items:{type:"string",format:"did"},description:"Array of DID subjects to schedule the action for"},createdBy:{type:"string",format:"did"},scheduling:{type:"ref",ref:"lex:tools.ozone.moderation.scheduleAction#schedulingConfig"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool",description:"This will be propagated to the moderation event when it is applied"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.scheduleAction#scheduledActionResults"}}},takedown:{type:"object",description:"Schedule a takedown action",properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the takedown should be in effect before automatically expiring."},acknowledgeAccountSubjects:{type:"boolean",description:"If true, all other reports on content authored by this account will be resolved (acknowledged)."},policies:{type:"array",maxLength:5,items:{type:"string"},description:"Names/Keywords of the policies that drove the decision."}}},schedulingConfig:{type:"object",description:"Configuration for when the action should be executed",properties:{executeAt:{type:"string",format:"datetime",description:"Exact time to execute the action"},executeAfter:{type:"string",format:"datetime",description:"Earliest time to execute the action (for randomized scheduling)"},executeUntil:{type:"string",format:"datetime",description:"Latest time to execute the action (for randomized scheduling)"}}},scheduledActionResults:{type:"object",required:["succeeded","failed"],properties:{succeeded:{type:"array",items:{type:"string",format:"did"}},failed:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.scheduleAction#failedScheduling"}}}},failedScheduling:{type:"object",required:["subject","error"],properties:{subject:{type:"string",format:"did"},error:{type:"string"},errorCode:{type:"string"}}}}},ToolsOzoneModerationSearchRepos:{lexicon:1,id:"tools.ozone.moderation.searchRepos",defs:{main:{type:"query",description:"Find repositories based on a search term.",parameters:{type:"params",properties:{term:{type:"string",description:"DEPRECATED: use 'q' instead"},q:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{cursor:{type:"string"},repos:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoView"}}}}}}}},ToolsOzoneReportDefs:{lexicon:1,id:"tools.ozone.report.defs",defs:{reasonType:{type:"string",knownValues:["tools.ozone.report.defs#reasonAppeal","tools.ozone.report.defs#reasonOther","tools.ozone.report.defs#reasonViolenceAnimal","tools.ozone.report.defs#reasonViolenceThreats","tools.ozone.report.defs#reasonViolenceGraphicContent","tools.ozone.report.defs#reasonViolenceGlorification","tools.ozone.report.defs#reasonViolenceExtremistContent","tools.ozone.report.defs#reasonViolenceTrafficking","tools.ozone.report.defs#reasonViolenceOther","tools.ozone.report.defs#reasonSexualAbuseContent","tools.ozone.report.defs#reasonSexualNCII","tools.ozone.report.defs#reasonSexualDeepfake","tools.ozone.report.defs#reasonSexualAnimal","tools.ozone.report.defs#reasonSexualUnlabeled","tools.ozone.report.defs#reasonSexualOther","tools.ozone.report.defs#reasonChildSafetyCSAM","tools.ozone.report.defs#reasonChildSafetyGroom","tools.ozone.report.defs#reasonChildSafetyPrivacy","tools.ozone.report.defs#reasonChildSafetyHarassment","tools.ozone.report.defs#reasonChildSafetyOther","tools.ozone.report.defs#reasonHarassmentTroll","tools.ozone.report.defs#reasonHarassmentTargeted","tools.ozone.report.defs#reasonHarassmentHateSpeech","tools.ozone.report.defs#reasonHarassmentDoxxing","tools.ozone.report.defs#reasonHarassmentOther","tools.ozone.report.defs#reasonMisleadingBot","tools.ozone.report.defs#reasonMisleadingImpersonation","tools.ozone.report.defs#reasonMisleadingSpam","tools.ozone.report.defs#reasonMisleadingScam","tools.ozone.report.defs#reasonMisleadingElections","tools.ozone.report.defs#reasonMisleadingOther","tools.ozone.report.defs#reasonRuleSiteSecurity","tools.ozone.report.defs#reasonRuleProhibitedSales","tools.ozone.report.defs#reasonRuleBanEvasion","tools.ozone.report.defs#reasonRuleOther","tools.ozone.report.defs#reasonSelfHarmContent","tools.ozone.report.defs#reasonSelfHarmED","tools.ozone.report.defs#reasonSelfHarmStunts","tools.ozone.report.defs#reasonSelfHarmSubstances","tools.ozone.report.defs#reasonSelfHarmOther"]},reasonAppeal:{type:"token",description:"Appeal a previously taken moderation action"},reasonOther:{type:"token",description:"An issue not included in these options"},reasonViolenceAnimal:{type:"token",description:"Animal welfare violations"},reasonViolenceThreats:{type:"token",description:"Threats or incitement"},reasonViolenceGraphicContent:{type:"token",description:"Graphic violent content"},reasonViolenceGlorification:{type:"token",description:"Glorification of violence"},reasonViolenceExtremistContent:{type:"token",description:"Extremist content. These reports will be sent only be sent to the application's Moderation Authority."},reasonViolenceTrafficking:{type:"token",description:"Human trafficking"},reasonViolenceOther:{type:"token",description:"Other violent content"},reasonSexualAbuseContent:{type:"token",description:"Adult sexual abuse content"},reasonSexualNCII:{type:"token",description:"Non-consensual intimate imagery"},reasonSexualDeepfake:{type:"token",description:"Deepfake adult content"},reasonSexualAnimal:{type:"token",description:"Animal sexual abuse"},reasonSexualUnlabeled:{type:"token",description:"Unlabelled adult content"},reasonSexualOther:{type:"token",description:"Other sexual violence content"},reasonChildSafetyCSAM:{type:"token",description:"Child sexual abuse material (CSAM). These reports will be sent only be sent to the application's Moderation Authority."},reasonChildSafetyGroom:{type:"token",description:"Grooming or predatory behavior. These reports will be sent only be sent to the application's Moderation Authority."},reasonChildSafetyPrivacy:{type:"token",description:"Privacy violation involving a minor"},reasonChildSafetyHarassment:{type:"token",description:"Harassment or bullying of minors"},reasonChildSafetyOther:{type:"token",description:"Other child safety. These reports will be sent only be sent to the application's Moderation Authority."},reasonHarassmentTroll:{type:"token",description:"Trolling"},reasonHarassmentTargeted:{type:"token",description:"Targeted harassment"},reasonHarassmentHateSpeech:{type:"token",description:"Hate speech"},reasonHarassmentDoxxing:{type:"token",description:"Doxxing"},reasonHarassmentOther:{type:"token",description:"Other harassing or hateful content"},reasonMisleadingBot:{type:"token",description:"Fake account or bot"},reasonMisleadingImpersonation:{type:"token",description:"Impersonation"},reasonMisleadingSpam:{type:"token",description:"Spam"},reasonMisleadingScam:{type:"token",description:"Scam"},reasonMisleadingElections:{type:"token",description:"False information about elections"},reasonMisleadingOther:{type:"token",description:"Other misleading content"},reasonRuleSiteSecurity:{type:"token",description:"Hacking or system attacks"},reasonRuleProhibitedSales:{type:"token",description:"Promoting or selling prohibited items or services"},reasonRuleBanEvasion:{type:"token",description:"Banned user returning"},reasonRuleOther:{type:"token",description:"Other"},reasonSelfHarmContent:{type:"token",description:"Content promoting or depicting self-harm"},reasonSelfHarmED:{type:"token",description:"Eating disorders"},reasonSelfHarmStunts:{type:"token",description:"Dangerous challenges or activities"},reasonSelfHarmSubstances:{type:"token",description:"Dangerous substances or drug abuse"},reasonSelfHarmOther:{type:"token",description:"Other dangerous content"}}},ToolsOzoneSafelinkAddRule:{lexicon:1,id:"tools.ozone.safelink.addRule",defs:{main:{type:"procedure",description:"Add a new URL safety rule",input:{encoding:"application/json",schema:{type:"object",required:["url","pattern","action","reason"],properties:{url:{type:"string",description:"The URL or domain to apply the rule to"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},comment:{type:"string",description:"Optional comment about the decision"},createdBy:{type:"string",format:"did",description:"Author DID. Only respected when using admin auth"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}},errors:[{name:"InvalidUrl",description:"The provided URL is invalid"},{name:"RuleAlreadyExists",description:"A rule for this URL/domain already exists"}]}}},ToolsOzoneSafelinkDefs:{lexicon:1,id:"tools.ozone.safelink.defs",defs:{event:{type:"object",description:"An event for URL safety decisions",required:["id","eventType","url","pattern","action","reason","createdBy","createdAt"],properties:{id:{type:"integer",description:"Auto-incrementing row ID"},eventType:{type:"ref",ref:"lex:tools.ozone.safelink.defs#eventType"},url:{type:"string",description:"The URL that this rule applies to"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},createdBy:{type:"string",format:"did",description:"DID of the user who created this rule"},createdAt:{type:"string",format:"datetime"},comment:{type:"string",description:"Optional comment about the decision"}}},eventType:{type:"string",knownValues:["addRule","updateRule","removeRule"]},patternType:{type:"string",knownValues:["domain","url"]},actionType:{type:"string",knownValues:["block","warn","whitelist"]},reasonType:{type:"string",knownValues:["csam","spam","phishing","none"]},urlRule:{type:"object",description:"Input for creating a URL safety rule",required:["url","pattern","action","reason","createdBy","createdAt","updatedAt"],properties:{url:{type:"string",description:"The URL or domain to apply the rule to"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},comment:{type:"string",description:"Optional comment about the decision"},createdBy:{type:"string",format:"did",description:"DID of the user added the rule."},createdAt:{type:"string",format:"datetime",description:"Timestamp when the rule was created"},updatedAt:{type:"string",format:"datetime",description:"Timestamp when the rule was last updated"}}}}},ToolsOzoneSafelinkQueryEvents:{lexicon:1,id:"tools.ozone.safelink.queryEvents",defs:{main:{type:"procedure",description:"Query URL safety audit events",input:{encoding:"application/json",schema:{type:"object",properties:{cursor:{type:"string",description:"Cursor for pagination"},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"Maximum number of results to return"},urls:{type:"array",items:{type:"string"},description:"Filter by specific URLs or domains"},patternType:{type:"string",description:"Filter by pattern type"},sortDirection:{type:"string",knownValues:["asc","desc"],default:"desc",description:"Sort direction"}}}},output:{encoding:"application/json",schema:{type:"object",required:["events"],properties:{cursor:{type:"string",description:"Next cursor for pagination. Only present if there are more results."},events:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}}}}}}}},ToolsOzoneSafelinkQueryRules:{lexicon:1,id:"tools.ozone.safelink.queryRules",defs:{main:{type:"procedure",description:"Query URL safety rules",input:{encoding:"application/json",schema:{type:"object",properties:{cursor:{type:"string",description:"Cursor for pagination"},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"Maximum number of results to return"},urls:{type:"array",items:{type:"string"},description:"Filter by specific URLs or domains"},patternType:{type:"string",description:"Filter by pattern type"},actions:{type:"array",items:{type:"string"},description:"Filter by action types"},reason:{type:"string",description:"Filter by reason type"},createdBy:{type:"string",format:"did",description:"Filter by rule creator"},sortDirection:{type:"string",knownValues:["asc","desc"],default:"desc",description:"Sort direction"}}}},output:{encoding:"application/json",schema:{type:"object",required:["rules"],properties:{cursor:{type:"string",description:"Next cursor for pagination. Only present if there are more results."},rules:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.safelink.defs#urlRule"}}}}}}}},ToolsOzoneSafelinkRemoveRule:{lexicon:1,id:"tools.ozone.safelink.removeRule",defs:{main:{type:"procedure",description:"Remove an existing URL safety rule",input:{encoding:"application/json",schema:{type:"object",required:["url","pattern"],properties:{url:{type:"string",description:"The URL or domain to remove the rule for"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},comment:{type:"string",description:"Optional comment about why the rule is being removed"},createdBy:{type:"string",format:"did",description:"Optional DID of the user. Only respected when using admin auth."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}},errors:[{name:"RuleNotFound",description:"No active rule found for this URL/domain"}]}}},ToolsOzoneSafelinkUpdateRule:{lexicon:1,id:"tools.ozone.safelink.updateRule",defs:{main:{type:"procedure",description:"Update an existing URL safety rule",input:{encoding:"application/json",schema:{type:"object",required:["url","pattern","action","reason"],properties:{url:{type:"string",description:"The URL or domain to update the rule for"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},comment:{type:"string",description:"Optional comment about the update"},createdBy:{type:"string",format:"did",description:"Optional DID to credit as the creator. Only respected for admin_token authentication."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}},errors:[{name:"RuleNotFound",description:"No active rule found for this URL/domain"}]}}},ToolsOzoneServerGetConfig:{lexicon:1,id:"tools.ozone.server.getConfig",defs:{main:{type:"query",description:"Get details about ozone's server configuration.",output:{encoding:"application/json",schema:{type:"object",properties:{appview:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},pds:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},blobDivert:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},chat:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},viewer:{type:"ref",ref:"lex:tools.ozone.server.getConfig#viewerConfig"},verifierDid:{type:"string",format:"did",description:"The did of the verifier used for verification."}}}}},serviceConfig:{type:"object",properties:{url:{type:"string",format:"uri"}}},viewerConfig:{type:"object",properties:{role:{type:"string",knownValues:["tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleTriage","tools.ozone.team.defs#roleVerifier"]}}}}},ToolsOzoneSetAddValues:{lexicon:1,id:"tools.ozone.set.addValues",defs:{main:{type:"procedure",description:"Add values to a specific set. Attempting to add values to a set that does not exist will result in an error.",input:{encoding:"application/json",schema:{type:"object",required:["name","values"],properties:{name:{type:"string",description:"Name of the set to add values to"},values:{type:"array",minLength:1,maxLength:1e3,items:{type:"string"},description:"Array of string values to add to the set"}}}}}}},ToolsOzoneSetDefs:{lexicon:1,id:"tools.ozone.set.defs",defs:{set:{type:"object",required:["name"],properties:{name:{type:"string",minLength:3,maxLength:128},description:{type:"string",maxGraphemes:1024,maxLength:10240}}},setView:{type:"object",required:["name","setSize","createdAt","updatedAt"],properties:{name:{type:"string",minLength:3,maxLength:128},description:{type:"string",maxGraphemes:1024,maxLength:10240},setSize:{type:"integer"},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"}}}}},ToolsOzoneSetDeleteSet:{lexicon:1,id:"tools.ozone.set.deleteSet",defs:{main:{type:"procedure",description:"Delete an entire set. Attempting to delete a set that does not exist will result in an error.",input:{encoding:"application/json",schema:{type:"object",required:["name"],properties:{name:{type:"string",description:"Name of the set to delete"}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}},errors:[{name:"SetNotFound",description:"set with the given name does not exist"}]}}},ToolsOzoneSetDeleteValues:{lexicon:1,id:"tools.ozone.set.deleteValues",defs:{main:{type:"procedure",description:"Delete values from a specific set. Attempting to delete values that are not in the set will not result in an error",input:{encoding:"application/json",schema:{type:"object",required:["name","values"],properties:{name:{type:"string",description:"Name of the set to delete values from"},values:{type:"array",minLength:1,items:{type:"string"},description:"Array of string values to delete from the set"}}}},errors:[{name:"SetNotFound",description:"set with the given name does not exist"}]}}},ToolsOzoneSetGetValues:{lexicon:1,id:"tools.ozone.set.getValues",defs:{main:{type:"query",description:"Get a specific set and its values",parameters:{type:"params",required:["name"],properties:{name:{type:"string"},limit:{type:"integer",minimum:1,maximum:1e3,default:100},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["set","values"],properties:{set:{type:"ref",ref:"lex:tools.ozone.set.defs#setView"},values:{type:"array",items:{type:"string"}},cursor:{type:"string"}}}},errors:[{name:"SetNotFound",description:"set with the given name does not exist"}]}}},ToolsOzoneSetQuerySets:{lexicon:1,id:"tools.ozone.set.querySets",defs:{main:{type:"query",description:"Query available sets",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},namePrefix:{type:"string"},sortBy:{type:"string",enum:["name","createdAt","updatedAt"],default:"name"},sortDirection:{type:"string",default:"asc",enum:["asc","desc"],description:"Defaults to ascending order of name field."}}},output:{encoding:"application/json",schema:{type:"object",required:["sets"],properties:{sets:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.set.defs#setView"}},cursor:{type:"string"}}}}}}},ToolsOzoneSetUpsertSet:{lexicon:1,id:"tools.ozone.set.upsertSet",defs:{main:{type:"procedure",description:"Create or update set metadata",input:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.set.defs#set"}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.set.defs#setView"}}}}},ToolsOzoneSettingDefs:{lexicon:1,id:"tools.ozone.setting.defs",defs:{option:{type:"object",required:["key","value","did","scope","createdBy","lastUpdatedBy"],properties:{key:{type:"string",format:"nsid"},did:{type:"string",format:"did"},value:{type:"unknown"},description:{type:"string",maxGraphemes:1024,maxLength:10240},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"},managerRole:{type:"string",knownValues:["tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleTriage","tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleVerifier"]},scope:{type:"string",knownValues:["instance","personal"]},createdBy:{type:"string",format:"did"},lastUpdatedBy:{type:"string",format:"did"}}}}},ToolsOzoneSettingListOptions:{lexicon:1,id:"tools.ozone.setting.listOptions",defs:{main:{type:"query",description:"List settings with optional filtering",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},scope:{type:"string",knownValues:["instance","personal"],default:"instance"},prefix:{type:"string",description:"Filter keys by prefix"},keys:{type:"array",maxLength:100,items:{type:"string",format:"nsid"},description:"Filter for only the specified keys. Ignored if prefix is provided"}}},output:{encoding:"application/json",schema:{type:"object",required:["options"],properties:{cursor:{type:"string"},options:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.setting.defs#option"}}}}}}}},ToolsOzoneSettingRemoveOptions:{lexicon:1,id:"tools.ozone.setting.removeOptions",defs:{main:{type:"procedure",description:"Delete settings by key",input:{encoding:"application/json",schema:{type:"object",required:["keys","scope"],properties:{keys:{type:"array",minLength:1,maxLength:200,items:{type:"string",format:"nsid"}},scope:{type:"string",knownValues:["instance","personal"]}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},ToolsOzoneSettingUpsertOption:{lexicon:1,id:"tools.ozone.setting.upsertOption",defs:{main:{type:"procedure",description:"Create or update setting option",input:{encoding:"application/json",schema:{type:"object",required:["key","scope","value"],properties:{key:{type:"string",format:"nsid"},scope:{type:"string",knownValues:["instance","personal"]},value:{type:"unknown"},description:{type:"string",maxLength:2e3},managerRole:{type:"string",knownValues:["tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleTriage","tools.ozone.team.defs#roleVerifier","tools.ozone.team.defs#roleAdmin"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["option"],properties:{option:{type:"ref",ref:"lex:tools.ozone.setting.defs#option"}}}}}}},ToolsOzoneSignatureDefs:{lexicon:1,id:"tools.ozone.signature.defs",defs:{sigDetail:{type:"object",required:["property","value"],properties:{property:{type:"string"},value:{type:"string"}}}}},ToolsOzoneSignatureFindCorrelation:{lexicon:1,id:"tools.ozone.signature.findCorrelation",defs:{main:{type:"query",description:"Find all correlated threat signatures between 2 or more accounts.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["details"],properties:{details:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.signature.defs#sigDetail"}}}}}}}},ToolsOzoneSignatureFindRelatedAccounts:{lexicon:1,id:"tools.ozone.signature.findRelatedAccounts",defs:{main:{type:"query",description:"Get accounts that share some matching threat signatures with the root account.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["accounts"],properties:{cursor:{type:"string"},accounts:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.signature.findRelatedAccounts#relatedAccount"}}}}}},relatedAccount:{type:"object",required:["account"],properties:{account:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"},similarities:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.signature.defs#sigDetail"}}}}}},ToolsOzoneSignatureSearchAccounts:{lexicon:1,id:"tools.ozone.signature.searchAccounts",defs:{main:{type:"query",description:"Search for accounts that match one or more threat signature values.",parameters:{type:"params",required:["values"],properties:{values:{type:"array",items:{type:"string"}},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["accounts"],properties:{cursor:{type:"string"},accounts:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}}}}},ToolsOzoneTeamAddMember:{lexicon:1,id:"tools.ozone.team.addMember",defs:{main:{type:"procedure",description:"Add a member to the ozone team. Requires admin role.",input:{encoding:"application/json",schema:{type:"object",required:["did","role"],properties:{did:{type:"string",format:"did"},role:{type:"string",knownValues:["tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleVerifier","tools.ozone.team.defs#roleTriage"]}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.team.defs#member"}},errors:[{name:"MemberAlreadyExists",description:"Member already exists in the team."}]}}},ToolsOzoneTeamDefs:{lexicon:1,id:"tools.ozone.team.defs",defs:{member:{type:"object",required:["did","role"],properties:{did:{type:"string",format:"did"},disabled:{type:"boolean"},profile:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewDetailed"},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"},lastUpdatedBy:{type:"string"},role:{type:"string",knownValues:["lex:tools.ozone.team.defs#roleAdmin","lex:tools.ozone.team.defs#roleModerator","lex:tools.ozone.team.defs#roleTriage","lex:tools.ozone.team.defs#roleVerifier"]}}},roleAdmin:{type:"token",description:"Admin role. Highest level of access, can perform all actions."},roleModerator:{type:"token",description:"Moderator role. Can perform most actions."},roleTriage:{type:"token",description:"Triage role. Mostly intended for monitoring and escalating issues."},roleVerifier:{type:"token",description:"Verifier role. Only allowed to issue verifications."}}},ToolsOzoneTeamDeleteMember:{lexicon:1,id:"tools.ozone.team.deleteMember",defs:{main:{type:"procedure",description:"Delete a member from ozone team. Requires admin role.",input:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}},errors:[{name:"MemberNotFound",description:"The member being deleted does not exist"},{name:"CannotDeleteSelf",description:"You can not delete yourself from the team"}]}}},ToolsOzoneTeamListMembers:{lexicon:1,id:"tools.ozone.team.listMembers",defs:{main:{type:"query",description:"List all members with access to the ozone service.",parameters:{type:"params",properties:{q:{type:"string"},disabled:{type:"boolean"},roles:{type:"array",items:{type:"string"}},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["members"],properties:{cursor:{type:"string"},members:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.team.defs#member"}}}}}}}},ToolsOzoneTeamUpdateMember:{lexicon:1,id:"tools.ozone.team.updateMember",defs:{main:{type:"procedure",description:"Update a member in the ozone service. Requires admin role.",input:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"},disabled:{type:"boolean"},role:{type:"string",knownValues:["tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleVerifier","tools.ozone.team.defs#roleTriage"]}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.team.defs#member"}},errors:[{name:"MemberNotFound",description:"The member being updated does not exist in the team"}]}}},ToolsOzoneVerificationDefs:{lexicon:1,id:"tools.ozone.verification.defs",defs:{verificationView:{type:"object",description:"Verification data for the associated subject.",required:["issuer","uri","subject","handle","displayName","createdAt"],properties:{issuer:{type:"string",description:"The user who issued this verification.",format:"did"},uri:{type:"string",description:"The AT-URI of the verification record.",format:"at-uri"},subject:{type:"string",format:"did",description:"The subject of the verification."},handle:{type:"string",description:"Handle of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current handle matches the one at the time of verifying.",format:"handle"},displayName:{type:"string",description:"Display name of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current displayName matches the one at the time of verifying."},createdAt:{type:"string",description:"Timestamp when the verification was created.",format:"datetime"},revokeReason:{type:"string",description:"Describes the reason for revocation, also indicating that the verification is no longer valid."},revokedAt:{type:"string",description:"Timestamp when the verification was revoked.",format:"datetime"},revokedBy:{type:"string",description:"The user who revoked this verification.",format:"did"},subjectProfile:{type:"union",refs:[]},issuerProfile:{type:"union",refs:[]},subjectRepo:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoViewDetail","lex:tools.ozone.moderation.defs#repoViewNotFound"]},issuerRepo:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoViewDetail","lex:tools.ozone.moderation.defs#repoViewNotFound"]}}}}},ToolsOzoneVerificationGrantVerifications:{lexicon:1,id:"tools.ozone.verification.grantVerifications",defs:{main:{type:"procedure",description:"Grant verifications to multiple subjects. Allows batch processing of up to 100 verifications at once.",input:{encoding:"application/json",schema:{type:"object",required:["verifications"],properties:{verifications:{type:"array",description:"Array of verification requests to process",maxLength:100,items:{type:"ref",ref:"lex:tools.ozone.verification.grantVerifications#verificationInput"}}}}},output:{encoding:"application/json",schema:{type:"object",required:["verifications","failedVerifications"],properties:{verifications:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.verification.defs#verificationView"}},failedVerifications:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.verification.grantVerifications#grantError"}}}}}},verificationInput:{type:"object",required:["subject","handle","displayName"],properties:{subject:{type:"string",description:"The did of the subject being verified",format:"did"},handle:{type:"string",description:"Handle of the subject the verification applies to at the moment of verifying.",format:"handle"},displayName:{type:"string",description:"Display name of the subject the verification applies to at the moment of verifying."},createdAt:{type:"string",format:"datetime",description:"Timestamp for verification record. Defaults to current time when not specified."}}},grantError:{type:"object",description:"Error object for failed verifications.",required:["error","subject"],properties:{error:{type:"string",description:"Error message describing the reason for failure."},subject:{type:"string",description:"The did of the subject being verified",format:"did"}}}}},ToolsOzoneVerificationListVerifications:{lexicon:1,id:"tools.ozone.verification.listVerifications",defs:{main:{type:"query",description:"List verifications",parameters:{type:"params",properties:{cursor:{type:"string",description:"Pagination cursor"},limit:{type:"integer",description:"Maximum number of results to return",minimum:1,maximum:100,default:50},createdAfter:{type:"string",format:"datetime",description:"Filter to verifications created after this timestamp"},createdBefore:{type:"string",format:"datetime",description:"Filter to verifications created before this timestamp"},issuers:{type:"array",maxLength:100,description:"Filter to verifications from specific issuers",items:{type:"string",format:"did"}},subjects:{type:"array",description:"Filter to specific verified DIDs",maxLength:100,items:{type:"string",format:"did"}},sortDirection:{type:"string",description:"Sort direction for creation date",enum:["asc","desc"],default:"desc"},isRevoked:{type:"boolean",description:"Filter to verifications that are revoked or not. By default, includes both."}}},output:{encoding:"application/json",schema:{type:"object",required:["verifications"],properties:{cursor:{type:"string"},verifications:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.verification.defs#verificationView"}}}}}}}},ToolsOzoneVerificationRevokeVerifications:{lexicon:1,id:"tools.ozone.verification.revokeVerifications",defs:{main:{type:"procedure",description:"Revoke previously granted verifications in batches of up to 100.",input:{encoding:"application/json",schema:{type:"object",required:["uris"],properties:{uris:{type:"array",description:"Array of verification record uris to revoke",maxLength:100,items:{type:"string",description:"The AT-URI of the verification record to revoke.",format:"at-uri"}},revokeReason:{type:"string",description:"Reason for revoking the verification. This is optional and can be omitted if not needed.",maxLength:1e3}}}},output:{encoding:"application/json",schema:{type:"object",required:["revokedVerifications","failedRevocations"],properties:{revokedVerifications:{type:"array",description:"List of verification uris successfully revoked",items:{type:"string",format:"at-uri"}},failedRevocations:{type:"array",description:"List of verification uris that couldn't be revoked, including failure reasons",items:{type:"ref",ref:"lex:tools.ozone.verification.revokeVerifications#revokeError"}}}}}},revokeError:{type:"object",description:"Error object for failed revocations",required:["uri","error"],properties:{uri:{type:"string",description:"The AT-URI of the verification record that failed to revoke.",format:"at-uri"},error:{type:"string",description:"Description of the error that occurred during revocation."}}}}}},r.schemas=Object.values(r.schemaDict),r.lexicons=new i.Lexicons(r.schemas);function c(d,m,e,a){return(a?s.is$typed:s.maybe$typed)(d,m,e)?r.lexicons.validate(`${m}#${e}`,d):{success:!1,error:new i.ValidationError(`Must be an object with "${e==="main"?m:`${m}#${e}`}" $type property`)}}r.ids={AppBskyActorDefs:"app.bsky.actor.defs",AppBskyActorGetPreferences:"app.bsky.actor.getPreferences",AppBskyActorGetProfile:"app.bsky.actor.getProfile",AppBskyActorGetProfiles:"app.bsky.actor.getProfiles",AppBskyActorGetSuggestions:"app.bsky.actor.getSuggestions",AppBskyActorProfile:"app.bsky.actor.profile",AppBskyActorPutPreferences:"app.bsky.actor.putPreferences",AppBskyActorSearchActors:"app.bsky.actor.searchActors",AppBskyActorSearchActorsTypeahead:"app.bsky.actor.searchActorsTypeahead",AppBskyActorStatus:"app.bsky.actor.status",AppBskyBookmarkCreateBookmark:"app.bsky.bookmark.createBookmark",AppBskyBookmarkDefs:"app.bsky.bookmark.defs",AppBskyBookmarkDeleteBookmark:"app.bsky.bookmark.deleteBookmark",AppBskyBookmarkGetBookmarks:"app.bsky.bookmark.getBookmarks",AppBskyEmbedDefs:"app.bsky.embed.defs",AppBskyEmbedExternal:"app.bsky.embed.external",AppBskyEmbedImages:"app.bsky.embed.images",AppBskyEmbedRecord:"app.bsky.embed.record",AppBskyEmbedRecordWithMedia:"app.bsky.embed.recordWithMedia",AppBskyEmbedVideo:"app.bsky.embed.video",AppBskyFeedDefs:"app.bsky.feed.defs",AppBskyFeedDescribeFeedGenerator:"app.bsky.feed.describeFeedGenerator",AppBskyFeedGenerator:"app.bsky.feed.generator",AppBskyFeedGetActorFeeds:"app.bsky.feed.getActorFeeds",AppBskyFeedGetActorLikes:"app.bsky.feed.getActorLikes",AppBskyFeedGetAuthorFeed:"app.bsky.feed.getAuthorFeed",AppBskyFeedGetFeed:"app.bsky.feed.getFeed",AppBskyFeedGetFeedGenerator:"app.bsky.feed.getFeedGenerator",AppBskyFeedGetFeedGenerators:"app.bsky.feed.getFeedGenerators",AppBskyFeedGetFeedSkeleton:"app.bsky.feed.getFeedSkeleton",AppBskyFeedGetLikes:"app.bsky.feed.getLikes",AppBskyFeedGetListFeed:"app.bsky.feed.getListFeed",AppBskyFeedGetPostThread:"app.bsky.feed.getPostThread",AppBskyFeedGetPosts:"app.bsky.feed.getPosts",AppBskyFeedGetQuotes:"app.bsky.feed.getQuotes",AppBskyFeedGetRepostedBy:"app.bsky.feed.getRepostedBy",AppBskyFeedGetSuggestedFeeds:"app.bsky.feed.getSuggestedFeeds",AppBskyFeedGetTimeline:"app.bsky.feed.getTimeline",AppBskyFeedLike:"app.bsky.feed.like",AppBskyFeedPost:"app.bsky.feed.post",AppBskyFeedPostgate:"app.bsky.feed.postgate",AppBskyFeedRepost:"app.bsky.feed.repost",AppBskyFeedSearchPosts:"app.bsky.feed.searchPosts",AppBskyFeedSendInteractions:"app.bsky.feed.sendInteractions",AppBskyFeedThreadgate:"app.bsky.feed.threadgate",AppBskyGraphBlock:"app.bsky.graph.block",AppBskyGraphDefs:"app.bsky.graph.defs",AppBskyGraphFollow:"app.bsky.graph.follow",AppBskyGraphGetActorStarterPacks:"app.bsky.graph.getActorStarterPacks",AppBskyGraphGetBlocks:"app.bsky.graph.getBlocks",AppBskyGraphGetFollowers:"app.bsky.graph.getFollowers",AppBskyGraphGetFollows:"app.bsky.graph.getFollows",AppBskyGraphGetKnownFollowers:"app.bsky.graph.getKnownFollowers",AppBskyGraphGetList:"app.bsky.graph.getList",AppBskyGraphGetListBlocks:"app.bsky.graph.getListBlocks",AppBskyGraphGetListMutes:"app.bsky.graph.getListMutes",AppBskyGraphGetLists:"app.bsky.graph.getLists",AppBskyGraphGetListsWithMembership:"app.bsky.graph.getListsWithMembership",AppBskyGraphGetMutes:"app.bsky.graph.getMutes",AppBskyGraphGetRelationships:"app.bsky.graph.getRelationships",AppBskyGraphGetStarterPack:"app.bsky.graph.getStarterPack",AppBskyGraphGetStarterPacks:"app.bsky.graph.getStarterPacks",AppBskyGraphGetStarterPacksWithMembership:"app.bsky.graph.getStarterPacksWithMembership",AppBskyGraphGetSuggestedFollowsByActor:"app.bsky.graph.getSuggestedFollowsByActor",AppBskyGraphList:"app.bsky.graph.list",AppBskyGraphListblock:"app.bsky.graph.listblock",AppBskyGraphListitem:"app.bsky.graph.listitem",AppBskyGraphMuteActor:"app.bsky.graph.muteActor",AppBskyGraphMuteActorList:"app.bsky.graph.muteActorList",AppBskyGraphMuteThread:"app.bsky.graph.muteThread",AppBskyGraphSearchStarterPacks:"app.bsky.graph.searchStarterPacks",AppBskyGraphStarterpack:"app.bsky.graph.starterpack",AppBskyGraphUnmuteActor:"app.bsky.graph.unmuteActor",AppBskyGraphUnmuteActorList:"app.bsky.graph.unmuteActorList",AppBskyGraphUnmuteThread:"app.bsky.graph.unmuteThread",AppBskyGraphVerification:"app.bsky.graph.verification",AppBskyLabelerDefs:"app.bsky.labeler.defs",AppBskyLabelerGetServices:"app.bsky.labeler.getServices",AppBskyLabelerService:"app.bsky.labeler.service",AppBskyNotificationDeclaration:"app.bsky.notification.declaration",AppBskyNotificationDefs:"app.bsky.notification.defs",AppBskyNotificationGetPreferences:"app.bsky.notification.getPreferences",AppBskyNotificationGetUnreadCount:"app.bsky.notification.getUnreadCount",AppBskyNotificationListActivitySubscriptions:"app.bsky.notification.listActivitySubscriptions",AppBskyNotificationListNotifications:"app.bsky.notification.listNotifications",AppBskyNotificationPutActivitySubscription:"app.bsky.notification.putActivitySubscription",AppBskyNotificationPutPreferences:"app.bsky.notification.putPreferences",AppBskyNotificationPutPreferencesV2:"app.bsky.notification.putPreferencesV2",AppBskyNotificationRegisterPush:"app.bsky.notification.registerPush",AppBskyNotificationUnregisterPush:"app.bsky.notification.unregisterPush",AppBskyNotificationUpdateSeen:"app.bsky.notification.updateSeen",AppBskyRichtextFacet:"app.bsky.richtext.facet",AppBskyUnspeccedDefs:"app.bsky.unspecced.defs",AppBskyUnspeccedGetAgeAssuranceState:"app.bsky.unspecced.getAgeAssuranceState",AppBskyUnspeccedGetConfig:"app.bsky.unspecced.getConfig",AppBskyUnspeccedGetOnboardingSuggestedStarterPacks:"app.bsky.unspecced.getOnboardingSuggestedStarterPacks",AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton:"app.bsky.unspecced.getOnboardingSuggestedStarterPacksSkeleton",AppBskyUnspeccedGetPopularFeedGenerators:"app.bsky.unspecced.getPopularFeedGenerators",AppBskyUnspeccedGetPostThreadOtherV2:"app.bsky.unspecced.getPostThreadOtherV2",AppBskyUnspeccedGetPostThreadV2:"app.bsky.unspecced.getPostThreadV2",AppBskyUnspeccedGetSuggestedFeeds:"app.bsky.unspecced.getSuggestedFeeds",AppBskyUnspeccedGetSuggestedFeedsSkeleton:"app.bsky.unspecced.getSuggestedFeedsSkeleton",AppBskyUnspeccedGetSuggestedStarterPacks:"app.bsky.unspecced.getSuggestedStarterPacks",AppBskyUnspeccedGetSuggestedStarterPacksSkeleton:"app.bsky.unspecced.getSuggestedStarterPacksSkeleton",AppBskyUnspeccedGetSuggestedUsers:"app.bsky.unspecced.getSuggestedUsers",AppBskyUnspeccedGetSuggestedUsersSkeleton:"app.bsky.unspecced.getSuggestedUsersSkeleton",AppBskyUnspeccedGetSuggestionsSkeleton:"app.bsky.unspecced.getSuggestionsSkeleton",AppBskyUnspeccedGetTaggedSuggestions:"app.bsky.unspecced.getTaggedSuggestions",AppBskyUnspeccedGetTrendingTopics:"app.bsky.unspecced.getTrendingTopics",AppBskyUnspeccedGetTrends:"app.bsky.unspecced.getTrends",AppBskyUnspeccedGetTrendsSkeleton:"app.bsky.unspecced.getTrendsSkeleton",AppBskyUnspeccedInitAgeAssurance:"app.bsky.unspecced.initAgeAssurance",AppBskyUnspeccedSearchActorsSkeleton:"app.bsky.unspecced.searchActorsSkeleton",AppBskyUnspeccedSearchPostsSkeleton:"app.bsky.unspecced.searchPostsSkeleton",AppBskyUnspeccedSearchStarterPacksSkeleton:"app.bsky.unspecced.searchStarterPacksSkeleton",AppBskyVideoDefs:"app.bsky.video.defs",AppBskyVideoGetJobStatus:"app.bsky.video.getJobStatus",AppBskyVideoGetUploadLimits:"app.bsky.video.getUploadLimits",AppBskyVideoUploadVideo:"app.bsky.video.uploadVideo",ChatBskyActorDeclaration:"chat.bsky.actor.declaration",ChatBskyActorDefs:"chat.bsky.actor.defs",ChatBskyActorDeleteAccount:"chat.bsky.actor.deleteAccount",ChatBskyActorExportAccountData:"chat.bsky.actor.exportAccountData",ChatBskyConvoAcceptConvo:"chat.bsky.convo.acceptConvo",ChatBskyConvoAddReaction:"chat.bsky.convo.addReaction",ChatBskyConvoDefs:"chat.bsky.convo.defs",ChatBskyConvoDeleteMessageForSelf:"chat.bsky.convo.deleteMessageForSelf",ChatBskyConvoGetConvo:"chat.bsky.convo.getConvo",ChatBskyConvoGetConvoAvailability:"chat.bsky.convo.getConvoAvailability",ChatBskyConvoGetConvoForMembers:"chat.bsky.convo.getConvoForMembers",ChatBskyConvoGetLog:"chat.bsky.convo.getLog",ChatBskyConvoGetMessages:"chat.bsky.convo.getMessages",ChatBskyConvoLeaveConvo:"chat.bsky.convo.leaveConvo",ChatBskyConvoListConvos:"chat.bsky.convo.listConvos",ChatBskyConvoMuteConvo:"chat.bsky.convo.muteConvo",ChatBskyConvoRemoveReaction:"chat.bsky.convo.removeReaction",ChatBskyConvoSendMessage:"chat.bsky.convo.sendMessage",ChatBskyConvoSendMessageBatch:"chat.bsky.convo.sendMessageBatch",ChatBskyConvoUnmuteConvo:"chat.bsky.convo.unmuteConvo",ChatBskyConvoUpdateAllRead:"chat.bsky.convo.updateAllRead",ChatBskyConvoUpdateRead:"chat.bsky.convo.updateRead",ChatBskyModerationGetActorMetadata:"chat.bsky.moderation.getActorMetadata",ChatBskyModerationGetMessageContext:"chat.bsky.moderation.getMessageContext",ChatBskyModerationUpdateActorAccess:"chat.bsky.moderation.updateActorAccess",ComAtprotoAdminDefs:"com.atproto.admin.defs",ComAtprotoAdminDeleteAccount:"com.atproto.admin.deleteAccount",ComAtprotoAdminDisableAccountInvites:"com.atproto.admin.disableAccountInvites",ComAtprotoAdminDisableInviteCodes:"com.atproto.admin.disableInviteCodes",ComAtprotoAdminEnableAccountInvites:"com.atproto.admin.enableAccountInvites",ComAtprotoAdminGetAccountInfo:"com.atproto.admin.getAccountInfo",ComAtprotoAdminGetAccountInfos:"com.atproto.admin.getAccountInfos",ComAtprotoAdminGetInviteCodes:"com.atproto.admin.getInviteCodes",ComAtprotoAdminGetSubjectStatus:"com.atproto.admin.getSubjectStatus",ComAtprotoAdminSearchAccounts:"com.atproto.admin.searchAccounts",ComAtprotoAdminSendEmail:"com.atproto.admin.sendEmail",ComAtprotoAdminUpdateAccountEmail:"com.atproto.admin.updateAccountEmail",ComAtprotoAdminUpdateAccountHandle:"com.atproto.admin.updateAccountHandle",ComAtprotoAdminUpdateAccountPassword:"com.atproto.admin.updateAccountPassword",ComAtprotoAdminUpdateAccountSigningKey:"com.atproto.admin.updateAccountSigningKey",ComAtprotoAdminUpdateSubjectStatus:"com.atproto.admin.updateSubjectStatus",ComAtprotoIdentityDefs:"com.atproto.identity.defs",ComAtprotoIdentityGetRecommendedDidCredentials:"com.atproto.identity.getRecommendedDidCredentials",ComAtprotoIdentityRefreshIdentity:"com.atproto.identity.refreshIdentity",ComAtprotoIdentityRequestPlcOperationSignature:"com.atproto.identity.requestPlcOperationSignature",ComAtprotoIdentityResolveDid:"com.atproto.identity.resolveDid",ComAtprotoIdentityResolveHandle:"com.atproto.identity.resolveHandle",ComAtprotoIdentityResolveIdentity:"com.atproto.identity.resolveIdentity",ComAtprotoIdentitySignPlcOperation:"com.atproto.identity.signPlcOperation",ComAtprotoIdentitySubmitPlcOperation:"com.atproto.identity.submitPlcOperation",ComAtprotoIdentityUpdateHandle:"com.atproto.identity.updateHandle",ComAtprotoLabelDefs:"com.atproto.label.defs",ComAtprotoLabelQueryLabels:"com.atproto.label.queryLabels",ComAtprotoLabelSubscribeLabels:"com.atproto.label.subscribeLabels",ComAtprotoLexiconSchema:"com.atproto.lexicon.schema",ComAtprotoModerationCreateReport:"com.atproto.moderation.createReport",ComAtprotoModerationDefs:"com.atproto.moderation.defs",ComAtprotoRepoApplyWrites:"com.atproto.repo.applyWrites",ComAtprotoRepoCreateRecord:"com.atproto.repo.createRecord",ComAtprotoRepoDefs:"com.atproto.repo.defs",ComAtprotoRepoDeleteRecord:"com.atproto.repo.deleteRecord",ComAtprotoRepoDescribeRepo:"com.atproto.repo.describeRepo",ComAtprotoRepoGetRecord:"com.atproto.repo.getRecord",ComAtprotoRepoImportRepo:"com.atproto.repo.importRepo",ComAtprotoRepoListMissingBlobs:"com.atproto.repo.listMissingBlobs",ComAtprotoRepoListRecords:"com.atproto.repo.listRecords",ComAtprotoRepoPutRecord:"com.atproto.repo.putRecord",ComAtprotoRepoStrongRef:"com.atproto.repo.strongRef",ComAtprotoRepoUploadBlob:"com.atproto.repo.uploadBlob",ComAtprotoServerActivateAccount:"com.atproto.server.activateAccount",ComAtprotoServerCheckAccountStatus:"com.atproto.server.checkAccountStatus",ComAtprotoServerConfirmEmail:"com.atproto.server.confirmEmail",ComAtprotoServerCreateAccount:"com.atproto.server.createAccount",ComAtprotoServerCreateAppPassword:"com.atproto.server.createAppPassword",ComAtprotoServerCreateInviteCode:"com.atproto.server.createInviteCode",ComAtprotoServerCreateInviteCodes:"com.atproto.server.createInviteCodes",ComAtprotoServerCreateSession:"com.atproto.server.createSession",ComAtprotoServerDeactivateAccount:"com.atproto.server.deactivateAccount",ComAtprotoServerDefs:"com.atproto.server.defs",ComAtprotoServerDeleteAccount:"com.atproto.server.deleteAccount",ComAtprotoServerDeleteSession:"com.atproto.server.deleteSession",ComAtprotoServerDescribeServer:"com.atproto.server.describeServer",ComAtprotoServerGetAccountInviteCodes:"com.atproto.server.getAccountInviteCodes",ComAtprotoServerGetServiceAuth:"com.atproto.server.getServiceAuth",ComAtprotoServerGetSession:"com.atproto.server.getSession",ComAtprotoServerListAppPasswords:"com.atproto.server.listAppPasswords",ComAtprotoServerRefreshSession:"com.atproto.server.refreshSession",ComAtprotoServerRequestAccountDelete:"com.atproto.server.requestAccountDelete",ComAtprotoServerRequestEmailConfirmation:"com.atproto.server.requestEmailConfirmation",ComAtprotoServerRequestEmailUpdate:"com.atproto.server.requestEmailUpdate",ComAtprotoServerRequestPasswordReset:"com.atproto.server.requestPasswordReset",ComAtprotoServerReserveSigningKey:"com.atproto.server.reserveSigningKey",ComAtprotoServerResetPassword:"com.atproto.server.resetPassword",ComAtprotoServerRevokeAppPassword:"com.atproto.server.revokeAppPassword",ComAtprotoServerUpdateEmail:"com.atproto.server.updateEmail",ComAtprotoSyncDefs:"com.atproto.sync.defs",ComAtprotoSyncGetBlob:"com.atproto.sync.getBlob",ComAtprotoSyncGetBlocks:"com.atproto.sync.getBlocks",ComAtprotoSyncGetCheckout:"com.atproto.sync.getCheckout",ComAtprotoSyncGetHead:"com.atproto.sync.getHead",ComAtprotoSyncGetHostStatus:"com.atproto.sync.getHostStatus",ComAtprotoSyncGetLatestCommit:"com.atproto.sync.getLatestCommit",ComAtprotoSyncGetRecord:"com.atproto.sync.getRecord",ComAtprotoSyncGetRepo:"com.atproto.sync.getRepo",ComAtprotoSyncGetRepoStatus:"com.atproto.sync.getRepoStatus",ComAtprotoSyncListBlobs:"com.atproto.sync.listBlobs",ComAtprotoSyncListHosts:"com.atproto.sync.listHosts",ComAtprotoSyncListRepos:"com.atproto.sync.listRepos",ComAtprotoSyncListReposByCollection:"com.atproto.sync.listReposByCollection",ComAtprotoSyncNotifyOfUpdate:"com.atproto.sync.notifyOfUpdate",ComAtprotoSyncRequestCrawl:"com.atproto.sync.requestCrawl",ComAtprotoSyncSubscribeRepos:"com.atproto.sync.subscribeRepos",ComAtprotoTempAddReservedHandle:"com.atproto.temp.addReservedHandle",ComAtprotoTempCheckHandleAvailability:"com.atproto.temp.checkHandleAvailability",ComAtprotoTempCheckSignupQueue:"com.atproto.temp.checkSignupQueue",ComAtprotoTempDereferenceScope:"com.atproto.temp.dereferenceScope",ComAtprotoTempFetchLabels:"com.atproto.temp.fetchLabels",ComAtprotoTempRequestPhoneVerification:"com.atproto.temp.requestPhoneVerification",ComAtprotoTempRevokeAccountCredentials:"com.atproto.temp.revokeAccountCredentials",ToolsOzoneCommunicationCreateTemplate:"tools.ozone.communication.createTemplate",ToolsOzoneCommunicationDefs:"tools.ozone.communication.defs",ToolsOzoneCommunicationDeleteTemplate:"tools.ozone.communication.deleteTemplate",ToolsOzoneCommunicationListTemplates:"tools.ozone.communication.listTemplates",ToolsOzoneCommunicationUpdateTemplate:"tools.ozone.communication.updateTemplate",ToolsOzoneHostingGetAccountHistory:"tools.ozone.hosting.getAccountHistory",ToolsOzoneModerationCancelScheduledActions:"tools.ozone.moderation.cancelScheduledActions",ToolsOzoneModerationDefs:"tools.ozone.moderation.defs",ToolsOzoneModerationEmitEvent:"tools.ozone.moderation.emitEvent",ToolsOzoneModerationGetAccountTimeline:"tools.ozone.moderation.getAccountTimeline",ToolsOzoneModerationGetEvent:"tools.ozone.moderation.getEvent",ToolsOzoneModerationGetRecord:"tools.ozone.moderation.getRecord",ToolsOzoneModerationGetRecords:"tools.ozone.moderation.getRecords",ToolsOzoneModerationGetRepo:"tools.ozone.moderation.getRepo",ToolsOzoneModerationGetReporterStats:"tools.ozone.moderation.getReporterStats",ToolsOzoneModerationGetRepos:"tools.ozone.moderation.getRepos",ToolsOzoneModerationGetSubjects:"tools.ozone.moderation.getSubjects",ToolsOzoneModerationListScheduledActions:"tools.ozone.moderation.listScheduledActions",ToolsOzoneModerationQueryEvents:"tools.ozone.moderation.queryEvents",ToolsOzoneModerationQueryStatuses:"tools.ozone.moderation.queryStatuses",ToolsOzoneModerationScheduleAction:"tools.ozone.moderation.scheduleAction",ToolsOzoneModerationSearchRepos:"tools.ozone.moderation.searchRepos",ToolsOzoneReportDefs:"tools.ozone.report.defs",ToolsOzoneSafelinkAddRule:"tools.ozone.safelink.addRule",ToolsOzoneSafelinkDefs:"tools.ozone.safelink.defs",ToolsOzoneSafelinkQueryEvents:"tools.ozone.safelink.queryEvents",ToolsOzoneSafelinkQueryRules:"tools.ozone.safelink.queryRules",ToolsOzoneSafelinkRemoveRule:"tools.ozone.safelink.removeRule",ToolsOzoneSafelinkUpdateRule:"tools.ozone.safelink.updateRule",ToolsOzoneServerGetConfig:"tools.ozone.server.getConfig",ToolsOzoneSetAddValues:"tools.ozone.set.addValues",ToolsOzoneSetDefs:"tools.ozone.set.defs",ToolsOzoneSetDeleteSet:"tools.ozone.set.deleteSet",ToolsOzoneSetDeleteValues:"tools.ozone.set.deleteValues",ToolsOzoneSetGetValues:"tools.ozone.set.getValues",ToolsOzoneSetQuerySets:"tools.ozone.set.querySets",ToolsOzoneSetUpsertSet:"tools.ozone.set.upsertSet",ToolsOzoneSettingDefs:"tools.ozone.setting.defs",ToolsOzoneSettingListOptions:"tools.ozone.setting.listOptions",ToolsOzoneSettingRemoveOptions:"tools.ozone.setting.removeOptions",ToolsOzoneSettingUpsertOption:"tools.ozone.setting.upsertOption",ToolsOzoneSignatureDefs:"tools.ozone.signature.defs",ToolsOzoneSignatureFindCorrelation:"tools.ozone.signature.findCorrelation",ToolsOzoneSignatureFindRelatedAccounts:"tools.ozone.signature.findRelatedAccounts",ToolsOzoneSignatureSearchAccounts:"tools.ozone.signature.searchAccounts",ToolsOzoneTeamAddMember:"tools.ozone.team.addMember",ToolsOzoneTeamDefs:"tools.ozone.team.defs",ToolsOzoneTeamDeleteMember:"tools.ozone.team.deleteMember",ToolsOzoneTeamListMembers:"tools.ozone.team.listMembers",ToolsOzoneTeamUpdateMember:"tools.ozone.team.updateMember",ToolsOzoneVerificationDefs:"tools.ozone.verification.defs",ToolsOzoneVerificationGrantVerifications:"tools.ozone.verification.grantVerifications",ToolsOzoneVerificationListVerifications:"tools.ozone.verification.listVerifications",ToolsOzoneVerificationRevokeVerifications:"tools.ozone.verification.revokeVerifications"}})(n1)),n1}var ca={},CS;function bM(){if(CS)return ca;CS=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.isAtprotoServiceType=r,ca.isDid=i,ca.assertDid=s,ca.asDid=c,ca.isAtprotoProxy=d,ca.assertAtprotoProxy=m,ca.asAtprotoProxy=e;function r(a){return!a.includes(" ")&&!a.includes("#")}function i(a){if(!a.startsWith("did:")||a.length<8||a.length>2048)return!1;const g=a.indexOf(":",4);return g>4&&g<a.length-1}function s(a){if(!i(a))throw new TypeError(`Invalid DID: ${a}`)}function c(a){return s(a),a}function d(a){const{length:g,[0]:w,[1]:R}=a.split("#");return g===2&&i(w)&&r(R)}function m(a){if(!d(a))throw new TypeError(`Invalid DID reference: ${a} (must be of the form did:example:alice#service)`)}function e(a){return m(a),a}return ca}var Kh={},kS;function vM(){return kS||(kS=1,Object.defineProperty(Kh,"__esModule",{value:!0}),Kh.BSKY_LABELER_DID=void 0,Kh.BSKY_LABELER_DID="did:plc:ar7c4by46qjdydhdevvrndac"),Kh}var s1={},PS;function xM(){return PS||(PS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.nuxSchema=void 0,r.sanitizeMutedWordValue=c,r.savedFeedsToUriArrays=d,r.getSavedFeedType=m,r.validateSavedFeed=e,r.validateNux=a;const i=Fc(),s=Rf();function c(g){return g.trim().replace(/^#(?!\ufe0f)/,"").replace(/[\r\n\u00AD\u2060\u200D\u200C\u200B]+/,"")}function d(g){const w=[],R=[];for(const S of g)S.pinned&&w.push(S.value),R.push(S.value);return{pinned:w,saved:R}}function m(g){switch(new s.AtUri(g).collection){case"app.bsky.feed.generator":return"feed";case"app.bsky.graph.list":return"list";default:return"unknown"}}function e(g){if(!g.id)throw new Error("Saved feed must have an `id` - use a TID");if(["feed","list"].includes(g.type)){const w=new s.AtUri(g.value),R=w.collection==="app.bsky.feed.generator",S=w.collection==="app.bsky.graph.list";if(g.type==="feed"&&!R)throw new Error(`Saved feed of type 'feed' must be a feed, got ${w.collection}`);if(g.type==="list"&&!S)throw new Error(`Saved feed of type 'list' must be a list, got ${w.collection}`)}}r.nuxSchema=i.z.object({id:i.z.string().max(64),completed:i.z.boolean(),data:i.z.string().max(300).optional(),expiresAt:i.z.string().datetime().optional()}).strict();function a(g){r.nuxSchema.parse(g)}})(s1)),s1}var O={},lc={},uc={},Cs={},o1={},LS;function zw(){return LS||(LS=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.XRPCInvalidResponseError=r.XRPCError=r.XRPCResponse=r.ResponseTypeStrings=r.ResponseType=r.errorResponseBody=void 0,r.httpResponseCodeToEnum=c,r.httpResponseCodeToName=d,r.httpResponseCodeToString=m;const i=Fc();r.errorResponseBody=i.z.object({error:i.z.string().optional(),message:i.z.string().optional()});var s;(function(w){w[w.Unknown=1]="Unknown",w[w.InvalidResponse=2]="InvalidResponse",w[w.Success=200]="Success",w[w.InvalidRequest=400]="InvalidRequest",w[w.AuthenticationRequired=401]="AuthenticationRequired",w[w.Forbidden=403]="Forbidden",w[w.XRPCNotSupported=404]="XRPCNotSupported",w[w.NotAcceptable=406]="NotAcceptable",w[w.PayloadTooLarge=413]="PayloadTooLarge",w[w.UnsupportedMediaType=415]="UnsupportedMediaType",w[w.RateLimitExceeded=429]="RateLimitExceeded",w[w.InternalServerError=500]="InternalServerError",w[w.MethodNotImplemented=501]="MethodNotImplemented",w[w.UpstreamFailure=502]="UpstreamFailure",w[w.NotEnoughResources=503]="NotEnoughResources",w[w.UpstreamTimeout=504]="UpstreamTimeout"})(s||(r.ResponseType=s={}));function c(w){return w in s?w:w>=100&&w<200?s.XRPCNotSupported:w>=200&&w<300?s.Success:w>=300&&w<400?s.XRPCNotSupported:w>=400&&w<500?s.InvalidRequest:s.InternalServerError}function d(w){return s[c(w)]}r.ResponseTypeStrings={[s.Unknown]:"Unknown",[s.InvalidResponse]:"Invalid Response",[s.Success]:"Success",[s.InvalidRequest]:"Invalid Request",[s.AuthenticationRequired]:"Authentication Required",[s.Forbidden]:"Forbidden",[s.XRPCNotSupported]:"XRPC Not Supported",[s.NotAcceptable]:"Not Acceptable",[s.PayloadTooLarge]:"Payload Too Large",[s.UnsupportedMediaType]:"Unsupported Media Type",[s.RateLimitExceeded]:"Rate Limit Exceeded",[s.InternalServerError]:"Internal Server Error",[s.MethodNotImplemented]:"Method Not Implemented",[s.UpstreamFailure]:"Upstream Failure",[s.NotEnoughResources]:"Not Enough Resources",[s.UpstreamTimeout]:"Upstream Timeout"};function m(w){return r.ResponseTypeStrings[c(w)]}class e{constructor(R,S){Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:R}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:S}),Object.defineProperty(this,"success",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}r.XRPCResponse=e;class a extends Error{constructor(R,S=d(R),D,k,B){super(D||S||m(R),B),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:S}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:k}),Object.defineProperty(this,"success",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.status=c(R);const F=B?.cause;this.cause===void 0&&F!==void 0&&(this.cause=F)}static from(R,S){if(R instanceof a)return R;const D=R instanceof Error?R:void 0,k=R instanceof Response?R:R?.response instanceof Response?R.response:void 0,B=D?.statusCode??D?.status??k?.status,F=typeof B=="number"?c(B):S??s.Unknown,K=D?.message??String(R),U=k?Object.fromEntries(k.headers.entries()):void 0;return new a(F,void 0,K,U,{cause:R})}}r.XRPCError=a;class g extends a{constructor(R,S,D){super(s.InvalidResponse,r.ResponseTypeStrings[s.InvalidResponse],"The server gave an invalid response and may be out of date.",void 0,{cause:S}),Object.defineProperty(this,"lexiconNsid",{enumerable:!0,configurable:!0,writable:!0,value:R}),Object.defineProperty(this,"validationError",{enumerable:!0,configurable:!0,writable:!0,value:S}),Object.defineProperty(this,"responseBody",{enumerable:!0,configurable:!0,writable:!0,value:D})}}r.XRPCInvalidResponseError=g})(o1)),o1}var DS;function h0(){if(DS)return Cs;DS=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.isErrorResponseBody=c,Cs.getMethodSchemaHTTPMethod=d,Cs.constructMethodCallUri=m,Cs.constructMethodCallUrl=e,Cs.encodeQueryParam=a,Cs.constructMethodCallHeaders=g,Cs.combineHeaders=w,Cs.isBodyInit=S,Cs.isIterable=D,Cs.encodeMethodCallBody=k,Cs.httpResponseBodyParse=F;const r=yf(),i=zw(),s=globalThis.ReadableStream||class{constructor(){throw new Error("ReadableStream is not supported in this environment")}};function c(K){return i.errorResponseBody.safeParse(K).success}function d(K){return K.type==="procedure"?"post":"get"}function m(K,U,ee,le){return new URL(e(K,U,le),ee).toString()}function e(K,U,ee){const le=`/xrpc/${encodeURIComponent(K)}`;if(!ee)return le;const Q=[];for(const[Te,pe]of Object.entries(ee)){const _e=U.parameters?.properties?.[Te];if(!_e)throw new Error(`Invalid query parameter: ${Te}`);if(pe!==void 0)if(_e.type==="array"){const Xe=Array.isArray(pe)?pe:[pe];for(const dt of Xe)Q.push([Te,a(_e.items.type,dt)])}else Q.push([Te,a(_e.type,pe)])}return Q.length?`${le}?${new URLSearchParams(Q).toString()}`:le}function a(K,U){if(K==="string"||K==="unknown")return String(U);if(K==="float")return String(Number(U));if(K==="integer")return String(Number(U)|0);if(K==="boolean")return U?"true":"false";if(K==="datetime")return U instanceof Date?U.toISOString():String(U);throw new Error(`Unsupported query param type: ${K}`)}function g(K,U,ee){const le=new Headers;if(ee?.headers)for(const Q in ee.headers){if(le.has(Q))throw new TypeError(`Duplicate header: ${Q}`);const Te=ee.headers[Q];Te!=null&&le.set(Q,Te)}if(K.type==="procedure"){if(ee?.encoding)le.set("content-type",ee.encoding);else if(!le.has("content-type")&&typeof U<"u")if(U instanceof ArrayBuffer||U instanceof s||ArrayBuffer.isView(U))le.set("content-type","application/octet-stream");else if(U instanceof FormData)le.set("content-type","multipart/form-data");else if(U instanceof URLSearchParams)le.set("content-type","application/x-www-form-urlencoded;charset=UTF-8");else if(R(U))le.set("content-type",U.type||"application/octet-stream");else if(typeof U=="string")le.set("content-type","text/plain;charset=UTF-8");else if(D(U))le.set("content-type","application/octet-stream");else if(typeof U=="boolean"||typeof U=="number"||typeof U=="string"||typeof U=="object")le.set("content-type","application/json");else throw new i.XRPCError(i.ResponseType.InvalidRequest,`Unsupported data type: ${typeof U}`)}return le}function w(K,U){if(!U)return K;let ee;for(const[le,Q]of U){if(Q===void 0||(ee??(ee=new Headers(K)),ee.has(le)))continue;const Te=typeof Q=="function"?Q():Q;if(typeof Te=="string")ee.set(le,Te);else if(Te===null)ee.delete(le);else throw new TypeError(`Invalid "${le}" header value: ${typeof Te}`)}return ee??K}function R(K){if(K==null||typeof K!="object")return!1;if(typeof Blob=="function"&&K instanceof Blob)return!0;const U=K[Symbol.toStringTag];return U==="Blob"||U==="File"?"stream"in K&&typeof K.stream=="function":!1}function S(K){switch(typeof K){case"string":return!0;case"object":return K instanceof ArrayBuffer||K instanceof FormData||K instanceof URLSearchParams||K instanceof s||ArrayBuffer.isView(K)||R(K);default:return!1}}function D(K){return K!=null&&typeof K=="object"&&(Symbol.iterator in K||Symbol.asyncIterator in K)}function k(K,U){const ee=K.get("content-type");if(!ee)return;if(typeof U>"u")throw new i.XRPCError(i.ResponseType.InvalidRequest,"A request body is expected but none was provided");if(S(U))return U instanceof FormData&&ee==="multipart/form-data"&&K.delete("content-type"),U;if(D(U))return B(U);if(ee.startsWith("text/"))return new TextEncoder().encode(String(U));if(ee.startsWith("application/json")){const Q=(0,r.stringifyLex)(U);if(Q===void 0)throw new i.XRPCError(i.ResponseType.InvalidRequest,"Failed to encode request body as JSON");return new TextEncoder().encode(Q)}const le=!U||typeof U!="object"?typeof U:U.constructor!==Object&&typeof U.constructor=="function"&&typeof U.constructor?.name=="string"?U.constructor.name:"object";throw new i.XRPCError(i.ResponseType.InvalidRequest,`Unable to encode ${le} as ${ee} data`)}function B(K){if("from"in s&&typeof s.from=="function")return s.from(K);throw new TypeError("ReadableStream.from() is not supported in this environment. It is required to support using iterables as the request body. Consider using a polyfill or re-write your code to use a different body type.")}function F(K,U){try{if(K){if(K.includes("application/json")){const ee=new TextDecoder().decode(U);return(0,r.jsonStringToLex)(ee)}if(K.startsWith("text/"))return new TextDecoder().decode(U)}return U instanceof ArrayBuffer?new Uint8Array(U):U}catch(ee){throw new i.XRPCError(i.ResponseType.InvalidResponse,void 0,`Failed to parse response body: ${String(ee)}`,void 0,{cause:ee})}}return Cs}var Gh={},Rg={},IS;function wM(){if(IS)return Rg;IS=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.buildFetchHandler=i;const r=h0();function i(s){if(typeof s=="function")return s;if(typeof s=="object"&&"fetchHandler"in s)return s.fetchHandler.bind(s);const{service:c,headers:d=void 0,fetch:m=globalThis.fetch}=typeof s=="string"||s instanceof URL?{service:s}:s;if(typeof m!="function")throw new TypeError("XrpcDispatcher requires fetch() to be available in your environment.");const e=d!=null?Object.entries(d):void 0;return async function(a,g){const w=typeof c=="function"?c():c,R=new URL(a,w),S=(0,r.combineHeaders)(g.headers,e);return m(R,{...g,headers:S})}}return Rg}var BS;function EM(){if(BS)return Gh;BS=1,Object.defineProperty(Gh,"__esModule",{value:!0}),Gh.XrpcClient=void 0;const r=yf(),i=wM(),s=zw(),c=h0();class d{constructor(e,a){Object.defineProperty(this,"fetchHandler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"lex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.fetchHandler=(0,i.buildFetchHandler)(e),this.lex=a instanceof r.Lexicons?a:new r.Lexicons(a)}setHeader(e,a){this.headers.set(e.toLowerCase(),a)}unsetHeader(e){this.headers.delete(e.toLowerCase())}clearHeaders(){this.headers.clear()}async call(e,a,g,w){const R=this.lex.getDefOrThrow(e);if(!R||R.type!=="query"&&R.type!=="procedure")throw new TypeError(`Invalid lexicon: ${e}. Must be a query or procedure.`);const S=(0,c.constructMethodCallUrl)(e,R,a),D=(0,c.getMethodSchemaHTTPMethod)(R),k=(0,c.constructMethodCallHeaders)(R,g,w),B=(0,c.encodeMethodCallBody)(k,g),F={method:D,headers:(0,c.combineHeaders)(k,this.headers),body:B,duplex:"half",redirect:"follow",signal:w?.signal};try{const K=await this.fetchHandler.call(void 0,S,F),U=K.status,ee=Object.fromEntries(K.headers.entries()),le=await K.arrayBuffer(),Q=(0,c.httpResponseBodyParse)(K.headers.get("content-type"),le),Te=(0,s.httpResponseCodeToEnum)(U);if(Te!==s.ResponseType.Success){const{error:pe=void 0,message:_e=void 0}=Q&&(0,c.isErrorResponseBody)(Q)?Q:{};throw new s.XRPCError(Te,pe,_e,ee)}try{this.lex.assertValidXrpcOutput(e,Q)}catch(pe){throw pe instanceof r.ValidationError?new s.XRPCInvalidResponseError(e,pe,Q):pe}return new s.XRPCResponse(Q,ee)}catch(K){throw s.XRPCError.from(K)}}}return Gh.XrpcClient=d,Gh}var MS;function zS(){if(MS)return uc;MS=1,Object.defineProperty(uc,"__esModule",{value:!0}),uc.ServiceClient=uc.Client=void 0;const r=yf(),i=h0(),s=EM();class c{constructor(){Object.defineProperty(this,"lex",{enumerable:!0,configurable:!0,writable:!0,value:new r.Lexicons})}get fetch(){throw new Error("Client.fetch is no longer supported. Use an XrpcClient instead.")}set fetch(e){throw new Error("Client.fetch is no longer supported. Use an XrpcClient instead.")}async call(e,a,g,w,R){return this.service(e).call(a,g,w,R)}service(e){return new d(this,e)}addLexicon(e){this.lex.add(e)}addLexicons(e){for(const a of e)this.addLexicon(a)}removeLexicon(e){this.lex.remove(e)}}uc.Client=c;class d extends s.XrpcClient{constructor(e,a){super(async(g,w)=>{const R=(0,i.combineHeaders)(w.headers,Object.entries(this.headers));return fetch(new URL(g,this.uri),{...w,headers:R})},e.lex),Object.defineProperty(this,"baseClient",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"uri",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.uri=typeof a=="string"?new URL(a):a}}return uc.ServiceClient=d,uc}var OS;function Wt(){return OS||(OS=1,(function(r){var i=lc&&lc.__createBinding||(Object.create?(function(m,e,a,g){g===void 0&&(g=a);var w=Object.getOwnPropertyDescriptor(e,a);(!w||("get"in w?!e.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(m,g,w)}):(function(m,e,a,g){g===void 0&&(g=a),m[g]=e[a]})),s=lc&&lc.__exportStar||function(m,e){for(var a in m)a!=="default"&&!Object.prototype.hasOwnProperty.call(e,a)&&i(e,m,a)};Object.defineProperty(r,"__esModule",{value:!0}),s(zS(),r),s(wM(),r),s(zw(),r),s(h0(),r),s(EM(),r);const c=zS(),d=new c.Client;r.default=d})(lc)),lc}var ip={},VS;function US(){if(VS)return ip;VS=1,Object.defineProperty(ip,"__esModule",{value:!0}),ip.UnsupportedCollectionError=void 0,ip.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}ip.UnsupportedCollectionError=c;function d(m){return m instanceof r.XRPCError&&m.error==="UnsupportedCollection"?new c(m):m}return ip}var np={},jS;function NS(){if(jS)return np;jS=1,Object.defineProperty(np,"__esModule",{value:!0}),np.UnsupportedCollectionError=void 0,np.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}np.UnsupportedCollectionError=c;function d(m){return m instanceof r.XRPCError&&m.error==="UnsupportedCollection"?new c(m):m}return np}var ql={},FS;function qS(){if(FS)return ql;FS=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.BlockedByActorError=ql.BlockedActorError=void 0,ql.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}ql.BlockedActorError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}ql.BlockedByActorError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="BlockedActor")return new c(e);if(e.error==="BlockedByActor")return new d(e)}return e}return ql}var Kl={},KS;function GS(){if(KS)return Kl;KS=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.BlockedByActorError=Kl.BlockedActorError=void 0,Kl.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Kl.BlockedActorError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Kl.BlockedByActorError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="BlockedActor")return new c(e);if(e.error==="BlockedByActor")return new d(e)}return e}return Kl}var sp={},$S;function ZS(){if($S)return sp;$S=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.UnknownFeedError=void 0,sp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}sp.UnknownFeedError=c;function d(m){return m instanceof r.XRPCError&&m.error==="UnknownFeed"?new c(m):m}return sp}var op={},HS;function XS(){if(HS)return op;HS=1,Object.defineProperty(op,"__esModule",{value:!0}),op.UnknownFeedError=void 0,op.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}op.UnknownFeedError=c;function d(m){return m instanceof r.XRPCError&&m.error==="UnknownFeed"?new c(m):m}return op}var ap={},WS;function YS(){if(WS)return ap;WS=1,Object.defineProperty(ap,"__esModule",{value:!0}),ap.UnknownListError=void 0,ap.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}ap.UnknownListError=c;function d(m){return m instanceof r.XRPCError&&m.error==="UnknownList"?new c(m):m}return ap}var lp={},JS;function QS(){if(JS)return lp;JS=1,Object.defineProperty(lp,"__esModule",{value:!0}),lp.NotFoundError=void 0,lp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}lp.NotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="NotFound"?new c(m):m}return lp}var up={},eT;function tT(){if(eT)return up;eT=1,Object.defineProperty(up,"__esModule",{value:!0}),up.BadQueryStringError=void 0,up.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}up.BadQueryStringError=c;function d(m){return m instanceof r.XRPCError&&m.error==="BadQueryString"?new c(m):m}return up}var cp={},rT;function iT(){if(rT)return cp;rT=1,Object.defineProperty(cp,"__esModule",{value:!0}),cp.ActorNotFoundError=void 0,cp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}cp.ActorNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="ActorNotFound"?new c(m):m}return cp}var da={},nT;function sT(){if(nT)return da;nT=1,Object.defineProperty(da,"__esModule",{value:!0}),da.InvalidInitiationError=da.DidTooLongError=da.InvalidEmailError=void 0,da.toKnownErr=e;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}da.InvalidEmailError=c;class d extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}da.DidTooLongError=d;class m extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}da.InvalidInitiationError=m;function e(a){if(a instanceof r.XRPCError){if(a.error==="InvalidEmail")return new c(a);if(a.error==="DidTooLong")return new d(a);if(a.error==="InvalidInitiation")return new m(a)}return a}return da}var dp={},oT;function aT(){if(oT)return dp;oT=1,Object.defineProperty(dp,"__esModule",{value:!0}),dp.BadQueryStringError=void 0,dp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}dp.BadQueryStringError=c;function d(m){return m instanceof r.XRPCError&&m.error==="BadQueryString"?new c(m):m}return dp}var pp={},lT;function uT(){if(lT)return pp;lT=1,Object.defineProperty(pp,"__esModule",{value:!0}),pp.BadQueryStringError=void 0,pp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}pp.BadQueryStringError=c;function d(m){return m instanceof r.XRPCError&&m.error==="BadQueryString"?new c(m):m}return pp}var fp={},cT;function dT(){if(cT)return fp;cT=1,Object.defineProperty(fp,"__esModule",{value:!0}),fp.BadQueryStringError=void 0,fp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}fp.BadQueryStringError=c;function d(m){return m instanceof r.XRPCError&&m.error==="BadQueryString"?new c(m):m}return fp}var pa={},pT;function fT(){if(pT)return pa;pT=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.ReactionInvalidValueError=pa.ReactionLimitReachedError=pa.ReactionMessageDeletedError=void 0,pa.toKnownErr=e;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}pa.ReactionMessageDeletedError=c;class d extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}pa.ReactionLimitReachedError=d;class m extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}pa.ReactionInvalidValueError=m;function e(a){if(a instanceof r.XRPCError){if(a.error==="ReactionMessageDeleted")return new c(a);if(a.error==="ReactionLimitReached")return new d(a);if(a.error==="ReactionInvalidValue")return new m(a)}return a}return pa}var Gl={},hT;function mT(){if(hT)return Gl;hT=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.ReactionInvalidValueError=Gl.ReactionMessageDeletedError=void 0,Gl.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Gl.ReactionMessageDeletedError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Gl.ReactionInvalidValueError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="ReactionMessageDeleted")return new c(e);if(e.error==="ReactionInvalidValue")return new d(e)}return e}return Gl}var fa={},yT;function gT(){if(yT)return fa;yT=1,Object.defineProperty(fa,"__esModule",{value:!0}),fa.DidDeactivatedError=fa.DidNotFoundError=fa.HandleNotFoundError=void 0,fa.toKnownErr=e;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}fa.HandleNotFoundError=c;class d extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}fa.DidNotFoundError=d;class m extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}fa.DidDeactivatedError=m;function e(a){if(a instanceof r.XRPCError){if(a.error==="HandleNotFound")return new c(a);if(a.error==="DidNotFound")return new d(a);if(a.error==="DidDeactivated")return new m(a)}return a}return fa}var $l={},_T;function bT(){if(_T)return $l;_T=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.DidDeactivatedError=$l.DidNotFoundError=void 0,$l.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}$l.DidNotFoundError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}$l.DidDeactivatedError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="DidNotFound")return new c(e);if(e.error==="DidDeactivated")return new d(e)}return e}return $l}var hp={},vT;function xT(){if(vT)return hp;vT=1,Object.defineProperty(hp,"__esModule",{value:!0}),hp.HandleNotFoundError=void 0,hp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}hp.HandleNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="HandleNotFound"?new c(m):m}return hp}var ha={},wT;function ET(){if(wT)return ha;wT=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.DidDeactivatedError=ha.DidNotFoundError=ha.HandleNotFoundError=void 0,ha.toKnownErr=e;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}ha.HandleNotFoundError=c;class d extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}ha.DidNotFoundError=d;class m extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}ha.DidDeactivatedError=m;function e(a){if(a instanceof r.XRPCError){if(a.error==="HandleNotFound")return new c(a);if(a.error==="DidNotFound")return new d(a);if(a.error==="DidDeactivated")return new m(a)}return a}return ha}var Ln={},AT;function RT(){if(AT)return Ln;AT=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.InvalidSwapError=void 0,Ln.toKnownErr=a,Ln.isCreate=w,Ln.validateCreate=R,Ln.isUpdate=D,Ln.validateUpdate=k,Ln.isDelete=F,Ln.validateDelete=K,Ln.isCreateResult=ee,Ln.validateCreateResult=le,Ln.isUpdateResult=Te,Ln.validateUpdateResult=pe,Ln.isDeleteResult=Xe,Ln.validateDeleteResult=dt;const r=Wt(),i=he(),c=me().is$typed,d=i.validate,m="com.atproto.repo.applyWrites";class e extends r.XRPCError{constructor(et){super(et.status,et.error,et.message,et.headers,{cause:et})}}Ln.InvalidSwapError=e;function a(He){return He instanceof r.XRPCError&&He.error==="InvalidSwap"?new e(He):He}const g="create";function w(He){return c(He,m,g)}function R(He){return d(He,m,g)}const S="update";function D(He){return c(He,m,S)}function k(He){return d(He,m,S)}const B="delete";function F(He){return c(He,m,B)}function K(He){return d(He,m,B)}const U="createResult";function ee(He){return c(He,m,U)}function le(He){return d(He,m,U)}const Q="updateResult";function Te(He){return c(He,m,Q)}function pe(He){return d(He,m,Q)}const _e="deleteResult";function Xe(He){return c(He,m,_e)}function dt(He){return d(He,m,_e)}return Ln}var mp={},ST;function TT(){if(ST)return mp;ST=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.InvalidSwapError=void 0,mp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}mp.InvalidSwapError=c;function d(m){return m instanceof r.XRPCError&&m.error==="InvalidSwap"?new c(m):m}return mp}var yp={},CT;function kT(){if(CT)return yp;CT=1,Object.defineProperty(yp,"__esModule",{value:!0}),yp.InvalidSwapError=void 0,yp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}yp.InvalidSwapError=c;function d(m){return m instanceof r.XRPCError&&m.error==="InvalidSwap"?new c(m):m}return yp}var gp={},PT;function LT(){if(PT)return gp;PT=1,Object.defineProperty(gp,"__esModule",{value:!0}),gp.RecordNotFoundError=void 0,gp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}gp.RecordNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="RecordNotFound"?new c(m):m}return gp}var _p={},DT;function IT(){if(DT)return _p;DT=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.InvalidSwapError=void 0,_p.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}_p.InvalidSwapError=c;function d(m){return m instanceof r.XRPCError&&m.error==="InvalidSwap"?new c(m):m}return _p}var fo={},BT;function MT(){if(BT)return fo;BT=1,Object.defineProperty(fo,"__esModule",{value:!0}),fo.InvalidEmailError=fo.InvalidTokenError=fo.ExpiredTokenError=fo.AccountNotFoundError=void 0,fo.toKnownErr=a;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}fo.AccountNotFoundError=c;class d extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}fo.ExpiredTokenError=d;class m extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}fo.InvalidTokenError=m;class e extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}fo.InvalidEmailError=e;function a(g){if(g instanceof r.XRPCError){if(g.error==="AccountNotFound")return new c(g);if(g.error==="ExpiredToken")return new d(g);if(g.error==="InvalidToken")return new m(g);if(g.error==="InvalidEmail")return new e(g)}return g}return fo}var Dn={},zT;function OT(){if(zT)return Dn;zT=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.IncompatibleDidDocError=Dn.UnresolvableDidError=Dn.UnsupportedDomainError=Dn.HandleNotAvailableError=Dn.InvalidInviteCodeError=Dn.InvalidPasswordError=Dn.InvalidHandleError=void 0,Dn.toKnownErr=R;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.InvalidHandleError=c;class d extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.InvalidPasswordError=d;class m extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.InvalidInviteCodeError=m;class e extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.HandleNotAvailableError=e;class a extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.UnsupportedDomainError=a;class g extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.UnresolvableDidError=g;class w extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Dn.IncompatibleDidDocError=w;function R(S){if(S instanceof r.XRPCError){if(S.error==="InvalidHandle")return new c(S);if(S.error==="InvalidPassword")return new d(S);if(S.error==="InvalidInviteCode")return new m(S);if(S.error==="HandleNotAvailable")return new e(S);if(S.error==="UnsupportedDomain")return new a(S);if(S.error==="UnresolvableDid")return new g(S);if(S.error==="IncompatibleDidDoc")return new w(S)}return S}return Dn}var Zl={},VT;function UT(){if(VT)return Zl;VT=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.AccountTakedownError=void 0,Zl.toKnownErr=a,Zl.isAppPassword=w,Zl.validateAppPassword=R;const r=Wt(),i=he(),c=me().is$typed,d=i.validate,m="com.atproto.server.createAppPassword";class e extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Zl.AccountTakedownError=e;function a(S){return S instanceof r.XRPCError&&S.error==="AccountTakedown"?new e(S):S}const g="appPassword";function w(S){return c(S,m,g)}function R(S){return d(S,m,g)}return Zl}var Hl={},jT;function NT(){if(jT)return Hl;jT=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.AuthFactorTokenRequiredError=Hl.AccountTakedownError=void 0,Hl.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Hl.AccountTakedownError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Hl.AuthFactorTokenRequiredError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="AccountTakedown")return new c(e);if(e.error==="AuthFactorTokenRequired")return new d(e)}return e}return Hl}var Xl={},FT;function qT(){if(FT)return Xl;FT=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.InvalidTokenError=Xl.ExpiredTokenError=void 0,Xl.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Xl.ExpiredTokenError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Xl.InvalidTokenError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="ExpiredToken")return new c(e);if(e.error==="InvalidToken")return new d(e)}return e}return Xl}var bp={},KT;function GT(){if(KT)return bp;KT=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.DuplicateCreateError=void 0,bp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}bp.DuplicateCreateError=c;function d(m){return m instanceof r.XRPCError&&m.error==="DuplicateCreate"?new c(m):m}return bp}var vp={},$T;function ZT(){if($T)return vp;$T=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.BadExpirationError=void 0,vp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}vp.BadExpirationError=c;function d(m){return m instanceof r.XRPCError&&m.error==="BadExpiration"?new c(m):m}return vp}var Wl={},HT;function XT(){if(HT)return Wl;HT=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.AccountTakedownError=void 0,Wl.toKnownErr=a,Wl.isAppPassword=w,Wl.validateAppPassword=R;const r=Wt(),i=he(),c=me().is$typed,d=i.validate,m="com.atproto.server.listAppPasswords";class e extends r.XRPCError{constructor(D){super(D.status,D.error,D.message,D.headers,{cause:D})}}Wl.AccountTakedownError=e;function a(S){return S instanceof r.XRPCError&&S.error==="AccountTakedown"?new e(S):S}const g="appPassword";function w(S){return c(S,m,g)}function R(S){return d(S,m,g)}return Wl}var xp={},WT;function YT(){if(WT)return xp;WT=1,Object.defineProperty(xp,"__esModule",{value:!0}),xp.AccountTakedownError=void 0,xp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}xp.AccountTakedownError=c;function d(m){return m instanceof r.XRPCError&&m.error==="AccountTakedown"?new c(m):m}return xp}var Yl={},JT;function QT(){if(JT)return Yl;JT=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.InvalidTokenError=Yl.ExpiredTokenError=void 0,Yl.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Yl.ExpiredTokenError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Yl.InvalidTokenError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="ExpiredToken")return new c(e);if(e.error==="InvalidToken")return new d(e)}return e}return Yl}var ma={},eC;function tC(){if(eC)return ma;eC=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.TokenRequiredError=ma.InvalidTokenError=ma.ExpiredTokenError=void 0,ma.toKnownErr=e;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}ma.ExpiredTokenError=c;class d extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}ma.InvalidTokenError=d;class m extends r.XRPCError{constructor(g){super(g.status,g.error,g.message,g.headers,{cause:g})}}ma.TokenRequiredError=m;function e(a){if(a instanceof r.XRPCError){if(a.error==="ExpiredToken")return new c(a);if(a.error==="InvalidToken")return new d(a);if(a.error==="TokenRequired")return new m(a)}return a}return ma}var ks={},rC;function iC(){if(rC)return ks;rC=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.RepoDeactivatedError=ks.RepoSuspendedError=ks.RepoTakendownError=ks.RepoNotFoundError=ks.BlobNotFoundError=void 0,ks.toKnownErr=g;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ks.BlobNotFoundError=c;class d extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ks.RepoNotFoundError=d;class m extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ks.RepoTakendownError=m;class e extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ks.RepoSuspendedError=e;class a extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ks.RepoDeactivatedError=a;function g(w){if(w instanceof r.XRPCError){if(w.error==="BlobNotFound")return new c(w);if(w.error==="RepoNotFound")return new d(w);if(w.error==="RepoTakendown")return new m(w);if(w.error==="RepoSuspended")return new e(w);if(w.error==="RepoDeactivated")return new a(w)}return w}return ks}var Ps={},nC;function sC(){if(nC)return Ps;nC=1,Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.RepoDeactivatedError=Ps.RepoSuspendedError=Ps.RepoTakendownError=Ps.RepoNotFoundError=Ps.BlockNotFoundError=void 0,Ps.toKnownErr=g;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ps.BlockNotFoundError=c;class d extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ps.RepoNotFoundError=d;class m extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ps.RepoTakendownError=m;class e extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ps.RepoSuspendedError=e;class a extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ps.RepoDeactivatedError=a;function g(w){if(w instanceof r.XRPCError){if(w.error==="BlockNotFound")return new c(w);if(w.error==="RepoNotFound")return new d(w);if(w.error==="RepoTakendown")return new m(w);if(w.error==="RepoSuspended")return new e(w);if(w.error==="RepoDeactivated")return new a(w)}return w}return Ps}var wp={},oC;function aC(){if(oC)return wp;oC=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.HeadNotFoundError=void 0,wp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}wp.HeadNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="HeadNotFound"?new c(m):m}return wp}var Ep={},lC;function uC(){if(lC)return Ep;lC=1,Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.HostNotFoundError=void 0,Ep.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Ep.HostNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="HostNotFound"?new c(m):m}return Ep}var ho={},cC;function dC(){if(cC)return ho;cC=1,Object.defineProperty(ho,"__esModule",{value:!0}),ho.RepoDeactivatedError=ho.RepoSuspendedError=ho.RepoTakendownError=ho.RepoNotFoundError=void 0,ho.toKnownErr=a;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ho.RepoNotFoundError=c;class d extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ho.RepoTakendownError=d;class m extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ho.RepoSuspendedError=m;class e extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ho.RepoDeactivatedError=e;function a(g){if(g instanceof r.XRPCError){if(g.error==="RepoNotFound")return new c(g);if(g.error==="RepoTakendown")return new d(g);if(g.error==="RepoSuspended")return new m(g);if(g.error==="RepoDeactivated")return new e(g)}return g}return ho}var Ls={},pC;function fC(){if(pC)return Ls;pC=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.RepoDeactivatedError=Ls.RepoSuspendedError=Ls.RepoTakendownError=Ls.RepoNotFoundError=Ls.RecordNotFoundError=void 0,Ls.toKnownErr=g;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ls.RecordNotFoundError=c;class d extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ls.RepoNotFoundError=d;class m extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ls.RepoTakendownError=m;class e extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ls.RepoSuspendedError=e;class a extends r.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}Ls.RepoDeactivatedError=a;function g(w){if(w instanceof r.XRPCError){if(w.error==="RecordNotFound")return new c(w);if(w.error==="RepoNotFound")return new d(w);if(w.error==="RepoTakendown")return new m(w);if(w.error==="RepoSuspended")return new e(w);if(w.error==="RepoDeactivated")return new a(w)}return w}return Ls}var mo={},hC;function mC(){if(hC)return mo;hC=1,Object.defineProperty(mo,"__esModule",{value:!0}),mo.RepoDeactivatedError=mo.RepoSuspendedError=mo.RepoTakendownError=mo.RepoNotFoundError=void 0,mo.toKnownErr=a;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}mo.RepoNotFoundError=c;class d extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}mo.RepoTakendownError=d;class m extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}mo.RepoSuspendedError=m;class e extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}mo.RepoDeactivatedError=e;function a(g){if(g instanceof r.XRPCError){if(g.error==="RepoNotFound")return new c(g);if(g.error==="RepoTakendown")return new d(g);if(g.error==="RepoSuspended")return new m(g);if(g.error==="RepoDeactivated")return new e(g)}return g}return mo}var Ap={},yC;function gC(){if(yC)return Ap;yC=1,Object.defineProperty(Ap,"__esModule",{value:!0}),Ap.RepoNotFoundError=void 0,Ap.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Ap.RepoNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="RepoNotFound"?new c(m):m}return Ap}var yo={},_C;function bC(){if(_C)return yo;_C=1,Object.defineProperty(yo,"__esModule",{value:!0}),yo.RepoDeactivatedError=yo.RepoSuspendedError=yo.RepoTakendownError=yo.RepoNotFoundError=void 0,yo.toKnownErr=a;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}yo.RepoNotFoundError=c;class d extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}yo.RepoTakendownError=d;class m extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}yo.RepoSuspendedError=m;class e extends r.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}yo.RepoDeactivatedError=e;function a(g){if(g instanceof r.XRPCError){if(g.error==="RepoNotFound")return new c(g);if(g.error==="RepoTakendown")return new d(g);if(g.error==="RepoSuspended")return new m(g);if(g.error==="RepoDeactivated")return new e(g)}return g}return yo}var Rp={},vC;function xC(){if(vC)return Rp;vC=1,Object.defineProperty(Rp,"__esModule",{value:!0}),Rp.HostBannedError=void 0,Rp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Rp.HostBannedError=c;function d(m){return m instanceof r.XRPCError&&m.error==="HostBanned"?new c(m):m}return Rp}var go={},wC;function EC(){if(wC)return go;wC=1,Object.defineProperty(go,"__esModule",{value:!0}),go.InvalidEmailError=void 0,go.toKnownErr=a,go.isResultAvailable=w,go.validateResultAvailable=R,go.isResultUnavailable=D,go.validateResultUnavailable=k,go.isSuggestion=F,go.validateSuggestion=K;const r=Wt(),i=he(),c=me().is$typed,d=i.validate,m="com.atproto.temp.checkHandleAvailability";class e extends r.XRPCError{constructor(ee){super(ee.status,ee.error,ee.message,ee.headers,{cause:ee})}}go.InvalidEmailError=e;function a(U){return U instanceof r.XRPCError&&U.error==="InvalidEmail"?new e(U):U}const g="resultAvailable";function w(U){return c(U,m,g)}function R(U){return d(U,m,g)}const S="resultUnavailable";function D(U){return c(U,m,S)}function k(U){return d(U,m,S)}const B="suggestion";function F(U){return c(U,m,B)}function K(U){return d(U,m,B)}return go}var Sp={},AC;function RC(){if(AC)return Sp;AC=1,Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.InvalidScopeReferenceError=void 0,Sp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Sp.InvalidScopeReferenceError=c;function d(m){return m instanceof r.XRPCError&&m.error==="InvalidScopeReference"?new c(m):m}return Sp}var Tp={},SC;function TC(){if(SC)return Tp;SC=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.DuplicateTemplateNameError=void 0,Tp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Tp.DuplicateTemplateNameError=c;function d(m){return m instanceof r.XRPCError&&m.error==="DuplicateTemplateName"?new c(m):m}return Tp}var Cp={},CC;function kC(){if(CC)return Cp;CC=1,Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.DuplicateTemplateNameError=void 0,Cp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Cp.DuplicateTemplateNameError=c;function d(m){return m instanceof r.XRPCError&&m.error==="DuplicateTemplateName"?new c(m):m}return Cp}var Jl={},PC;function LC(){if(PC)return Jl;PC=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.DuplicateExternalIdError=Jl.SubjectHasActionError=void 0,Jl.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Jl.SubjectHasActionError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Jl.DuplicateExternalIdError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="SubjectHasAction")return new c(e);if(e.error==="DuplicateExternalId")return new d(e)}return e}return Jl}var ya={},DC;function IC(){if(DC)return ya;DC=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.RepoNotFoundError=void 0,ya.toKnownErr=a,ya.isTimelineItem=w,ya.validateTimelineItem=R,ya.isTimelineItemSummary=D,ya.validateTimelineItemSummary=k;const r=Wt(),i=he(),c=me().is$typed,d=i.validate,m="tools.ozone.moderation.getAccountTimeline";class e extends r.XRPCError{constructor(F){super(F.status,F.error,F.message,F.headers,{cause:F})}}ya.RepoNotFoundError=e;function a(B){return B instanceof r.XRPCError&&B.error==="RepoNotFound"?new e(B):B}const g="timelineItem";function w(B){return c(B,m,g)}function R(B){return d(B,m,g)}const S="timelineItemSummary";function D(B){return c(B,m,S)}function k(B){return d(B,m,S)}return ya}var kp={},BC;function MC(){if(BC)return kp;BC=1,Object.defineProperty(kp,"__esModule",{value:!0}),kp.RecordNotFoundError=void 0,kp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}kp.RecordNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="RecordNotFound"?new c(m):m}return kp}var Pp={},zC;function OC(){if(zC)return Pp;zC=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.RepoNotFoundError=void 0,Pp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Pp.RepoNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="RepoNotFound"?new c(m):m}return Pp}var Ql={},VC;function UC(){if(VC)return Ql;VC=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.RuleAlreadyExistsError=Ql.InvalidUrlError=void 0,Ql.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Ql.InvalidUrlError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}Ql.RuleAlreadyExistsError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="InvalidUrl")return new c(e);if(e.error==="RuleAlreadyExists")return new d(e)}return e}return Ql}var Lp={},jC;function NC(){if(jC)return Lp;jC=1,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.RuleNotFoundError=void 0,Lp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Lp.RuleNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="RuleNotFound"?new c(m):m}return Lp}var Dp={},FC;function qC(){if(FC)return Dp;FC=1,Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.RuleNotFoundError=void 0,Dp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Dp.RuleNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="RuleNotFound"?new c(m):m}return Dp}var Ip={},KC;function GC(){if(KC)return Ip;KC=1,Object.defineProperty(Ip,"__esModule",{value:!0}),Ip.SetNotFoundError=void 0,Ip.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Ip.SetNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="SetNotFound"?new c(m):m}return Ip}var Bp={},$C;function ZC(){if($C)return Bp;$C=1,Object.defineProperty(Bp,"__esModule",{value:!0}),Bp.SetNotFoundError=void 0,Bp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Bp.SetNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="SetNotFound"?new c(m):m}return Bp}var Mp={},HC;function XC(){if(HC)return Mp;HC=1,Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.SetNotFoundError=void 0,Mp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Mp.SetNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="SetNotFound"?new c(m):m}return Mp}var zp={},WC;function YC(){if(WC)return zp;WC=1,Object.defineProperty(zp,"__esModule",{value:!0}),zp.MemberAlreadyExistsError=void 0,zp.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}zp.MemberAlreadyExistsError=c;function d(m){return m instanceof r.XRPCError&&m.error==="MemberAlreadyExists"?new c(m):m}return zp}var eu={},JC;function QC(){if(JC)return eu;JC=1,Object.defineProperty(eu,"__esModule",{value:!0}),eu.CannotDeleteSelfError=eu.MemberNotFoundError=void 0,eu.toKnownErr=m;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}eu.MemberNotFoundError=c;class d extends r.XRPCError{constructor(a){super(a.status,a.error,a.message,a.headers,{cause:a})}}eu.CannotDeleteSelfError=d;function m(e){if(e instanceof r.XRPCError){if(e.error==="MemberNotFound")return new c(e);if(e.error==="CannotDeleteSelf")return new d(e)}return e}return eu}var Op={},ek;function tk(){if(ek)return Op;ek=1,Object.defineProperty(Op,"__esModule",{value:!0}),Op.MemberNotFoundError=void 0,Op.toKnownErr=d;const r=Wt(),i=he();me().is$typed,i.validate;class c extends r.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Op.MemberNotFoundError=c;function d(m){return m instanceof r.XRPCError&&m.error==="MemberNotFound"?new c(m):m}return Op}var Qt={},rk;function $6(){if(rk)return Qt;rk=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.isProfileViewBasic=e,Qt.validateProfileViewBasic=a,Qt.isProfileView=w,Qt.validateProfileView=R,Qt.isProfileViewDetailed=D,Qt.validateProfileViewDetailed=k,Qt.isProfileAssociated=F,Qt.validateProfileAssociated=K,Qt.isProfileAssociatedChat=ee,Qt.validateProfileAssociatedChat=le,Qt.isProfileAssociatedActivitySubscription=Te,Qt.validateProfileAssociatedActivitySubscription=pe,Qt.isViewerState=Xe,Qt.validateViewerState=dt,Qt.isKnownFollowers=et,Qt.validateKnownFollowers=rt,Qt.isVerificationState=Be,Qt.validateVerificationState=fe,Qt.isVerificationView=nt,Qt.validateVerificationView=gt,Qt.isAdultContentPref=be,Qt.validateAdultContentPref=Ft,Qt.isContentLabelPref=Le,Qt.validateContentLabelPref=ur,Qt.isSavedFeed=tr,Qt.validateSavedFeed=qr,Qt.isSavedFeedsPrefV2=kr,Qt.validateSavedFeedsPrefV2=Sr,Qt.isSavedFeedsPref=sr,Qt.validateSavedFeedsPref=br,Qt.isPersonalDetailsPref=Xr,Qt.validatePersonalDetailsPref=Vt,Qt.isFeedViewPref=Ct,Qt.validateFeedViewPref=er,Qt.isThreadViewPref=Lr,Qt.validateThreadViewPref=Jr,Qt.isInterestsPref=gi,Qt.validateInterestsPref=Oi,Qt.isMutedWord=vt,Qt.validateMutedWord=Nt,Qt.isMutedWordsPref=W,Qt.validateMutedWordsPref=J,Qt.isHiddenPostsPref=ve,Qt.validateHiddenPostsPref=Se,Qt.isLabelersPref=Ge,Qt.validateLabelersPref=Ne,Qt.isLabelerPrefItem=mt,Qt.validateLabelerPrefItem=Ze,Qt.isBskyAppStatePref=qt,Qt.validateBskyAppStatePref=Ke,Qt.isBskyAppProgressGuide=Dr,Qt.validateBskyAppProgressGuide=Ot,Qt.isNux=pi,Qt.validateNux=fi,Qt.isVerificationPrefs=_i,Qt.validateVerificationPrefs=Kr,Qt.isPostInteractionSettingsPref=Mr,Qt.validatePostInteractionSettingsPref=pt,Qt.isStatusView=Di,Qt.validateStatusView=Ii;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.actor.defs",m="profileViewBasic";function e(at){return s(at,d,m)}function a(at){return c(at,d,m)}const g="profileView";function w(at){return s(at,d,g)}function R(at){return c(at,d,g)}const S="profileViewDetailed";function D(at){return s(at,d,S)}function k(at){return c(at,d,S)}const B="profileAssociated";function F(at){return s(at,d,B)}function K(at){return c(at,d,B)}const U="profileAssociatedChat";function ee(at){return s(at,d,U)}function le(at){return c(at,d,U)}const Q="profileAssociatedActivitySubscription";function Te(at){return s(at,d,Q)}function pe(at){return c(at,d,Q)}const _e="viewerState";function Xe(at){return s(at,d,_e)}function dt(at){return c(at,d,_e)}const He="knownFollowers";function et(at){return s(at,d,He)}function rt(at){return c(at,d,He)}const te="verificationState";function Be(at){return s(at,d,te)}function fe(at){return c(at,d,te)}const ye="verificationView";function nt(at){return s(at,d,ye)}function gt(at){return c(at,d,ye)}const lt="adultContentPref";function be(at){return s(at,d,lt)}function Ft(at){return c(at,d,lt)}const Ut="contentLabelPref";function Le(at){return s(at,d,Ut)}function ur(at){return c(at,d,Ut)}const Tt="savedFeed";function tr(at){return s(at,d,Tt)}function qr(at){return c(at,d,Tt)}const lr="savedFeedsPrefV2";function kr(at){return s(at,d,lr)}function Sr(at){return c(at,d,lr)}const $r="savedFeedsPref";function sr(at){return s(at,d,$r)}function br(at){return c(at,d,$r)}const nr="personalDetailsPref";function Xr(at){return s(at,d,nr)}function Vt(at){return c(at,d,nr)}const Pr="feedViewPref";function Ct(at){return s(at,d,Pr)}function er(at){return c(at,d,Pr)}const or="threadViewPref";function Lr(at){return s(at,d,or)}function Jr(at){return c(at,d,or)}const bt="interestsPref";function gi(at){return s(at,d,bt)}function Oi(at){return c(at,d,bt)}const Oe="mutedWord";function vt(at){return s(at,d,Oe)}function Nt(at){return c(at,d,Oe)}const we="mutedWordsPref";function W(at){return s(at,d,we)}function J(at){return c(at,d,we)}const se="hiddenPostsPref";function ve(at){return s(at,d,se)}function Se(at){return c(at,d,se)}const je="labelersPref";function Ge(at){return s(at,d,je)}function Ne(at){return c(at,d,je)}const Qe="labelerPrefItem";function mt(at){return s(at,d,Qe)}function Ze(at){return c(at,d,Qe)}const Mt="bskyAppStatePref";function qt(at){return s(at,d,Mt)}function Ke(at){return c(at,d,Mt)}const yr="bskyAppProgressGuide";function Dr(at){return s(at,d,yr)}function Ot(at){return c(at,d,yr)}const gr="nux";function pi(at){return s(at,d,gr)}function fi(at){return c(at,d,gr)}const ti="verificationPrefs";function _i(at){return s(at,d,ti)}function Kr(at){return c(at,d,ti)}const oi="postInteractionSettingsPref";function Mr(at){return s(at,d,oi)}function pt(at){return c(at,d,oi)}const Vi="statusView";function Di(at){return s(at,d,Vi)}function Ii(at){return c(at,d,Vi)}return Qt}var Sg={},ik;function Z6(){if(ik)return Sg;ik=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Sg}var Tg={},nk;function H6(){if(nk)return Tg;nk=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Tg}var Cg={},sk;function X6(){if(sk)return Cg;sk=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Cg}var kg={},ok;function W6(){if(ok)return kg;ok=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return kg}var $h={},ak;function Y6(){if(ak)return $h;ak=1,Object.defineProperty($h,"__esModule",{value:!0}),$h.isRecord=e,$h.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.actor.profile",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return $h}var Pg={},lk;function J6(){if(lk)return Pg;lk=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Pg}var Lg={},uk;function Q6(){if(uk)return Lg;uk=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Lg}var Dg={},ck;function eK(){if(ck)return Dg;ck=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Dg}var cc={},dk;function tK(){if(dk)return cc;dk=1,Object.defineProperty(cc,"__esModule",{value:!0}),cc.LIVE=void 0,cc.isRecord=e,cc.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.actor.status",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return cc.LIVE=`${d}#live`,cc}var dc={},pk;function rK(){if(pk)return dc;pk=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.isBookmark=e,dc.validateBookmark=a,dc.isBookmarkView=w,dc.validateBookmarkView=R;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.bookmark.defs",m="bookmark";function e(S){return s(S,d,m)}function a(S){return c(S,d,m)}const g="bookmarkView";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return dc}var Ig={},fk;function iK(){if(fk)return Ig;fk=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ig}var Zh={},hk;function nK(){if(hk)return Zh;hk=1,Object.defineProperty(Zh,"__esModule",{value:!0}),Zh.isAspectRatio=e,Zh.validateAspectRatio=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.embed.defs",m="aspectRatio";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return Zh}var Vo={},mk;function sK(){if(mk)return Vo;mk=1,Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.isMain=e,Vo.validateMain=a,Vo.isExternal=w,Vo.validateExternal=R,Vo.isView=D,Vo.validateView=k,Vo.isViewExternal=F,Vo.validateViewExternal=K;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.embed.external",m="main";function e(U){return s(U,d,m)}function a(U){return c(U,d,m)}const g="external";function w(U){return s(U,d,g)}function R(U){return c(U,d,g)}const S="view";function D(U){return s(U,d,S)}function k(U){return c(U,d,S)}const B="viewExternal";function F(U){return s(U,d,B)}function K(U){return c(U,d,B)}return Vo}var Uo={},yk;function oK(){if(yk)return Uo;yk=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.isMain=e,Uo.validateMain=a,Uo.isImage=w,Uo.validateImage=R,Uo.isView=D,Uo.validateView=k,Uo.isViewImage=F,Uo.validateViewImage=K;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.embed.images",m="main";function e(U){return s(U,d,m)}function a(U){return c(U,d,m)}const g="image";function w(U){return s(U,d,g)}function R(U){return c(U,d,g)}const S="view";function D(U){return s(U,d,S)}function k(U){return c(U,d,S)}const B="viewImage";function F(U){return s(U,d,B)}function K(U){return c(U,d,B)}return Uo}var fs={},gk;function aK(){if(gk)return fs;gk=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.isMain=e,fs.validateMain=a,fs.isView=w,fs.validateView=R,fs.isViewRecord=D,fs.validateViewRecord=k,fs.isViewNotFound=F,fs.validateViewNotFound=K,fs.isViewBlocked=ee,fs.validateViewBlocked=le,fs.isViewDetached=Te,fs.validateViewDetached=pe;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.embed.record",m="main";function e(_e){return s(_e,d,m)}function a(_e){return c(_e,d,m)}const g="view";function w(_e){return s(_e,d,g)}function R(_e){return c(_e,d,g)}const S="viewRecord";function D(_e){return s(_e,d,S)}function k(_e){return c(_e,d,S)}const B="viewNotFound";function F(_e){return s(_e,d,B)}function K(_e){return c(_e,d,B)}const U="viewBlocked";function ee(_e){return s(_e,d,U)}function le(_e){return c(_e,d,U)}const Q="viewDetached";function Te(_e){return s(_e,d,Q)}function pe(_e){return c(_e,d,Q)}return fs}var pc={},_k;function lK(){if(_k)return pc;_k=1,Object.defineProperty(pc,"__esModule",{value:!0}),pc.isMain=e,pc.validateMain=a,pc.isView=w,pc.validateView=R;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.embed.recordWithMedia",m="main";function e(S){return s(S,d,m)}function a(S){return c(S,d,m)}const g="view";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return pc}var Qa={},bk;function uK(){if(bk)return Qa;bk=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.isMain=e,Qa.validateMain=a,Qa.isCaption=w,Qa.validateCaption=R,Qa.isView=D,Qa.validateView=k;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.embed.video",m="main";function e(B){return s(B,d,m)}function a(B){return c(B,d,m)}const g="caption";function w(B){return s(B,d,g)}function R(B){return c(B,d,g)}const S="view";function D(B){return s(B,d,S)}function k(B){return c(B,d,S)}return Qa}var Ht={},vk;function cK(){if(vk)return Ht;vk=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.INTERACTIONSHARE=Ht.INTERACTIONQUOTE=Ht.INTERACTIONREPLY=Ht.INTERACTIONREPOST=Ht.INTERACTIONLIKE=Ht.INTERACTIONSEEN=Ht.CONTENTMODEVIDEO=Ht.CONTENTMODEUNSPECIFIED=Ht.CLICKTHROUGHEMBED=Ht.CLICKTHROUGHREPOSTER=Ht.CLICKTHROUGHAUTHOR=Ht.CLICKTHROUGHITEM=Ht.REQUESTMORE=Ht.REQUESTLESS=void 0,Ht.isPostView=e,Ht.validatePostView=a,Ht.isViewerState=w,Ht.validateViewerState=R,Ht.isThreadContext=D,Ht.validateThreadContext=k,Ht.isFeedViewPost=F,Ht.validateFeedViewPost=K,Ht.isReplyRef=ee,Ht.validateReplyRef=le,Ht.isReasonRepost=Te,Ht.validateReasonRepost=pe,Ht.isReasonPin=Xe,Ht.validateReasonPin=dt,Ht.isThreadViewPost=et,Ht.validateThreadViewPost=rt,Ht.isNotFoundPost=Be,Ht.validateNotFoundPost=fe,Ht.isBlockedPost=nt,Ht.validateBlockedPost=gt,Ht.isBlockedAuthor=be,Ht.validateBlockedAuthor=Ft,Ht.isGeneratorView=Le,Ht.validateGeneratorView=ur,Ht.isGeneratorViewerState=tr,Ht.validateGeneratorViewerState=qr,Ht.isSkeletonFeedPost=kr,Ht.validateSkeletonFeedPost=Sr,Ht.isSkeletonReasonRepost=sr,Ht.validateSkeletonReasonRepost=br,Ht.isSkeletonReasonPin=Xr,Ht.validateSkeletonReasonPin=Vt,Ht.isThreadgateView=Ct,Ht.validateThreadgateView=er,Ht.isInteraction=Lr,Ht.validateInteraction=Jr;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.defs",m="postView";function e(bt){return s(bt,d,m)}function a(bt){return c(bt,d,m)}const g="viewerState";function w(bt){return s(bt,d,g)}function R(bt){return c(bt,d,g)}const S="threadContext";function D(bt){return s(bt,d,S)}function k(bt){return c(bt,d,S)}const B="feedViewPost";function F(bt){return s(bt,d,B)}function K(bt){return c(bt,d,B)}const U="replyRef";function ee(bt){return s(bt,d,U)}function le(bt){return c(bt,d,U)}const Q="reasonRepost";function Te(bt){return s(bt,d,Q)}function pe(bt){return c(bt,d,Q)}const _e="reasonPin";function Xe(bt){return s(bt,d,_e)}function dt(bt){return c(bt,d,_e)}const He="threadViewPost";function et(bt){return s(bt,d,He)}function rt(bt){return c(bt,d,He)}const te="notFoundPost";function Be(bt){return s(bt,d,te)}function fe(bt){return c(bt,d,te)}const ye="blockedPost";function nt(bt){return s(bt,d,ye)}function gt(bt){return c(bt,d,ye)}const lt="blockedAuthor";function be(bt){return s(bt,d,lt)}function Ft(bt){return c(bt,d,lt)}const Ut="generatorView";function Le(bt){return s(bt,d,Ut)}function ur(bt){return c(bt,d,Ut)}const Tt="generatorViewerState";function tr(bt){return s(bt,d,Tt)}function qr(bt){return c(bt,d,Tt)}const lr="skeletonFeedPost";function kr(bt){return s(bt,d,lr)}function Sr(bt){return c(bt,d,lr)}const $r="skeletonReasonRepost";function sr(bt){return s(bt,d,$r)}function br(bt){return c(bt,d,$r)}const nr="skeletonReasonPin";function Xr(bt){return s(bt,d,nr)}function Vt(bt){return c(bt,d,nr)}const Pr="threadgateView";function Ct(bt){return s(bt,d,Pr)}function er(bt){return c(bt,d,Pr)}const or="interaction";function Lr(bt){return s(bt,d,or)}function Jr(bt){return c(bt,d,or)}return Ht.REQUESTLESS=`${d}#requestLess`,Ht.REQUESTMORE=`${d}#requestMore`,Ht.CLICKTHROUGHITEM=`${d}#clickthroughItem`,Ht.CLICKTHROUGHAUTHOR=`${d}#clickthroughAuthor`,Ht.CLICKTHROUGHREPOSTER=`${d}#clickthroughReposter`,Ht.CLICKTHROUGHEMBED=`${d}#clickthroughEmbed`,Ht.CONTENTMODEUNSPECIFIED=`${d}#contentModeUnspecified`,Ht.CONTENTMODEVIDEO=`${d}#contentModeVideo`,Ht.INTERACTIONSEEN=`${d}#interactionSeen`,Ht.INTERACTIONLIKE=`${d}#interactionLike`,Ht.INTERACTIONREPOST=`${d}#interactionRepost`,Ht.INTERACTIONREPLY=`${d}#interactionReply`,Ht.INTERACTIONQUOTE=`${d}#interactionQuote`,Ht.INTERACTIONSHARE=`${d}#interactionShare`,Ht}var tu={},xk;function dK(){if(xk)return tu;xk=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.toKnownErr=m,tu.isFeed=a,tu.validateFeed=g,tu.isLinks=R,tu.validateLinks=S;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.describeFeedGenerator";function m(D){return D}const e="feed";function a(D){return s(D,d,e)}function g(D){return c(D,d,e)}const w="links";function R(D){return s(D,d,w)}function S(D){return c(D,d,w)}return tu}var Hh={},wk;function pK(){if(wk)return Hh;wk=1,Object.defineProperty(Hh,"__esModule",{value:!0}),Hh.isRecord=e,Hh.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.generator",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return Hh}var Bg={},Ek;function fK(){if(Ek)return Bg;Ek=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Bg}var Mg={},Ak;function hK(){if(Ak)return Mg;Ak=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Mg}var zg={},Rk;function mK(){if(Rk)return zg;Rk=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return zg}var Vp={},Sk;function yK(){if(Sk)return Vp;Sk=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.toKnownErr=m,Vp.isLike=a,Vp.validateLike=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.getLikes";function m(w){return w}const e="like";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Vp}var Og={},Tk;function gK(){if(Tk)return Og;Tk=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Og}var Vg={},Ck;function _K(){if(Ck)return Vg;Ck=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Vg}var Ug={},kk;function bK(){if(kk)return Ug;kk=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ug}var jg={},Pk;function vK(){if(Pk)return jg;Pk=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return jg}var Ng={},Lk;function xK(){if(Lk)return Ng;Lk=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ng}var Xh={},Dk;function wK(){if(Dk)return Xh;Dk=1,Object.defineProperty(Xh,"__esModule",{value:!0}),Xh.isRecord=e,Xh.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.like",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return Xh}var jo={},Ik;function EK(){if(Ik)return jo;Ik=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.isRecord=e,jo.validateRecord=a,jo.isReplyRef=w,jo.validateReplyRef=R,jo.isEntity=D,jo.validateEntity=k,jo.isTextSlice=F,jo.validateTextSlice=K;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.post",m="main";function e(U){return s(U,d,m)}function a(U){return c(U,d,m,!0)}const g="replyRef";function w(U){return s(U,d,g)}function R(U){return c(U,d,g)}const S="entity";function D(U){return s(U,d,S)}function k(U){return c(U,d,S)}const B="textSlice";function F(U){return s(U,d,B)}function K(U){return c(U,d,B)}return jo}var fc={},Bk;function AK(){if(Bk)return fc;Bk=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.isRecord=e,fc.validateRecord=a,fc.isDisableRule=w,fc.validateDisableRule=R;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.postgate",m="main";function e(S){return s(S,d,m)}function a(S){return c(S,d,m,!0)}const g="disableRule";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return fc}var Wh={},Mk;function RK(){if(Mk)return Wh;Mk=1,Object.defineProperty(Wh,"__esModule",{value:!0}),Wh.isRecord=e,Wh.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.repost",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return Wh}var Fg={},zk;function SK(){if(zk)return Fg;zk=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Fg}var Hs={},Ok;function TK(){if(Ok)return Hs;Ok=1,Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.isRecord=e,Hs.validateRecord=a,Hs.isMentionRule=w,Hs.validateMentionRule=R,Hs.isFollowerRule=D,Hs.validateFollowerRule=k,Hs.isFollowingRule=F,Hs.validateFollowingRule=K,Hs.isListRule=ee,Hs.validateListRule=le;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.feed.threadgate",m="main";function e(Q){return s(Q,d,m)}function a(Q){return c(Q,d,m,!0)}const g="mentionRule";function w(Q){return s(Q,d,g)}function R(Q){return c(Q,d,g)}const S="followerRule";function D(Q){return s(Q,d,S)}function k(Q){return c(Q,d,S)}const B="followingRule";function F(Q){return s(Q,d,B)}function K(Q){return c(Q,d,B)}const U="listRule";function ee(Q){return s(Q,d,U)}function le(Q){return c(Q,d,U)}return Hs}var Yh={},Vk;function CK(){if(Vk)return Yh;Vk=1,Object.defineProperty(Yh,"__esModule",{value:!0}),Yh.isRecord=e,Yh.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.block",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return Yh}var Pi={},Uk;function kK(){if(Uk)return Pi;Uk=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.REFERENCELIST=Pi.CURATELIST=Pi.MODLIST=void 0,Pi.isListViewBasic=e,Pi.validateListViewBasic=a,Pi.isListView=w,Pi.validateListView=R,Pi.isListItemView=D,Pi.validateListItemView=k,Pi.isStarterPackView=F,Pi.validateStarterPackView=K,Pi.isStarterPackViewBasic=ee,Pi.validateStarterPackViewBasic=le,Pi.isListViewerState=Te,Pi.validateListViewerState=pe,Pi.isNotFoundActor=Xe,Pi.validateNotFoundActor=dt,Pi.isRelationship=et,Pi.validateRelationship=rt;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.defs",m="listViewBasic";function e(te){return s(te,d,m)}function a(te){return c(te,d,m)}const g="listView";function w(te){return s(te,d,g)}function R(te){return c(te,d,g)}const S="listItemView";function D(te){return s(te,d,S)}function k(te){return c(te,d,S)}const B="starterPackView";function F(te){return s(te,d,B)}function K(te){return c(te,d,B)}const U="starterPackViewBasic";function ee(te){return s(te,d,U)}function le(te){return c(te,d,U)}Pi.MODLIST=`${d}#modlist`,Pi.CURATELIST=`${d}#curatelist`,Pi.REFERENCELIST=`${d}#referencelist`;const Q="listViewerState";function Te(te){return s(te,d,Q)}function pe(te){return c(te,d,Q)}const _e="notFoundActor";function Xe(te){return s(te,d,_e)}function dt(te){return c(te,d,_e)}const He="relationship";function et(te){return s(te,d,He)}function rt(te){return c(te,d,He)}return Pi}var Jh={},jk;function PK(){if(jk)return Jh;jk=1,Object.defineProperty(Jh,"__esModule",{value:!0}),Jh.isRecord=e,Jh.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.follow",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return Jh}var qg={},Nk;function LK(){if(Nk)return qg;Nk=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return qg}var Kg={},Fk;function DK(){if(Fk)return Kg;Fk=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Kg}var Gg={},qk;function IK(){if(qk)return Gg;qk=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Gg}var $g={},Kk;function BK(){if(Kk)return $g;Kk=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return $g}var Zg={},Gk;function MK(){if(Gk)return Zg;Gk=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Zg}var Hg={},$k;function zK(){if($k)return Hg;$k=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Hg}var Xg={},Zk;function OK(){if(Zk)return Xg;Zk=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Xg}var Wg={},Hk;function VK(){if(Hk)return Wg;Hk=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Wg}var Yg={},Xk;function UK(){if(Xk)return Yg;Xk=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Yg}var Up={},Wk;function jK(){if(Wk)return Up;Wk=1,Object.defineProperty(Up,"__esModule",{value:!0}),Up.toKnownErr=m,Up.isListWithMembership=a,Up.validateListWithMembership=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.getListsWithMembership";function m(w){return w}const e="listWithMembership";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Up}var Jg={},Yk;function NK(){if(Yk)return Jg;Yk=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Jg}var Qg={},Jk;function FK(){if(Jk)return Qg;Jk=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Qg}var e_={},Qk;function qK(){if(Qk)return e_;Qk=1,Object.defineProperty(e_,"__esModule",{value:!0}),e_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return e_}var jp={},e2;function KK(){if(e2)return jp;e2=1,Object.defineProperty(jp,"__esModule",{value:!0}),jp.toKnownErr=m,jp.isStarterPackWithMembership=a,jp.validateStarterPackWithMembership=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.getStarterPacksWithMembership";function m(w){return w}const e="starterPackWithMembership";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return jp}var t_={},t2;function GK(){if(t2)return t_;t2=1,Object.defineProperty(t_,"__esModule",{value:!0}),t_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return t_}var Qh={},r2;function $K(){if(r2)return Qh;r2=1,Object.defineProperty(Qh,"__esModule",{value:!0}),Qh.isRecord=e,Qh.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.list",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return Qh}var em={},i2;function ZK(){if(i2)return em;i2=1,Object.defineProperty(em,"__esModule",{value:!0}),em.isRecord=e,em.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.listblock",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return em}var tm={},n2;function HK(){if(n2)return tm;n2=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.isRecord=e,tm.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.listitem",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return tm}var r_={},s2;function XK(){if(s2)return r_;s2=1,Object.defineProperty(r_,"__esModule",{value:!0}),r_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return r_}var i_={},o2;function WK(){if(o2)return i_;o2=1,Object.defineProperty(i_,"__esModule",{value:!0}),i_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return i_}var n_={},a2;function YK(){if(a2)return n_;a2=1,Object.defineProperty(n_,"__esModule",{value:!0}),n_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return n_}var s_={},l2;function JK(){if(l2)return s_;l2=1,Object.defineProperty(s_,"__esModule",{value:!0}),s_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return s_}var hc={},u2;function QK(){if(u2)return hc;u2=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.isRecord=e,hc.validateRecord=a,hc.isFeedItem=w,hc.validateFeedItem=R;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.starterpack",m="main";function e(S){return s(S,d,m)}function a(S){return c(S,d,m,!0)}const g="feedItem";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return hc}var o_={},c2;function e8(){if(c2)return o_;c2=1,Object.defineProperty(o_,"__esModule",{value:!0}),o_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return o_}var a_={},d2;function t8(){if(d2)return a_;d2=1,Object.defineProperty(a_,"__esModule",{value:!0}),a_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return a_}var l_={},p2;function r8(){if(p2)return l_;p2=1,Object.defineProperty(l_,"__esModule",{value:!0}),l_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return l_}var rm={},f2;function i8(){if(f2)return rm;f2=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.isRecord=e,rm.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.graph.verification",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return rm}var No={},h2;function n8(){if(h2)return No;h2=1,Object.defineProperty(No,"__esModule",{value:!0}),No.isLabelerView=e,No.validateLabelerView=a,No.isLabelerViewDetailed=w,No.validateLabelerViewDetailed=R,No.isLabelerViewerState=D,No.validateLabelerViewerState=k,No.isLabelerPolicies=F,No.validateLabelerPolicies=K;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.labeler.defs",m="labelerView";function e(U){return s(U,d,m)}function a(U){return c(U,d,m)}const g="labelerViewDetailed";function w(U){return s(U,d,g)}function R(U){return c(U,d,g)}const S="labelerViewerState";function D(U){return s(U,d,S)}function k(U){return c(U,d,S)}const B="labelerPolicies";function F(U){return s(U,d,B)}function K(U){return c(U,d,B)}return No}var u_={},m2;function s8(){if(m2)return u_;m2=1,Object.defineProperty(u_,"__esModule",{value:!0}),u_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return u_}var im={},y2;function o8(){if(y2)return im;y2=1,Object.defineProperty(im,"__esModule",{value:!0}),im.isRecord=e,im.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.labeler.service",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return im}var nm={},g2;function a8(){if(g2)return nm;g2=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.isRecord=e,nm.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.notification.declaration",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return nm}var jn={},_2;function l8(){if(_2)return jn;_2=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.isRecordDeleted=e,jn.validateRecordDeleted=a,jn.isChatPreference=w,jn.validateChatPreference=R,jn.isFilterablePreference=D,jn.validateFilterablePreference=k,jn.isPreference=F,jn.validatePreference=K,jn.isPreferences=ee,jn.validatePreferences=le,jn.isActivitySubscription=Te,jn.validateActivitySubscription=pe,jn.isSubjectActivitySubscription=Xe,jn.validateSubjectActivitySubscription=dt;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.notification.defs",m="recordDeleted";function e(He){return s(He,d,m)}function a(He){return c(He,d,m)}const g="chatPreference";function w(He){return s(He,d,g)}function R(He){return c(He,d,g)}const S="filterablePreference";function D(He){return s(He,d,S)}function k(He){return c(He,d,S)}const B="preference";function F(He){return s(He,d,B)}function K(He){return c(He,d,B)}const U="preferences";function ee(He){return s(He,d,U)}function le(He){return c(He,d,U)}const Q="activitySubscription";function Te(He){return s(He,d,Q)}function pe(He){return c(He,d,Q)}const _e="subjectActivitySubscription";function Xe(He){return s(He,d,_e)}function dt(He){return c(He,d,_e)}return jn}var c_={},b2;function u8(){if(b2)return c_;b2=1,Object.defineProperty(c_,"__esModule",{value:!0}),c_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return c_}var d_={},v2;function c8(){if(v2)return d_;v2=1,Object.defineProperty(d_,"__esModule",{value:!0}),d_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return d_}var p_={},x2;function d8(){if(x2)return p_;x2=1,Object.defineProperty(p_,"__esModule",{value:!0}),p_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return p_}var Np={},w2;function p8(){if(w2)return Np;w2=1,Object.defineProperty(Np,"__esModule",{value:!0}),Np.toKnownErr=m,Np.isNotification=a,Np.validateNotification=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.notification.listNotifications";function m(w){return w}const e="notification";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Np}var f_={},E2;function f8(){if(E2)return f_;E2=1,Object.defineProperty(f_,"__esModule",{value:!0}),f_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return f_}var h_={},A2;function h8(){if(A2)return h_;A2=1,Object.defineProperty(h_,"__esModule",{value:!0}),h_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return h_}var m_={},R2;function m8(){if(R2)return m_;R2=1,Object.defineProperty(m_,"__esModule",{value:!0}),m_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return m_}var y_={},S2;function y8(){if(S2)return y_;S2=1,Object.defineProperty(y_,"__esModule",{value:!0}),y_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return y_}var g_={},T2;function g8(){if(T2)return g_;T2=1,Object.defineProperty(g_,"__esModule",{value:!0}),g_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return g_}var __={},C2;function _8(){if(C2)return __;C2=1,Object.defineProperty(__,"__esModule",{value:!0}),__.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return __}var Xs={},k2;function b8(){if(k2)return Xs;k2=1,Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.isMain=e,Xs.validateMain=a,Xs.isMention=w,Xs.validateMention=R,Xs.isLink=D,Xs.validateLink=k,Xs.isTag=F,Xs.validateTag=K,Xs.isByteSlice=ee,Xs.validateByteSlice=le;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.richtext.facet",m="main";function e(Q){return s(Q,d,m)}function a(Q){return c(Q,d,m)}const g="mention";function w(Q){return s(Q,d,g)}function R(Q){return c(Q,d,g)}const S="link";function D(Q){return s(Q,d,S)}function k(Q){return c(Q,d,S)}const B="tag";function F(Q){return s(Q,d,B)}function K(Q){return c(Q,d,B)}const U="byteSlice";function ee(Q){return s(Q,d,U)}function le(Q){return c(Q,d,U)}return Xs}var Ei={},P2;function v8(){if(P2)return Ei;P2=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.isSkeletonSearchPost=e,Ei.validateSkeletonSearchPost=a,Ei.isSkeletonSearchActor=w,Ei.validateSkeletonSearchActor=R,Ei.isSkeletonSearchStarterPack=D,Ei.validateSkeletonSearchStarterPack=k,Ei.isTrendingTopic=F,Ei.validateTrendingTopic=K,Ei.isSkeletonTrend=ee,Ei.validateSkeletonTrend=le,Ei.isTrendView=Te,Ei.validateTrendView=pe,Ei.isThreadItemPost=Xe,Ei.validateThreadItemPost=dt,Ei.isThreadItemNoUnauthenticated=et,Ei.validateThreadItemNoUnauthenticated=rt,Ei.isThreadItemNotFound=Be,Ei.validateThreadItemNotFound=fe,Ei.isThreadItemBlocked=nt,Ei.validateThreadItemBlocked=gt,Ei.isAgeAssuranceState=be,Ei.validateAgeAssuranceState=Ft,Ei.isAgeAssuranceEvent=Le,Ei.validateAgeAssuranceEvent=ur;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.unspecced.defs",m="skeletonSearchPost";function e(Tt){return s(Tt,d,m)}function a(Tt){return c(Tt,d,m)}const g="skeletonSearchActor";function w(Tt){return s(Tt,d,g)}function R(Tt){return c(Tt,d,g)}const S="skeletonSearchStarterPack";function D(Tt){return s(Tt,d,S)}function k(Tt){return c(Tt,d,S)}const B="trendingTopic";function F(Tt){return s(Tt,d,B)}function K(Tt){return c(Tt,d,B)}const U="skeletonTrend";function ee(Tt){return s(Tt,d,U)}function le(Tt){return c(Tt,d,U)}const Q="trendView";function Te(Tt){return s(Tt,d,Q)}function pe(Tt){return c(Tt,d,Q)}const _e="threadItemPost";function Xe(Tt){return s(Tt,d,_e)}function dt(Tt){return c(Tt,d,_e)}const He="threadItemNoUnauthenticated";function et(Tt){return s(Tt,d,He)}function rt(Tt){return c(Tt,d,He)}const te="threadItemNotFound";function Be(Tt){return s(Tt,d,te)}function fe(Tt){return c(Tt,d,te)}const ye="threadItemBlocked";function nt(Tt){return s(Tt,d,ye)}function gt(Tt){return c(Tt,d,ye)}const lt="ageAssuranceState";function be(Tt){return s(Tt,d,lt)}function Ft(Tt){return c(Tt,d,lt)}const Ut="ageAssuranceEvent";function Le(Tt){return s(Tt,d,Ut)}function ur(Tt){return c(Tt,d,Ut)}return Ei}var b_={},L2;function x8(){if(L2)return b_;L2=1,Object.defineProperty(b_,"__esModule",{value:!0}),b_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return b_}var Fp={},D2;function w8(){if(D2)return Fp;D2=1,Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.toKnownErr=m,Fp.isLiveNowConfig=a,Fp.validateLiveNowConfig=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.unspecced.getConfig";function m(w){return w}const e="liveNowConfig";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Fp}var v_={},I2;function E8(){if(I2)return v_;I2=1,Object.defineProperty(v_,"__esModule",{value:!0}),v_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return v_}var x_={},B2;function A8(){if(B2)return x_;B2=1,Object.defineProperty(x_,"__esModule",{value:!0}),x_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return x_}var w_={},M2;function R8(){if(M2)return w_;M2=1,Object.defineProperty(w_,"__esModule",{value:!0}),w_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return w_}var qp={},z2;function S8(){if(z2)return qp;z2=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.toKnownErr=m,qp.isThreadItem=a,qp.validateThreadItem=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.unspecced.getPostThreadOtherV2";function m(w){return w}const e="threadItem";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return qp}var Kp={},O2;function T8(){if(O2)return Kp;O2=1,Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.toKnownErr=m,Kp.isThreadItem=a,Kp.validateThreadItem=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.unspecced.getPostThreadV2";function m(w){return w}const e="threadItem";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Kp}var E_={},V2;function C8(){if(V2)return E_;V2=1,Object.defineProperty(E_,"__esModule",{value:!0}),E_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return E_}var A_={},U2;function k8(){if(U2)return A_;U2=1,Object.defineProperty(A_,"__esModule",{value:!0}),A_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return A_}var R_={},j2;function P8(){if(j2)return R_;j2=1,Object.defineProperty(R_,"__esModule",{value:!0}),R_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return R_}var S_={},N2;function L8(){if(N2)return S_;N2=1,Object.defineProperty(S_,"__esModule",{value:!0}),S_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return S_}var T_={},F2;function D8(){if(F2)return T_;F2=1,Object.defineProperty(T_,"__esModule",{value:!0}),T_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return T_}var C_={},q2;function I8(){if(q2)return C_;q2=1,Object.defineProperty(C_,"__esModule",{value:!0}),C_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return C_}var k_={},K2;function B8(){if(K2)return k_;K2=1,Object.defineProperty(k_,"__esModule",{value:!0}),k_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return k_}var Gp={},G2;function M8(){if(G2)return Gp;G2=1,Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.toKnownErr=m,Gp.isSuggestion=a,Gp.validateSuggestion=g;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.unspecced.getTaggedSuggestions";function m(w){return w}const e="suggestion";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Gp}var P_={},$2;function z8(){if($2)return P_;$2=1,Object.defineProperty(P_,"__esModule",{value:!0}),P_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return P_}var L_={},Z2;function O8(){if(Z2)return L_;Z2=1,Object.defineProperty(L_,"__esModule",{value:!0}),L_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return L_}var D_={},H2;function V8(){if(H2)return D_;H2=1,Object.defineProperty(D_,"__esModule",{value:!0}),D_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return D_}var sm={},X2;function U8(){if(X2)return sm;X2=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.isJobStatus=e,sm.validateJobStatus=a;const r=he(),s=me().is$typed,c=r.validate,d="app.bsky.video.defs",m="jobStatus";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return sm}var I_={},W2;function j8(){if(W2)return I_;W2=1,Object.defineProperty(I_,"__esModule",{value:!0}),I_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return I_}var B_={},Y2;function N8(){if(Y2)return B_;Y2=1,Object.defineProperty(B_,"__esModule",{value:!0}),B_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return B_}var M_={},J2;function F8(){if(J2)return M_;J2=1,Object.defineProperty(M_,"__esModule",{value:!0}),M_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return M_}var om={},Q2;function q8(){if(Q2)return om;Q2=1,Object.defineProperty(om,"__esModule",{value:!0}),om.isRecord=e,om.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="chat.bsky.actor.declaration",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return om}var am={},eP;function K8(){if(eP)return am;eP=1,Object.defineProperty(am,"__esModule",{value:!0}),am.isProfileViewBasic=e,am.validateProfileViewBasic=a;const r=he(),s=me().is$typed,c=r.validate,d="chat.bsky.actor.defs",m="profileViewBasic";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return am}var z_={},tP;function G8(){if(tP)return z_;tP=1,Object.defineProperty(z_,"__esModule",{value:!0}),z_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return z_}var O_={},rP;function $8(){if(rP)return O_;rP=1,Object.defineProperty(O_,"__esModule",{value:!0}),O_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return O_}var V_={},iP;function Z8(){if(iP)return V_;iP=1,Object.defineProperty(V_,"__esModule",{value:!0}),V_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return V_}var jr={},nP;function H8(){if(nP)return jr;nP=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.isMessageRef=e,jr.validateMessageRef=a,jr.isMessageInput=w,jr.validateMessageInput=R,jr.isMessageView=D,jr.validateMessageView=k,jr.isDeletedMessageView=F,jr.validateDeletedMessageView=K,jr.isMessageViewSender=ee,jr.validateMessageViewSender=le,jr.isReactionView=Te,jr.validateReactionView=pe,jr.isReactionViewSender=Xe,jr.validateReactionViewSender=dt,jr.isMessageAndReactionView=et,jr.validateMessageAndReactionView=rt,jr.isConvoView=Be,jr.validateConvoView=fe,jr.isLogBeginConvo=nt,jr.validateLogBeginConvo=gt,jr.isLogAcceptConvo=be,jr.validateLogAcceptConvo=Ft,jr.isLogLeaveConvo=Le,jr.validateLogLeaveConvo=ur,jr.isLogMuteConvo=tr,jr.validateLogMuteConvo=qr,jr.isLogUnmuteConvo=kr,jr.validateLogUnmuteConvo=Sr,jr.isLogCreateMessage=sr,jr.validateLogCreateMessage=br,jr.isLogDeleteMessage=Xr,jr.validateLogDeleteMessage=Vt,jr.isLogReadMessage=Ct,jr.validateLogReadMessage=er,jr.isLogAddReaction=Lr,jr.validateLogAddReaction=Jr,jr.isLogRemoveReaction=gi,jr.validateLogRemoveReaction=Oi;const r=he(),s=me().is$typed,c=r.validate,d="chat.bsky.convo.defs",m="messageRef";function e(Oe){return s(Oe,d,m)}function a(Oe){return c(Oe,d,m)}const g="messageInput";function w(Oe){return s(Oe,d,g)}function R(Oe){return c(Oe,d,g)}const S="messageView";function D(Oe){return s(Oe,d,S)}function k(Oe){return c(Oe,d,S)}const B="deletedMessageView";function F(Oe){return s(Oe,d,B)}function K(Oe){return c(Oe,d,B)}const U="messageViewSender";function ee(Oe){return s(Oe,d,U)}function le(Oe){return c(Oe,d,U)}const Q="reactionView";function Te(Oe){return s(Oe,d,Q)}function pe(Oe){return c(Oe,d,Q)}const _e="reactionViewSender";function Xe(Oe){return s(Oe,d,_e)}function dt(Oe){return c(Oe,d,_e)}const He="messageAndReactionView";function et(Oe){return s(Oe,d,He)}function rt(Oe){return c(Oe,d,He)}const te="convoView";function Be(Oe){return s(Oe,d,te)}function fe(Oe){return c(Oe,d,te)}const ye="logBeginConvo";function nt(Oe){return s(Oe,d,ye)}function gt(Oe){return c(Oe,d,ye)}const lt="logAcceptConvo";function be(Oe){return s(Oe,d,lt)}function Ft(Oe){return c(Oe,d,lt)}const Ut="logLeaveConvo";function Le(Oe){return s(Oe,d,Ut)}function ur(Oe){return c(Oe,d,Ut)}const Tt="logMuteConvo";function tr(Oe){return s(Oe,d,Tt)}function qr(Oe){return c(Oe,d,Tt)}const lr="logUnmuteConvo";function kr(Oe){return s(Oe,d,lr)}function Sr(Oe){return c(Oe,d,lr)}const $r="logCreateMessage";function sr(Oe){return s(Oe,d,$r)}function br(Oe){return c(Oe,d,$r)}const nr="logDeleteMessage";function Xr(Oe){return s(Oe,d,nr)}function Vt(Oe){return c(Oe,d,nr)}const Pr="logReadMessage";function Ct(Oe){return s(Oe,d,Pr)}function er(Oe){return c(Oe,d,Pr)}const or="logAddReaction";function Lr(Oe){return s(Oe,d,or)}function Jr(Oe){return c(Oe,d,or)}const bt="logRemoveReaction";function gi(Oe){return s(Oe,d,bt)}function Oi(Oe){return c(Oe,d,bt)}return jr}var U_={},sP;function X8(){if(sP)return U_;sP=1,Object.defineProperty(U_,"__esModule",{value:!0}),U_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return U_}var j_={},oP;function W8(){if(oP)return j_;oP=1,Object.defineProperty(j_,"__esModule",{value:!0}),j_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return j_}var N_={},aP;function Y8(){if(aP)return N_;aP=1,Object.defineProperty(N_,"__esModule",{value:!0}),N_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return N_}var F_={},lP;function J8(){if(lP)return F_;lP=1,Object.defineProperty(F_,"__esModule",{value:!0}),F_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return F_}var q_={},uP;function Q8(){if(uP)return q_;uP=1,Object.defineProperty(q_,"__esModule",{value:!0}),q_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return q_}var K_={},cP;function eG(){if(cP)return K_;cP=1,Object.defineProperty(K_,"__esModule",{value:!0}),K_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return K_}var G_={},dP;function tG(){if(dP)return G_;dP=1,Object.defineProperty(G_,"__esModule",{value:!0}),G_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return G_}var $_={},pP;function rG(){if(pP)return $_;pP=1,Object.defineProperty($_,"__esModule",{value:!0}),$_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return $_}var Z_={},fP;function iG(){if(fP)return Z_;fP=1,Object.defineProperty(Z_,"__esModule",{value:!0}),Z_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Z_}var H_={},hP;function nG(){if(hP)return H_;hP=1,Object.defineProperty(H_,"__esModule",{value:!0}),H_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return H_}var $p={},mP;function sG(){if(mP)return $p;mP=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.toKnownErr=m,$p.isBatchItem=a,$p.validateBatchItem=g;const r=he(),s=me().is$typed,c=r.validate,d="chat.bsky.convo.sendMessageBatch";function m(w){return w}const e="batchItem";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return $p}var X_={},yP;function oG(){if(yP)return X_;yP=1,Object.defineProperty(X_,"__esModule",{value:!0}),X_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return X_}var W_={},gP;function aG(){if(gP)return W_;gP=1,Object.defineProperty(W_,"__esModule",{value:!0}),W_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return W_}var Y_={},_P;function lG(){if(_P)return Y_;_P=1,Object.defineProperty(Y_,"__esModule",{value:!0}),Y_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Y_}var Zp={},bP;function uG(){if(bP)return Zp;bP=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.toKnownErr=m,Zp.isMetadata=a,Zp.validateMetadata=g;const r=he(),s=me().is$typed,c=r.validate,d="chat.bsky.moderation.getActorMetadata";function m(w){return w}const e="metadata";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Zp}var J_={},vP;function cG(){if(vP)return J_;vP=1,Object.defineProperty(J_,"__esModule",{value:!0}),J_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return J_}var Q_={},xP;function dG(){if(xP)return Q_;xP=1,Object.defineProperty(Q_,"__esModule",{value:!0}),Q_.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Q_}var Ws={},wP;function pG(){if(wP)return Ws;wP=1,Object.defineProperty(Ws,"__esModule",{value:!0}),Ws.isStatusAttr=e,Ws.validateStatusAttr=a,Ws.isAccountView=w,Ws.validateAccountView=R,Ws.isRepoRef=D,Ws.validateRepoRef=k,Ws.isRepoBlobRef=F,Ws.validateRepoBlobRef=K,Ws.isThreatSignature=ee,Ws.validateThreatSignature=le;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.admin.defs",m="statusAttr";function e(Q){return s(Q,d,m)}function a(Q){return c(Q,d,m)}const g="accountView";function w(Q){return s(Q,d,g)}function R(Q){return c(Q,d,g)}const S="repoRef";function D(Q){return s(Q,d,S)}function k(Q){return c(Q,d,S)}const B="repoBlobRef";function F(Q){return s(Q,d,B)}function K(Q){return c(Q,d,B)}const U="threatSignature";function ee(Q){return s(Q,d,U)}function le(Q){return c(Q,d,U)}return Ws}var eb={},EP;function fG(){if(EP)return eb;EP=1,Object.defineProperty(eb,"__esModule",{value:!0}),eb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return eb}var tb={},AP;function hG(){if(AP)return tb;AP=1,Object.defineProperty(tb,"__esModule",{value:!0}),tb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return tb}var rb={},RP;function mG(){if(RP)return rb;RP=1,Object.defineProperty(rb,"__esModule",{value:!0}),rb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return rb}var ib={},SP;function yG(){if(SP)return ib;SP=1,Object.defineProperty(ib,"__esModule",{value:!0}),ib.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return ib}var nb={},TP;function gG(){if(TP)return nb;TP=1,Object.defineProperty(nb,"__esModule",{value:!0}),nb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return nb}var sb={},CP;function _G(){if(CP)return sb;CP=1,Object.defineProperty(sb,"__esModule",{value:!0}),sb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return sb}var ob={},kP;function bG(){if(kP)return ob;kP=1,Object.defineProperty(ob,"__esModule",{value:!0}),ob.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return ob}var ab={},PP;function vG(){if(PP)return ab;PP=1,Object.defineProperty(ab,"__esModule",{value:!0}),ab.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return ab}var lb={},LP;function xG(){if(LP)return lb;LP=1,Object.defineProperty(lb,"__esModule",{value:!0}),lb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return lb}var ub={},DP;function wG(){if(DP)return ub;DP=1,Object.defineProperty(ub,"__esModule",{value:!0}),ub.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return ub}var cb={},IP;function EG(){if(IP)return cb;IP=1,Object.defineProperty(cb,"__esModule",{value:!0}),cb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return cb}var db={},BP;function AG(){if(BP)return db;BP=1,Object.defineProperty(db,"__esModule",{value:!0}),db.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return db}var pb={},MP;function RG(){if(MP)return pb;MP=1,Object.defineProperty(pb,"__esModule",{value:!0}),pb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return pb}var fb={},zP;function SG(){if(zP)return fb;zP=1,Object.defineProperty(fb,"__esModule",{value:!0}),fb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return fb}var hb={},OP;function TG(){if(OP)return hb;OP=1,Object.defineProperty(hb,"__esModule",{value:!0}),hb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return hb}var lm={},VP;function CG(){if(VP)return lm;VP=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.isIdentityInfo=e,lm.validateIdentityInfo=a;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.identity.defs",m="identityInfo";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return lm}var mb={},UP;function kG(){if(UP)return mb;UP=1,Object.defineProperty(mb,"__esModule",{value:!0}),mb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return mb}var yb={},jP;function PG(){if(jP)return yb;jP=1,Object.defineProperty(yb,"__esModule",{value:!0}),yb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return yb}var gb={},NP;function LG(){if(NP)return gb;NP=1,Object.defineProperty(gb,"__esModule",{value:!0}),gb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return gb}var _b={},FP;function DG(){if(FP)return _b;FP=1,Object.defineProperty(_b,"__esModule",{value:!0}),_b.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return _b}var bb={},qP;function IG(){if(qP)return bb;qP=1,Object.defineProperty(bb,"__esModule",{value:!0}),bb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return bb}var Ys={},KP;function BG(){if(KP)return Ys;KP=1,Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.isLabel=e,Ys.validateLabel=a,Ys.isSelfLabels=w,Ys.validateSelfLabels=R,Ys.isSelfLabel=D,Ys.validateSelfLabel=k,Ys.isLabelValueDefinition=F,Ys.validateLabelValueDefinition=K,Ys.isLabelValueDefinitionStrings=ee,Ys.validateLabelValueDefinitionStrings=le;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.label.defs",m="label";function e(Q){return s(Q,d,m)}function a(Q){return c(Q,d,m)}const g="selfLabels";function w(Q){return s(Q,d,g)}function R(Q){return c(Q,d,g)}const S="selfLabel";function D(Q){return s(Q,d,S)}function k(Q){return c(Q,d,S)}const B="labelValueDefinition";function F(Q){return s(Q,d,B)}function K(Q){return c(Q,d,B)}const U="labelValueDefinitionStrings";function ee(Q){return s(Q,d,U)}function le(Q){return c(Q,d,U)}return Ys}var vb={},GP;function MG(){if(GP)return vb;GP=1,Object.defineProperty(vb,"__esModule",{value:!0}),vb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return vb}var mc={},$P;function zG(){if($P)return mc;$P=1,Object.defineProperty(mc,"__esModule",{value:!0}),mc.isLabels=e,mc.validateLabels=a,mc.isInfo=w,mc.validateInfo=R;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.label.subscribeLabels",m="labels";function e(S){return s(S,d,m)}function a(S){return c(S,d,m)}const g="info";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return mc}var um={},ZP;function OG(){if(ZP)return um;ZP=1,Object.defineProperty(um,"__esModule",{value:!0}),um.isRecord=e,um.validateRecord=a;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.lexicon.schema",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m,!0)}return um}var Hp={},HP;function VG(){if(HP)return Hp;HP=1,Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.toKnownErr=m,Hp.isModTool=a,Hp.validateModTool=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.moderation.createReport";function m(w){return w}const e="modTool";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Hp}var Nn={},XP;function UG(){if(XP)return Nn;XP=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.REASONAPPEAL=Nn.REASONOTHER=Nn.REASONRUDE=Nn.REASONSEXUAL=Nn.REASONMISLEADING=Nn.REASONVIOLATION=Nn.REASONSPAM=void 0;const r=he();me().is$typed,r.validate;const s="com.atproto.moderation.defs";return Nn.REASONSPAM=`${s}#reasonSpam`,Nn.REASONVIOLATION=`${s}#reasonViolation`,Nn.REASONMISLEADING=`${s}#reasonMisleading`,Nn.REASONSEXUAL=`${s}#reasonSexual`,Nn.REASONRUDE=`${s}#reasonRude`,Nn.REASONOTHER=`${s}#reasonOther`,Nn.REASONAPPEAL=`${s}#reasonAppeal`,Nn}var cm={},WP;function jG(){if(WP)return cm;WP=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.isCommitMeta=e,cm.validateCommitMeta=a;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.repo.defs",m="commitMeta";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return cm}var xb={},YP;function NG(){if(YP)return xb;YP=1,Object.defineProperty(xb,"__esModule",{value:!0}),xb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return xb}var wb={},JP;function FG(){if(JP)return wb;JP=1,Object.defineProperty(wb,"__esModule",{value:!0}),wb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return wb}var Xp={},QP;function qG(){if(QP)return Xp;QP=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.toKnownErr=m,Xp.isRecordBlob=a,Xp.validateRecordBlob=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.repo.listMissingBlobs";function m(w){return w}const e="recordBlob";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Xp}var Wp={},eL;function KG(){if(eL)return Wp;eL=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.toKnownErr=m,Wp.isRecord=a,Wp.validateRecord=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.repo.listRecords";function m(w){return w}const e="record";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Wp}var dm={},tL;function GG(){if(tL)return dm;tL=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.isMain=e,dm.validateMain=a;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.repo.strongRef",m="main";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return dm}var Eb={},rL;function $G(){if(rL)return Eb;rL=1,Object.defineProperty(Eb,"__esModule",{value:!0}),Eb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Eb}var Ab={},iL;function ZG(){if(iL)return Ab;iL=1,Object.defineProperty(Ab,"__esModule",{value:!0}),Ab.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ab}var Rb={},nL;function HG(){if(nL)return Rb;nL=1,Object.defineProperty(Rb,"__esModule",{value:!0}),Rb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Rb}var Sb={},sL;function XG(){if(sL)return Sb;sL=1,Object.defineProperty(Sb,"__esModule",{value:!0}),Sb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Sb}var Yp={},oL;function WG(){if(oL)return Yp;oL=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.toKnownErr=m,Yp.isAccountCodes=a,Yp.validateAccountCodes=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.server.createInviteCodes";function m(w){return w}const e="accountCodes";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Yp}var Tb={},aL;function YG(){if(aL)return Tb;aL=1,Object.defineProperty(Tb,"__esModule",{value:!0}),Tb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Tb}var yc={},lL;function JG(){if(lL)return yc;lL=1,Object.defineProperty(yc,"__esModule",{value:!0}),yc.isInviteCode=e,yc.validateInviteCode=a,yc.isInviteCodeUse=w,yc.validateInviteCodeUse=R;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.server.defs",m="inviteCode";function e(S){return s(S,d,m)}function a(S){return c(S,d,m)}const g="inviteCodeUse";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return yc}var Cb={},uL;function QG(){if(uL)return Cb;uL=1,Object.defineProperty(Cb,"__esModule",{value:!0}),Cb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Cb}var ru={},cL;function e9(){if(cL)return ru;cL=1,Object.defineProperty(ru,"__esModule",{value:!0}),ru.toKnownErr=m,ru.isLinks=a,ru.validateLinks=g,ru.isContact=R,ru.validateContact=S;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.server.describeServer";function m(D){return D}const e="links";function a(D){return s(D,d,e)}function g(D){return c(D,d,e)}const w="contact";function R(D){return s(D,d,w)}function S(D){return c(D,d,w)}return ru}var kb={},dL;function t9(){if(dL)return kb;dL=1,Object.defineProperty(kb,"__esModule",{value:!0}),kb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return kb}var Pb={},pL;function r9(){if(pL)return Pb;pL=1,Object.defineProperty(Pb,"__esModule",{value:!0}),Pb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Pb}var Lb={},fL;function i9(){if(fL)return Lb;fL=1,Object.defineProperty(Lb,"__esModule",{value:!0}),Lb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Lb}var Db={},hL;function n9(){if(hL)return Db;hL=1,Object.defineProperty(Db,"__esModule",{value:!0}),Db.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Db}var Ib={},mL;function s9(){if(mL)return Ib;mL=1,Object.defineProperty(Ib,"__esModule",{value:!0}),Ib.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ib}var Bb={},yL;function o9(){if(yL)return Bb;yL=1,Object.defineProperty(Bb,"__esModule",{value:!0}),Bb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Bb}var Mb={},gL;function a9(){if(gL)return Mb;gL=1,Object.defineProperty(Mb,"__esModule",{value:!0}),Mb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Mb}var a1={},_L;function l9(){if(_L)return a1;_L=1,Object.defineProperty(a1,"__esModule",{value:!0});const r=he();return me().is$typed,r.validate,a1}var zb={},bL;function u9(){if(bL)return zb;bL=1,Object.defineProperty(zb,"__esModule",{value:!0}),zb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return zb}var Jp={},vL;function c9(){if(vL)return Jp;vL=1,Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.toKnownErr=m,Jp.isHost=a,Jp.validateHost=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.sync.listHosts";function m(w){return w}const e="host";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Jp}var Qp={},xL;function d9(){if(xL)return Qp;xL=1,Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.toKnownErr=m,Qp.isRepo=a,Qp.validateRepo=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.sync.listRepos";function m(w){return w}const e="repo";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return Qp}var ef={},wL;function p9(){if(wL)return ef;wL=1,Object.defineProperty(ef,"__esModule",{value:!0}),ef.toKnownErr=m,ef.isRepo=a,ef.validateRepo=g;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.sync.listReposByCollection";function m(w){return w}const e="repo";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return ef}var Ob={},EL;function f9(){if(EL)return Ob;EL=1,Object.defineProperty(Ob,"__esModule",{value:!0}),Ob.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ob}var hs={},AL;function h9(){if(AL)return hs;AL=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.isCommit=e,hs.validateCommit=a,hs.isSync=w,hs.validateSync=R,hs.isIdentity=D,hs.validateIdentity=k,hs.isAccount=F,hs.validateAccount=K,hs.isInfo=ee,hs.validateInfo=le,hs.isRepoOp=Te,hs.validateRepoOp=pe;const r=he(),s=me().is$typed,c=r.validate,d="com.atproto.sync.subscribeRepos",m="commit";function e(_e){return s(_e,d,m)}function a(_e){return c(_e,d,m)}const g="sync";function w(_e){return s(_e,d,g)}function R(_e){return c(_e,d,g)}const S="identity";function D(_e){return s(_e,d,S)}function k(_e){return c(_e,d,S)}const B="account";function F(_e){return s(_e,d,B)}function K(_e){return c(_e,d,B)}const U="info";function ee(_e){return s(_e,d,U)}function le(_e){return c(_e,d,U)}const Q="repoOp";function Te(_e){return s(_e,d,Q)}function pe(_e){return c(_e,d,Q)}return hs}var Vb={},RL;function m9(){if(RL)return Vb;RL=1,Object.defineProperty(Vb,"__esModule",{value:!0}),Vb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Vb}var Ub={},SL;function y9(){if(SL)return Ub;SL=1,Object.defineProperty(Ub,"__esModule",{value:!0}),Ub.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Ub}var jb={},TL;function g9(){if(TL)return jb;TL=1,Object.defineProperty(jb,"__esModule",{value:!0}),jb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return jb}var Nb={},CL;function _9(){if(CL)return Nb;CL=1,Object.defineProperty(Nb,"__esModule",{value:!0}),Nb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Nb}var Fb={},kL;function b9(){if(kL)return Fb;kL=1,Object.defineProperty(Fb,"__esModule",{value:!0}),Fb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Fb}var pm={},PL;function v9(){if(PL)return pm;PL=1,Object.defineProperty(pm,"__esModule",{value:!0}),pm.isTemplateView=e,pm.validateTemplateView=a;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.communication.defs",m="templateView";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return pm}var qb={},LL;function x9(){if(LL)return qb;LL=1,Object.defineProperty(qb,"__esModule",{value:!0}),qb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return qb}var Kb={},DL;function w9(){if(DL)return Kb;DL=1,Object.defineProperty(Kb,"__esModule",{value:!0}),Kb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Kb}var Yn={},IL;function E9(){if(IL)return Yn;IL=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.toKnownErr=m,Yn.isEvent=a,Yn.validateEvent=g,Yn.isAccountCreated=R,Yn.validateAccountCreated=S,Yn.isEmailUpdated=k,Yn.validateEmailUpdated=B,Yn.isEmailConfirmed=K,Yn.validateEmailConfirmed=U,Yn.isPasswordUpdated=le,Yn.validatePasswordUpdated=Q,Yn.isHandleUpdated=pe,Yn.validateHandleUpdated=_e;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.hosting.getAccountHistory";function m(Xe){return Xe}const e="event";function a(Xe){return s(Xe,d,e)}function g(Xe){return c(Xe,d,e)}const w="accountCreated";function R(Xe){return s(Xe,d,w)}function S(Xe){return c(Xe,d,w)}const D="emailUpdated";function k(Xe){return s(Xe,d,D)}function B(Xe){return c(Xe,d,D)}const F="emailConfirmed";function K(Xe){return s(Xe,d,F)}function U(Xe){return c(Xe,d,F)}const ee="passwordUpdated";function le(Xe){return s(Xe,d,ee)}function Q(Xe){return c(Xe,d,ee)}const Te="handleUpdated";function pe(Xe){return s(Xe,d,Te)}function _e(Xe){return c(Xe,d,Te)}return Yn}var iu={},BL;function A9(){if(BL)return iu;BL=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.toKnownErr=m,iu.isCancellationResults=a,iu.validateCancellationResults=g,iu.isFailedCancellation=R,iu.validateFailedCancellation=S;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.moderation.cancelScheduledActions";function m(D){return D}const e="cancellationResults";function a(D){return s(D,d,e)}function g(D){return c(D,d,e)}const w="failedCancellation";function R(D){return s(D,d,w)}function S(D){return c(D,d,w)}return iu}var _t={},ML;function R9(){if(ML)return _t;ML=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.TIMELINEEVENTPLCTOMBSTONE=_t.TIMELINEEVENTPLCOPERATION=_t.TIMELINEEVENTPLCCREATE=_t.REVIEWNONE=_t.REVIEWCLOSED=_t.REVIEWESCALATED=_t.REVIEWOPEN=void 0,_t.isModEventView=e,_t.validateModEventView=a,_t.isModEventViewDetail=w,_t.validateModEventViewDetail=R,_t.isSubjectStatusView=D,_t.validateSubjectStatusView=k,_t.isSubjectView=F,_t.validateSubjectView=K,_t.isAccountStats=ee,_t.validateAccountStats=le,_t.isRecordsStats=Te,_t.validateRecordsStats=pe,_t.isModEventTakedown=Xe,_t.validateModEventTakedown=dt,_t.isModEventReverseTakedown=et,_t.validateModEventReverseTakedown=rt,_t.isModEventResolveAppeal=Be,_t.validateModEventResolveAppeal=fe,_t.isModEventComment=nt,_t.validateModEventComment=gt,_t.isModEventReport=be,_t.validateModEventReport=Ft,_t.isModEventLabel=Le,_t.validateModEventLabel=ur,_t.isModEventPriorityScore=tr,_t.validateModEventPriorityScore=qr,_t.isAgeAssuranceEvent=kr,_t.validateAgeAssuranceEvent=Sr,_t.isAgeAssuranceOverrideEvent=sr,_t.validateAgeAssuranceOverrideEvent=br,_t.isRevokeAccountCredentialsEvent=Xr,_t.validateRevokeAccountCredentialsEvent=Vt,_t.isModEventAcknowledge=Ct,_t.validateModEventAcknowledge=er,_t.isModEventEscalate=Lr,_t.validateModEventEscalate=Jr,_t.isModEventMute=gi,_t.validateModEventMute=Oi,_t.isModEventUnmute=vt,_t.validateModEventUnmute=Nt,_t.isModEventMuteReporter=W,_t.validateModEventMuteReporter=J,_t.isModEventUnmuteReporter=ve,_t.validateModEventUnmuteReporter=Se,_t.isModEventEmail=Ge,_t.validateModEventEmail=Ne,_t.isModEventDivert=mt,_t.validateModEventDivert=Ze,_t.isModEventTag=qt,_t.validateModEventTag=Ke,_t.isAccountEvent=Dr,_t.validateAccountEvent=Ot,_t.isIdentityEvent=pi,_t.validateIdentityEvent=fi,_t.isRecordEvent=_i,_t.validateRecordEvent=Kr,_t.isScheduleTakedownEvent=Mr,_t.validateScheduleTakedownEvent=pt,_t.isCancelScheduledTakedownEvent=Di,_t.validateCancelScheduledTakedownEvent=Ii,_t.isRepoView=At,_t.validateRepoView=_r,_t.isRepoViewDetail=Gi,_t.validateRepoViewDetail=gn,_t.isRepoViewNotFound=dr,_t.validateRepoViewNotFound=ns,_t.isRecordView=Kn,_t.validateRecordView=vs,_t.isRecordViewDetail=Gn,_t.validateRecordViewDetail=hi,_t.isRecordViewNotFound=Qr,_t.validateRecordViewNotFound=xs,_t.isModeration=oo,_t.validateModeration=ke,_t.isModerationDetail=re,_t.validateModerationDetail=oe,_t.isBlobView=Me,_t.validateBlobView=Et,_t.isImageDetails=$t,_t.validateImageDetails=Yt,_t.isVideoDetails=ji,_t.validateVideoDetails=Mn,_t.isAccountHosting=L,_t.validateAccountHosting=M,_t.isRecordHosting=ut,_t.validateRecordHosting=vr,_t.isReporterStats=bu,_t.validateReporterStats=_n,_t.isModTool=Xo,_t.validateModTool=bn,_t.isScheduledActionView=Tr,_t.validateScheduledActionView=Ca;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.moderation.defs",m="modEventView";function e($e){return s($e,d,m)}function a($e){return c($e,d,m)}const g="modEventViewDetail";function w($e){return s($e,d,g)}function R($e){return c($e,d,g)}const S="subjectStatusView";function D($e){return s($e,d,S)}function k($e){return c($e,d,S)}const B="subjectView";function F($e){return s($e,d,B)}function K($e){return c($e,d,B)}const U="accountStats";function ee($e){return s($e,d,U)}function le($e){return c($e,d,U)}const Q="recordsStats";function Te($e){return s($e,d,Q)}function pe($e){return c($e,d,Q)}_t.REVIEWOPEN=`${d}#reviewOpen`,_t.REVIEWESCALATED=`${d}#reviewEscalated`,_t.REVIEWCLOSED=`${d}#reviewClosed`,_t.REVIEWNONE=`${d}#reviewNone`;const _e="modEventTakedown";function Xe($e){return s($e,d,_e)}function dt($e){return c($e,d,_e)}const He="modEventReverseTakedown";function et($e){return s($e,d,He)}function rt($e){return c($e,d,He)}const te="modEventResolveAppeal";function Be($e){return s($e,d,te)}function fe($e){return c($e,d,te)}const ye="modEventComment";function nt($e){return s($e,d,ye)}function gt($e){return c($e,d,ye)}const lt="modEventReport";function be($e){return s($e,d,lt)}function Ft($e){return c($e,d,lt)}const Ut="modEventLabel";function Le($e){return s($e,d,Ut)}function ur($e){return c($e,d,Ut)}const Tt="modEventPriorityScore";function tr($e){return s($e,d,Tt)}function qr($e){return c($e,d,Tt)}const lr="ageAssuranceEvent";function kr($e){return s($e,d,lr)}function Sr($e){return c($e,d,lr)}const $r="ageAssuranceOverrideEvent";function sr($e){return s($e,d,$r)}function br($e){return c($e,d,$r)}const nr="revokeAccountCredentialsEvent";function Xr($e){return s($e,d,nr)}function Vt($e){return c($e,d,nr)}const Pr="modEventAcknowledge";function Ct($e){return s($e,d,Pr)}function er($e){return c($e,d,Pr)}const or="modEventEscalate";function Lr($e){return s($e,d,or)}function Jr($e){return c($e,d,or)}const bt="modEventMute";function gi($e){return s($e,d,bt)}function Oi($e){return c($e,d,bt)}const Oe="modEventUnmute";function vt($e){return s($e,d,Oe)}function Nt($e){return c($e,d,Oe)}const we="modEventMuteReporter";function W($e){return s($e,d,we)}function J($e){return c($e,d,we)}const se="modEventUnmuteReporter";function ve($e){return s($e,d,se)}function Se($e){return c($e,d,se)}const je="modEventEmail";function Ge($e){return s($e,d,je)}function Ne($e){return c($e,d,je)}const Qe="modEventDivert";function mt($e){return s($e,d,Qe)}function Ze($e){return c($e,d,Qe)}const Mt="modEventTag";function qt($e){return s($e,d,Mt)}function Ke($e){return c($e,d,Mt)}const yr="accountEvent";function Dr($e){return s($e,d,yr)}function Ot($e){return c($e,d,yr)}const gr="identityEvent";function pi($e){return s($e,d,gr)}function fi($e){return c($e,d,gr)}const ti="recordEvent";function _i($e){return s($e,d,ti)}function Kr($e){return c($e,d,ti)}const oi="scheduleTakedownEvent";function Mr($e){return s($e,d,oi)}function pt($e){return c($e,d,oi)}const Vi="cancelScheduledTakedownEvent";function Di($e){return s($e,d,Vi)}function Ii($e){return c($e,d,Vi)}const at="repoView";function At($e){return s($e,d,at)}function _r($e){return c($e,d,at)}const cr="repoViewDetail";function Gi($e){return s($e,d,cr)}function gn($e){return c($e,d,cr)}const tn="repoViewNotFound";function dr($e){return s($e,d,tn)}function ns($e){return c($e,d,tn)}const ss="recordView";function Kn($e){return s($e,d,ss)}function vs($e){return c($e,d,ss)}const rn="recordViewDetail";function Gn($e){return s($e,d,rn)}function hi($e){return c($e,d,rn)}const Ui="recordViewNotFound";function Qr($e){return s($e,d,Ui)}function xs($e){return c($e,d,Ui)}const $n="moderation";function oo($e){return s($e,d,$n)}function ke($e){return c($e,d,$n)}const j="moderationDetail";function re($e){return s($e,d,j)}function oe($e){return c($e,d,j)}const De="blobView";function Me($e){return s($e,d,De)}function Et($e){return c($e,d,De)}const ht="imageDetails";function $t($e){return s($e,d,ht)}function Yt($e){return c($e,d,ht)}const wr="videoDetails";function ji($e){return s($e,d,wr)}function Mn($e){return c($e,d,wr)}const Bt="accountHosting";function L($e){return s($e,d,Bt)}function M($e){return c($e,d,Bt)}const Ve="recordHosting";function ut($e){return s($e,d,Ve)}function vr($e){return c($e,d,Ve)}const Ho="reporterStats";function bu($e){return s($e,d,Ho)}function _n($e){return c($e,d,Ho)}const Ir="modTool";function Xo($e){return s($e,d,Ir)}function bn($e){return c($e,d,Ir)}_t.TIMELINEEVENTPLCCREATE=`${d}#timelineEventPlcCreate`,_t.TIMELINEEVENTPLCOPERATION=`${d}#timelineEventPlcOperation`,_t.TIMELINEEVENTPLCTOMBSTONE=`${d}#timelineEventPlcTombstone`;const ao="scheduledActionView";function Tr($e){return s($e,d,ao)}function Ca($e){return c($e,d,ao)}return _t}var Gb={},zL;function S9(){if(zL)return Gb;zL=1,Object.defineProperty(Gb,"__esModule",{value:!0}),Gb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Gb}var $b={},OL;function T9(){if(OL)return $b;OL=1,Object.defineProperty($b,"__esModule",{value:!0}),$b.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return $b}var Zb={},VL;function C9(){if(VL)return Zb;VL=1,Object.defineProperty(Zb,"__esModule",{value:!0}),Zb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Zb}var Hb={},UL;function k9(){if(UL)return Hb;UL=1,Object.defineProperty(Hb,"__esModule",{value:!0}),Hb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Hb}var Xb={},jL;function P9(){if(jL)return Xb;jL=1,Object.defineProperty(Xb,"__esModule",{value:!0}),Xb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Xb}var Wb={},NL;function L9(){if(NL)return Wb;NL=1,Object.defineProperty(Wb,"__esModule",{value:!0}),Wb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Wb}var Yb={},FL;function D9(){if(FL)return Yb;FL=1,Object.defineProperty(Yb,"__esModule",{value:!0}),Yb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Yb}var Jb={},qL;function I9(){if(qL)return Jb;qL=1,Object.defineProperty(Jb,"__esModule",{value:!0}),Jb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Jb}var _o={},KL;function B9(){if(KL)return _o;KL=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.toKnownErr=m,_o.isTakedown=a,_o.validateTakedown=g,_o.isSchedulingConfig=R,_o.validateSchedulingConfig=S,_o.isScheduledActionResults=k,_o.validateScheduledActionResults=B,_o.isFailedScheduling=K,_o.validateFailedScheduling=U;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.moderation.scheduleAction";function m(ee){return ee}const e="takedown";function a(ee){return s(ee,d,e)}function g(ee){return c(ee,d,e)}const w="schedulingConfig";function R(ee){return s(ee,d,w)}function S(ee){return c(ee,d,w)}const D="scheduledActionResults";function k(ee){return s(ee,d,D)}function B(ee){return c(ee,d,D)}const F="failedScheduling";function K(ee){return s(ee,d,F)}function U(ee){return c(ee,d,F)}return _o}var Qb={},GL;function M9(){if(GL)return Qb;GL=1,Object.defineProperty(Qb,"__esModule",{value:!0}),Qb.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return Qb}var zt={},$L;function z9(){if($L)return zt;$L=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.REASONSELFHARMOTHER=zt.REASONSELFHARMSUBSTANCES=zt.REASONSELFHARMSTUNTS=zt.REASONSELFHARMED=zt.REASONSELFHARMCONTENT=zt.REASONRULEOTHER=zt.REASONRULEBANEVASION=zt.REASONRULEPROHIBITEDSALES=zt.REASONRULESITESECURITY=zt.REASONMISLEADINGOTHER=zt.REASONMISLEADINGELECTIONS=zt.REASONMISLEADINGSCAM=zt.REASONMISLEADINGSPAM=zt.REASONMISLEADINGIMPERSONATION=zt.REASONMISLEADINGBOT=zt.REASONHARASSMENTOTHER=zt.REASONHARASSMENTDOXXING=zt.REASONHARASSMENTHATESPEECH=zt.REASONHARASSMENTTARGETED=zt.REASONHARASSMENTTROLL=zt.REASONCHILDSAFETYOTHER=zt.REASONCHILDSAFETYHARASSMENT=zt.REASONCHILDSAFETYPRIVACY=zt.REASONCHILDSAFETYGROOM=zt.REASONCHILDSAFETYCSAM=zt.REASONSEXUALOTHER=zt.REASONSEXUALUNLABELED=zt.REASONSEXUALANIMAL=zt.REASONSEXUALDEEPFAKE=zt.REASONSEXUALNCII=zt.REASONSEXUALABUSECONTENT=zt.REASONVIOLENCEOTHER=zt.REASONVIOLENCETRAFFICKING=zt.REASONVIOLENCEEXTREMISTCONTENT=zt.REASONVIOLENCEGLORIFICATION=zt.REASONVIOLENCEGRAPHICCONTENT=zt.REASONVIOLENCETHREATS=zt.REASONVIOLENCEANIMAL=zt.REASONOTHER=zt.REASONAPPEAL=void 0;const r=he();me().is$typed,r.validate;const s="tools.ozone.report.defs";return zt.REASONAPPEAL=`${s}#reasonAppeal`,zt.REASONOTHER=`${s}#reasonOther`,zt.REASONVIOLENCEANIMAL=`${s}#reasonViolenceAnimal`,zt.REASONVIOLENCETHREATS=`${s}#reasonViolenceThreats`,zt.REASONVIOLENCEGRAPHICCONTENT=`${s}#reasonViolenceGraphicContent`,zt.REASONVIOLENCEGLORIFICATION=`${s}#reasonViolenceGlorification`,zt.REASONVIOLENCEEXTREMISTCONTENT=`${s}#reasonViolenceExtremistContent`,zt.REASONVIOLENCETRAFFICKING=`${s}#reasonViolenceTrafficking`,zt.REASONVIOLENCEOTHER=`${s}#reasonViolenceOther`,zt.REASONSEXUALABUSECONTENT=`${s}#reasonSexualAbuseContent`,zt.REASONSEXUALNCII=`${s}#reasonSexualNCII`,zt.REASONSEXUALDEEPFAKE=`${s}#reasonSexualDeepfake`,zt.REASONSEXUALANIMAL=`${s}#reasonSexualAnimal`,zt.REASONSEXUALUNLABELED=`${s}#reasonSexualUnlabeled`,zt.REASONSEXUALOTHER=`${s}#reasonSexualOther`,zt.REASONCHILDSAFETYCSAM=`${s}#reasonChildSafetyCSAM`,zt.REASONCHILDSAFETYGROOM=`${s}#reasonChildSafetyGroom`,zt.REASONCHILDSAFETYPRIVACY=`${s}#reasonChildSafetyPrivacy`,zt.REASONCHILDSAFETYHARASSMENT=`${s}#reasonChildSafetyHarassment`,zt.REASONCHILDSAFETYOTHER=`${s}#reasonChildSafetyOther`,zt.REASONHARASSMENTTROLL=`${s}#reasonHarassmentTroll`,zt.REASONHARASSMENTTARGETED=`${s}#reasonHarassmentTargeted`,zt.REASONHARASSMENTHATESPEECH=`${s}#reasonHarassmentHateSpeech`,zt.REASONHARASSMENTDOXXING=`${s}#reasonHarassmentDoxxing`,zt.REASONHARASSMENTOTHER=`${s}#reasonHarassmentOther`,zt.REASONMISLEADINGBOT=`${s}#reasonMisleadingBot`,zt.REASONMISLEADINGIMPERSONATION=`${s}#reasonMisleadingImpersonation`,zt.REASONMISLEADINGSPAM=`${s}#reasonMisleadingSpam`,zt.REASONMISLEADINGSCAM=`${s}#reasonMisleadingScam`,zt.REASONMISLEADINGELECTIONS=`${s}#reasonMisleadingElections`,zt.REASONMISLEADINGOTHER=`${s}#reasonMisleadingOther`,zt.REASONRULESITESECURITY=`${s}#reasonRuleSiteSecurity`,zt.REASONRULEPROHIBITEDSALES=`${s}#reasonRuleProhibitedSales`,zt.REASONRULEBANEVASION=`${s}#reasonRuleBanEvasion`,zt.REASONRULEOTHER=`${s}#reasonRuleOther`,zt.REASONSELFHARMCONTENT=`${s}#reasonSelfHarmContent`,zt.REASONSELFHARMED=`${s}#reasonSelfHarmED`,zt.REASONSELFHARMSTUNTS=`${s}#reasonSelfHarmStunts`,zt.REASONSELFHARMSUBSTANCES=`${s}#reasonSelfHarmSubstances`,zt.REASONSELFHARMOTHER=`${s}#reasonSelfHarmOther`,zt}var gc={},ZL;function O9(){if(ZL)return gc;ZL=1,Object.defineProperty(gc,"__esModule",{value:!0}),gc.isEvent=e,gc.validateEvent=a,gc.isUrlRule=w,gc.validateUrlRule=R;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.safelink.defs",m="event";function e(S){return s(S,d,m)}function a(S){return c(S,d,m)}const g="urlRule";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return gc}var ev={},HL;function V9(){if(HL)return ev;HL=1,Object.defineProperty(ev,"__esModule",{value:!0}),ev.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return ev}var tv={},XL;function U9(){if(XL)return tv;XL=1,Object.defineProperty(tv,"__esModule",{value:!0}),tv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return tv}var nu={},WL;function j9(){if(WL)return nu;WL=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.toKnownErr=m,nu.isServiceConfig=a,nu.validateServiceConfig=g,nu.isViewerConfig=R,nu.validateViewerConfig=S;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.server.getConfig";function m(D){return D}const e="serviceConfig";function a(D){return s(D,d,e)}function g(D){return c(D,d,e)}const w="viewerConfig";function R(D){return s(D,d,w)}function S(D){return c(D,d,w)}return nu}var rv={},YL;function N9(){if(YL)return rv;YL=1,Object.defineProperty(rv,"__esModule",{value:!0}),rv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return rv}var _c={},JL;function F9(){if(JL)return _c;JL=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.isSet=e,_c.validateSet=a,_c.isSetView=w,_c.validateSetView=R;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.set.defs",m="set";function e(S){return s(S,d,m)}function a(S){return c(S,d,m)}const g="setView";function w(S){return s(S,d,g)}function R(S){return c(S,d,g)}return _c}var iv={},QL;function q9(){if(QL)return iv;QL=1,Object.defineProperty(iv,"__esModule",{value:!0}),iv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return iv}var nv={},eD;function K9(){if(eD)return nv;eD=1,Object.defineProperty(nv,"__esModule",{value:!0}),nv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return nv}var fm={},tD;function G9(){if(tD)return fm;tD=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.isOption=e,fm.validateOption=a;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.setting.defs",m="option";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return fm}var sv={},rD;function $9(){if(rD)return sv;rD=1,Object.defineProperty(sv,"__esModule",{value:!0}),sv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return sv}var ov={},iD;function Z9(){if(iD)return ov;iD=1,Object.defineProperty(ov,"__esModule",{value:!0}),ov.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return ov}var av={},nD;function H9(){if(nD)return av;nD=1,Object.defineProperty(av,"__esModule",{value:!0}),av.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return av}var hm={},sD;function X9(){if(sD)return hm;sD=1,Object.defineProperty(hm,"__esModule",{value:!0}),hm.isSigDetail=e,hm.validateSigDetail=a;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.signature.defs",m="sigDetail";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return hm}var lv={},oD;function W9(){if(oD)return lv;oD=1,Object.defineProperty(lv,"__esModule",{value:!0}),lv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return lv}var tf={},aD;function Y9(){if(aD)return tf;aD=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.toKnownErr=m,tf.isRelatedAccount=a,tf.validateRelatedAccount=g;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.signature.findRelatedAccounts";function m(w){return w}const e="relatedAccount";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return tf}var uv={},lD;function J9(){if(lD)return uv;lD=1,Object.defineProperty(uv,"__esModule",{value:!0}),uv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return uv}var Js={},uD;function Q9(){if(uD)return Js;uD=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.ROLEVERIFIER=Js.ROLETRIAGE=Js.ROLEMODERATOR=Js.ROLEADMIN=void 0,Js.isMember=e,Js.validateMember=a;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.team.defs",m="member";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return Js.ROLEADMIN=`${d}#roleAdmin`,Js.ROLEMODERATOR=`${d}#roleModerator`,Js.ROLETRIAGE=`${d}#roleTriage`,Js.ROLEVERIFIER=`${d}#roleVerifier`,Js}var cv={},cD;function e7(){if(cD)return cv;cD=1,Object.defineProperty(cv,"__esModule",{value:!0}),cv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return cv}var mm={},dD;function t7(){if(dD)return mm;dD=1,Object.defineProperty(mm,"__esModule",{value:!0}),mm.isVerificationView=e,mm.validateVerificationView=a;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.verification.defs",m="verificationView";function e(g){return s(g,d,m)}function a(g){return c(g,d,m)}return mm}var su={},pD;function r7(){if(pD)return su;pD=1,Object.defineProperty(su,"__esModule",{value:!0}),su.toKnownErr=m,su.isVerificationInput=a,su.validateVerificationInput=g,su.isGrantError=R,su.validateGrantError=S;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.verification.grantVerifications";function m(D){return D}const e="verificationInput";function a(D){return s(D,d,e)}function g(D){return c(D,d,e)}const w="grantError";function R(D){return s(D,d,w)}function S(D){return c(D,d,w)}return su}var dv={},fD;function i7(){if(fD)return dv;fD=1,Object.defineProperty(dv,"__esModule",{value:!0}),dv.toKnownErr=s;const r=he();me().is$typed,r.validate;function s(c){return c}return dv}var rf={},hD;function n7(){if(hD)return rf;hD=1,Object.defineProperty(rf,"__esModule",{value:!0}),rf.toKnownErr=m,rf.isRevokeError=a,rf.validateRevokeError=g;const r=he(),s=me().is$typed,c=r.validate,d="tools.ozone.verification.revokeVerifications";function m(w){return w}const e="revokeError";function a(w){return s(w,d,e)}function g(w){return c(w,d,e)}return rf}var mD;function gu(){if(mD)return O;mD=1;var r=O&&O.__createBinding||(Object.create?(function(Bt,L,M,Ve){Ve===void 0&&(Ve=M);var ut=Object.getOwnPropertyDescriptor(L,M);(!ut||("get"in ut?!L.__esModule:ut.writable||ut.configurable))&&(ut={enumerable:!0,get:function(){return L[M]}}),Object.defineProperty(Bt,Ve,ut)}):(function(Bt,L,M,Ve){Ve===void 0&&(Ve=M),Bt[Ve]=L[M]})),i=O&&O.__setModuleDefault||(Object.create?(function(Bt,L){Object.defineProperty(Bt,"default",{enumerable:!0,value:L})}):function(Bt,L){Bt.default=L}),s=O&&O.__importStar||(function(){var Bt=function(L){return Bt=Object.getOwnPropertyNames||function(M){var Ve=[];for(var ut in M)Object.prototype.hasOwnProperty.call(M,ut)&&(Ve[Ve.length]=ut);return Ve},Bt(L)};return function(L){if(L&&L.__esModule)return L;var M={};if(L!=null)for(var Ve=Bt(L),ut=0;ut<Ve.length;ut++)Ve[ut]!=="default"&&r(M,L,Ve[ut]);return i(M,L),M}})();Object.defineProperty(O,"__esModule",{value:!0}),O.AppBskyGraphGetBlocks=O.AppBskyGraphGetActorStarterPacks=O.AppBskyGraphFollow=O.AppBskyGraphDefs=O.AppBskyGraphBlock=O.AppBskyFeedThreadgate=O.AppBskyFeedSendInteractions=O.AppBskyFeedSearchPosts=O.AppBskyFeedRepost=O.AppBskyFeedPostgate=O.AppBskyFeedPost=O.AppBskyFeedLike=O.AppBskyFeedGetTimeline=O.AppBskyFeedGetSuggestedFeeds=O.AppBskyFeedGetRepostedBy=O.AppBskyFeedGetQuotes=O.AppBskyFeedGetPosts=O.AppBskyFeedGetPostThread=O.AppBskyFeedGetListFeed=O.AppBskyFeedGetLikes=O.AppBskyFeedGetFeedSkeleton=O.AppBskyFeedGetFeedGenerators=O.AppBskyFeedGetFeedGenerator=O.AppBskyFeedGetFeed=O.AppBskyFeedGetAuthorFeed=O.AppBskyFeedGetActorLikes=O.AppBskyFeedGetActorFeeds=O.AppBskyFeedGenerator=O.AppBskyFeedDescribeFeedGenerator=O.AppBskyFeedDefs=O.AppBskyEmbedVideo=O.AppBskyEmbedRecordWithMedia=O.AppBskyEmbedRecord=O.AppBskyEmbedImages=O.AppBskyEmbedExternal=O.AppBskyEmbedDefs=O.AppBskyBookmarkGetBookmarks=O.AppBskyBookmarkDeleteBookmark=O.AppBskyBookmarkDefs=O.AppBskyBookmarkCreateBookmark=O.AppBskyActorStatus=O.AppBskyActorSearchActorsTypeahead=O.AppBskyActorSearchActors=O.AppBskyActorPutPreferences=O.AppBskyActorProfile=O.AppBskyActorGetSuggestions=O.AppBskyActorGetProfiles=O.AppBskyActorGetProfile=O.AppBskyActorGetPreferences=O.AppBskyActorDefs=void 0,O.AppBskyUnspeccedGetPostThreadV2=O.AppBskyUnspeccedGetPostThreadOtherV2=O.AppBskyUnspeccedGetPopularFeedGenerators=O.AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton=O.AppBskyUnspeccedGetOnboardingSuggestedStarterPacks=O.AppBskyUnspeccedGetConfig=O.AppBskyUnspeccedGetAgeAssuranceState=O.AppBskyUnspeccedDefs=O.AppBskyRichtextFacet=O.AppBskyNotificationUpdateSeen=O.AppBskyNotificationUnregisterPush=O.AppBskyNotificationRegisterPush=O.AppBskyNotificationPutPreferencesV2=O.AppBskyNotificationPutPreferences=O.AppBskyNotificationPutActivitySubscription=O.AppBskyNotificationListNotifications=O.AppBskyNotificationListActivitySubscriptions=O.AppBskyNotificationGetUnreadCount=O.AppBskyNotificationGetPreferences=O.AppBskyNotificationDefs=O.AppBskyNotificationDeclaration=O.AppBskyLabelerService=O.AppBskyLabelerGetServices=O.AppBskyLabelerDefs=O.AppBskyGraphVerification=O.AppBskyGraphUnmuteThread=O.AppBskyGraphUnmuteActorList=O.AppBskyGraphUnmuteActor=O.AppBskyGraphStarterpack=O.AppBskyGraphSearchStarterPacks=O.AppBskyGraphMuteThread=O.AppBskyGraphMuteActorList=O.AppBskyGraphMuteActor=O.AppBskyGraphListitem=O.AppBskyGraphListblock=O.AppBskyGraphList=O.AppBskyGraphGetSuggestedFollowsByActor=O.AppBskyGraphGetStarterPacksWithMembership=O.AppBskyGraphGetStarterPacks=O.AppBskyGraphGetStarterPack=O.AppBskyGraphGetRelationships=O.AppBskyGraphGetMutes=O.AppBskyGraphGetListsWithMembership=O.AppBskyGraphGetLists=O.AppBskyGraphGetListMutes=O.AppBskyGraphGetListBlocks=O.AppBskyGraphGetList=O.AppBskyGraphGetKnownFollowers=O.AppBskyGraphGetFollows=O.AppBskyGraphGetFollowers=void 0,O.ComAtprotoAdminGetAccountInfo=O.ComAtprotoAdminEnableAccountInvites=O.ComAtprotoAdminDisableInviteCodes=O.ComAtprotoAdminDisableAccountInvites=O.ComAtprotoAdminDeleteAccount=O.ComAtprotoAdminDefs=O.ChatBskyModerationUpdateActorAccess=O.ChatBskyModerationGetMessageContext=O.ChatBskyModerationGetActorMetadata=O.ChatBskyConvoUpdateRead=O.ChatBskyConvoUpdateAllRead=O.ChatBskyConvoUnmuteConvo=O.ChatBskyConvoSendMessageBatch=O.ChatBskyConvoSendMessage=O.ChatBskyConvoRemoveReaction=O.ChatBskyConvoMuteConvo=O.ChatBskyConvoListConvos=O.ChatBskyConvoLeaveConvo=O.ChatBskyConvoGetMessages=O.ChatBskyConvoGetLog=O.ChatBskyConvoGetConvoForMembers=O.ChatBskyConvoGetConvoAvailability=O.ChatBskyConvoGetConvo=O.ChatBskyConvoDeleteMessageForSelf=O.ChatBskyConvoDefs=O.ChatBskyConvoAddReaction=O.ChatBskyConvoAcceptConvo=O.ChatBskyActorExportAccountData=O.ChatBskyActorDeleteAccount=O.ChatBskyActorDefs=O.ChatBskyActorDeclaration=O.AppBskyVideoUploadVideo=O.AppBskyVideoGetUploadLimits=O.AppBskyVideoGetJobStatus=O.AppBskyVideoDefs=O.AppBskyUnspeccedSearchStarterPacksSkeleton=O.AppBskyUnspeccedSearchPostsSkeleton=O.AppBskyUnspeccedSearchActorsSkeleton=O.AppBskyUnspeccedInitAgeAssurance=O.AppBskyUnspeccedGetTrendsSkeleton=O.AppBskyUnspeccedGetTrends=O.AppBskyUnspeccedGetTrendingTopics=O.AppBskyUnspeccedGetTaggedSuggestions=O.AppBskyUnspeccedGetSuggestionsSkeleton=O.AppBskyUnspeccedGetSuggestedUsersSkeleton=O.AppBskyUnspeccedGetSuggestedUsers=O.AppBskyUnspeccedGetSuggestedStarterPacksSkeleton=O.AppBskyUnspeccedGetSuggestedStarterPacks=O.AppBskyUnspeccedGetSuggestedFeedsSkeleton=O.AppBskyUnspeccedGetSuggestedFeeds=void 0,O.ComAtprotoServerDeleteSession=O.ComAtprotoServerDeleteAccount=O.ComAtprotoServerDefs=O.ComAtprotoServerDeactivateAccount=O.ComAtprotoServerCreateSession=O.ComAtprotoServerCreateInviteCodes=O.ComAtprotoServerCreateInviteCode=O.ComAtprotoServerCreateAppPassword=O.ComAtprotoServerCreateAccount=O.ComAtprotoServerConfirmEmail=O.ComAtprotoServerCheckAccountStatus=O.ComAtprotoServerActivateAccount=O.ComAtprotoRepoUploadBlob=O.ComAtprotoRepoStrongRef=O.ComAtprotoRepoPutRecord=O.ComAtprotoRepoListRecords=O.ComAtprotoRepoListMissingBlobs=O.ComAtprotoRepoImportRepo=O.ComAtprotoRepoGetRecord=O.ComAtprotoRepoDescribeRepo=O.ComAtprotoRepoDeleteRecord=O.ComAtprotoRepoDefs=O.ComAtprotoRepoCreateRecord=O.ComAtprotoRepoApplyWrites=O.ComAtprotoModerationDefs=O.ComAtprotoModerationCreateReport=O.ComAtprotoLexiconSchema=O.ComAtprotoLabelSubscribeLabels=O.ComAtprotoLabelQueryLabels=O.ComAtprotoLabelDefs=O.ComAtprotoIdentityUpdateHandle=O.ComAtprotoIdentitySubmitPlcOperation=O.ComAtprotoIdentitySignPlcOperation=O.ComAtprotoIdentityResolveIdentity=O.ComAtprotoIdentityResolveHandle=O.ComAtprotoIdentityResolveDid=O.ComAtprotoIdentityRequestPlcOperationSignature=O.ComAtprotoIdentityRefreshIdentity=O.ComAtprotoIdentityGetRecommendedDidCredentials=O.ComAtprotoIdentityDefs=O.ComAtprotoAdminUpdateSubjectStatus=O.ComAtprotoAdminUpdateAccountSigningKey=O.ComAtprotoAdminUpdateAccountPassword=O.ComAtprotoAdminUpdateAccountHandle=O.ComAtprotoAdminUpdateAccountEmail=O.ComAtprotoAdminSendEmail=O.ComAtprotoAdminSearchAccounts=O.ComAtprotoAdminGetSubjectStatus=O.ComAtprotoAdminGetInviteCodes=O.ComAtprotoAdminGetAccountInfos=void 0,O.ToolsOzoneModerationGetRecord=O.ToolsOzoneModerationGetEvent=O.ToolsOzoneModerationGetAccountTimeline=O.ToolsOzoneModerationEmitEvent=O.ToolsOzoneModerationDefs=O.ToolsOzoneModerationCancelScheduledActions=O.ToolsOzoneHostingGetAccountHistory=O.ToolsOzoneCommunicationUpdateTemplate=O.ToolsOzoneCommunicationListTemplates=O.ToolsOzoneCommunicationDeleteTemplate=O.ToolsOzoneCommunicationDefs=O.ToolsOzoneCommunicationCreateTemplate=O.ComAtprotoTempRevokeAccountCredentials=O.ComAtprotoTempRequestPhoneVerification=O.ComAtprotoTempFetchLabels=O.ComAtprotoTempDereferenceScope=O.ComAtprotoTempCheckSignupQueue=O.ComAtprotoTempCheckHandleAvailability=O.ComAtprotoTempAddReservedHandle=O.ComAtprotoSyncSubscribeRepos=O.ComAtprotoSyncRequestCrawl=O.ComAtprotoSyncNotifyOfUpdate=O.ComAtprotoSyncListReposByCollection=O.ComAtprotoSyncListRepos=O.ComAtprotoSyncListHosts=O.ComAtprotoSyncListBlobs=O.ComAtprotoSyncGetRepoStatus=O.ComAtprotoSyncGetRepo=O.ComAtprotoSyncGetRecord=O.ComAtprotoSyncGetLatestCommit=O.ComAtprotoSyncGetHostStatus=O.ComAtprotoSyncGetHead=O.ComAtprotoSyncGetCheckout=O.ComAtprotoSyncGetBlocks=O.ComAtprotoSyncGetBlob=O.ComAtprotoSyncDefs=O.ComAtprotoServerUpdateEmail=O.ComAtprotoServerRevokeAppPassword=O.ComAtprotoServerResetPassword=O.ComAtprotoServerReserveSigningKey=O.ComAtprotoServerRequestPasswordReset=O.ComAtprotoServerRequestEmailUpdate=O.ComAtprotoServerRequestEmailConfirmation=O.ComAtprotoServerRequestAccountDelete=O.ComAtprotoServerRefreshSession=O.ComAtprotoServerListAppPasswords=O.ComAtprotoServerGetSession=O.ComAtprotoServerGetServiceAuth=O.ComAtprotoServerGetAccountInviteCodes=O.ComAtprotoServerDescribeServer=void 0,O.AtpBaseClient=O.TOOLS_OZONE_TEAM=O.TOOLS_OZONE_REPORT=O.TOOLS_OZONE_MODERATION=O.COM_ATPROTO_MODERATION=O.APP_BSKY_GRAPH=O.APP_BSKY_FEED=O.APP_BSKY_ACTOR=O.ToolsOzoneVerificationRevokeVerifications=O.ToolsOzoneVerificationListVerifications=O.ToolsOzoneVerificationGrantVerifications=O.ToolsOzoneVerificationDefs=O.ToolsOzoneTeamUpdateMember=O.ToolsOzoneTeamListMembers=O.ToolsOzoneTeamDeleteMember=O.ToolsOzoneTeamDefs=O.ToolsOzoneTeamAddMember=O.ToolsOzoneSignatureSearchAccounts=O.ToolsOzoneSignatureFindRelatedAccounts=O.ToolsOzoneSignatureFindCorrelation=O.ToolsOzoneSignatureDefs=O.ToolsOzoneSettingUpsertOption=O.ToolsOzoneSettingRemoveOptions=O.ToolsOzoneSettingListOptions=O.ToolsOzoneSettingDefs=O.ToolsOzoneSetUpsertSet=O.ToolsOzoneSetQuerySets=O.ToolsOzoneSetGetValues=O.ToolsOzoneSetDeleteValues=O.ToolsOzoneSetDeleteSet=O.ToolsOzoneSetDefs=O.ToolsOzoneSetAddValues=O.ToolsOzoneServerGetConfig=O.ToolsOzoneSafelinkUpdateRule=O.ToolsOzoneSafelinkRemoveRule=O.ToolsOzoneSafelinkQueryRules=O.ToolsOzoneSafelinkQueryEvents=O.ToolsOzoneSafelinkDefs=O.ToolsOzoneSafelinkAddRule=O.ToolsOzoneReportDefs=O.ToolsOzoneModerationSearchRepos=O.ToolsOzoneModerationScheduleAction=O.ToolsOzoneModerationQueryStatuses=O.ToolsOzoneModerationQueryEvents=O.ToolsOzoneModerationListScheduledActions=O.ToolsOzoneModerationGetSubjects=O.ToolsOzoneModerationGetRepos=O.ToolsOzoneModerationGetReporterStats=O.ToolsOzoneModerationGetRepo=O.ToolsOzoneModerationGetRecords=void 0,O.ToolsOzoneCommunicationNS=O.ToolsOzoneNS=O.ToolsNS=O.ComAtprotoTempNS=O.ComAtprotoSyncNS=O.ComAtprotoServerNS=O.ComAtprotoRepoNS=O.ComAtprotoModerationNS=O.ComAtprotoLexiconSchemaRecord=O.ComAtprotoLexiconNS=O.ComAtprotoLabelNS=O.ComAtprotoIdentityNS=O.ComAtprotoAdminNS=O.ComAtprotoNS=O.ComNS=O.ChatBskyModerationNS=O.ChatBskyConvoNS=O.ChatBskyActorDeclarationRecord=O.ChatBskyActorNS=O.ChatBskyNS=O.ChatNS=O.AppBskyVideoNS=O.AppBskyUnspeccedNS=O.AppBskyRichtextNS=O.AppBskyNotificationDeclarationRecord=O.AppBskyNotificationNS=O.AppBskyLabelerServiceRecord=O.AppBskyLabelerNS=O.AppBskyGraphVerificationRecord=O.AppBskyGraphStarterpackRecord=O.AppBskyGraphListitemRecord=O.AppBskyGraphListblockRecord=O.AppBskyGraphListRecord=O.AppBskyGraphFollowRecord=O.AppBskyGraphBlockRecord=O.AppBskyGraphNS=O.AppBskyFeedThreadgateRecord=O.AppBskyFeedRepostRecord=O.AppBskyFeedPostgateRecord=O.AppBskyFeedPostRecord=O.AppBskyFeedLikeRecord=O.AppBskyFeedGeneratorRecord=O.AppBskyFeedNS=O.AppBskyEmbedNS=O.AppBskyBookmarkNS=O.AppBskyActorStatusRecord=O.AppBskyActorProfileRecord=O.AppBskyActorNS=O.AppBskyNS=O.AppNS=void 0,O.ToolsOzoneVerificationNS=O.ToolsOzoneTeamNS=O.ToolsOzoneSignatureNS=O.ToolsOzoneSettingNS=O.ToolsOzoneSetNS=O.ToolsOzoneServerNS=O.ToolsOzoneSafelinkNS=O.ToolsOzoneModerationNS=O.ToolsOzoneHostingNS=void 0;const c=Wt(),d=he(),m=s(US()),e=s(NS()),a=s(qS()),g=s(GS()),w=s(ZS()),R=s(XS()),S=s(YS()),D=s(QS()),k=s(tT()),B=s(iT()),F=s(sT()),K=s(aT()),U=s(uT()),ee=s(dT()),le=s(fT()),Q=s(mT()),Te=s(gT()),pe=s(bT()),_e=s(xT()),Xe=s(ET()),dt=s(RT()),He=s(TT()),et=s(kT()),rt=s(LT()),te=s(IT()),Be=s(MT()),fe=s(OT()),ye=s(UT()),nt=s(NT()),gt=s(qT()),lt=s(GT()),be=s(ZT()),Ft=s(XT()),Ut=s(YT()),Le=s(QT()),ur=s(tC()),Tt=s(iC()),tr=s(sC()),qr=s(aC()),lr=s(uC()),kr=s(dC()),Sr=s(fC()),$r=s(mC()),sr=s(gC()),br=s(bC()),nr=s(xC()),Xr=s(EC()),Vt=s(RC()),Pr=s(TC()),Ct=s(kC()),er=s(LC()),or=s(IC()),Lr=s(MC()),Jr=s(OC()),bt=s(UC()),gi=s(NC()),Oi=s(qC()),Oe=s(GC()),vt=s(ZC()),Nt=s(XC()),we=s(YC()),W=s(QC()),J=s(tk());O.AppBskyActorDefs=s($6()),O.AppBskyActorGetPreferences=s(Z6()),O.AppBskyActorGetProfile=s(H6()),O.AppBskyActorGetProfiles=s(X6()),O.AppBskyActorGetSuggestions=s(W6()),O.AppBskyActorProfile=s(Y6()),O.AppBskyActorPutPreferences=s(J6()),O.AppBskyActorSearchActors=s(Q6()),O.AppBskyActorSearchActorsTypeahead=s(eK()),O.AppBskyActorStatus=s(tK()),O.AppBskyBookmarkCreateBookmark=s(US()),O.AppBskyBookmarkDefs=s(rK()),O.AppBskyBookmarkDeleteBookmark=s(NS()),O.AppBskyBookmarkGetBookmarks=s(iK()),O.AppBskyEmbedDefs=s(nK()),O.AppBskyEmbedExternal=s(sK()),O.AppBskyEmbedImages=s(oK()),O.AppBskyEmbedRecord=s(aK()),O.AppBskyEmbedRecordWithMedia=s(lK()),O.AppBskyEmbedVideo=s(uK()),O.AppBskyFeedDefs=s(cK()),O.AppBskyFeedDescribeFeedGenerator=s(dK()),O.AppBskyFeedGenerator=s(pK()),O.AppBskyFeedGetActorFeeds=s(fK()),O.AppBskyFeedGetActorLikes=s(qS()),O.AppBskyFeedGetAuthorFeed=s(GS()),O.AppBskyFeedGetFeed=s(ZS()),O.AppBskyFeedGetFeedGenerator=s(hK()),O.AppBskyFeedGetFeedGenerators=s(mK()),O.AppBskyFeedGetFeedSkeleton=s(XS()),O.AppBskyFeedGetLikes=s(yK()),O.AppBskyFeedGetListFeed=s(YS()),O.AppBskyFeedGetPostThread=s(QS()),O.AppBskyFeedGetPosts=s(gK()),O.AppBskyFeedGetQuotes=s(_K()),O.AppBskyFeedGetRepostedBy=s(bK()),O.AppBskyFeedGetSuggestedFeeds=s(vK()),O.AppBskyFeedGetTimeline=s(xK()),O.AppBskyFeedLike=s(wK()),O.AppBskyFeedPost=s(EK()),O.AppBskyFeedPostgate=s(AK()),O.AppBskyFeedRepost=s(RK()),O.AppBskyFeedSearchPosts=s(tT()),O.AppBskyFeedSendInteractions=s(SK()),O.AppBskyFeedThreadgate=s(TK()),O.AppBskyGraphBlock=s(CK()),O.AppBskyGraphDefs=s(kK()),O.AppBskyGraphFollow=s(PK()),O.AppBskyGraphGetActorStarterPacks=s(LK()),O.AppBskyGraphGetBlocks=s(DK()),O.AppBskyGraphGetFollowers=s(IK()),O.AppBskyGraphGetFollows=s(BK()),O.AppBskyGraphGetKnownFollowers=s(MK()),O.AppBskyGraphGetList=s(zK()),O.AppBskyGraphGetListBlocks=s(OK()),O.AppBskyGraphGetListMutes=s(VK()),O.AppBskyGraphGetLists=s(UK()),O.AppBskyGraphGetListsWithMembership=s(jK()),O.AppBskyGraphGetMutes=s(NK()),O.AppBskyGraphGetRelationships=s(iT()),O.AppBskyGraphGetStarterPack=s(FK()),O.AppBskyGraphGetStarterPacks=s(qK()),O.AppBskyGraphGetStarterPacksWithMembership=s(KK()),O.AppBskyGraphGetSuggestedFollowsByActor=s(GK()),O.AppBskyGraphList=s($K()),O.AppBskyGraphListblock=s(ZK()),O.AppBskyGraphListitem=s(HK()),O.AppBskyGraphMuteActor=s(XK()),O.AppBskyGraphMuteActorList=s(WK()),O.AppBskyGraphMuteThread=s(YK()),O.AppBskyGraphSearchStarterPacks=s(JK()),O.AppBskyGraphStarterpack=s(QK()),O.AppBskyGraphUnmuteActor=s(e8()),O.AppBskyGraphUnmuteActorList=s(t8()),O.AppBskyGraphUnmuteThread=s(r8()),O.AppBskyGraphVerification=s(i8()),O.AppBskyLabelerDefs=s(n8()),O.AppBskyLabelerGetServices=s(s8()),O.AppBskyLabelerService=s(o8()),O.AppBskyNotificationDeclaration=s(a8()),O.AppBskyNotificationDefs=s(l8()),O.AppBskyNotificationGetPreferences=s(u8()),O.AppBskyNotificationGetUnreadCount=s(c8()),O.AppBskyNotificationListActivitySubscriptions=s(d8()),O.AppBskyNotificationListNotifications=s(p8()),O.AppBskyNotificationPutActivitySubscription=s(f8()),O.AppBskyNotificationPutPreferences=s(h8()),O.AppBskyNotificationPutPreferencesV2=s(m8()),O.AppBskyNotificationRegisterPush=s(y8()),O.AppBskyNotificationUnregisterPush=s(g8()),O.AppBskyNotificationUpdateSeen=s(_8()),O.AppBskyRichtextFacet=s(b8()),O.AppBskyUnspeccedDefs=s(v8()),O.AppBskyUnspeccedGetAgeAssuranceState=s(x8()),O.AppBskyUnspeccedGetConfig=s(w8()),O.AppBskyUnspeccedGetOnboardingSuggestedStarterPacks=s(E8()),O.AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton=s(A8()),O.AppBskyUnspeccedGetPopularFeedGenerators=s(R8()),O.AppBskyUnspeccedGetPostThreadOtherV2=s(S8()),O.AppBskyUnspeccedGetPostThreadV2=s(T8()),O.AppBskyUnspeccedGetSuggestedFeeds=s(C8()),O.AppBskyUnspeccedGetSuggestedFeedsSkeleton=s(k8()),O.AppBskyUnspeccedGetSuggestedStarterPacks=s(P8()),O.AppBskyUnspeccedGetSuggestedStarterPacksSkeleton=s(L8()),O.AppBskyUnspeccedGetSuggestedUsers=s(D8()),O.AppBskyUnspeccedGetSuggestedUsersSkeleton=s(I8()),O.AppBskyUnspeccedGetSuggestionsSkeleton=s(B8()),O.AppBskyUnspeccedGetTaggedSuggestions=s(M8()),O.AppBskyUnspeccedGetTrendingTopics=s(z8()),O.AppBskyUnspeccedGetTrends=s(O8()),O.AppBskyUnspeccedGetTrendsSkeleton=s(V8()),O.AppBskyUnspeccedInitAgeAssurance=s(sT()),O.AppBskyUnspeccedSearchActorsSkeleton=s(aT()),O.AppBskyUnspeccedSearchPostsSkeleton=s(uT()),O.AppBskyUnspeccedSearchStarterPacksSkeleton=s(dT()),O.AppBskyVideoDefs=s(U8()),O.AppBskyVideoGetJobStatus=s(j8()),O.AppBskyVideoGetUploadLimits=s(N8()),O.AppBskyVideoUploadVideo=s(F8()),O.ChatBskyActorDeclaration=s(q8()),O.ChatBskyActorDefs=s(K8()),O.ChatBskyActorDeleteAccount=s(G8()),O.ChatBskyActorExportAccountData=s($8()),O.ChatBskyConvoAcceptConvo=s(Z8()),O.ChatBskyConvoAddReaction=s(fT()),O.ChatBskyConvoDefs=s(H8()),O.ChatBskyConvoDeleteMessageForSelf=s(X8()),O.ChatBskyConvoGetConvo=s(W8()),O.ChatBskyConvoGetConvoAvailability=s(Y8()),O.ChatBskyConvoGetConvoForMembers=s(J8()),O.ChatBskyConvoGetLog=s(Q8()),O.ChatBskyConvoGetMessages=s(eG()),O.ChatBskyConvoLeaveConvo=s(tG()),O.ChatBskyConvoListConvos=s(rG()),O.ChatBskyConvoMuteConvo=s(iG()),O.ChatBskyConvoRemoveReaction=s(mT()),O.ChatBskyConvoSendMessage=s(nG()),O.ChatBskyConvoSendMessageBatch=s(sG()),O.ChatBskyConvoUnmuteConvo=s(oG()),O.ChatBskyConvoUpdateAllRead=s(aG()),O.ChatBskyConvoUpdateRead=s(lG()),O.ChatBskyModerationGetActorMetadata=s(uG()),O.ChatBskyModerationGetMessageContext=s(cG()),O.ChatBskyModerationUpdateActorAccess=s(dG()),O.ComAtprotoAdminDefs=s(pG()),O.ComAtprotoAdminDeleteAccount=s(fG()),O.ComAtprotoAdminDisableAccountInvites=s(hG()),O.ComAtprotoAdminDisableInviteCodes=s(mG()),O.ComAtprotoAdminEnableAccountInvites=s(yG()),O.ComAtprotoAdminGetAccountInfo=s(gG()),O.ComAtprotoAdminGetAccountInfos=s(_G()),O.ComAtprotoAdminGetInviteCodes=s(bG()),O.ComAtprotoAdminGetSubjectStatus=s(vG()),O.ComAtprotoAdminSearchAccounts=s(xG()),O.ComAtprotoAdminSendEmail=s(wG()),O.ComAtprotoAdminUpdateAccountEmail=s(EG()),O.ComAtprotoAdminUpdateAccountHandle=s(AG()),O.ComAtprotoAdminUpdateAccountPassword=s(RG()),O.ComAtprotoAdminUpdateAccountSigningKey=s(SG()),O.ComAtprotoAdminUpdateSubjectStatus=s(TG()),O.ComAtprotoIdentityDefs=s(CG()),O.ComAtprotoIdentityGetRecommendedDidCredentials=s(kG()),O.ComAtprotoIdentityRefreshIdentity=s(gT()),O.ComAtprotoIdentityRequestPlcOperationSignature=s(PG()),O.ComAtprotoIdentityResolveDid=s(bT()),O.ComAtprotoIdentityResolveHandle=s(xT()),O.ComAtprotoIdentityResolveIdentity=s(ET()),O.ComAtprotoIdentitySignPlcOperation=s(LG()),O.ComAtprotoIdentitySubmitPlcOperation=s(DG()),O.ComAtprotoIdentityUpdateHandle=s(IG()),O.ComAtprotoLabelDefs=s(BG()),O.ComAtprotoLabelQueryLabels=s(MG()),O.ComAtprotoLabelSubscribeLabels=s(zG()),O.ComAtprotoLexiconSchema=s(OG()),O.ComAtprotoModerationCreateReport=s(VG()),O.ComAtprotoModerationDefs=s(UG()),O.ComAtprotoRepoApplyWrites=s(RT()),O.ComAtprotoRepoCreateRecord=s(TT()),O.ComAtprotoRepoDefs=s(jG()),O.ComAtprotoRepoDeleteRecord=s(kT()),O.ComAtprotoRepoDescribeRepo=s(NG()),O.ComAtprotoRepoGetRecord=s(LT()),O.ComAtprotoRepoImportRepo=s(FG()),O.ComAtprotoRepoListMissingBlobs=s(qG()),O.ComAtprotoRepoListRecords=s(KG()),O.ComAtprotoRepoPutRecord=s(IT()),O.ComAtprotoRepoStrongRef=s(GG()),O.ComAtprotoRepoUploadBlob=s($G()),O.ComAtprotoServerActivateAccount=s(ZG()),O.ComAtprotoServerCheckAccountStatus=s(HG()),O.ComAtprotoServerConfirmEmail=s(MT()),O.ComAtprotoServerCreateAccount=s(OT()),O.ComAtprotoServerCreateAppPassword=s(UT()),O.ComAtprotoServerCreateInviteCode=s(XG()),O.ComAtprotoServerCreateInviteCodes=s(WG()),O.ComAtprotoServerCreateSession=s(NT()),O.ComAtprotoServerDeactivateAccount=s(YG()),O.ComAtprotoServerDefs=s(JG()),O.ComAtprotoServerDeleteAccount=s(qT()),O.ComAtprotoServerDeleteSession=s(QG()),O.ComAtprotoServerDescribeServer=s(e9()),O.ComAtprotoServerGetAccountInviteCodes=s(GT()),O.ComAtprotoServerGetServiceAuth=s(ZT()),O.ComAtprotoServerGetSession=s(t9()),O.ComAtprotoServerListAppPasswords=s(XT()),O.ComAtprotoServerRefreshSession=s(YT()),O.ComAtprotoServerRequestAccountDelete=s(r9()),O.ComAtprotoServerRequestEmailConfirmation=s(i9()),O.ComAtprotoServerRequestEmailUpdate=s(n9()),O.ComAtprotoServerRequestPasswordReset=s(s9()),O.ComAtprotoServerReserveSigningKey=s(o9()),O.ComAtprotoServerResetPassword=s(QT()),O.ComAtprotoServerRevokeAppPassword=s(a9()),O.ComAtprotoServerUpdateEmail=s(tC()),O.ComAtprotoSyncDefs=s(l9()),O.ComAtprotoSyncGetBlob=s(iC()),O.ComAtprotoSyncGetBlocks=s(sC()),O.ComAtprotoSyncGetCheckout=s(u9()),O.ComAtprotoSyncGetHead=s(aC()),O.ComAtprotoSyncGetHostStatus=s(uC()),O.ComAtprotoSyncGetLatestCommit=s(dC()),O.ComAtprotoSyncGetRecord=s(fC()),O.ComAtprotoSyncGetRepo=s(mC()),O.ComAtprotoSyncGetRepoStatus=s(gC()),O.ComAtprotoSyncListBlobs=s(bC()),O.ComAtprotoSyncListHosts=s(c9()),O.ComAtprotoSyncListRepos=s(d9()),O.ComAtprotoSyncListReposByCollection=s(p9()),O.ComAtprotoSyncNotifyOfUpdate=s(f9()),O.ComAtprotoSyncRequestCrawl=s(xC()),O.ComAtprotoSyncSubscribeRepos=s(h9()),O.ComAtprotoTempAddReservedHandle=s(m9()),O.ComAtprotoTempCheckHandleAvailability=s(EC()),O.ComAtprotoTempCheckSignupQueue=s(y9()),O.ComAtprotoTempDereferenceScope=s(RC()),O.ComAtprotoTempFetchLabels=s(g9()),O.ComAtprotoTempRequestPhoneVerification=s(_9()),O.ComAtprotoTempRevokeAccountCredentials=s(b9()),O.ToolsOzoneCommunicationCreateTemplate=s(TC()),O.ToolsOzoneCommunicationDefs=s(v9()),O.ToolsOzoneCommunicationDeleteTemplate=s(x9()),O.ToolsOzoneCommunicationListTemplates=s(w9()),O.ToolsOzoneCommunicationUpdateTemplate=s(kC()),O.ToolsOzoneHostingGetAccountHistory=s(E9()),O.ToolsOzoneModerationCancelScheduledActions=s(A9()),O.ToolsOzoneModerationDefs=s(R9()),O.ToolsOzoneModerationEmitEvent=s(LC()),O.ToolsOzoneModerationGetAccountTimeline=s(IC()),O.ToolsOzoneModerationGetEvent=s(S9()),O.ToolsOzoneModerationGetRecord=s(MC()),O.ToolsOzoneModerationGetRecords=s(T9()),O.ToolsOzoneModerationGetRepo=s(OC()),O.ToolsOzoneModerationGetReporterStats=s(C9()),O.ToolsOzoneModerationGetRepos=s(k9()),O.ToolsOzoneModerationGetSubjects=s(P9()),O.ToolsOzoneModerationListScheduledActions=s(L9()),O.ToolsOzoneModerationQueryEvents=s(D9()),O.ToolsOzoneModerationQueryStatuses=s(I9()),O.ToolsOzoneModerationScheduleAction=s(B9()),O.ToolsOzoneModerationSearchRepos=s(M9()),O.ToolsOzoneReportDefs=s(z9()),O.ToolsOzoneSafelinkAddRule=s(UC()),O.ToolsOzoneSafelinkDefs=s(O9()),O.ToolsOzoneSafelinkQueryEvents=s(V9()),O.ToolsOzoneSafelinkQueryRules=s(U9()),O.ToolsOzoneSafelinkRemoveRule=s(NC()),O.ToolsOzoneSafelinkUpdateRule=s(qC()),O.ToolsOzoneServerGetConfig=s(j9()),O.ToolsOzoneSetAddValues=s(N9()),O.ToolsOzoneSetDefs=s(F9()),O.ToolsOzoneSetDeleteSet=s(GC()),O.ToolsOzoneSetDeleteValues=s(ZC()),O.ToolsOzoneSetGetValues=s(XC()),O.ToolsOzoneSetQuerySets=s(q9()),O.ToolsOzoneSetUpsertSet=s(K9()),O.ToolsOzoneSettingDefs=s(G9()),O.ToolsOzoneSettingListOptions=s($9()),O.ToolsOzoneSettingRemoveOptions=s(Z9()),O.ToolsOzoneSettingUpsertOption=s(H9()),O.ToolsOzoneSignatureDefs=s(X9()),O.ToolsOzoneSignatureFindCorrelation=s(W9()),O.ToolsOzoneSignatureFindRelatedAccounts=s(Y9()),O.ToolsOzoneSignatureSearchAccounts=s(J9()),O.ToolsOzoneTeamAddMember=s(YC()),O.ToolsOzoneTeamDefs=s(Q9()),O.ToolsOzoneTeamDeleteMember=s(QC()),O.ToolsOzoneTeamListMembers=s(e7()),O.ToolsOzoneTeamUpdateMember=s(tk()),O.ToolsOzoneVerificationDefs=s(t7()),O.ToolsOzoneVerificationGrantVerifications=s(r7()),O.ToolsOzoneVerificationListVerifications=s(i7()),O.ToolsOzoneVerificationRevokeVerifications=s(n7()),O.APP_BSKY_ACTOR={StatusLive:"app.bsky.actor.status#live"},O.APP_BSKY_FEED={DefsRequestLess:"app.bsky.feed.defs#requestLess",DefsRequestMore:"app.bsky.feed.defs#requestMore",DefsClickthroughItem:"app.bsky.feed.defs#clickthroughItem",DefsClickthroughAuthor:"app.bsky.feed.defs#clickthroughAuthor",DefsClickthroughReposter:"app.bsky.feed.defs#clickthroughReposter",DefsClickthroughEmbed:"app.bsky.feed.defs#clickthroughEmbed",DefsContentModeUnspecified:"app.bsky.feed.defs#contentModeUnspecified",DefsContentModeVideo:"app.bsky.feed.defs#contentModeVideo",DefsInteractionSeen:"app.bsky.feed.defs#interactionSeen",DefsInteractionLike:"app.bsky.feed.defs#interactionLike",DefsInteractionRepost:"app.bsky.feed.defs#interactionRepost",DefsInteractionReply:"app.bsky.feed.defs#interactionReply",DefsInteractionQuote:"app.bsky.feed.defs#interactionQuote",DefsInteractionShare:"app.bsky.feed.defs#interactionShare"},O.APP_BSKY_GRAPH={DefsModlist:"app.bsky.graph.defs#modlist",DefsCuratelist:"app.bsky.graph.defs#curatelist",DefsReferencelist:"app.bsky.graph.defs#referencelist"},O.COM_ATPROTO_MODERATION={DefsReasonSpam:"com.atproto.moderation.defs#reasonSpam",DefsReasonViolation:"com.atproto.moderation.defs#reasonViolation",DefsReasonMisleading:"com.atproto.moderation.defs#reasonMisleading",DefsReasonSexual:"com.atproto.moderation.defs#reasonSexual",DefsReasonRude:"com.atproto.moderation.defs#reasonRude",DefsReasonOther:"com.atproto.moderation.defs#reasonOther",DefsReasonAppeal:"com.atproto.moderation.defs#reasonAppeal"},O.TOOLS_OZONE_MODERATION={DefsReviewOpen:"tools.ozone.moderation.defs#reviewOpen",DefsReviewEscalated:"tools.ozone.moderation.defs#reviewEscalated",DefsReviewClosed:"tools.ozone.moderation.defs#reviewClosed",DefsReviewNone:"tools.ozone.moderation.defs#reviewNone",DefsTimelineEventPlcCreate:"tools.ozone.moderation.defs#timelineEventPlcCreate",DefsTimelineEventPlcOperation:"tools.ozone.moderation.defs#timelineEventPlcOperation",DefsTimelineEventPlcTombstone:"tools.ozone.moderation.defs#timelineEventPlcTombstone"},O.TOOLS_OZONE_REPORT={DefsReasonAppeal:"tools.ozone.report.defs#reasonAppeal",DefsReasonOther:"tools.ozone.report.defs#reasonOther",DefsReasonViolenceAnimal:"tools.ozone.report.defs#reasonViolenceAnimal",DefsReasonViolenceThreats:"tools.ozone.report.defs#reasonViolenceThreats",DefsReasonViolenceGraphicContent:"tools.ozone.report.defs#reasonViolenceGraphicContent",DefsReasonViolenceGlorification:"tools.ozone.report.defs#reasonViolenceGlorification",DefsReasonViolenceExtremistContent:"tools.ozone.report.defs#reasonViolenceExtremistContent",DefsReasonViolenceTrafficking:"tools.ozone.report.defs#reasonViolenceTrafficking",DefsReasonViolenceOther:"tools.ozone.report.defs#reasonViolenceOther",DefsReasonSexualAbuseContent:"tools.ozone.report.defs#reasonSexualAbuseContent",DefsReasonSexualNCII:"tools.ozone.report.defs#reasonSexualNCII",DefsReasonSexualDeepfake:"tools.ozone.report.defs#reasonSexualDeepfake",DefsReasonSexualAnimal:"tools.ozone.report.defs#reasonSexualAnimal",DefsReasonSexualUnlabeled:"tools.ozone.report.defs#reasonSexualUnlabeled",DefsReasonSexualOther:"tools.ozone.report.defs#reasonSexualOther",DefsReasonChildSafetyCSAM:"tools.ozone.report.defs#reasonChildSafetyCSAM",DefsReasonChildSafetyGroom:"tools.ozone.report.defs#reasonChildSafetyGroom",DefsReasonChildSafetyPrivacy:"tools.ozone.report.defs#reasonChildSafetyPrivacy",DefsReasonChildSafetyHarassment:"tools.ozone.report.defs#reasonChildSafetyHarassment",DefsReasonChildSafetyOther:"tools.ozone.report.defs#reasonChildSafetyOther",DefsReasonHarassmentTroll:"tools.ozone.report.defs#reasonHarassmentTroll",DefsReasonHarassmentTargeted:"tools.ozone.report.defs#reasonHarassmentTargeted",DefsReasonHarassmentHateSpeech:"tools.ozone.report.defs#reasonHarassmentHateSpeech",DefsReasonHarassmentDoxxing:"tools.ozone.report.defs#reasonHarassmentDoxxing",DefsReasonHarassmentOther:"tools.ozone.report.defs#reasonHarassmentOther",DefsReasonMisleadingBot:"tools.ozone.report.defs#reasonMisleadingBot",DefsReasonMisleadingImpersonation:"tools.ozone.report.defs#reasonMisleadingImpersonation",DefsReasonMisleadingSpam:"tools.ozone.report.defs#reasonMisleadingSpam",DefsReasonMisleadingScam:"tools.ozone.report.defs#reasonMisleadingScam",DefsReasonMisleadingElections:"tools.ozone.report.defs#reasonMisleadingElections",DefsReasonMisleadingOther:"tools.ozone.report.defs#reasonMisleadingOther",DefsReasonRuleSiteSecurity:"tools.ozone.report.defs#reasonRuleSiteSecurity",DefsReasonRuleProhibitedSales:"tools.ozone.report.defs#reasonRuleProhibitedSales",DefsReasonRuleBanEvasion:"tools.ozone.report.defs#reasonRuleBanEvasion",DefsReasonRuleOther:"tools.ozone.report.defs#reasonRuleOther",DefsReasonSelfHarmContent:"tools.ozone.report.defs#reasonSelfHarmContent",DefsReasonSelfHarmED:"tools.ozone.report.defs#reasonSelfHarmED",DefsReasonSelfHarmStunts:"tools.ozone.report.defs#reasonSelfHarmStunts",DefsReasonSelfHarmSubstances:"tools.ozone.report.defs#reasonSelfHarmSubstances",DefsReasonSelfHarmOther:"tools.ozone.report.defs#reasonSelfHarmOther"},O.TOOLS_OZONE_TEAM={DefsRoleAdmin:"tools.ozone.team.defs#roleAdmin",DefsRoleModerator:"tools.ozone.team.defs#roleModerator",DefsRoleTriage:"tools.ozone.team.defs#roleTriage",DefsRoleVerifier:"tools.ozone.team.defs#roleVerifier"};class se extends c.XrpcClient{constructor(L){super(L,d.schemas),Object.defineProperty(this,"app",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"com",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.app=new ve(this),this.chat=new cr(this),this.com=new ss(this),this.tools=new j(this)}get xrpc(){return this}}O.AtpBaseClient=se;class ve{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bsky",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.bsky=new Se(L)}}O.AppNS=ve;class Se{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"actor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bookmark",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"embed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"feed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"labeler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"notification",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"richtext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"unspecced",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"video",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.actor=new je(L),this.bookmark=new Qe(L),this.embed=new mt(L),this.feed=new Ze(L),this.graph=new gr(L),this.labeler=new pt(L),this.notification=new Di(L),this.richtext=new at(L),this.unspecced=new At(L),this.video=new _r(L)}}O.AppBskyNS=Se;class je{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"profile",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.profile=new Ge(L),this.status=new Ne(L)}getPreferences(L,M){return this._client.call("app.bsky.actor.getPreferences",L,void 0,M)}getProfile(L,M){return this._client.call("app.bsky.actor.getProfile",L,void 0,M)}getProfiles(L,M){return this._client.call("app.bsky.actor.getProfiles",L,void 0,M)}getSuggestions(L,M){return this._client.call("app.bsky.actor.getSuggestions",L,void 0,M)}putPreferences(L,M){return this._client.call("app.bsky.actor.putPreferences",M?.qp,L,M)}searchActors(L,M){return this._client.call("app.bsky.actor.searchActors",L,void 0,M)}searchActorsTypeahead(L,M){return this._client.call("app.bsky.actor.searchActorsTypeahead",L,void 0,M)}}O.AppBskyActorNS=je;class Ge{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.actor.profile",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.actor.profile",...L})).data}async create(L,M,Ve){const ut="app.bsky.actor.profile";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.actor.profile";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.actor.profile",...L},{headers:M})}}O.AppBskyActorProfileRecord=Ge;class Ne{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.actor.status",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.actor.status",...L})).data}async create(L,M,Ve){const ut="app.bsky.actor.status";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.actor.status";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.actor.status",...L},{headers:M})}}O.AppBskyActorStatusRecord=Ne;class Qe{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}createBookmark(L,M){return this._client.call("app.bsky.bookmark.createBookmark",M?.qp,L,M).catch(Ve=>{throw m.toKnownErr(Ve)})}deleteBookmark(L,M){return this._client.call("app.bsky.bookmark.deleteBookmark",M?.qp,L,M).catch(Ve=>{throw e.toKnownErr(Ve)})}getBookmarks(L,M){return this._client.call("app.bsky.bookmark.getBookmarks",L,void 0,M)}}O.AppBskyBookmarkNS=Qe;class mt{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}}O.AppBskyEmbedNS=mt;class Ze{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"like",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"postgate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repost",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"threadgate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.generator=new Mt(L),this.like=new qt(L),this.post=new Ke(L),this.postgate=new yr(L),this.repost=new Dr(L),this.threadgate=new Ot(L)}describeFeedGenerator(L,M){return this._client.call("app.bsky.feed.describeFeedGenerator",L,void 0,M)}getActorFeeds(L,M){return this._client.call("app.bsky.feed.getActorFeeds",L,void 0,M)}getActorLikes(L,M){return this._client.call("app.bsky.feed.getActorLikes",L,void 0,M).catch(Ve=>{throw a.toKnownErr(Ve)})}getAuthorFeed(L,M){return this._client.call("app.bsky.feed.getAuthorFeed",L,void 0,M).catch(Ve=>{throw g.toKnownErr(Ve)})}getFeed(L,M){return this._client.call("app.bsky.feed.getFeed",L,void 0,M).catch(Ve=>{throw w.toKnownErr(Ve)})}getFeedGenerator(L,M){return this._client.call("app.bsky.feed.getFeedGenerator",L,void 0,M)}getFeedGenerators(L,M){return this._client.call("app.bsky.feed.getFeedGenerators",L,void 0,M)}getFeedSkeleton(L,M){return this._client.call("app.bsky.feed.getFeedSkeleton",L,void 0,M).catch(Ve=>{throw R.toKnownErr(Ve)})}getLikes(L,M){return this._client.call("app.bsky.feed.getLikes",L,void 0,M)}getListFeed(L,M){return this._client.call("app.bsky.feed.getListFeed",L,void 0,M).catch(Ve=>{throw S.toKnownErr(Ve)})}getPostThread(L,M){return this._client.call("app.bsky.feed.getPostThread",L,void 0,M).catch(Ve=>{throw D.toKnownErr(Ve)})}getPosts(L,M){return this._client.call("app.bsky.feed.getPosts",L,void 0,M)}getQuotes(L,M){return this._client.call("app.bsky.feed.getQuotes",L,void 0,M)}getRepostedBy(L,M){return this._client.call("app.bsky.feed.getRepostedBy",L,void 0,M)}getSuggestedFeeds(L,M){return this._client.call("app.bsky.feed.getSuggestedFeeds",L,void 0,M)}getTimeline(L,M){return this._client.call("app.bsky.feed.getTimeline",L,void 0,M)}searchPosts(L,M){return this._client.call("app.bsky.feed.searchPosts",L,void 0,M).catch(Ve=>{throw k.toKnownErr(Ve)})}sendInteractions(L,M){return this._client.call("app.bsky.feed.sendInteractions",M?.qp,L,M)}}O.AppBskyFeedNS=Ze;class Mt{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.generator",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.generator",...L})).data}async create(L,M,Ve){const ut="app.bsky.feed.generator";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.feed.generator";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.generator",...L},{headers:M})}}O.AppBskyFeedGeneratorRecord=Mt;class qt{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.like",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.like",...L})).data}async create(L,M,Ve){const ut="app.bsky.feed.like";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.feed.like";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.like",...L},{headers:M})}}O.AppBskyFeedLikeRecord=qt;class Ke{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.post",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.post",...L})).data}async create(L,M,Ve){const ut="app.bsky.feed.post";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.feed.post";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.post",...L},{headers:M})}}O.AppBskyFeedPostRecord=Ke;class yr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.postgate",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.postgate",...L})).data}async create(L,M,Ve){const ut="app.bsky.feed.postgate";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.feed.postgate";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.postgate",...L},{headers:M})}}O.AppBskyFeedPostgateRecord=yr;class Dr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.repost",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.repost",...L})).data}async create(L,M,Ve){const ut="app.bsky.feed.repost";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.feed.repost";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.repost",...L},{headers:M})}}O.AppBskyFeedRepostRecord=Dr;class Ot{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.threadgate",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.threadgate",...L})).data}async create(L,M,Ve){const ut="app.bsky.feed.threadgate";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.feed.threadgate";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.threadgate",...L},{headers:M})}}O.AppBskyFeedThreadgateRecord=Ot;class gr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"block",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"follow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"listblock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"listitem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"starterpack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verification",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.block=new pi(L),this.follow=new fi(L),this.list=new ti(L),this.listblock=new _i(L),this.listitem=new Kr(L),this.starterpack=new oi(L),this.verification=new Mr(L)}getActorStarterPacks(L,M){return this._client.call("app.bsky.graph.getActorStarterPacks",L,void 0,M)}getBlocks(L,M){return this._client.call("app.bsky.graph.getBlocks",L,void 0,M)}getFollowers(L,M){return this._client.call("app.bsky.graph.getFollowers",L,void 0,M)}getFollows(L,M){return this._client.call("app.bsky.graph.getFollows",L,void 0,M)}getKnownFollowers(L,M){return this._client.call("app.bsky.graph.getKnownFollowers",L,void 0,M)}getList(L,M){return this._client.call("app.bsky.graph.getList",L,void 0,M)}getListBlocks(L,M){return this._client.call("app.bsky.graph.getListBlocks",L,void 0,M)}getListMutes(L,M){return this._client.call("app.bsky.graph.getListMutes",L,void 0,M)}getLists(L,M){return this._client.call("app.bsky.graph.getLists",L,void 0,M)}getListsWithMembership(L,M){return this._client.call("app.bsky.graph.getListsWithMembership",L,void 0,M)}getMutes(L,M){return this._client.call("app.bsky.graph.getMutes",L,void 0,M)}getRelationships(L,M){return this._client.call("app.bsky.graph.getRelationships",L,void 0,M).catch(Ve=>{throw B.toKnownErr(Ve)})}getStarterPack(L,M){return this._client.call("app.bsky.graph.getStarterPack",L,void 0,M)}getStarterPacks(L,M){return this._client.call("app.bsky.graph.getStarterPacks",L,void 0,M)}getStarterPacksWithMembership(L,M){return this._client.call("app.bsky.graph.getStarterPacksWithMembership",L,void 0,M)}getSuggestedFollowsByActor(L,M){return this._client.call("app.bsky.graph.getSuggestedFollowsByActor",L,void 0,M)}muteActor(L,M){return this._client.call("app.bsky.graph.muteActor",M?.qp,L,M)}muteActorList(L,M){return this._client.call("app.bsky.graph.muteActorList",M?.qp,L,M)}muteThread(L,M){return this._client.call("app.bsky.graph.muteThread",M?.qp,L,M)}searchStarterPacks(L,M){return this._client.call("app.bsky.graph.searchStarterPacks",L,void 0,M)}unmuteActor(L,M){return this._client.call("app.bsky.graph.unmuteActor",M?.qp,L,M)}unmuteActorList(L,M){return this._client.call("app.bsky.graph.unmuteActorList",M?.qp,L,M)}unmuteThread(L,M){return this._client.call("app.bsky.graph.unmuteThread",M?.qp,L,M)}}O.AppBskyGraphNS=gr;class pi{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.block",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.block",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.block";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.block";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.block",...L},{headers:M})}}O.AppBskyGraphBlockRecord=pi;class fi{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.follow",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.follow",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.follow";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.follow";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.follow",...L},{headers:M})}}O.AppBskyGraphFollowRecord=fi;class ti{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.list",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.list",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.list";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.list";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.list",...L},{headers:M})}}O.AppBskyGraphListRecord=ti;class _i{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.listblock",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.listblock",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.listblock";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.listblock";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.listblock",...L},{headers:M})}}O.AppBskyGraphListblockRecord=_i;class Kr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.listitem",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.listitem",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.listitem";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.listitem";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.listitem",...L},{headers:M})}}O.AppBskyGraphListitemRecord=Kr;class oi{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.starterpack",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.starterpack",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.starterpack";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.starterpack";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.starterpack",...L},{headers:M})}}O.AppBskyGraphStarterpackRecord=oi;class Mr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.verification",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.verification",...L})).data}async create(L,M,Ve){const ut="app.bsky.graph.verification";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.graph.verification";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.verification",...L},{headers:M})}}O.AppBskyGraphVerificationRecord=Mr;class pt{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"service",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.service=new Vi(L)}getServices(L,M){return this._client.call("app.bsky.labeler.getServices",L,void 0,M)}}O.AppBskyLabelerNS=pt;class Vi{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.labeler.service",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.labeler.service",...L})).data}async create(L,M,Ve){const ut="app.bsky.labeler.service";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.labeler.service";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.labeler.service",...L},{headers:M})}}O.AppBskyLabelerServiceRecord=Vi;class Di{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"declaration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.declaration=new Ii(L)}getPreferences(L,M){return this._client.call("app.bsky.notification.getPreferences",L,void 0,M)}getUnreadCount(L,M){return this._client.call("app.bsky.notification.getUnreadCount",L,void 0,M)}listActivitySubscriptions(L,M){return this._client.call("app.bsky.notification.listActivitySubscriptions",L,void 0,M)}listNotifications(L,M){return this._client.call("app.bsky.notification.listNotifications",L,void 0,M)}putActivitySubscription(L,M){return this._client.call("app.bsky.notification.putActivitySubscription",M?.qp,L,M)}putPreferences(L,M){return this._client.call("app.bsky.notification.putPreferences",M?.qp,L,M)}putPreferencesV2(L,M){return this._client.call("app.bsky.notification.putPreferencesV2",M?.qp,L,M)}registerPush(L,M){return this._client.call("app.bsky.notification.registerPush",M?.qp,L,M)}unregisterPush(L,M){return this._client.call("app.bsky.notification.unregisterPush",M?.qp,L,M)}updateSeen(L,M){return this._client.call("app.bsky.notification.updateSeen",M?.qp,L,M)}}O.AppBskyNotificationNS=Di;class Ii{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.notification.declaration",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.notification.declaration",...L})).data}async create(L,M,Ve){const ut="app.bsky.notification.declaration";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="app.bsky.notification.declaration";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.notification.declaration",...L},{headers:M})}}O.AppBskyNotificationDeclarationRecord=Ii;class at{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}}O.AppBskyRichtextNS=at;class At{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getAgeAssuranceState(L,M){return this._client.call("app.bsky.unspecced.getAgeAssuranceState",L,void 0,M)}getConfig(L,M){return this._client.call("app.bsky.unspecced.getConfig",L,void 0,M)}getOnboardingSuggestedStarterPacks(L,M){return this._client.call("app.bsky.unspecced.getOnboardingSuggestedStarterPacks",L,void 0,M)}getOnboardingSuggestedStarterPacksSkeleton(L,M){return this._client.call("app.bsky.unspecced.getOnboardingSuggestedStarterPacksSkeleton",L,void 0,M)}getPopularFeedGenerators(L,M){return this._client.call("app.bsky.unspecced.getPopularFeedGenerators",L,void 0,M)}getPostThreadOtherV2(L,M){return this._client.call("app.bsky.unspecced.getPostThreadOtherV2",L,void 0,M)}getPostThreadV2(L,M){return this._client.call("app.bsky.unspecced.getPostThreadV2",L,void 0,M)}getSuggestedFeeds(L,M){return this._client.call("app.bsky.unspecced.getSuggestedFeeds",L,void 0,M)}getSuggestedFeedsSkeleton(L,M){return this._client.call("app.bsky.unspecced.getSuggestedFeedsSkeleton",L,void 0,M)}getSuggestedStarterPacks(L,M){return this._client.call("app.bsky.unspecced.getSuggestedStarterPacks",L,void 0,M)}getSuggestedStarterPacksSkeleton(L,M){return this._client.call("app.bsky.unspecced.getSuggestedStarterPacksSkeleton",L,void 0,M)}getSuggestedUsers(L,M){return this._client.call("app.bsky.unspecced.getSuggestedUsers",L,void 0,M)}getSuggestedUsersSkeleton(L,M){return this._client.call("app.bsky.unspecced.getSuggestedUsersSkeleton",L,void 0,M)}getSuggestionsSkeleton(L,M){return this._client.call("app.bsky.unspecced.getSuggestionsSkeleton",L,void 0,M)}getTaggedSuggestions(L,M){return this._client.call("app.bsky.unspecced.getTaggedSuggestions",L,void 0,M)}getTrendingTopics(L,M){return this._client.call("app.bsky.unspecced.getTrendingTopics",L,void 0,M)}getTrends(L,M){return this._client.call("app.bsky.unspecced.getTrends",L,void 0,M)}getTrendsSkeleton(L,M){return this._client.call("app.bsky.unspecced.getTrendsSkeleton",L,void 0,M)}initAgeAssurance(L,M){return this._client.call("app.bsky.unspecced.initAgeAssurance",M?.qp,L,M).catch(Ve=>{throw F.toKnownErr(Ve)})}searchActorsSkeleton(L,M){return this._client.call("app.bsky.unspecced.searchActorsSkeleton",L,void 0,M).catch(Ve=>{throw K.toKnownErr(Ve)})}searchPostsSkeleton(L,M){return this._client.call("app.bsky.unspecced.searchPostsSkeleton",L,void 0,M).catch(Ve=>{throw U.toKnownErr(Ve)})}searchStarterPacksSkeleton(L,M){return this._client.call("app.bsky.unspecced.searchStarterPacksSkeleton",L,void 0,M).catch(Ve=>{throw ee.toKnownErr(Ve)})}}O.AppBskyUnspeccedNS=At;class _r{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getJobStatus(L,M){return this._client.call("app.bsky.video.getJobStatus",L,void 0,M)}getUploadLimits(L,M){return this._client.call("app.bsky.video.getUploadLimits",L,void 0,M)}uploadVideo(L,M){return this._client.call("app.bsky.video.uploadVideo",M?.qp,L,M)}}O.AppBskyVideoNS=_r;class cr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bsky",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.bsky=new Gi(L)}}O.ChatNS=cr;class Gi{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"actor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"convo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moderation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.actor=new gn(L),this.convo=new dr(L),this.moderation=new ns(L)}}O.ChatBskyNS=Gi;class gn{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"declaration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.declaration=new tn(L)}deleteAccount(L,M){return this._client.call("chat.bsky.actor.deleteAccount",M?.qp,L,M)}exportAccountData(L,M){return this._client.call("chat.bsky.actor.exportAccountData",L,void 0,M)}}O.ChatBskyActorNS=gn;class tn{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"chat.bsky.actor.declaration",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"chat.bsky.actor.declaration",...L})).data}async create(L,M,Ve){const ut="chat.bsky.actor.declaration";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="chat.bsky.actor.declaration";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"chat.bsky.actor.declaration",...L},{headers:M})}}O.ChatBskyActorDeclarationRecord=tn;class dr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}acceptConvo(L,M){return this._client.call("chat.bsky.convo.acceptConvo",M?.qp,L,M)}addReaction(L,M){return this._client.call("chat.bsky.convo.addReaction",M?.qp,L,M).catch(Ve=>{throw le.toKnownErr(Ve)})}deleteMessageForSelf(L,M){return this._client.call("chat.bsky.convo.deleteMessageForSelf",M?.qp,L,M)}getConvo(L,M){return this._client.call("chat.bsky.convo.getConvo",L,void 0,M)}getConvoAvailability(L,M){return this._client.call("chat.bsky.convo.getConvoAvailability",L,void 0,M)}getConvoForMembers(L,M){return this._client.call("chat.bsky.convo.getConvoForMembers",L,void 0,M)}getLog(L,M){return this._client.call("chat.bsky.convo.getLog",L,void 0,M)}getMessages(L,M){return this._client.call("chat.bsky.convo.getMessages",L,void 0,M)}leaveConvo(L,M){return this._client.call("chat.bsky.convo.leaveConvo",M?.qp,L,M)}listConvos(L,M){return this._client.call("chat.bsky.convo.listConvos",L,void 0,M)}muteConvo(L,M){return this._client.call("chat.bsky.convo.muteConvo",M?.qp,L,M)}removeReaction(L,M){return this._client.call("chat.bsky.convo.removeReaction",M?.qp,L,M).catch(Ve=>{throw Q.toKnownErr(Ve)})}sendMessage(L,M){return this._client.call("chat.bsky.convo.sendMessage",M?.qp,L,M)}sendMessageBatch(L,M){return this._client.call("chat.bsky.convo.sendMessageBatch",M?.qp,L,M)}unmuteConvo(L,M){return this._client.call("chat.bsky.convo.unmuteConvo",M?.qp,L,M)}updateAllRead(L,M){return this._client.call("chat.bsky.convo.updateAllRead",M?.qp,L,M)}updateRead(L,M){return this._client.call("chat.bsky.convo.updateRead",M?.qp,L,M)}}O.ChatBskyConvoNS=dr;class ns{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getActorMetadata(L,M){return this._client.call("chat.bsky.moderation.getActorMetadata",L,void 0,M)}getMessageContext(L,M){return this._client.call("chat.bsky.moderation.getMessageContext",L,void 0,M)}updateActorAccess(L,M){return this._client.call("chat.bsky.moderation.updateActorAccess",M?.qp,L,M)}}O.ChatBskyModerationNS=ns;class ss{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"atproto",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.atproto=new Kn(L)}}O.ComNS=ss;class Kn{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"admin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"identity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lexicon",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moderation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sync",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.admin=new vs(L),this.identity=new rn(L),this.label=new Gn(L),this.lexicon=new hi(L),this.moderation=new Qr(L),this.repo=new xs(L),this.server=new $n(L),this.sync=new oo(L),this.temp=new ke(L)}}O.ComAtprotoNS=Kn;class vs{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}deleteAccount(L,M){return this._client.call("com.atproto.admin.deleteAccount",M?.qp,L,M)}disableAccountInvites(L,M){return this._client.call("com.atproto.admin.disableAccountInvites",M?.qp,L,M)}disableInviteCodes(L,M){return this._client.call("com.atproto.admin.disableInviteCodes",M?.qp,L,M)}enableAccountInvites(L,M){return this._client.call("com.atproto.admin.enableAccountInvites",M?.qp,L,M)}getAccountInfo(L,M){return this._client.call("com.atproto.admin.getAccountInfo",L,void 0,M)}getAccountInfos(L,M){return this._client.call("com.atproto.admin.getAccountInfos",L,void 0,M)}getInviteCodes(L,M){return this._client.call("com.atproto.admin.getInviteCodes",L,void 0,M)}getSubjectStatus(L,M){return this._client.call("com.atproto.admin.getSubjectStatus",L,void 0,M)}searchAccounts(L,M){return this._client.call("com.atproto.admin.searchAccounts",L,void 0,M)}sendEmail(L,M){return this._client.call("com.atproto.admin.sendEmail",M?.qp,L,M)}updateAccountEmail(L,M){return this._client.call("com.atproto.admin.updateAccountEmail",M?.qp,L,M)}updateAccountHandle(L,M){return this._client.call("com.atproto.admin.updateAccountHandle",M?.qp,L,M)}updateAccountPassword(L,M){return this._client.call("com.atproto.admin.updateAccountPassword",M?.qp,L,M)}updateAccountSigningKey(L,M){return this._client.call("com.atproto.admin.updateAccountSigningKey",M?.qp,L,M)}updateSubjectStatus(L,M){return this._client.call("com.atproto.admin.updateSubjectStatus",M?.qp,L,M)}}O.ComAtprotoAdminNS=vs;class rn{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getRecommendedDidCredentials(L,M){return this._client.call("com.atproto.identity.getRecommendedDidCredentials",L,void 0,M)}refreshIdentity(L,M){return this._client.call("com.atproto.identity.refreshIdentity",M?.qp,L,M).catch(Ve=>{throw Te.toKnownErr(Ve)})}requestPlcOperationSignature(L,M){return this._client.call("com.atproto.identity.requestPlcOperationSignature",M?.qp,L,M)}resolveDid(L,M){return this._client.call("com.atproto.identity.resolveDid",L,void 0,M).catch(Ve=>{throw pe.toKnownErr(Ve)})}resolveHandle(L,M){return this._client.call("com.atproto.identity.resolveHandle",L,void 0,M).catch(Ve=>{throw _e.toKnownErr(Ve)})}resolveIdentity(L,M){return this._client.call("com.atproto.identity.resolveIdentity",L,void 0,M).catch(Ve=>{throw Xe.toKnownErr(Ve)})}signPlcOperation(L,M){return this._client.call("com.atproto.identity.signPlcOperation",M?.qp,L,M)}submitPlcOperation(L,M){return this._client.call("com.atproto.identity.submitPlcOperation",M?.qp,L,M)}updateHandle(L,M){return this._client.call("com.atproto.identity.updateHandle",M?.qp,L,M)}}O.ComAtprotoIdentityNS=rn;class Gn{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}queryLabels(L,M){return this._client.call("com.atproto.label.queryLabels",L,void 0,M)}}O.ComAtprotoLabelNS=Gn;class hi{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.schema=new Ui(L)}}O.ComAtprotoLexiconNS=hi;class Ui{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}async list(L){return(await this._client.call("com.atproto.repo.listRecords",{collection:"com.atproto.lexicon.schema",...L})).data}async get(L){return(await this._client.call("com.atproto.repo.getRecord",{collection:"com.atproto.lexicon.schema",...L})).data}async create(L,M,Ve){const ut="com.atproto.lexicon.schema";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(L,M,Ve){const ut="com.atproto.lexicon.schema";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...L,record:{...M,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(L,M){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"com.atproto.lexicon.schema",...L},{headers:M})}}O.ComAtprotoLexiconSchemaRecord=Ui;class Qr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}createReport(L,M){return this._client.call("com.atproto.moderation.createReport",M?.qp,L,M)}}O.ComAtprotoModerationNS=Qr;class xs{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}applyWrites(L,M){return this._client.call("com.atproto.repo.applyWrites",M?.qp,L,M).catch(Ve=>{throw dt.toKnownErr(Ve)})}createRecord(L,M){return this._client.call("com.atproto.repo.createRecord",M?.qp,L,M).catch(Ve=>{throw He.toKnownErr(Ve)})}deleteRecord(L,M){return this._client.call("com.atproto.repo.deleteRecord",M?.qp,L,M).catch(Ve=>{throw et.toKnownErr(Ve)})}describeRepo(L,M){return this._client.call("com.atproto.repo.describeRepo",L,void 0,M)}getRecord(L,M){return this._client.call("com.atproto.repo.getRecord",L,void 0,M).catch(Ve=>{throw rt.toKnownErr(Ve)})}importRepo(L,M){return this._client.call("com.atproto.repo.importRepo",M?.qp,L,M)}listMissingBlobs(L,M){return this._client.call("com.atproto.repo.listMissingBlobs",L,void 0,M)}listRecords(L,M){return this._client.call("com.atproto.repo.listRecords",L,void 0,M)}putRecord(L,M){return this._client.call("com.atproto.repo.putRecord",M?.qp,L,M).catch(Ve=>{throw te.toKnownErr(Ve)})}uploadBlob(L,M){return this._client.call("com.atproto.repo.uploadBlob",M?.qp,L,M)}}O.ComAtprotoRepoNS=xs;class $n{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}activateAccount(L,M){return this._client.call("com.atproto.server.activateAccount",M?.qp,L,M)}checkAccountStatus(L,M){return this._client.call("com.atproto.server.checkAccountStatus",L,void 0,M)}confirmEmail(L,M){return this._client.call("com.atproto.server.confirmEmail",M?.qp,L,M).catch(Ve=>{throw Be.toKnownErr(Ve)})}createAccount(L,M){return this._client.call("com.atproto.server.createAccount",M?.qp,L,M).catch(Ve=>{throw fe.toKnownErr(Ve)})}createAppPassword(L,M){return this._client.call("com.atproto.server.createAppPassword",M?.qp,L,M).catch(Ve=>{throw ye.toKnownErr(Ve)})}createInviteCode(L,M){return this._client.call("com.atproto.server.createInviteCode",M?.qp,L,M)}createInviteCodes(L,M){return this._client.call("com.atproto.server.createInviteCodes",M?.qp,L,M)}createSession(L,M){return this._client.call("com.atproto.server.createSession",M?.qp,L,M).catch(Ve=>{throw nt.toKnownErr(Ve)})}deactivateAccount(L,M){return this._client.call("com.atproto.server.deactivateAccount",M?.qp,L,M)}deleteAccount(L,M){return this._client.call("com.atproto.server.deleteAccount",M?.qp,L,M).catch(Ve=>{throw gt.toKnownErr(Ve)})}deleteSession(L,M){return this._client.call("com.atproto.server.deleteSession",M?.qp,L,M)}describeServer(L,M){return this._client.call("com.atproto.server.describeServer",L,void 0,M)}getAccountInviteCodes(L,M){return this._client.call("com.atproto.server.getAccountInviteCodes",L,void 0,M).catch(Ve=>{throw lt.toKnownErr(Ve)})}getServiceAuth(L,M){return this._client.call("com.atproto.server.getServiceAuth",L,void 0,M).catch(Ve=>{throw be.toKnownErr(Ve)})}getSession(L,M){return this._client.call("com.atproto.server.getSession",L,void 0,M)}listAppPasswords(L,M){return this._client.call("com.atproto.server.listAppPasswords",L,void 0,M).catch(Ve=>{throw Ft.toKnownErr(Ve)})}refreshSession(L,M){return this._client.call("com.atproto.server.refreshSession",M?.qp,L,M).catch(Ve=>{throw Ut.toKnownErr(Ve)})}requestAccountDelete(L,M){return this._client.call("com.atproto.server.requestAccountDelete",M?.qp,L,M)}requestEmailConfirmation(L,M){return this._client.call("com.atproto.server.requestEmailConfirmation",M?.qp,L,M)}requestEmailUpdate(L,M){return this._client.call("com.atproto.server.requestEmailUpdate",M?.qp,L,M)}requestPasswordReset(L,M){return this._client.call("com.atproto.server.requestPasswordReset",M?.qp,L,M)}reserveSigningKey(L,M){return this._client.call("com.atproto.server.reserveSigningKey",M?.qp,L,M)}resetPassword(L,M){return this._client.call("com.atproto.server.resetPassword",M?.qp,L,M).catch(Ve=>{throw Le.toKnownErr(Ve)})}revokeAppPassword(L,M){return this._client.call("com.atproto.server.revokeAppPassword",M?.qp,L,M)}updateEmail(L,M){return this._client.call("com.atproto.server.updateEmail",M?.qp,L,M).catch(Ve=>{throw ur.toKnownErr(Ve)})}}O.ComAtprotoServerNS=$n;class oo{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getBlob(L,M){return this._client.call("com.atproto.sync.getBlob",L,void 0,M).catch(Ve=>{throw Tt.toKnownErr(Ve)})}getBlocks(L,M){return this._client.call("com.atproto.sync.getBlocks",L,void 0,M).catch(Ve=>{throw tr.toKnownErr(Ve)})}getCheckout(L,M){return this._client.call("com.atproto.sync.getCheckout",L,void 0,M)}getHead(L,M){return this._client.call("com.atproto.sync.getHead",L,void 0,M).catch(Ve=>{throw qr.toKnownErr(Ve)})}getHostStatus(L,M){return this._client.call("com.atproto.sync.getHostStatus",L,void 0,M).catch(Ve=>{throw lr.toKnownErr(Ve)})}getLatestCommit(L,M){return this._client.call("com.atproto.sync.getLatestCommit",L,void 0,M).catch(Ve=>{throw kr.toKnownErr(Ve)})}getRecord(L,M){return this._client.call("com.atproto.sync.getRecord",L,void 0,M).catch(Ve=>{throw Sr.toKnownErr(Ve)})}getRepo(L,M){return this._client.call("com.atproto.sync.getRepo",L,void 0,M).catch(Ve=>{throw $r.toKnownErr(Ve)})}getRepoStatus(L,M){return this._client.call("com.atproto.sync.getRepoStatus",L,void 0,M).catch(Ve=>{throw sr.toKnownErr(Ve)})}listBlobs(L,M){return this._client.call("com.atproto.sync.listBlobs",L,void 0,M).catch(Ve=>{throw br.toKnownErr(Ve)})}listHosts(L,M){return this._client.call("com.atproto.sync.listHosts",L,void 0,M)}listRepos(L,M){return this._client.call("com.atproto.sync.listRepos",L,void 0,M)}listReposByCollection(L,M){return this._client.call("com.atproto.sync.listReposByCollection",L,void 0,M)}notifyOfUpdate(L,M){return this._client.call("com.atproto.sync.notifyOfUpdate",M?.qp,L,M)}requestCrawl(L,M){return this._client.call("com.atproto.sync.requestCrawl",M?.qp,L,M).catch(Ve=>{throw nr.toKnownErr(Ve)})}}O.ComAtprotoSyncNS=oo;class ke{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}addReservedHandle(L,M){return this._client.call("com.atproto.temp.addReservedHandle",M?.qp,L,M)}checkHandleAvailability(L,M){return this._client.call("com.atproto.temp.checkHandleAvailability",L,void 0,M).catch(Ve=>{throw Xr.toKnownErr(Ve)})}checkSignupQueue(L,M){return this._client.call("com.atproto.temp.checkSignupQueue",L,void 0,M)}dereferenceScope(L,M){return this._client.call("com.atproto.temp.dereferenceScope",L,void 0,M).catch(Ve=>{throw Vt.toKnownErr(Ve)})}fetchLabels(L,M){return this._client.call("com.atproto.temp.fetchLabels",L,void 0,M)}requestPhoneVerification(L,M){return this._client.call("com.atproto.temp.requestPhoneVerification",M?.qp,L,M)}revokeAccountCredentials(L,M){return this._client.call("com.atproto.temp.revokeAccountCredentials",M?.qp,L,M)}}O.ComAtprotoTempNS=ke;class j{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ozone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.ozone=new re(L)}}O.ToolsNS=j;class re{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"communication",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hosting",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moderation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"safelink",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"set",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setting",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"team",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verification",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L,this.communication=new oe(L),this.hosting=new De(L),this.moderation=new Me(L),this.safelink=new Et(L),this.server=new ht(L),this.set=new $t(L),this.setting=new Yt(L),this.signature=new wr(L),this.team=new ji(L),this.verification=new Mn(L)}}O.ToolsOzoneNS=re;class oe{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}createTemplate(L,M){return this._client.call("tools.ozone.communication.createTemplate",M?.qp,L,M).catch(Ve=>{throw Pr.toKnownErr(Ve)})}deleteTemplate(L,M){return this._client.call("tools.ozone.communication.deleteTemplate",M?.qp,L,M)}listTemplates(L,M){return this._client.call("tools.ozone.communication.listTemplates",L,void 0,M)}updateTemplate(L,M){return this._client.call("tools.ozone.communication.updateTemplate",M?.qp,L,M).catch(Ve=>{throw Ct.toKnownErr(Ve)})}}O.ToolsOzoneCommunicationNS=oe;class De{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getAccountHistory(L,M){return this._client.call("tools.ozone.hosting.getAccountHistory",L,void 0,M)}}O.ToolsOzoneHostingNS=De;class Me{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}cancelScheduledActions(L,M){return this._client.call("tools.ozone.moderation.cancelScheduledActions",M?.qp,L,M)}emitEvent(L,M){return this._client.call("tools.ozone.moderation.emitEvent",M?.qp,L,M).catch(Ve=>{throw er.toKnownErr(Ve)})}getAccountTimeline(L,M){return this._client.call("tools.ozone.moderation.getAccountTimeline",L,void 0,M).catch(Ve=>{throw or.toKnownErr(Ve)})}getEvent(L,M){return this._client.call("tools.ozone.moderation.getEvent",L,void 0,M)}getRecord(L,M){return this._client.call("tools.ozone.moderation.getRecord",L,void 0,M).catch(Ve=>{throw Lr.toKnownErr(Ve)})}getRecords(L,M){return this._client.call("tools.ozone.moderation.getRecords",L,void 0,M)}getRepo(L,M){return this._client.call("tools.ozone.moderation.getRepo",L,void 0,M).catch(Ve=>{throw Jr.toKnownErr(Ve)})}getReporterStats(L,M){return this._client.call("tools.ozone.moderation.getReporterStats",L,void 0,M)}getRepos(L,M){return this._client.call("tools.ozone.moderation.getRepos",L,void 0,M)}getSubjects(L,M){return this._client.call("tools.ozone.moderation.getSubjects",L,void 0,M)}listScheduledActions(L,M){return this._client.call("tools.ozone.moderation.listScheduledActions",M?.qp,L,M)}queryEvents(L,M){return this._client.call("tools.ozone.moderation.queryEvents",L,void 0,M)}queryStatuses(L,M){return this._client.call("tools.ozone.moderation.queryStatuses",L,void 0,M)}scheduleAction(L,M){return this._client.call("tools.ozone.moderation.scheduleAction",M?.qp,L,M)}searchRepos(L,M){return this._client.call("tools.ozone.moderation.searchRepos",L,void 0,M)}}O.ToolsOzoneModerationNS=Me;class Et{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}addRule(L,M){return this._client.call("tools.ozone.safelink.addRule",M?.qp,L,M).catch(Ve=>{throw bt.toKnownErr(Ve)})}queryEvents(L,M){return this._client.call("tools.ozone.safelink.queryEvents",M?.qp,L,M)}queryRules(L,M){return this._client.call("tools.ozone.safelink.queryRules",M?.qp,L,M)}removeRule(L,M){return this._client.call("tools.ozone.safelink.removeRule",M?.qp,L,M).catch(Ve=>{throw gi.toKnownErr(Ve)})}updateRule(L,M){return this._client.call("tools.ozone.safelink.updateRule",M?.qp,L,M).catch(Ve=>{throw Oi.toKnownErr(Ve)})}}O.ToolsOzoneSafelinkNS=Et;class ht{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}getConfig(L,M){return this._client.call("tools.ozone.server.getConfig",L,void 0,M)}}O.ToolsOzoneServerNS=ht;class $t{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}addValues(L,M){return this._client.call("tools.ozone.set.addValues",M?.qp,L,M)}deleteSet(L,M){return this._client.call("tools.ozone.set.deleteSet",M?.qp,L,M).catch(Ve=>{throw Oe.toKnownErr(Ve)})}deleteValues(L,M){return this._client.call("tools.ozone.set.deleteValues",M?.qp,L,M).catch(Ve=>{throw vt.toKnownErr(Ve)})}getValues(L,M){return this._client.call("tools.ozone.set.getValues",L,void 0,M).catch(Ve=>{throw Nt.toKnownErr(Ve)})}querySets(L,M){return this._client.call("tools.ozone.set.querySets",L,void 0,M)}upsertSet(L,M){return this._client.call("tools.ozone.set.upsertSet",M?.qp,L,M)}}O.ToolsOzoneSetNS=$t;class Yt{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}listOptions(L,M){return this._client.call("tools.ozone.setting.listOptions",L,void 0,M)}removeOptions(L,M){return this._client.call("tools.ozone.setting.removeOptions",M?.qp,L,M)}upsertOption(L,M){return this._client.call("tools.ozone.setting.upsertOption",M?.qp,L,M)}}O.ToolsOzoneSettingNS=Yt;class wr{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}findCorrelation(L,M){return this._client.call("tools.ozone.signature.findCorrelation",L,void 0,M)}findRelatedAccounts(L,M){return this._client.call("tools.ozone.signature.findRelatedAccounts",L,void 0,M)}searchAccounts(L,M){return this._client.call("tools.ozone.signature.searchAccounts",L,void 0,M)}}O.ToolsOzoneSignatureNS=wr;class ji{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}addMember(L,M){return this._client.call("tools.ozone.team.addMember",M?.qp,L,M).catch(Ve=>{throw we.toKnownErr(Ve)})}deleteMember(L,M){return this._client.call("tools.ozone.team.deleteMember",M?.qp,L,M).catch(Ve=>{throw W.toKnownErr(Ve)})}listMembers(L,M){return this._client.call("tools.ozone.team.listMembers",L,void 0,M)}updateMember(L,M){return this._client.call("tools.ozone.team.updateMember",M?.qp,L,M).catch(Ve=>{throw J.toKnownErr(Ve)})}}O.ToolsOzoneTeamNS=ji;class Mn{constructor(L){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=L}grantVerifications(L,M){return this._client.call("tools.ozone.verification.grantVerifications",M?.qp,L,M)}listVerifications(L,M){return this._client.call("tools.ozone.verification.listVerifications",L,void 0,M)}revokeVerifications(L,M){return this._client.call("tools.ozone.verification.revokeVerifications",M?.qp,L,M)}}return O.ToolsOzoneVerificationNS=Mn,O}var bc={},nf={};const s7=JSON.parse('["aaa","aarp","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","ads","adult","ae","aeg","aero","aetna","af","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerryproperties","kfh","kg","kh","ki","kia","kids","kim","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","link","live","living","lk","llc","llp","loan","loans","locker","locus","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","music","mv","mw","mx","my","mz","na","nab","nagoya","name","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","office","okinawa","olayan","olayangroup","ollo","om","omega","one","ong","onl","online","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","racing","radio","re","read","realestate","realtor","realty","recipes","red","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","ro","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scot","sd","se","search","seat","secure","security","seek","select","sener","services","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shell","shia","shiksha","shoes","shop","shopping","shouji","show","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","vermögensberater","vermögensberatung","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volvo","vote","voting","voto","voyage","vu","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xihuan","xin","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw","ελ","ευ","бг","бел","дети","ею","католик","ком","мкд","мон","москва","онлайн","орг","рус","рф","сайт","срб","укр","қаз","հայ","ישראל","קום","ابوظبي","ارامكو","الاردن","البحرين","الجزائر","السعودية","العليان","المغرب","امارات","ایران","بارت","بازار","بيتك","بھارت","تونس","سودان","سورية","شبكة","عراق","عرب","عمان","فلسطين","قطر","كاثوليك","كوم","مصر","مليسيا","موريتانيا","موقع","همراه","پاکستان","ڀارت","कॉम","नेट","भारत","भारतम्","भारोत","संगठन","বাংলা","ভারত","ভাৰত","ਭਾਰਤ","ભારત","ଭାରତ","இந்தியா","இலங்கை","சிங்கப்பூர்","భారత్","ಭಾರತ","ഭാരതം","ලංකා","คอม","ไทย","ລາວ","გე","みんな","アマゾン","クラウド","グーグル","コム","ストア","セール","ファッション","ポイント","世界","中信","中国","中國","中文网","亚马逊","企业","佛山","信息","健康","八卦","公司","公益","台湾","台灣","商城","商店","商标","嘉里","嘉里大酒店","在线","大拿","天主教","娱乐","家電","广东","微博","慈善","我爱你","手机","招聘","政务","政府","新加坡","新闻","时尚","書籍","机构","淡马锡","游戏","澳門","点看","移动","组织机构","网址","网店","网站","网络","联通","谷歌","购物","通販","集团","電訊盈科","飞利浦","食品","餐厅","香格里拉","香港","닷넷","닷컴","삼성","한국"]');var Fo={},yD;function AM(){return yD||(yD=1,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.TAG_REGEX=Fo.TRAILING_PUNCTUATION_REGEX=Fo.URL_REGEX=Fo.MENTION_REGEX=void 0,Fo.MENTION_REGEX=/(^|\s|\()(@)([a-zA-Z0-9.-]+)(\b)/g,Fo.URL_REGEX=/(^|\s|\()((https?:\/\/[\S]+)|((?<domain>[a-z][a-z0-9]*(\.[a-z0-9]+)+)[\S]*))/gim,Fo.TRAILING_PUNCTUATION_REGEX=new RegExp("\\p{P}+$","gu"),Fo.TAG_REGEX=/(^|\s)[#＃]((?!\ufe0f)[^\s\u00AD\u2060\u200A\u200B\u200C\u200D\u20e2]*[^\d\s\p{P}\u00AD\u2060\u200A\u200B\u200C\u200D\u20e2]+[^\s\u00AD\u2060\u200A\u200B\u200C\u200D\u20e2]*)?/gu),Fo}var gD;function o7(){if(gD)return nf;gD=1;var r=nf&&nf.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(nf,"__esModule",{value:!0}),nf.detectFacets=c;const i=r(s7),s=AM();function c(m){let e;const a=[];{const g=s.MENTION_REGEX;for(;e=g.exec(m.utf16);){if(!d(e[3])&&!e[3].endsWith(".test"))continue;const w=m.utf16.indexOf(e[3],e.index)-1;a.push({$type:"app.bsky.richtext.facet",index:{byteStart:m.utf16IndexToUtf8Index(w),byteEnd:m.utf16IndexToUtf8Index(w+e[3].length+1)},features:[{$type:"app.bsky.richtext.facet#mention",did:e[3]}]})}}{const g=s.URL_REGEX;for(;e=g.exec(m.utf16);){let w=e[2];if(!w.startsWith("http")){const D=e.groups?.domain;if(!D||!d(D))continue;w=`https://${w}`}const R=m.utf16.indexOf(e[2],e.index),S={start:R,end:R+e[2].length};/[.,;:!?]$/.test(w)&&(w=w.slice(0,-1),S.end--),/[)]$/.test(w)&&!w.includes("(")&&(w=w.slice(0,-1),S.end--),a.push({index:{byteStart:m.utf16IndexToUtf8Index(S.start),byteEnd:m.utf16IndexToUtf8Index(S.end)},features:[{$type:"app.bsky.richtext.facet#link",uri:w}]})}}{const g=s.TAG_REGEX;for(;e=g.exec(m.utf16);){const w=e[1];let R=e[2];if(!R||(R=R.trim().replace(s.TRAILING_PUNCTUATION_REGEX,""),R.length===0||R.length>64))continue;const S=e.index+w.length;a.push({index:{byteStart:m.utf16IndexToUtf8Index(S),byteEnd:m.utf16IndexToUtf8Index(S+1+R.length)},features:[{$type:"app.bsky.richtext.facet#tag",tag:R}]})}}return a.length>0?a:void 0}function d(m){return!!i.default.find(e=>{const a=m.lastIndexOf(e);return a===-1?!1:m.charAt(a-1)==="."&&a===m.length-e.length})}return nf}var pv={},ym={},_D;function Ow(){if(_D)return ym;_D=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.UnicodeString=void 0;const r=fl(),i=new TextEncoder,s=new TextDecoder;class c{constructor(m){Object.defineProperty(this,"utf16",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"utf8",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_graphemeLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.utf16=m,this.utf8=i.encode(m)}get length(){return this.utf8.byteLength}get graphemeLength(){return this._graphemeLen||(this._graphemeLen=(0,r.graphemeLen)(this.utf16)),this._graphemeLen}slice(m,e){return s.decode(this.utf8.slice(m,e))}utf16IndexToUtf8Index(m){return i.encode(this.utf16.slice(0,m)).byteLength}toString(){return this.utf16}}return ym.UnicodeString=c,ym}var bD;function RM(){if(bD)return pv;bD=1,Object.defineProperty(pv,"__esModule",{value:!0}),pv.sanitizeRichText=c;const r=Ow(),i=/[\r\n]([\u00AD\u2060\u200D\u200C\u200B\s]*[\r\n]){2,}/,s=`

`;function c(m,e){return e.cleanNewlines&&(m=d(m,i,s)),m}function d(m,e,a){m=m.clone();let g=m.unicodeText.utf16.match(e);for(;g&&typeof g.index<"u";){const w=m.unicodeText,R=m.unicodeText.utf16IndexToUtf8Index(g.index),S=R+new r.UnicodeString(g[0]).length;if(m.delete(R,S),m.unicodeText.utf16===w.utf16)break;m.insert(R,a),g=m.unicodeText.utf16.match(e)}return m}return pv}var vD;function a7(){if(vD)return bc;vD=1,Object.defineProperty(bc,"__esModule",{value:!0}),bc.RichText=bc.RichTextSegment=void 0;const r=gu(),i=o7(),s=RM(),c=Ow();class d{constructor(S,D){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:S}),Object.defineProperty(this,"facet",{enumerable:!0,configurable:!0,writable:!0,value:D})}get link(){return this.facet?.features.find(r.AppBskyRichtextFacet.isLink)}isLink(){return!!this.link}get mention(){return this.facet?.features.find(r.AppBskyRichtextFacet.isMention)}isMention(){return!!this.mention}get tag(){return this.facet?.features.find(r.AppBskyRichtextFacet.isTag)}isTag(){return!!this.tag}}bc.RichTextSegment=d;class m{constructor(S,D){Object.defineProperty(this,"unicodeText",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"facets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.unicodeText=new c.UnicodeString(S.text),this.facets=S.facets,!this.facets?.length&&S.entities?.length&&(this.facets=g(this.unicodeText,S.entities)),this.facets&&(this.facets=this.facets.filter(a).sort(e)),D?.cleanNewlines&&(0,s.sanitizeRichText)(this,{cleanNewlines:!0}).copyInto(this)}get text(){return this.unicodeText.toString()}get length(){return this.unicodeText.length}get graphemeLength(){return this.unicodeText.graphemeLength}clone(){return new m({text:this.unicodeText.utf16,facets:w(this.facets)})}copyInto(S){S.unicodeText=this.unicodeText,S.facets=w(this.facets)}*segments(){const S=this.facets||[];if(!S.length){yield new d(this.unicodeText.utf16);return}let D=0,k=0;do{const B=S[k];if(D<B.index.byteStart)yield new d(this.unicodeText.slice(D,B.index.byteStart));else if(D>B.index.byteStart){k++;continue}if(B.index.byteStart<B.index.byteEnd){const F=this.unicodeText.slice(B.index.byteStart,B.index.byteEnd);F.trim()?yield new d(F,B):yield new d(F)}D=B.index.byteEnd,k++}while(k<S.length);D<this.unicodeText.length&&(yield new d(this.unicodeText.slice(D,this.unicodeText.length)))}insert(S,D){if(this.unicodeText=new c.UnicodeString(this.unicodeText.slice(0,S)+D+this.unicodeText.slice(S)),!this.facets?.length)return this;const k=D.length;for(const B of this.facets)S<=B.index.byteStart?(B.index.byteStart+=k,B.index.byteEnd+=k):S>=B.index.byteStart&&S<B.index.byteEnd&&(B.index.byteEnd+=k);return this}delete(S,D){if(this.unicodeText=new c.UnicodeString(this.unicodeText.slice(0,S)+this.unicodeText.slice(D)),!this.facets?.length)return this;const k=D-S;for(const B of this.facets)S<=B.index.byteStart&&D>=B.index.byteEnd?(B.index.byteStart=0,B.index.byteEnd=0):S>B.index.byteEnd||(S>B.index.byteStart&&S<=B.index.byteEnd&&D>B.index.byteEnd?B.index.byteEnd=S:S>=B.index.byteStart&&D<=B.index.byteEnd?B.index.byteEnd-=k:S<B.index.byteStart&&D>=B.index.byteStart&&D<=B.index.byteEnd?(B.index.byteStart=S,B.index.byteEnd-=k):D<B.index.byteStart&&(B.index.byteStart-=k,B.index.byteEnd-=k));return this.facets=this.facets.filter(B=>B.index.byteStart<B.index.byteEnd),this}async detectFacets(S){if(this.facets=(0,i.detectFacets)(this.unicodeText),this.facets){const D=[];for(const k of this.facets)for(const B of k.features)r.AppBskyRichtextFacet.isMention(B)&&D.push(S.com.atproto.identity.resolveHandle({handle:B.did}).then(F=>F?.data.did).catch(F=>{}).then(F=>{B.did=F||""}));await Promise.allSettled(D),this.facets.sort(e)}}detectFacetsWithoutResolution(){this.facets=(0,i.detectFacets)(this.unicodeText),this.facets&&this.facets.sort(e)}}bc.RichText=m;const e=(R,S)=>R.index.byteStart-S.index.byteStart,a=R=>R.index.byteStart<=R.index.byteEnd;function g(R,S){const D=[];for(const k of S)k.type==="link"?D.push({$type:"app.bsky.richtext.facet",index:{byteStart:R.utf16IndexToUtf8Index(k.index.start),byteEnd:R.utf16IndexToUtf8Index(k.index.end)},features:[{$type:"app.bsky.richtext.facet#link",uri:k.value}]}):k.type==="mention"&&D.push({$type:"app.bsky.richtext.facet",index:{byteStart:R.utf16IndexToUtf8Index(k.index.start),byteEnd:R.utf16IndexToUtf8Index(k.index.end)},features:[{$type:"app.bsky.richtext.facet#mention",did:k.value}]});return D}function w(R){return typeof R>"u"?R:JSON.parse(JSON.stringify(R))}return bc}var l1={},gm={},vc={},xD;function Vw(){return xD||(xD=1,Object.defineProperty(vc,"__esModule",{value:!0}),vc.LABELS=vc.DEFAULT_LABEL_SETTINGS=void 0,vc.DEFAULT_LABEL_SETTINGS={porn:"hide",sexual:"warn",nudity:"ignore","graphic-media":"warn"},vc.LABELS={"!hide":{identifier:"!hide",configurable:!1,defaultSetting:"hide",flags:["no-override","no-self"],severity:"alert",blurs:"content",behaviors:{account:{profileList:"blur",profileView:"blur",avatar:"blur",banner:"blur",displayName:"blur",contentList:"blur",contentView:"blur"},profile:{avatar:"blur",banner:"blur",displayName:"blur"},content:{contentList:"blur",contentView:"blur"}},locales:[]},"!warn":{identifier:"!warn",configurable:!1,defaultSetting:"warn",flags:["no-self"],severity:"none",blurs:"content",behaviors:{account:{profileList:"blur",profileView:"blur",avatar:"blur",banner:"blur",contentList:"blur",contentView:"blur"},profile:{avatar:"blur",banner:"blur",displayName:"blur"},content:{contentList:"blur",contentView:"blur"}},locales:[]},"!no-unauthenticated":{identifier:"!no-unauthenticated",configurable:!1,defaultSetting:"hide",flags:["no-override","unauthed"],severity:"none",blurs:"content",behaviors:{account:{profileList:"blur",profileView:"blur",avatar:"blur",banner:"blur",displayName:"blur",contentList:"blur",contentView:"blur"},profile:{avatar:"blur",banner:"blur",displayName:"blur"},content:{contentList:"blur",contentView:"blur"}},locales:[]},porn:{identifier:"porn",configurable:!0,defaultSetting:"hide",flags:["adult"],severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},sexual:{identifier:"sexual",configurable:!0,defaultSetting:"warn",flags:["adult"],severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},nudity:{identifier:"nudity",configurable:!0,defaultSetting:"ignore",flags:[],severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},"graphic-media":{identifier:"graphic-media",flags:["adult"],configurable:!0,defaultSetting:"warn",severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},gore:{identifier:"gore",flags:["adult"],configurable:!0,defaultSetting:"warn",severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]}}),vc}var ms={},wD;function SM(){return wD||(wD=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.NOOP_BEHAVIOR=ms.HIDE_BEHAVIOR=ms.MUTEWORD_BEHAVIOR=ms.MUTE_BEHAVIOR=ms.BLOCK_BEHAVIOR=ms.CUSTOM_LABEL_VALUE_RE=void 0,ms.CUSTOM_LABEL_VALUE_RE=/^[a-z-]+$/,ms.BLOCK_BEHAVIOR={profileList:"blur",profileView:"alert",avatar:"blur",banner:"blur",contentList:"blur",contentView:"blur"},ms.MUTE_BEHAVIOR={profileList:"inform",profileView:"alert",contentList:"blur",contentView:"inform"},ms.MUTEWORD_BEHAVIOR={contentList:"blur",contentView:"blur"},ms.HIDE_BEHAVIOR={contentList:"blur",contentView:"blur"},ms.NOOP_BEHAVIOR={}),ms}var _m={},ED;function TM(){if(ED)return _m;ED=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.ModerationUI=void 0;class r{constructor(){Object.defineProperty(this,"noOverride",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"filters",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"blurs",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"alerts",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"informs",{enumerable:!0,configurable:!0,writable:!0,value:[]})}get filter(){return this.filters.length!==0}get blur(){return this.blurs.length!==0}get alert(){return this.alerts.length!==0}get inform(){return this.informs.length!==0}}return _m.ModerationUI=r,_m}var AD;function pu(){if(AD)return gm;AD=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.ModerationDecision=void 0;const r=Vw(),i=SM(),s=TM();var c;(function(a){a[a.High=0]="High",a[a.Medium=1]="Medium",a[a.Low=2]="Low"})(c||(c={}));class d{constructor(){Object.defineProperty(this,"did",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"isMe",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"causes",{enumerable:!0,configurable:!0,writable:!0,value:[]})}static merge(...g){const w=g.filter(S=>S!=null),R=new d;return w[0]&&(R.did=w[0].did,R.isMe=w[0].isMe),R.causes=w.flatMap(S=>S.causes),R}downgrade(){for(const g of this.causes)g.downgraded=!0;return this}get blocked(){return!!this.blockCause}get muted(){return!!this.muteCause}get blockCause(){return this.causes.find(g=>g.type==="blocking"||g.type==="blocked-by"||g.type==="block-other")}get muteCause(){return this.causes.find(g=>g.type==="muted")}get labelCauses(){return this.causes.filter(g=>g.type==="label")}ui(g){const w=new s.ModerationUI;for(const R of this.causes)if(R.type==="blocking"||R.type==="blocked-by"||R.type==="block-other"){if(this.isMe)continue;(g==="profileList"||g==="contentList")&&w.filters.push(R),R.downgraded||(i.BLOCK_BEHAVIOR[g]==="blur"?(w.noOverride=!0,w.blurs.push(R)):i.BLOCK_BEHAVIOR[g]==="alert"?w.alerts.push(R):i.BLOCK_BEHAVIOR[g]==="inform"&&w.informs.push(R))}else if(R.type==="muted"){if(this.isMe)continue;(g==="profileList"||g==="contentList")&&w.filters.push(R),R.downgraded||(i.MUTE_BEHAVIOR[g]==="blur"?w.blurs.push(R):i.MUTE_BEHAVIOR[g]==="alert"?w.alerts.push(R):i.MUTE_BEHAVIOR[g]==="inform"&&w.informs.push(R))}else if(R.type==="mute-word"){if(this.isMe)continue;g==="contentList"&&w.filters.push(R),R.downgraded||(i.MUTEWORD_BEHAVIOR[g]==="blur"?w.blurs.push(R):i.MUTEWORD_BEHAVIOR[g]==="alert"?w.alerts.push(R):i.MUTEWORD_BEHAVIOR[g]==="inform"&&w.informs.push(R))}else R.type==="hidden"?((g==="profileList"||g==="contentList")&&w.filters.push(R),R.downgraded||(i.HIDE_BEHAVIOR[g]==="blur"?w.blurs.push(R):i.HIDE_BEHAVIOR[g]==="alert"?w.alerts.push(R):i.HIDE_BEHAVIOR[g]==="inform"&&w.informs.push(R))):R.type==="label"&&(g==="profileList"&&R.target==="account"?R.setting==="hide"&&!this.isMe&&w.filters.push(R):g==="contentList"&&(R.target==="account"||R.target==="content")&&R.setting==="hide"&&!this.isMe&&w.filters.push(R),R.downgraded||(R.behavior[g]==="blur"?(w.blurs.push(R),R.noOverride&&!this.isMe&&(w.noOverride=!0)):R.behavior[g]==="alert"?w.alerts.push(R):R.behavior[g]==="inform"&&w.informs.push(R)));return w.filters.sort(e),w.blurs.sort(e),w}setDid(g){this.did=g}setIsMe(g){this.isMe=g}addHidden(g){g&&this.causes.push({type:"hidden",source:{type:"user"},priority:6})}addMutedWord(g){g?.length&&this.causes.push({type:"mute-word",source:{type:"user"},priority:6,matches:g})}addBlocking(g){g&&this.causes.push({type:"blocking",source:{type:"user"},priority:3})}addBlockingByList(g){g&&this.causes.push({type:"blocking",source:{type:"list",list:g},priority:3})}addBlockedBy(g){g&&this.causes.push({type:"blocked-by",source:{type:"user"},priority:4})}addBlockOther(g){g&&this.causes.push({type:"block-other",source:{type:"user"},priority:4})}addLabel(g,w,R){const S=i.CUSTOM_LABEL_VALUE_RE.test(w.val)&&R.labelDefs?.[w.src]?.find(ee=>ee.identifier===w.val)||r.LABELS[w.val];if(!S)return;const D=w.src===this.did,k=D?void 0:R.prefs.labelers.find(ee=>ee.did===w.src);if(!D&&!k||D&&S.flags.includes("no-self"))return;let B=S.defaultSetting||"ignore";if(S.configurable?S.flags.includes("adult")&&!R.prefs.adultContentEnabled?B="hide":k?.labels[S.identifier]?B=k?.labels[S.identifier]:R.prefs.labels[S.identifier]&&(B=R.prefs.labels[S.identifier]):B=S.defaultSetting||"hide",B==="ignore"||S.flags.includes("unauthed")&&R.userDid)return;let F;const K=m(S.behaviors[g]);S.flags.includes("no-override")||S.flags.includes("adult")&&!R.prefs.adultContentEnabled?F=1:B==="hide"?F=2:K===c.High?F=5:K===c.Medium?F=7:F=8;let U=!1;(S.flags.includes("no-override")||S.flags.includes("adult")&&!R.prefs.adultContentEnabled)&&(U=!0),this.causes.push({type:"label",source:D||!k?{type:"user"}:{type:"labeler",did:k.did},label:w,labelDef:S,target:g,setting:B,behavior:S.behaviors[g]||i.NOOP_BEHAVIOR,noOverride:U,priority:F})}addMuted(g){g&&this.causes.push({type:"muted",source:{type:"user"},priority:6})}addMutedByList(g){g&&this.causes.push({type:"muted",source:{type:"list",list:g},priority:6})}}gm.ModerationDecision=d;function m(a){return a?a.profileView==="blur"||a.contentView==="blur"?c.High:a.contentList==="blur"||a.contentMedia==="blur"?c.Medium:c.Low:c.Low}function e(a,g){return a.priority-g.priority}return gm}var bm={},RD;function ty(){if(RD)return bm;RD=1,Object.defineProperty(bm,"__esModule",{value:!0}),bm.decideAccount=i,bm.filterAccountLabels=s;const r=pu();function i(c,d){const m=new r.ModerationDecision;m.setDid(c.did),m.setIsMe(c.did===d.userDid),c.viewer?.muted&&(c.viewer?.mutedByList?m.addMutedByList(c.viewer?.mutedByList):m.addMuted(c.viewer?.muted)),c.viewer?.blocking&&(c.viewer?.blockingByList?m.addBlockingByList(c.viewer?.blockingByList):m.addBlocking(c.viewer?.blocking)),m.addBlockedBy(c.viewer?.blockedBy);for(const e of s(c.labels))m.addLabel("account",e,d);return m}function s(c){return c?c.filter(d=>!d.uri.endsWith("/app.bsky.actor.profile/self")||d.val==="!no-unauthenticated"):[]}return bm}var fv={},vm={},SD;function ry(){if(SD)return vm;SD=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.decideProfile=i,vm.filterProfileLabels=s;const r=pu();function i(c,d){const m=new r.ModerationDecision;m.setDid(c.did),m.setIsMe(c.did===d.userDid);for(const e of s(c.labels))m.addLabel("profile",e,d);return m}function s(c){return c?c.filter(d=>d.uri.endsWith("/app.bsky.actor.profile/self")):[]}return vm}var TD;function l7(){if(TD)return fv;TD=1,Object.defineProperty(fv,"__esModule",{value:!0}),fv.decideFeedGenerator=c;const r=pu(),i=ty(),s=ry();function c(d,m){const e=new r.ModerationDecision;if(e.setDid(d.creator.did),e.setIsMe(d.creator.did===m.userDid),d.labels?.length)for(const a of d.labels)e.addLabel("content",a,m);return r.ModerationDecision.merge(e,(0,i.decideAccount)(d.creator,m),(0,s.decideProfile)(d.creator,m))}return fv}var hv={},CD;function u7(){if(CD)return hv;CD=1,Object.defineProperty(hv,"__esModule",{value:!0}),hv.decideNotification=c;const r=pu(),i=ty(),s=ry();function c(d,m){const e=new r.ModerationDecision;if(e.setDid(d.author.did),e.setIsMe(d.author.did===m.userDid),d.labels?.length)for(const a of d.labels)e.addLabel("content",a,m);return r.ModerationDecision.merge(e,(0,i.decideAccount)(d.author,m),(0,s.decideProfile)(d.author,m))}return hv}var mv={},xm={},kD;function CM(){if(kD)return xm;kD=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.matchMuteWords=c,xm.hasMutedWord=d;const r=gu(),i={LEADING_TRAILING_PUNCTUATION:new RegExp("(?:^\\p{P}+|\\p{P}+$)","gu"),WORD_BOUNDARY:/[\s\n\t\r\f\v]+?/g},s=["ja","zh","ko","th","vi"];function c({mutedWords:m,text:e,facets:a,outlineTags:g,languages:w,actor:R}){const S=s.includes(w?.[0]||""),D=[].concat(g||[]).concat((a||[]).flatMap(B=>B.features.filter(r.AppBskyRichtextFacet.isTag).map(F=>F.tag))).map(B=>B.toLowerCase()),k=[];e:for(const B of m){const F=B.value.toLowerCase(),K=e.toLowerCase();if(B.expiresAt&&B.expiresAt<new Date().toISOString()||B.actorTarget==="exclude-following"&&R?.viewer?.following)continue;if(D.includes(F)){k.push({word:B,predicate:B.value});continue}if(!B.targets.includes("content"))continue;if((F.length===1||S)&&K.includes(F)){k.push({word:B,predicate:B.value});continue}if(F.length>K.length)continue;if(F===K){k.push({word:B,predicate:B.value});continue}if(new RegExp("(?:\\s|\\p{P})+?","u").test(F)&&K.includes(F)){k.push({word:B,predicate:B.value});continue}const U=K.split(i.WORD_BOUNDARY);for(const ee of U){if(ee===F){k.push({word:B,predicate:ee});continue e}const le=ee.replace(i.LEADING_TRAILING_PUNCTUATION,"");if(F===le){k.push({word:B,predicate:ee});continue e}if(!(F.length>le.length)&&new RegExp("\\p{P}+","u").test(le)){if(/[/]+/.test(le))continue e;const Q=le.replace(new RegExp("\\p{P}+","gu")," ");if(Q===F){k.push({word:B,predicate:ee});continue e}if(Q.replace(/\s/gu,"")===F){k.push({word:B,predicate:ee});continue e}const pe=le.split(new RegExp("\\p{P}+","u"));for(const _e of pe)if(_e===F){k.push({word:B,predicate:ee});continue e}}}}return k.length?k:void 0}function d(m){return!!c(m)}return xm}var PD;function c7(){if(PD)return mv;PD=1,Object.defineProperty(mv,"__esModule",{value:!0}),mv.decidePost=m;const r=gu(),i=pu(),s=CM(),c=ty(),d=ry();function m(D,k){return i.ModerationDecision.merge(e(D,k),a(D.embed,k)?.downgrade(),(0,c.decideAccount)(D.author,k),(0,d.decideProfile)(D.author,k))}function e(D,k){const B=new i.ModerationDecision;if(B.setDid(D.author.did),B.setIsMe(D.author.did===k.userDid),D.labels?.length)for(const F of D.labels)B.addLabel("content",F,k);return B.addHidden(R(D,k.prefs.hiddenPosts)),B.isMe||B.addMutedWord(S(D,k.prefs.mutedWords)),B}function a(D,k){if(D){if((r.AppBskyEmbedRecord.isView(D)||r.AppBskyEmbedRecordWithMedia.isView(D))&&r.AppBskyEmbedRecord.isViewRecord(D.record))return g(D.record,k);if(r.AppBskyEmbedRecordWithMedia.isView(D)&&r.AppBskyEmbedRecord.isViewRecord(D.record.record))return g(D.record.record,k);if((r.AppBskyEmbedRecord.isView(D)||r.AppBskyEmbedRecordWithMedia.isView(D))&&r.AppBskyEmbedRecord.isViewBlocked(D.record))return w(D.record,k);if(r.AppBskyEmbedRecordWithMedia.isView(D)&&r.AppBskyEmbedRecord.isViewBlocked(D.record.record))return w(D.record.record,k)}}function g(D,k){const B=new i.ModerationDecision;if(B.setDid(D.author.did),B.setIsMe(D.author.did===k.userDid),D.labels?.length)for(const F of D.labels)B.addLabel("content",F,k);return i.ModerationDecision.merge(B,(0,c.decideAccount)(D.author,k),(0,d.decideProfile)(D.author,k))}function w(D,k){const B=new i.ModerationDecision;return B.setDid(D.author.did),B.setIsMe(D.author.did===k.userDid),D.author.viewer?.muted&&(D.author.viewer?.mutedByList?B.addMutedByList(D.author.viewer?.mutedByList):B.addMuted(D.author.viewer?.muted)),D.author.viewer?.blocking&&(D.author.viewer?.blockingByList?B.addBlockingByList(D.author.viewer?.blockingByList):B.addBlocking(D.author.viewer?.blocking)),B.addBlockedBy(D.author.viewer?.blockedBy),B}function R(D,k){return k?.length?!!(k.includes(D.uri)||D.embed&&(r.AppBskyEmbedRecord.isView(D.embed)&&r.AppBskyEmbedRecord.isViewRecord(D.embed.record)&&k.includes(D.embed.record.uri)||r.AppBskyEmbedRecordWithMedia.isView(D.embed)&&r.AppBskyEmbedRecord.isViewRecord(D.embed.record.record)&&k.includes(D.embed.record.record.uri))):!1}function S(D,k){if(!k?.length)return;const B=D.author;if(r.AppBskyFeedPost.isRecord(D.record)){const K=D.record,U=(0,s.matchMuteWords)({mutedWords:k,text:K.text,facets:K.facets,outlineTags:K.tags,languages:K.langs,actor:B});if(U)return U;if(K.embed&&r.AppBskyEmbedImages.isMain(K.embed))for(const ee of K.embed.images){const le=(0,s.matchMuteWords)({mutedWords:k,text:ee.alt,languages:K.langs,actor:B});if(le)return le}}const{embed:F}=D;if(F){if((r.AppBskyEmbedRecord.isView(F)||r.AppBskyEmbedRecordWithMedia.isView(F))&&r.AppBskyEmbedRecord.isViewRecord(F.record)){if(r.AppBskyFeedPost.isRecord(F.record.value)){const K=F.record.value,U=F.record.author,ee=(0,s.matchMuteWords)({mutedWords:k,text:K.text,facets:K.facets,outlineTags:K.tags,languages:K.langs,actor:U});if(ee)return ee;if(r.AppBskyEmbedImages.isMain(K.embed))for(const le of K.embed.images){const Q=(0,s.matchMuteWords)({mutedWords:k,text:le.alt,languages:K.langs,actor:U});if(Q)return Q}if(r.AppBskyEmbedExternal.isMain(K.embed)){const{external:le}=K.embed,Q=(0,s.matchMuteWords)({mutedWords:k,text:le.title+" "+le.description,languages:[],actor:U});if(Q)return Q}if(r.AppBskyEmbedRecordWithMedia.isMain(K.embed)){if(r.AppBskyEmbedExternal.isMain(K.embed.media)){const{external:le}=K.embed.media,Q=(0,s.matchMuteWords)({mutedWords:k,text:le.title+" "+le.description,languages:[],actor:U});if(Q)return Q}if(r.AppBskyEmbedImages.isMain(K.embed.media))for(const le of K.embed.media.images){const Q=(0,s.matchMuteWords)({mutedWords:k,text:le.alt,languages:r.AppBskyFeedPost.isRecord(K.record)?K.langs:[],actor:U});if(Q)return Q}}}}else if(r.AppBskyEmbedExternal.isView(F)){const{external:K}=F,U=(0,s.matchMuteWords)({mutedWords:k,text:K.title+" "+K.description,languages:[],actor:B});if(U)return U}else if(r.AppBskyEmbedRecordWithMedia.isView(F)&&r.AppBskyEmbedRecord.isViewRecord(F.record.record)){const K=F.record.record.author;if(r.AppBskyFeedPost.isRecord(F.record.record.value)){const U=F.record.record.value,ee=(0,s.matchMuteWords)({mutedWords:k,text:U.text,facets:U.facets,outlineTags:U.tags,languages:U.langs,actor:K});if(ee)return ee}if(r.AppBskyEmbedImages.isView(F.media))for(const U of F.media.images){const ee=(0,s.matchMuteWords)({mutedWords:k,text:U.alt,languages:r.AppBskyFeedPost.isRecord(D.record)?D.record.langs:[],actor:K});if(ee)return ee}if(r.AppBskyEmbedExternal.isView(F.media)){const{external:U}=F.media,ee=(0,s.matchMuteWords)({mutedWords:k,text:U.title+" "+U.description,languages:[],actor:K});if(ee)return ee}}}}return mv}var yv={},LD;function d7(){if(LD)return yv;LD=1,Object.defineProperty(yv,"__esModule",{value:!0}),yv.decideUserList=d;const r=Rf(),i=pu(),s=ty(),c=ry();function d(e,a){const g=new i.ModerationDecision,w="creator"in e&&m(e.creator)?e.creator:void 0;if(w){if(g.setDid(w.did),g.setIsMe(w.did===a.userDid),e.labels?.length)for(const S of e.labels)g.addLabel("content",S,a);return i.ModerationDecision.merge(g,(0,s.decideAccount)(w,a),(0,c.decideProfile)(w,a))}const R=new r.AtUri(e.uri).hostname;if(g.setDid(R),g.setIsMe(R===a.userDid),e.labels?.length)for(const S of e.labels)g.addLabel("content",S,a);return g}function m(e){return e&&typeof e=="object"&&"did"in e}return yv}var xc={},DD;function p7(){if(DD)return xc;DD=1,Object.defineProperty(xc,"__esModule",{value:!0}),xc.isQuotedPost=s,xc.isQuotedPostWithMedia=c,xc.interpretLabelValueDefinition=d,xc.interpretLabelValueDefinitions=m;const r=gu(),i=me();function s(e){return!!(e&&r.AppBskyEmbedRecord.isView(e))}function c(e){return!!(e&&r.AppBskyEmbedRecordWithMedia.isView(e))}function d(e,a){const g={account:{},profile:{},content:{}},w=e.severity==="alert"?"alert":e.severity==="inform"?"inform":void 0;e.blurs==="content"?(g.account.profileList=w,g.account.profileView=w,g.account.contentList="blur",g.account.contentView=e.adultOnly?"blur":w,g.profile.profileList=w,g.profile.profileView=w,g.content.contentList="blur",g.content.contentView=e.adultOnly?"blur":w):e.blurs==="media"?(g.account.profileList=w,g.account.profileView=w,g.account.avatar="blur",g.account.banner="blur",g.profile.profileList=w,g.profile.profileView=w,g.profile.avatar="blur",g.profile.banner="blur",g.content.contentMedia="blur"):e.blurs==="none"&&(g.account.profileList=w,g.account.profileView=w,g.account.contentList=w,g.account.contentView=w,g.profile.profileList=w,g.profile.profileView=w,g.content.contentList=w,g.content.contentView=w);let R="warn";(e.defaultSetting==="hide"||e.defaultSetting==="ignore")&&(R=e.defaultSetting);const S=["no-self"];return e.adultOnly&&S.push("adult"),{...e,definedBy:a,configurable:!0,defaultSetting:R,flags:S,behaviors:g}}function m(e){return(e.policies?.labelValueDefinitions||[]).filter((0,i.asPredicate)(r.ComAtprotoLabelDefs.validateLabelValueDefinition)).map(a=>d(a,e.creator.did))}return xc}var ID;function kM(){return ID||(ID=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.interpretLabelValueDefinitions=r.interpretLabelValueDefinition=r.matchMuteWords=r.hasMutedWord=r.ModerationDecision=r.ModerationUI=void 0,r.moderateProfile=D,r.moderatePost=k,r.moderateNotification=B,r.moderateFeedGenerator=F,r.moderateUserList=K;const i=pu(),s=ty(),c=l7(),d=u7(),m=c7(),e=ry(),a=d7();var g=TM();Object.defineProperty(r,"ModerationUI",{enumerable:!0,get:function(){return g.ModerationUI}});var w=pu();Object.defineProperty(r,"ModerationDecision",{enumerable:!0,get:function(){return w.ModerationDecision}});var R=CM();Object.defineProperty(r,"hasMutedWord",{enumerable:!0,get:function(){return R.hasMutedWord}}),Object.defineProperty(r,"matchMuteWords",{enumerable:!0,get:function(){return R.matchMuteWords}});var S=p7();Object.defineProperty(r,"interpretLabelValueDefinition",{enumerable:!0,get:function(){return S.interpretLabelValueDefinition}}),Object.defineProperty(r,"interpretLabelValueDefinitions",{enumerable:!0,get:function(){return S.interpretLabelValueDefinitions}});function D(U,ee){return i.ModerationDecision.merge((0,s.decideAccount)(U,ee),(0,e.decideProfile)(U,ee))}function k(U,ee){return(0,m.decidePost)(U,ee)}function B(U,ee){return(0,d.decideNotification)(U,ee)}function F(U,ee){return(0,c.decideFeedGenerator)(U,ee)}function K(U,ee){return(0,a.decideUserList)(U,ee)}})(l1)),l1}var wm={},BD;function f7(){if(BD)return wm;BD=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.mock=void 0;const r="bafyreiclp443lavogvhj3d2ob2cxbfuscni2k5jk7bebjzg7khl3esabwq";return wm.mock={post({text:i,facets:s,reply:c,embed:d}){return{$type:"app.bsky.feed.post",text:i,facets:s,reply:c,embed:d,langs:["en"],createdAt:new Date().toISOString()}},postView({record:i,author:s,embed:c,replyCount:d,repostCount:m,likeCount:e,viewer:a,labels:g}){return{$type:"app.bsky.feed.defs#postView",uri:`at://${s.did}/app.bsky.feed.post/fake`,cid:r,author:s,record:i,embed:c,replyCount:d,repostCount:m,likeCount:e,indexedAt:new Date().toISOString(),viewer:a,labels:g}},embedRecordView({record:i,author:s,labels:c}){return{$type:"app.bsky.embed.record#view",record:{$type:"app.bsky.embed.record#viewRecord",uri:`at://${s.did}/app.bsky.feed.post/fake`,cid:r,author:s,value:i,labels:c,indexedAt:new Date().toISOString()}}},profileViewBasic({handle:i,displayName:s,description:c,viewer:d,labels:m}){return{did:`did:web:${i}`,handle:i,displayName:s,description:c,viewer:d,labels:m}},actorViewerState({muted:i,mutedByList:s,blockedBy:c,blocking:d,blockingByList:m,following:e,followedBy:a}){return{muted:i,mutedByList:s,blockedBy:c,blocking:d,blockingByList:m,following:e,followedBy:a}},listViewBasic({name:i}){return{uri:"at://did:plc:fake/app.bsky.graph.list/fake",cid:r,name:i,purpose:"app.bsky.graph.defs#modlist",indexedAt:new Date().toISOString()}},replyNotification({author:i,record:s,labels:c}){return{uri:`at://${i.did}/app.bsky.feed.post/fake`,cid:r,author:i,reason:"reply",reasonSubject:`at://${i.did}/app.bsky.feed.post/fake-parent`,record:s,isRead:!1,indexedAt:new Date().toISOString(),labels:c}},followNotification({author:i,subjectDid:s,labels:c}){return{uri:`at://${i.did}/app.bsky.graph.follow/fake`,cid:r,author:i,reason:"follow",record:{$type:"app.bsky.graph.follow",createdAt:new Date().toISOString(),subject:s},isRead:!1,indexedAt:new Date().toISOString(),labels:c}},label({val:i,uri:s,src:c}){return{src:c||"did:plc:fake-labeler",uri:s,val:i,cts:new Date().toISOString()}}},wm}var ys={},ou={},MD;function h7(){if(MD)return ou;MD=1;var r=ou&&ou.__classPrivateFieldGet||function(m,e,a,g){if(a==="a"&&!g)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?m!==e||!g:!e.has(m))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?g:a==="a"?g.call(m):g?g.value:e.get(m)},i=ou&&ou.__classPrivateFieldSet||function(m,e,a,g,w){if(g==="m")throw new TypeError("Private method is not writable");if(g==="a"&&!w)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?m!==e||!w:!e.has(m))throw new TypeError("Cannot write private member to an object whose class did not declare it");return g==="a"?w.call(m,a):w?w.value=a:e.set(m,a),a},s,c;Object.defineProperty(ou,"__esModule",{value:!0});let d=class{constructor(){s.set(this,!1),c.set(this,new Set)}get acquired(){return r(this,s,"f")}acquireAsync({timeout:e}={}){if(!r(this,s,"f"))return i(this,s,!0,"f"),Promise.resolve();if(e==null)return new Promise(w=>{r(this,c,"f").add(w)});let a,g;return Promise.race([new Promise(w=>{a=()=>{clearTimeout(g),w()},r(this,c,"f").add(a)}),new Promise((w,R)=>{g=setTimeout(()=>{r(this,c,"f").delete(a),R(new Error("Timed out waiting for lock"))},e)})])}tryAcquire(){return r(this,s,"f")?!1:(i(this,s,!0,"f"),!0)}release(){if(!r(this,s,"f"))throw new Error("Cannot release an unacquired lock");if(r(this,c,"f").size>0){const[e]=r(this,c,"f");r(this,c,"f").delete(e),e()}else i(this,s,!1,"f")}};return ou.default=d,s=new WeakMap,c=new WeakMap,ou}var ni={},zD;function m7(){if(zD)return ni;zD=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isValidVerificationPrefs=ni.isValidThreadViewPref=ni.isValidSavedFeedsPrefV2=ni.isValidSavedFeedsPref=ni.isValidPostInteractionSettingsPref=ni.isValidPersonalDetailsPref=ni.isValidMutedWordsPref=ni.isValidLabelersPref=ni.isValidInterestsPref=ni.isValidHiddenPostsPref=ni.isValidFeedViewPref=ni.isValidContentLabelPref=ni.isValidBskyAppStatePref=ni.isValidAdultContentPref=ni.isValidProfile=void 0;const r=gu(),i=me();return ni.isValidProfile=(0,i.asPredicate)(r.AppBskyActorProfile.validateRecord),ni.isValidAdultContentPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateAdultContentPref),ni.isValidBskyAppStatePref=(0,i.asPredicate)(r.AppBskyActorDefs.validateBskyAppStatePref),ni.isValidContentLabelPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateContentLabelPref),ni.isValidFeedViewPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateFeedViewPref),ni.isValidHiddenPostsPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateHiddenPostsPref),ni.isValidInterestsPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateInterestsPref),ni.isValidLabelersPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateLabelersPref),ni.isValidMutedWordsPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateMutedWordsPref),ni.isValidPersonalDetailsPref=(0,i.asPredicate)(r.AppBskyActorDefs.validatePersonalDetailsPref),ni.isValidPostInteractionSettingsPref=(0,i.asPredicate)(r.AppBskyActorDefs.validatePostInteractionSettingsPref),ni.isValidSavedFeedsPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateSavedFeedsPref),ni.isValidSavedFeedsPrefV2=(0,i.asPredicate)(r.AppBskyActorDefs.validateSavedFeedsPrefV2),ni.isValidThreadViewPref=(0,i.asPredicate)(r.AppBskyActorDefs.validateThreadViewPref),ni.isValidVerificationPrefs=(0,i.asPredicate)(r.AppBskyActorDefs.validateVerificationPrefs),ni}var OD;function PM(){if(OD)return ys;OD=1;var r=ys&&ys.__createBinding||(Object.create?(function(rt,te,Be,fe){fe===void 0&&(fe=Be);var ye=Object.getOwnPropertyDescriptor(te,Be);(!ye||("get"in ye?!te.__esModule:ye.writable||ye.configurable))&&(ye={enumerable:!0,get:function(){return te[Be]}}),Object.defineProperty(rt,fe,ye)}):(function(rt,te,Be,fe){fe===void 0&&(fe=Be),rt[fe]=te[Be]})),i=ys&&ys.__setModuleDefault||(Object.create?(function(rt,te){Object.defineProperty(rt,"default",{enumerable:!0,value:te})}):function(rt,te){rt.default=te}),s=ys&&ys.__importStar||(function(){var rt=function(te){return rt=Object.getOwnPropertyNames||function(Be){var fe=[];for(var ye in Be)Object.prototype.hasOwnProperty.call(Be,ye)&&(fe[fe.length]=ye);return fe},rt(te)};return function(te){if(te&&te.__esModule)return te;var Be={};if(te!=null)for(var fe=rt(te),ye=0;ye<fe.length;ye++)fe[ye]!=="default"&&r(Be,te,fe[ye]);return i(Be,te),Be}})(),c=ys&&ys.__classPrivateFieldGet||function(rt,te,Be,fe){if(Be==="a"&&!fe)throw new TypeError("Private accessor was defined without a getter");if(typeof te=="function"?rt!==te||!fe:!te.has(rt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Be==="m"?fe:Be==="a"?fe.call(rt):fe?fe.value:te.get(rt)},d=ys&&ys.__importDefault||function(rt){return rt&&rt.__esModule?rt:{default:rt}},m;Object.defineProperty(ys,"__esModule",{value:!0}),ys.Agent=void 0;const e=d(h7()),a=fl(),g=Rf(),w=Wt(),R=gu(),S=he(),D=vM(),k=kM(),B=Vw(),F=s(m7()),K=bM(),U=xM(),ee={hideReplies:!1,hideRepliesByUnfollowed:!0,hideRepliesByLikeCount:0,hideReposts:!1,hideQuotePosts:!1},le={sort:"hotness",prioritizeFollowedUsers:!0};class Q extends w.XrpcClient{static configure(te){te.appLabelers&&(this.appLabelers=te.appLabelers.map(K.asDid))}get xrpc(){return this}constructor(te){const Be=typeof te=="object"&&"fetchHandler"in te?te:{did:void 0,fetchHandler:(0,w.buildFetchHandler)(te)};super((fe,ye)=>{const nt=new Headers(ye?.headers);return this.proxy&&!nt.has("atproto-proxy")&&nt.set("atproto-proxy",this.proxy),nt.set("atproto-accept-labelers",[...this.appLabelers.map(gt=>`${gt};redact`),...this.labelers,nt.get("atproto-accept-labelers")?.trim()].filter(Boolean).join(", ")),this.sessionManager.fetchHandler(fe,{...ye,headers:nt})},S.schemas),Object.defineProperty(this,"com",{enumerable:!0,configurable:!0,writable:!0,value:new R.ComNS(this)}),Object.defineProperty(this,"app",{enumerable:!0,configurable:!0,writable:!0,value:new R.AppNS(this)}),Object.defineProperty(this,"chat",{enumerable:!0,configurable:!0,writable:!0,value:new R.ChatNS(this)}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:new R.ToolsNS(this)}),Object.defineProperty(this,"sessionManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"labelers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"proxy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"uploadBlob",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.com.atproto.repo.uploadBlob(fe,ye)}),Object.defineProperty(this,"resolveHandle",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.com.atproto.identity.resolveHandle(fe,ye)}),Object.defineProperty(this,"updateHandle",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.com.atproto.identity.updateHandle(fe,ye)}),Object.defineProperty(this,"createModerationReport",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.com.atproto.moderation.createReport(fe,ye)}),Object.defineProperty(this,"getTimeline",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getTimeline(fe,ye)}),Object.defineProperty(this,"getAuthorFeed",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getAuthorFeed(fe,ye)}),Object.defineProperty(this,"getActorLikes",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getActorLikes(fe,ye)}),Object.defineProperty(this,"getPostThread",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getPostThread(fe,ye)}),Object.defineProperty(this,"getPost",{enumerable:!0,configurable:!0,writable:!0,value:fe=>this.app.bsky.feed.post.get(fe)}),Object.defineProperty(this,"getPosts",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getPosts(fe,ye)}),Object.defineProperty(this,"getLikes",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getLikes(fe,ye)}),Object.defineProperty(this,"getRepostedBy",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.feed.getRepostedBy(fe,ye)}),Object.defineProperty(this,"getFollows",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.graph.getFollows(fe,ye)}),Object.defineProperty(this,"getFollowers",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.graph.getFollowers(fe,ye)}),Object.defineProperty(this,"getProfile",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.actor.getProfile(fe,ye)}),Object.defineProperty(this,"getProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.actor.getProfiles(fe,ye)}),Object.defineProperty(this,"getSuggestions",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.actor.getSuggestions(fe,ye)}),Object.defineProperty(this,"searchActors",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.actor.searchActors(fe,ye)}),Object.defineProperty(this,"searchActorsTypeahead",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.actor.searchActorsTypeahead(fe,ye)}),Object.defineProperty(this,"listNotifications",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.notification.listNotifications(fe,ye)}),Object.defineProperty(this,"countUnreadNotifications",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.notification.getUnreadCount(fe,ye)}),Object.defineProperty(this,"getLabelers",{enumerable:!0,configurable:!0,writable:!0,value:(fe,ye)=>this.app.bsky.labeler.getServices(fe,ye)}),m.set(this,new e.default),this.sessionManager=Be}clone(){return this.copyInto(new Q(this.sessionManager))}copyInto(te){te.configureLabelers(this.labelers),te.configureProxy(this.proxy??null),te.clearHeaders();for(const[Be,fe]of this.headers)te.setHeader(Be,fe);return te}withProxy(te,Be){const fe=this.clone();return fe.configureProxy(`${(0,K.asDid)(Be)}#${te}`),fe}get appLabelers(){return this.constructor.appLabelers}configureLabelers(te){this.labelers=te.map(K.asDid)}configureLabelersHeader(te){this.configureLabelers(te.filter(K.isDid))}configureProxy(te){te===null?this.proxy=void 0:this.proxy=(0,K.asAtprotoProxy)(te)}configureProxyHeader(te,Be){(0,K.isDid)(Be)&&this.configureProxy(`${Be}#${te}`)}get did(){return this.sessionManager.did}get accountDid(){return this.assertDid}get assertDid(){return this.assertAuthenticated(),this.did}assertAuthenticated(){if(!this.did)throw new Error("Not logged in")}get api(){return this}async getLabelDefinitions(te){const Be=[...this.appLabelers];Xe(te)?Be.push(...te.moderationPrefs.labelers.map(nt=>nt.did)):dt(te)?Be.push(...te.labelers.map(nt=>nt.did)):Be.push(...te);const fe=await this.getLabelers({dids:Be,detailed:!0}),ye={};if(fe.data)for(const nt of fe.data.views)ye[nt.creator.did]=(0,k.interpretLabelValueDefinitions)(nt);return ye}async post(te){return te.createdAt||(te.createdAt=new Date().toISOString()),this.app.bsky.feed.post.create({repo:this.accountDid},te)}async deletePost(te){this.assertAuthenticated();const Be=new g.AtUri(te);return this.app.bsky.feed.post.delete({repo:Be.hostname,rkey:Be.rkey})}async like(te,Be,fe){return this.app.bsky.feed.like.create({repo:this.accountDid},{subject:{uri:te,cid:Be},createdAt:new Date().toISOString(),via:fe})}async deleteLike(te){this.assertAuthenticated();const Be=new g.AtUri(te);return this.app.bsky.feed.like.delete({repo:Be.hostname,rkey:Be.rkey})}async repost(te,Be,fe){return this.app.bsky.feed.repost.create({repo:this.accountDid},{subject:{uri:te,cid:Be},createdAt:new Date().toISOString(),via:fe})}async deleteRepost(te){this.assertAuthenticated();const Be=new g.AtUri(te);return this.app.bsky.feed.repost.delete({repo:Be.hostname,rkey:Be.rkey})}async follow(te){return this.app.bsky.graph.follow.create({repo:this.accountDid},{subject:te,createdAt:new Date().toISOString()})}async deleteFollow(te){this.assertAuthenticated();const Be=new g.AtUri(te);return this.app.bsky.graph.follow.delete({repo:Be.hostname,rkey:Be.rkey})}async upsertProfile(te){const Be=async()=>{const fe=this.assertDid,ye="app.bsky.actor.profile",nt=await this.com.atproto.repo.getRecord({repo:fe,collection:ye,rkey:"self"}).catch(Ft=>{}),gt=nt&&F.isValidProfile(nt.data.value)?nt.data.value:void 0,lt=await te(gt),be=R.AppBskyActorProfile.validateRecord({$type:ye,...lt});if(!be.success)throw be.error;await this.com.atproto.repo.putRecord({repo:fe,collection:ye,rkey:"self",record:be.value,swapRecord:nt?.data.cid||null})};return(0,a.retry)(Be,{maxRetries:5,retryable:fe=>fe instanceof R.ComAtprotoRepoPutRecord.InvalidSwapError})}async mute(te){return this.app.bsky.graph.muteActor({actor:te})}async unmute(te){return this.app.bsky.graph.unmuteActor({actor:te})}async muteModList(te){return this.app.bsky.graph.muteActorList({list:te})}async unmuteModList(te){return this.app.bsky.graph.unmuteActorList({list:te})}async blockModList(te){return this.app.bsky.graph.listblock.create({repo:this.accountDid},{subject:te,createdAt:new Date().toISOString()})}async unblockModList(te){const Be=this.accountDid,ye=(await this.app.bsky.graph.getList({list:te,limit:1})).data.list.viewer?.blocked;if(ye){const{rkey:nt}=new g.AtUri(ye);return this.app.bsky.graph.listblock.delete({repo:Be,rkey:nt})}}async updateSeenNotifications(te=new Date().toISOString()){return this.app.bsky.notification.updateSeen({seenAt:te})}async getPreferences(){const te={feeds:{saved:void 0,pinned:void 0},savedFeeds:void 0,feedViewPrefs:{home:{...ee}},threadViewPrefs:{...le},moderationPrefs:{adultContentEnabled:!1,labels:{...B.DEFAULT_LABEL_SETTINGS},labelers:this.appLabelers.map(ye=>({did:ye,labels:{}})),mutedWords:[],hiddenPosts:[]},birthDate:void 0,interests:{tags:[]},bskyAppState:{queuedNudges:[],activeProgressGuide:void 0,nuxs:[]},postInteractionSettings:{threadgateAllowRules:void 0,postgateEmbeddingRules:void 0},verificationPrefs:{hideBadges:!1}},Be=await this.app.bsky.actor.getPreferences({}),fe=[];for(const ye of Be.data.preferences)if(F.isValidAdultContentPref(ye))te.moderationPrefs.adultContentEnabled=ye.enabled;else if(F.isValidContentLabelPref(ye)){const nt=Te(ye);fe.push(nt)}else if(F.isValidLabelersPref(ye))te.moderationPrefs.labelers=this.appLabelers.map(nt=>({did:nt,labels:{}})).concat(ye.labelers.map(nt=>({...nt,labels:{}})));else if(F.isValidSavedFeedsPrefV2(ye))te.savedFeeds=ye.items;else if(F.isValidSavedFeedsPref(ye))te.feeds.saved=ye.saved,te.feeds.pinned=ye.pinned;else if(F.isValidPersonalDetailsPref(ye))ye.birthDate&&(te.birthDate=new Date(ye.birthDate));else if(F.isValidFeedViewPref(ye)){const{$type:nt,feed:gt,...lt}=ye;te.feedViewPrefs[gt]={...ee,...lt}}else if(F.isValidThreadViewPref(ye)){const{$type:nt,...gt}=ye;te.threadViewPrefs={...te.threadViewPrefs,...gt}}else if(F.isValidInterestsPref(ye)){const{$type:nt,...gt}=ye;te.interests={...te.interests,...gt}}else F.isValidMutedWordsPref(ye)?(te.moderationPrefs.mutedWords=ye.items,te.moderationPrefs.mutedWords.length&&(te.moderationPrefs.mutedWords=te.moderationPrefs.mutedWords.map(nt=>(nt.actorTarget=nt.actorTarget||"all",nt)))):F.isValidHiddenPostsPref(ye)?te.moderationPrefs.hiddenPosts=ye.items:F.isValidBskyAppStatePref(ye)?(te.bskyAppState.queuedNudges=ye.queuedNudges||[],te.bskyAppState.activeProgressGuide=ye.activeProgressGuide,te.bskyAppState.nuxs=ye.nuxs||[]):F.isValidPostInteractionSettingsPref(ye)?(te.postInteractionSettings.threadgateAllowRules=ye.threadgateAllowRules,te.postInteractionSettings.postgateEmbeddingRules=ye.postgateEmbeddingRules):F.isValidVerificationPrefs(ye)&&(te.verificationPrefs={hideBadges:ye.hideBadges});if(te.savedFeeds==null){const{saved:ye,pinned:nt}=te.feeds;if(ye&&nt){const gt=new Map;gt.set("timeline",{id:a.TID.nextStr(),type:"timeline",value:"following",pinned:!0});for(const lt of nt){const be=(0,U.getSavedFeedType)(lt);be!=="unknown"&&gt.set(lt,{id:a.TID.nextStr(),type:be,value:lt,pinned:!0})}for(const lt of ye)if(!gt.has(lt)){const be=(0,U.getSavedFeedType)(lt);if(be==="unknown")continue;gt.set(lt,{id:a.TID.nextStr(),type:be,value:lt,pinned:!1})}te.savedFeeds=Array.from(gt.values())}else te.savedFeeds=[{id:a.TID.nextStr(),type:"timeline",value:"following",pinned:!0}];await this.overwriteSavedFeeds(te.savedFeeds)}for(const ye of fe)if(ye.labelerDid){const nt=te.moderationPrefs.labelers.find(gt=>gt.did===ye.labelerDid);if(!nt)continue;nt.labels[ye.label]=ye.visibility}else te.moderationPrefs.labels[ye.label]=ye.visibility;return te.moderationPrefs.labels=pe(te.moderationPrefs.labels),this.configureLabelers(_e(Be.data.preferences)),te}async overwriteSavedFeeds(te){te.forEach(U.validateSavedFeed);const Be=new Map;return te.forEach(fe=>{Be.has(fe.id)&&Be.delete(fe.id),Be.set(fe.id,fe)}),this.updateSavedFeedsV2Preferences(()=>Array.from(Be.values()))}async updateSavedFeeds(te){return te.map(U.validateSavedFeed),this.updateSavedFeedsV2Preferences(Be=>Be.map(fe=>{const ye=te.find(nt=>fe.id===nt.id);return ye?{...fe,pinned:ye.pinned}:fe}))}async addSavedFeeds(te){const Be=te.map(fe=>({...fe,id:a.TID.nextStr()}));return Be.forEach(U.validateSavedFeed),this.updateSavedFeedsV2Preferences(fe=>[...fe,...Be])}async removeSavedFeeds(te){return this.updateSavedFeedsV2Preferences(Be=>[...Be.filter(fe=>!te.find(ye=>fe.id===ye))])}async setSavedFeeds(te,Be){return this.updateFeedPreferences(()=>({saved:te,pinned:Be}))}async addSavedFeed(te){return this.updateFeedPreferences((Be,fe)=>({saved:[...Be.filter(ye=>ye!==te),te],pinned:fe}))}async removeSavedFeed(te){return this.updateFeedPreferences((Be,fe)=>({saved:Be.filter(ye=>ye!==te),pinned:fe.filter(ye=>ye!==te)}))}async addPinnedFeed(te){return this.updateFeedPreferences((Be,fe)=>({saved:[...Be.filter(ye=>ye!==te),te],pinned:[...fe.filter(ye=>ye!==te),te]}))}async removePinnedFeed(te){return this.updateFeedPreferences((Be,fe)=>({saved:Be,pinned:fe.filter(ye=>ye!==te)}))}async setAdultContentEnabled(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidAdultContentPref)||{$type:"app.bsky.actor.defs#adultContentPref",enabled:te};return fe.enabled=te,Be.filter(ye=>!R.AppBskyActorDefs.isAdultContentPref(ye)).concat(fe)})}async setContentLabelPref(te,Be,fe){fe&&(0,g.ensureValidDid)(fe),await this.updatePreferences(ye=>{const nt=ye.filter(F.isValidContentLabelPref).findLast(lt=>lt.label===te&&lt.labelerDid===fe)||{$type:"app.bsky.actor.defs#contentLabelPref",label:te,labelerDid:fe,visibility:Be};nt.visibility=Be;let gt;if(R.AppBskyActorDefs.isContentLabelPref(nt)&&!nt.labelerDid){const lt={"graphic-media":"gore",porn:"nsfw",sexual:"suggestive",__proto__:null}[nt.label];lt&&(gt=ye.filter(F.isValidContentLabelPref).findLast(be=>be.label===lt&&be.labelerDid===void 0)||{$type:"app.bsky.actor.defs#contentLabelPref",label:lt,labelerDid:void 0,visibility:Be},gt.visibility=Be)}return ye.filter(lt=>!R.AppBskyActorDefs.isContentLabelPref(lt)||!(lt.label===te&&lt.labelerDid===fe)).concat(nt).filter(lt=>gt?!R.AppBskyActorDefs.isContentLabelPref(lt)||!(lt.label===gt.label&&lt.labelerDid===void 0):!0).concat(gt?[gt]:[])})}async addLabeler(te){const Be=await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidLabelersPref)||{$type:"app.bsky.actor.defs#labelersPref",labelers:[]};return ye.labelers.some(nt=>nt.did===te)||ye.labelers.push({did:te}),fe.filter(nt=>!R.AppBskyActorDefs.isLabelersPref(nt)).concat(ye)});this.configureLabelers(_e(Be))}async removeLabeler(te){const Be=await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidLabelersPref)||{$type:"app.bsky.actor.defs#labelersPref",labelers:[]};return ye.labelers=ye.labelers.filter(nt=>nt.did!==te),fe.filter(nt=>!R.AppBskyActorDefs.isLabelersPref(nt)).concat(ye)});this.configureLabelers(_e(Be))}async setPersonalDetails({birthDate:te}){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidPersonalDetailsPref)||{$type:"app.bsky.actor.defs#personalDetailsPref"};return fe.birthDate=te instanceof Date?te.toISOString():te,Be.filter(ye=>!R.AppBskyActorDefs.isPersonalDetailsPref(ye)).concat(fe)})}async setFeedViewPrefs(te,Be){await this.updatePreferences(fe=>{const ye=fe.filter(F.isValidFeedViewPref).findLast(nt=>nt.feed===te);return fe.filter(nt=>!R.AppBskyActorDefs.isFeedViewPref(nt)||nt.feed!==te).concat({...ye,...Be,$type:"app.bsky.actor.defs#feedViewPref",feed:te})})}async setThreadViewPrefs(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidThreadViewPref);return Be.filter(ye=>!R.AppBskyActorDefs.isThreadViewPref(ye)).concat({...fe,...te,$type:"app.bsky.actor.defs#threadViewPref"})})}async setInterestsPref(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidInterestsPref);return Be.filter(ye=>!R.AppBskyActorDefs.isInterestsPref(ye)).concat({...fe,...te,$type:"app.bsky.actor.defs#interestsPref"})})}async addMutedWord(te){const Be=(0,U.sanitizeMutedWordValue)(te.value);Be&&await this.updatePreferences(fe=>{let ye=fe.findLast(F.isValidMutedWordsPref);const nt={id:a.TID.nextStr(),value:Be,targets:te.targets||[],actorTarget:te.actorTarget||"all",expiresAt:te.expiresAt||void 0};return ye?(ye.items.push(nt),ye.items=He(ye.items)):ye={$type:"app.bsky.actor.defs#mutedWordsPref",items:[nt]},fe.filter(gt=>!R.AppBskyActorDefs.isMutedWordsPref(gt)).concat(ye)})}async addMutedWords(te){await Promise.all(te.map(Be=>this.addMutedWord(Be)))}async upsertMutedWords(te){await this.addMutedWords(te)}async updateMutedWord(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidMutedWordsPref);return fe?(fe.items=fe.items.map(ye=>{if(et(ye,te)){const gt={...ye,...te};return{id:ye.id||a.TID.nextStr(),value:(0,U.sanitizeMutedWordValue)(gt.value)||ye.value,targets:gt.targets||[],actorTarget:gt.actorTarget||"all",expiresAt:gt.expiresAt||void 0}}else return ye}),fe.items=He(fe.items),Be.filter(ye=>!R.AppBskyActorDefs.isMutedWordsPref(ye)).concat(fe)):Be})}async removeMutedWord(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidMutedWordsPref);if(fe){for(let ye=0;ye<fe.items.length;ye++)if(et(fe.items[ye],te)){fe.items.splice(ye,1);break}return fe.items=He(fe.items),Be.filter(ye=>!R.AppBskyActorDefs.isMutedWordsPref(ye)).concat(fe)}return Be})}async removeMutedWords(te){await Promise.all(te.map(Be=>this.removeMutedWord(Be)))}async hidePost(te){await this.updateHiddenPost(te,"hide")}async unhidePost(te){await this.updateHiddenPost(te,"unhide")}async bskyAppQueueNudges(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return fe.queuedNudges=(fe.queuedNudges||[]).concat(te),Be.filter(ye=>!R.AppBskyActorDefs.isBskyAppStatePref(ye)).concat(fe)})}async bskyAppDismissNudges(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return te=Array.isArray(te)?te:[te],fe.queuedNudges=(fe.queuedNudges||[]).filter(ye=>!te.includes(ye)),Be.filter(ye=>!R.AppBskyActorDefs.isBskyAppStatePref(ye)).concat(fe)})}async bskyAppSetActiveProgressGuide(te){if(te){const Be=R.AppBskyActorDefs.validateBskyAppProgressGuide(te);if(!Be.success)throw Be.error}await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return fe.activeProgressGuide=te,Be.filter(ye=>!R.AppBskyActorDefs.isBskyAppStatePref(ye)).concat(fe)})}async bskyAppUpsertNux(te){(0,U.validateNux)(te),await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};fe.nuxs=fe.nuxs||[];const ye=fe.nuxs?.find(gt=>gt.id===te.id);let nt;return ye?nt={id:ye.id,completed:te.completed,data:te.data,expiresAt:te.expiresAt}:nt=te,fe.nuxs=fe.nuxs.filter(gt=>gt.id!==te.id).concat(nt),Be.filter(gt=>!R.AppBskyActorDefs.isBskyAppStatePref(gt)).concat(fe)})}async bskyAppRemoveNuxs(te){await this.updatePreferences(Be=>{const fe=Be.findLast(F.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return fe.nuxs=(fe.nuxs||[]).filter(ye=>!te.includes(ye.id)),Be.filter(ye=>!R.AppBskyActorDefs.isBskyAppStatePref(ye)).concat(fe)})}async setPostInteractionSettings(te){const Be=R.AppBskyActorDefs.validatePostInteractionSettingsPref(te);if(!Be.success)throw Be.error;await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidPostInteractionSettingsPref)||{$type:"app.bsky.actor.defs#postInteractionSettingsPref"};return ye.threadgateAllowRules=te.threadgateAllowRules,ye.postgateEmbeddingRules=te.postgateEmbeddingRules,fe.filter(nt=>!R.AppBskyActorDefs.isPostInteractionSettingsPref(nt)).concat(ye)})}async setVerificationPrefs(te){const Be=R.AppBskyActorDefs.validateVerificationPrefs(te);if(!Be.success)throw Be.error;await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidVerificationPrefs)||{$type:"app.bsky.actor.defs#verificationPrefs",hideBadges:!1};return ye.hideBadges=te.hideBadges,fe.filter(nt=>!R.AppBskyActorDefs.isVerificationPrefs(nt)).concat(ye)})}async updatePreferences(te){try{await c(this,m,"f").acquireAsync();const Be=await this.app.bsky.actor.getPreferences({}),fe=te(Be.data.preferences);return fe===!1?Be.data.preferences:(await this.app.bsky.actor.putPreferences({preferences:fe}),fe)}finally{c(this,m,"f").release()}}async updateHiddenPost(te,Be){await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidHiddenPostsPref)||{$type:"app.bsky.actor.defs#hiddenPostsPref",items:[]},nt=new Set(ye.items);return Be==="hide"?nt.add(te):nt.delete(te),ye.items=[...nt],fe.filter(gt=>!R.AppBskyActorDefs.isHiddenPostsPref(gt)).concat(ye)})}async updateFeedPreferences(te){let Be;return await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidSavedFeedsPref)||{$type:"app.bsky.actor.defs#savedFeedsPref",saved:[],pinned:[]};return Be=te(ye.saved,ye.pinned),ye.saved=Be.saved,ye.pinned=Be.pinned,fe.filter(nt=>!R.AppBskyActorDefs.isSavedFeedsPref(nt)).concat(ye)}),Be}async updateSavedFeedsV2Preferences(te){let Be=[];return await this.updatePreferences(fe=>{const ye=fe.findLast(F.isValidSavedFeedsPrefV2)||{$type:"app.bsky.actor.defs#savedFeedsPrefV2",items:[]},nt=te(ye.items);ye.items=[...nt].sort((be,Ft)=>be.pinned===Ft.pinned?0:be.pinned?-1:1),Be=nt;let gt=fe.filter(be=>!R.AppBskyActorDefs.isSavedFeedsPrefV2(be)).concat(ye),lt=fe.findLast(F.isValidSavedFeedsPref);if(lt){const{saved:be,pinned:Ft}=lt,Ut=(0,U.savedFeedsToUriArrays)(ye.items.filter(Le=>["feed","list"].includes(Le.type)));lt={...lt,saved:Array.from(new Set([...be,...Ut.saved])),pinned:Array.from(new Set([...Ft,...Ut.pinned]))},gt=gt.filter(Le=>!R.AppBskyActorDefs.isSavedFeedsPref(Le)).concat(lt)}return gt}),Be}}ys.Agent=Q,m=new WeakMap,Object.defineProperty(Q,"appLabelers",{enumerable:!0,configurable:!0,writable:!0,value:[D.BSKY_LABELER_DID]});function Te(rt){let te=rt.visibility;return te==="show"&&(te="ignore"),{...rt,visibility:te}}function pe(rt){const te={...rt},Be={gore:"graphic-media",nsfw:"porn",suggestive:"sexual"};for(const fe in te){const ye=Be[fe];ye&&(te[ye]=te[fe])}return te}function _e(rt){const te=rt.findLast(F.isValidLabelersPref);let Be=[];return te&&(Be=te.labelers.map(fe=>fe.did)),Be}function Xe(rt){return rt&&typeof rt=="object"&&"moderationPrefs"in rt&&dt(rt.moderationPrefs)}function dt(rt){return rt&&typeof rt=="object"&&"labelers"in rt}function He(rt){return rt.map(te=>({...te,id:te.id||a.TID.nextStr()}))}function et(rt,te){const Be=rt.id,fe=Be&&Be===te.id,ye=!Be&&rt.value===te.value;return fe||ye}return ys}var wc={},VD;function Ev(){if(VD)return wc;VD=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.CredentialSession=wc.AtpAgent=void 0;const r=fl(),i=Wt(),s=PM(),c=gu(),d=he(),m=globalThis.ReadableStream;class e extends s.Agent{constructor(B){const F=B instanceof a?B:new a(new URL(B.service),B.fetch,B.persistSession);if(super(F),Object.defineProperty(this,"sessionManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sessionManager=F,!(B instanceof a)&&B.headers)for(const[K,U]of B.headers)this.setHeader(K,U)}clone(){return this.copyInto(new e(this.sessionManager))}get session(){return this.sessionManager.session}get hasSession(){return this.sessionManager.hasSession}get did(){return this.sessionManager.did}get serviceUrl(){return this.sessionManager.serviceUrl}get pdsUrl(){return this.sessionManager.pdsUrl}get dispatchUrl(){return this.sessionManager.dispatchUrl}get service(){return this.serviceUrl}get persistSession(){throw new Error('Cannot set persistSession directly. "persistSession" is defined through the constructor and will be invoked automatically when session data changes.')}set persistSession(B){throw new Error('Cannot set persistSession directly. "persistSession" must be defined in the constructor and can no longer be changed.')}getServiceUrl(){return this.serviceUrl}async resumeSession(B){return this.sessionManager.resumeSession(B)}async createAccount(B,F){return this.sessionManager.createAccount(B,F)}async login(B){return this.sessionManager.login(B)}async logout(){return this.sessionManager.logout()}}wc.AtpAgent=e;class a{constructor(B,F=globalThis.fetch,K){Object.defineProperty(this,"serviceUrl",{enumerable:!0,configurable:!0,writable:!0,value:B}),Object.defineProperty(this,"fetch",{enumerable:!0,configurable:!0,writable:!0,value:F}),Object.defineProperty(this,"persistSession",{enumerable:!0,configurable:!0,writable:!0,value:K}),Object.defineProperty(this,"pdsUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"refreshSessionPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server",{enumerable:!0,configurable:!0,writable:!0,value:new c.ComAtprotoServerNS(new i.XrpcClient((U,ee)=>(0,this.fetch)(new URL(U,this.serviceUrl),ee),d.schemas))})}get did(){return this.session?.did}get dispatchUrl(){return this.pdsUrl||this.serviceUrl}get hasSession(){return!!this.session}setFetch(B=globalThis.fetch){this.fetch=B}async fetchHandler(B,F){await this.refreshSessionPromise;const K=new URL(B,this.dispatchUrl),U=new Request(K,F),ee=this.session?.accessJwt;if(!ee||U.headers.has("authorization"))return(0,this.fetch)(U);U.headers.set("authorization",`Bearer ${ee}`);const le=await(0,this.fetch)(U);if(!this.session?.refreshJwt||!await w(le,[400],["ExpiredToken"]))return le;try{await this.refreshSession()}catch{return le}if(F?.signal?.aborted||m&&F?.body instanceof m)return le;const Te=this.session?.accessJwt;if(!Te||Te===ee)return le;await le.body?.cancel();const pe=new URL(B,this.dispatchUrl),_e=new Request(pe,F);return _e.headers.set("authorization",`Bearer ${Te}`),await(0,this.fetch)(_e)}async createAccount(B,F){try{const K=await this.server.createAccount(B,F);return this.session={accessJwt:K.data.accessJwt,refreshJwt:K.data.refreshJwt,handle:K.data.handle,did:K.data.did,email:B.email,emailConfirmed:!1,emailAuthFactor:!1,active:!0},this.persistSession?.("create",this.session),this._updateApiEndpoint(K.data.didDoc),K}catch(K){throw this.session=void 0,this.persistSession?.("create-failed",void 0),K}}async login(B){try{const F=await this.server.createSession({identifier:B.identifier,password:B.password,authFactorToken:B.authFactorToken,allowTakendown:B.allowTakendown});return this.session={accessJwt:F.data.accessJwt,refreshJwt:F.data.refreshJwt,handle:F.data.handle,did:F.data.did,email:F.data.email,emailConfirmed:F.data.emailConfirmed,emailAuthFactor:F.data.emailAuthFactor,active:F.data.active??!0,status:F.data.status},this._updateApiEndpoint(F.data.didDoc),this.persistSession?.("create",this.session),F}catch(F){throw this.session=void 0,this.persistSession?.("create-failed",void 0),F}}async logout(){if(this.session)try{await this.server.deleteSession(void 0,{headers:{authorization:`Bearer ${this.session.refreshJwt}`}})}catch{}finally{this.session=void 0,this.persistSession?.("expired",void 0)}}async resumeSession(B){this.session=B;try{const F=await this.server.getSession(void 0,{headers:{authorization:`Bearer ${B.accessJwt}`}}).catch(async K=>{if(K instanceof i.XRPCError&&["ExpiredToken","InvalidToken"].includes(K.error)&&B.refreshJwt)try{const U=await this.server.refreshSession(void 0,{headers:{authorization:`Bearer ${B.refreshJwt}`}});return B.accessJwt=U.data.accessJwt,B.refreshJwt=U.data.refreshJwt,this.server.getSession(void 0,{headers:{authorization:`Bearer ${B.accessJwt}`}})}catch{}throw K});if(F.data.did!==B.did)throw new i.XRPCError(i.ResponseType.InvalidRequest,"Invalid session","InvalidDID");return B.email=F.data.email,B.handle=F.data.handle,B.emailConfirmed=F.data.emailConfirmed,B.emailAuthFactor=F.data.emailAuthFactor,B.active=F.data.active??!0,B.status=F.data.status,this.session===B&&(this._updateApiEndpoint(F.data.didDoc),this.persistSession?.("update",B)),F}catch(F){throw this.session===B&&(F instanceof i.XRPCError&&["ExpiredToken","InvalidToken"].includes(F.error)?(this.session=void 0,this.persistSession?.("expired",void 0)):(this.session=B,this.persistSession?.("network-error",B))),F}}async refreshSession(){return this.refreshSessionPromise||(this.refreshSessionPromise=this._refreshSessionInner().finally(()=>{this.refreshSessionPromise=void 0}))}async _refreshSessionInner(){if(this.session?.refreshJwt)try{const B=await this.server.refreshSession(void 0,{headers:{authorization:`Bearer ${this.session.refreshJwt}`}});this.session={...this.session,accessJwt:B.data.accessJwt,refreshJwt:B.data.refreshJwt,handle:B.data.handle,did:B.data.did},this._updateApiEndpoint(B.data.didDoc),this.persistSession?.("update",this.session)}catch(B){B instanceof i.XRPCError&&B.error&&["ExpiredToken","InvalidToken"].includes(B.error)&&(this.session=void 0,this.persistSession?.("expired",void 0))}}_updateApiEndpoint(B){if((0,r.isValidDidDoc)(B)){const F=(0,r.getPdsEndpoint)(B);this.pdsUrl=F?new URL(F):void 0}else this.pdsUrl=void 0}}wc.CredentialSession=a;function g(k){return i.errorResponseBody.safeParse(k).success}async function w(k,B,F){if(!B.includes(k.status))return!1;try{const K=await R(k,10240);return g(K)&&F.includes(K.error)}catch{return!1}}async function R(k,B=1/0){if(D(k)!=="application/json")throw new Error("Not JSON");if(S(k)>B)throw new Error("Response too large");return k.clone().json()}function S({headers:k}){return k.get("Content-Length")?Number(k.get("Content-Length")):NaN}function D({headers:k}){return k.get("Content-Type")?.split(";")[0]?.trim()}return wc}var Em={},UD;function y7(){if(UD)return Em;UD=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.BskyAgent=void 0;const r=Ev();class i extends r.AtpAgent{clone(){if(this.constructor===i){const c=new i(this.sessionManager);return this.copyInto(c)}throw new TypeError("Cannot clone a subclass of BskyAgent")}}return Em.BskyAgent=i,Em}var jD;function g7(){return jD||(jD=1,(function(r){var i=tc&&tc.__createBinding||(Object.create?(function(K,U,ee,le){le===void 0&&(le=ee);var Q=Object.getOwnPropertyDescriptor(U,ee);(!Q||("get"in Q?!U.__esModule:Q.writable||Q.configurable))&&(Q={enumerable:!0,get:function(){return U[ee]}}),Object.defineProperty(K,le,Q)}):(function(K,U,ee,le){le===void 0&&(le=ee),K[le]=U[ee]})),s=tc&&tc.__exportStar||function(K,U){for(var ee in K)ee!=="default"&&!Object.prototype.hasOwnProperty.call(U,ee)&&i(U,K,ee)};Object.defineProperty(r,"__esModule",{value:!0}),r.lexicons=r.default=r.BskyAgent=r.CredentialSession=r.AtpAgent=r.Agent=r.LABELS=r.DEFAULT_LABEL_SETTINGS=r.asPredicate=r.schemas=r.parseLanguage=r.stringifyLex=r.lexToJson=r.jsonToLex=r.jsonStringToLex=r.BlobRef=r.AtUri=void 0;const c=yf(),d=he();var m=Rf();Object.defineProperty(r,"AtUri",{enumerable:!0,get:function(){return m.AtUri}});var e=yf();Object.defineProperty(r,"BlobRef",{enumerable:!0,get:function(){return e.BlobRef}}),Object.defineProperty(r,"jsonStringToLex",{enumerable:!0,get:function(){return e.jsonStringToLex}}),Object.defineProperty(r,"jsonToLex",{enumerable:!0,get:function(){return e.jsonToLex}}),Object.defineProperty(r,"lexToJson",{enumerable:!0,get:function(){return e.lexToJson}}),Object.defineProperty(r,"stringifyLex",{enumerable:!0,get:function(){return e.stringifyLex}});var a=fl();Object.defineProperty(r,"parseLanguage",{enumerable:!0,get:function(){return a.parseLanguage}}),s(bM(),r),s(vM(),r),s(xM(),r),s(gu(),r);var g=he();Object.defineProperty(r,"schemas",{enumerable:!0,get:function(){return g.schemas}});var w=me();Object.defineProperty(r,"asPredicate",{enumerable:!0,get:function(){return w.asPredicate}}),s(a7(),r),s(RM(),r),s(Ow(),r),s(AM(),r),s(kM(),r),s(SM(),r),s(f7(),r);var R=Vw();Object.defineProperty(r,"DEFAULT_LABEL_SETTINGS",{enumerable:!0,get:function(){return R.DEFAULT_LABEL_SETTINGS}}),Object.defineProperty(r,"LABELS",{enumerable:!0,get:function(){return R.LABELS}});var S=PM();Object.defineProperty(r,"Agent",{enumerable:!0,get:function(){return S.Agent}});var D=Ev();Object.defineProperty(r,"AtpAgent",{enumerable:!0,get:function(){return D.AtpAgent}});var k=Ev();Object.defineProperty(r,"CredentialSession",{enumerable:!0,get:function(){return k.CredentialSession}});var B=y7();Object.defineProperty(r,"BskyAgent",{enumerable:!0,get:function(){return B.BskyAgent}});var F=Ev();Object.defineProperty(r,"default",{enumerable:!0,get:function(){return F.AtpAgent}}),r.lexicons=new c.Lexicons(d.lexicons)})(tc)),tc}var _7=g7();const b7=wB(_7),v7=r=>typeof r=="object"?r.handle.bind(r):r,x7=({service:r,fetch:i=fetch})=>async(s,c)=>{const d=new URL(s,r);return i(d,c)},w7=(r,i)=>{let s;for(const c in i){const d=i[c];d!==null&&(s??=new Headers(r),s.has(c)||s.set(c,d))}return s??r};class Av extends Error{constructor(i,{kind:s=`HTTP error ${i}`,description:c="Unspecified error description",headers:d,cause:m}={}){super(`${s} > ${c}`,{cause:m}),this.name="XRPCError",this.status=i,this.kind=s,this.description=c,this.headers=d||{}}}class E7{constructor({handler:i,proxy:s}){this.handle=v7(i),this.proxy=s}get(i,s){return this.request({type:"get",nsid:i,...s})}call(i,s){return this.request({type:"post",nsid:i,...s})}async request(i){const s=i.data,c=`/xrpc/${i.nsid}`+R7(i.params),d=S7(s),m=await this.handle(c,{method:i.type,signal:i.signal,body:d?JSON.stringify(s):s,headers:w7(i.headers,{"content-type":d?"application/json":null,"atproto-proxy":A7(this.proxy)})}),e=m.status,a=Object.fromEntries(m.headers),g=a["content-type"];let w,R;g&&(g.startsWith("application/json")?w=m.json():g.startsWith("text/")&&(w=m.text()));try{R=await(w||m.arrayBuffer().then(S=>new Uint8Array(S)))}catch(S){throw new Av(2,{cause:S,kind:"InvalidResponse",description:"Failed to parse response body",headers:a})}if(e===200)return{data:R,headers:a};throw T7(R)?new Av(e,{kind:R.error,description:R.message,headers:a}):new Av(e,{headers:a})}}const A7=r=>r?`${r.service}#${r.type}`:null,R7=r=>{let i;for(const s in r){const c=r[s];if(c!==void 0)if(i??=new URLSearchParams,Array.isArray(c))for(let d=0,m=c.length;d<m;d++){const e=c[d];i.append(s,""+e)}else i.set(s,""+c)}return i?"?"+i.toString():""},S7=r=>{if(typeof r!="object"||r===null)return!1;if("toJSON"in r)return!0;const i=Object.getPrototypeOf(r);return i===null||i===Object.prototype},T7=r=>{if(typeof r!="object"||r===null)return!1;const i=typeof r.error,s=typeof r.message;return(i==="undefined"||i==="string")&&(s==="undefined"||s==="string")},gv=(r,i)=>({text:r,features:r.length>0?i:void 0}),C7=(r,i)=>{if(i===void 0||i.length===0)return[gv(r,void 0)];const s=[],c=r.length;let d=0,m=0;const e=(a,g)=>{let w=a;if(r.charCodeAt(w)<128)for(w+=1,m+=1;m+8<=g&&w+8<=c;){const S=r.charCodeAt(w),D=r.charCodeAt(w+1),k=r.charCodeAt(w+2),B=r.charCodeAt(w+3),F=r.charCodeAt(w+4),K=r.charCodeAt(w+5),U=r.charCodeAt(w+6),ee=r.charCodeAt(w+7);if((S|D|k|B|F|K|U|ee)<128){w+=8,m+=8;continue}break}for(;m<g&&w<c;){const S=r.charCodeAt(w);S<128?(w+=1,m+=1):S<2048?(w+=1,m+=2):S<55296||S>56319?(w+=1,m+=3):(w+=2,m+=4)}return w};for(let a=0,g=i.length;a<g;a++){const w=i[a],{byteStart:R,byteEnd:S}=w.index,D=w.features;if(!(R>S||D.length===0)){if(m<R){const k=e(d,R);k>d&&s.push(gv(r.slice(d,k),void 0)),d=k}{const k=e(d,S);k>d&&s.push(gv(r.slice(d,k),D)),d=k}}}return d<c&&s.push(gv(r.slice(d),void 0)),s},k7=/[&"<]/g,P7=/[&<]/g;function Yr(r,i){const s=String(r??""),c=i?k7:P7;c.lastIndex=0;let d="",m=0;for(;c.test(s);){const e=c.lastIndex-1,a=s[e];d+=s.substring(m,e)+(a==="&"?"&amp;":a==='"'?"&quot;":"&lt;"),m=e+1}return d+s.substring(m)}function Rr(r,i,s=!1){if(i==null||!i&&s||i===""&&r==="class")return"";const d=s?"":`="${Yr(i,!0)}"`;return` ${r}${d}`}function L7(r,i){const s={out:""};return r(s,i?.props??{}),{head:"",body:s.out}}function cl(r){return typeof r=="string"?r:r==null?"":r+""}const D7="https://public.api.bsky.app",I7="!no-unauthenticated";function LM(r,i){const{children:s}=i;r.out+='<div class="bluesky-embed s-3olstj">',s(r),r.out+="</div>"}const Gm=r=>`https://bsky.app/profile/${r}`,m0=(r,i)=>`https://bsky.app/profile/${r}/post/${i}`,B7=r=>`https://bsky.app/hashtag/${r}`,DM=(r,i)=>`https://bsky.app/profile/${r}/feed/${i}`,M7=(r,i)=>`https://bsky.app/starter-pack/${r}/${i}`,z7=(r,i)=>`https://ogcard.cdn.bsky.app/start/${r}/${i}`;let ND=0,u1=0;const O7=new Intl.DateTimeFormat("en-US",{dateStyle:"long",timeStyle:"short"}),V7=new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}),U7=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}),IM=r=>{const i=new Date(r),s=i.getTime();if(isNaN(s))return"N/A";const c=Date.now();if(c>u1){const d=new Date(c);d.setMonth(0,1),d.setHours(0,0,0),ND=d.getTime(),d.setFullYear(d.getFullYear()+1,0,0),d.setHours(23,59,59,999),u1=d.getTime()}return s>=ND&&s<=u1?U7.format(i):V7.format(i)},BM=r=>{const i=new Date(r);return isNaN(i.getTime())?"N/A":O7.format(i)},_v=0,N1=1,FD={"!hide":{name:"Hidden by moderators",flags:N1},"!warn":{name:"Content warning",flags:N1},porn:{name:"Adult content",flags:_v},sexual:{name:"Sexually suggestive",flags:_v},"graphic-media":{name:"Graphic media",flags:_v},nudity:{name:"Nudity",flags:_v}},y0=(r,i)=>{if(r?.length)for(let s=0,c=r.length;s<c;s++){const d=r[s],m=d.val;if(!(m in FD))continue;const e=FD[m];if(!(e.flags&N1&&d.src===i))return e}},MM=new Intl.NumberFormat("en-US"),j7=new Intl.NumberFormat("en-US",{notation:"compact"}),bv=r=>r<1e3?""+r:r<1e5?MM.format(r):j7.format(r),vv=r=>MM.format(r),N7=/^at:\/\/((?:did:[a-zA-Z0-9._:%-]+)|(?:[a-zA-Z0-9][a-zA-Z0-9-.]*))(?:\/([a-zA-Z0-9.-]+)(?:\/([a-zA-Z0-9_~.:-]{1,512}))?)?\/?(?:\?([^#\s]*))?(?:#([^\s]*))?$/,_u=r=>{const i=N7.exec(r);if(!i)throw new F7(`invalid at-uri: ${r}`);return{repo:i[1],collection:i[2]??"",rkey:i[3]??"",query:i[4]??"",fragment:i[5]??""}};class F7 extends Error{}function q7(r,i){const{warning:s,children:c}=i;s?(r.out+=`<details class="content-hider s-q6x07m"><summary class="gate s-q6x07m"><svg class="icon s-q6x07m" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="M11 11h1v5m9-4a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path><path fill="currentColor" stroke="currentColor" stroke-width=".5" d="M11.5 7.25h-.25v1.5h1.5v-1.5H11.5Z"></path></svg> <span class="label s-q6x07m">${Yr(s.name)}</span> <span class="action s-q6x07m"></span></summary> `,c(r),r.out+="</details>"):c(r)}const K7=r=>{let i;if("parse"in URL)i=URL.parse(r);else try{i=new URL(r)}catch{}return i&&(i.protocol==="https:"||i.protocol==="http:")?i:null};function G7(r,i){const{embed:s}=i,c=s.external,d=K7(c.uri)?.host;r.out+=`<a target="_blank"${Rr("href",d&&c.uri)} rel="noopener noreferrer nofollow" class="external-embed s-rtbqd8">`,c.thumb&&(r.out+=`<img loading="lazy"${Rr("src",c.thumb)} alt="" class="thumbnail s-rtbqd8">`),r.out+=` <div class="meta s-rtbqd8"><p class="title s-rtbqd8">${Yr(c.title)}</p> <p class="description s-rtbqd8">${Yr(c.description)}</p> `,d&&(r.out+=`<div class="domain s-rtbqd8"><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m4.172 8.07 3.94 2.957.977-1.941 3.887-.978 1.15-4.6M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-6.078 4.865.973-1.946-2.869-1.928-1.89-.12-1.08 1.075 1.947 2.919h2.919Z"></path></svg> <span class="domain-name">${Yr(d)}</span></div>`),r.out+="</div></a>"}function $7(r,i){const{embed:s}=i,c=s.creator,d=DM(c.did,_u(s.uri).rkey);r.out+=`<a target="_blank"${Rr("href",d)} class="feed-embed s-156tlwp"><div class="main s-156tlwp"><div class="avatar-wrapper s-156tlwp">`,s.avatar?r.out+=`<img loading="lazy"${Rr("src",s.avatar)} alt="" class="avatar s-156tlwp">`:r.out+='<svg viewBox="0 0 32 32" class="avatar s-156tlwp"><path fill="#0070FF" d="M0 0h32v32H0z"></path><path fill="#fff" d="M22.153 22.354a9.328 9.328 0 0 0 3.837-.491 3.076 3.076 0 0 0-4.802-2.79m.965 3.281a6.128 6.128 0 0 0-.965-3.28Zm-11.342-3.28a3.077 3.077 0 0 0-4.801 2.79 9.21 9.21 0 0 0 3.835.49m.966-3.28a6.127 6.127 0 0 0-.966 3.28Zm8.265-8.997a3.076 3.076 0 1 1-6.153 0 3.076 3.076 0 0 1 6.153 0Zm6.154 3.077a2.307 2.307 0 1 1-4.615 0 2.307 2.307 0 0 1 4.615 0Zm-13.847 0a2.307 2.307 0 1 1-4.614 0 2.307 2.307 0 0 1 4.614 0Z"></path><path fill="#fff" d="M22 22c0 3.314-2.686 3.5-6 3.5s-6-.186-6-3.5a6 6 0 0 1 12 0Z"></path></svg>',r.out+=`</div> <div class="info"><p class="name s-156tlwp">${Yr(s.displayName)}</p> <p class="creator s-156tlwp">Feed by @${Yr(c.handle)}</p></div></div> <p class="description s-156tlwp">${Yr(s.description)}</p></a>`}const Z7={width:16,height:9};function F1(r,i){const{embed:s,borderless:c,standalone:d,blur:m}=i,e=s.images,a=e.length;function g(w,R){const S=e[R];w.out+=`<img loading="lazy"${Rr("src",S.thumb)}${Rr("alt",S.alt)}${Rr("class",`${cl("image"+(m?" is-blurred":""))} s-t3k6fc`)}>`}if(r.out+=`<div${Rr("class",`${cl("image-embed"+(c?"":" is-bordered")+(d&&a===1?" is-aligned":""))} s-t3k6fc`)}>`,a===4)r.out+='<div class="grid s-t3k6fc"><div class="col s-t3k6fc"><div class="item wide tl s-t3k6fc">',g(r,0),r.out+='</div> <div class="item wide bl s-t3k6fc">',g(r,2),r.out+='</div></div> <div class="col s-t3k6fc"><div class="item wide tr s-t3k6fc">',g(r,1),r.out+='</div> <div class="item wide br s-t3k6fc">',g(r,3),r.out+="</div></div></div>";else if(a===3)r.out+='<div class="grid s-t3k6fc"><div class="col square s-t3k6fc"><div class="item tl bl s-t3k6fc">',g(r,0),r.out+='</div></div> <div class="col square s-t3k6fc"><div class="item tr s-t3k6fc">',g(r,1),r.out+='</div> <div class="item br s-t3k6fc">',g(r,2),r.out+="</div></div></div>";else if(a===2)r.out+='<div class="grid s-t3k6fc"><div class="col s-t3k6fc"><div class="item square tl bl s-t3k6fc">',g(r,0),r.out+='</div></div> <div class="col s-t3k6fc"><div class="item square tr br s-t3k6fc">',g(r,1),r.out+="</div></div></div>";else if(a===1){const w=d&&(e[0].aspectRatio||Z7);r.out+=`<div${Rr("class",`${cl("single-item tl tr bl br"+(w?" is-standalone":""))} s-t3k6fc`)}${Rr("style",w?`aspect-ratio: ${w.width}/${w.height}`:"")}>`,g(r,0),r.out+=" ",w&&(r.out+='<div class="placeholder s-t3k6fc"></div>'),r.out+="</div>"}r.out+="</div>"}const H7=r=>{switch(r){case"app.bsky.graph.defs#curatelist":return"User list";case"app.bsky.graph.defs#modlist":return"Moderation list"}return"Unknown list"};function X7(r,i){const{embed:s}=i,c=s.creator,d=DM(c.did,_u(s.uri).rkey);r.out+=`<a target="_blank"${Rr("href",d)} class="list-embed s-6uize5"><div class="main s-6uize5"><div class="avatar-wrapper s-6uize5">`,s.avatar?r.out+=`<img loading="lazy"${Rr("src",s.avatar)} alt="" class="avatar s-6uize5">`:r.out+='<svg viewBox="0 0 32 32" class="avatar s-6uize5"><path fill="#0070FF" d="M0 0h32v32H0z"></path><path fill="#fff" d="M22.153 22.354a9.328 9.328 0 0 0 3.837-.491 3.076 3.076 0 0 0-4.802-2.79m.965 3.281a6.128 6.128 0 0 0-.965-3.28Zm-11.342-3.28a3.077 3.077 0 0 0-4.801 2.79 9.21 9.21 0 0 0 3.835.49m.966-3.28a6.127 6.127 0 0 0-.966 3.28Zm8.265-8.997a3.076 3.076 0 1 1-6.153 0 3.076 3.076 0 0 1 6.153 0Zm6.154 3.077a2.307 2.307 0 1 1-4.615 0 2.307 2.307 0 0 1 4.615 0Zm-13.847 0a2.307 2.307 0 1 1-4.614 0 2.307 2.307 0 0 1 4.614 0Z"></path><path fill="#fff" d="M22 22c0 3.314-2.686 3.5-6 3.5s-6-.186-6-3.5a6 6 0 0 1 12 0Z"></path></svg>',r.out+=`</div> <div class="info"><p class="name s-6uize5">${Yr(s.name)}</p> <p class="creator s-6uize5">${Yr(H7(s.purpose))} by @${Yr(c.handle)}</p></div></div> <p class="description s-6uize5">${Yr(s.description)}</p></a>`}function q1(r,i){const{post:s,embed:c,borderless:d,standalone:m,blur:e}=i,a=m&&c.aspectRatio,g=s&&m0(s.author.did,_u(s.uri).rkey);function w(R){R.out+=`<img loading="lazy"${Rr("src",c.thumbnail)} alt=""${Rr("class",`${cl("thumbnail"+(e?" is-blurred":""))} s-1azk58e`)}> `,a&&(R.out+='<div class="placeholder s-1azk58e"></div>'),R.out+=' <div class="play s-1azk58e"><svg class="icon s-1azk58e" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12 5 2v20l17-10Z"></path></svg></div>'}m?(r.out+=`<a target="_blank"${Rr("href",g)}${Rr("class",`${cl("video-embed"+(d?"":" is-bordered")+(m?" is-standalone":""))} s-1azk58e`)}><div class="constrainer s-1azk58e"${Rr("style",a?`aspect-ratio: ${a.width}/${a.height}`:"")}>`,w(r),r.out+="</div></a>"):(r.out+=`<div${Rr("class",`${cl("video-embed"+(d?"":" is-bordered"))} s-1azk58e`)}${Rr("style",a?`aspect-ratio: ${a.width}/${a.height}`:"")}>`,w(r),r.out+="</div>")}const zM=r=>{if(r){if(r.$type==="app.bsky.embed.images#view")return r;if(r.$type==="app.bsky.embed.recordWithMedia#view")return zM(r.media)}},OM=r=>{if(r){if(r.$type==="app.bsky.embed.video#view")return r;if(r.$type==="app.bsky.embed.recordWithMedia#view")return OM(r.media)}};function W7(r,i){const{embed:s,large:c=!1}=i,d=s.value,m=d.text.trim(),e=s.author,a=e.displayName?.trim(),g=s.embeds?.[0],w=zM(g),R=OM(g),S=m0(e.did,_u(s.uri).rkey),D=!!y0(s.labels,e.did);r.out+=`<a target="_blank"${Rr("href",S)} class="quote-embed s-za6fip"><div class="meta s-za6fip"><div class="avatar-wrapper s-za6fip">`,e.avatar&&(r.out+=`<img loading="lazy"${Rr("src",e.avatar)} alt="" class="avatar s-za6fip">`),r.out+='</div> <span class="name-wrapper s-za6fip">',a&&(r.out+=`<bdi class="display-name-wrapper s-za6fip"><span class="display-name s-za6fip">${Yr(a)}</span></bdi>`),r.out+=` <span class="handle s-za6fip">@${Yr(e.handle)}</span></span> <span aria-hidden="true" class="dot s-za6fip">·</span> <time${Rr("datetime",d.createdAt)} class="date s-za6fip">${Yr(IM(d.createdAt))}</time></div> `,m?(r.out+='<div class="body s-za6fip">',c||(w?(r.out+='<div class="aside s-za6fip">',F1(r,{embed:w,blur:D}),r.out+="</div>"):R&&(r.out+='<div class="aside s-za6fip">',q1(r,{embed:R,blur:D}),r.out+="</div>")),r.out+=` <p class="text s-za6fip">${Yr(m)}</p></div>`):r.out+='<div class="divide s-za6fip"></div>',r.out+=" ",(c||!m)&&(w?F1(r,{embed:w,borderless:!0,blur:D}):R&&q1(r,{embed:R,borderless:!0,blur:D})),r.out+="</a>"}function Y7(r,i){const{embed:s,large:c=!1}=i,d=s.record,m=s.creator,e=m.did,a=_u(s.uri).rkey,g=M7(e,a);if(r.out+=`<a target="_blank"${Rr("href",g)} class="starterpack-embed s-15v965v">`,c){const w=z7(e,a);r.out+=`<img loading="lazy"${Rr("src",w)} alt="" class="banner s-15v965v">`}r.out+=` <div class="meta s-15v965v"><div class="main s-15v965v"><svg fill="none" viewBox="0 0 24 24" class="avatar s-15v965v"><defs><linearGradient id="a" x1="0" x2="100%" y1="0" y2="0" gradientTransform="rotate(45)"><stop offset="0" stop-color="#0A7AFF"></stop><stop offset="1" stop-color="#59B9FF"></stop></linearGradient></defs><path fill="url(#a)" fill-rule="evenodd" d="M11.26 5.227 5.02 6.899c-.734.197-1.17.95-.973 1.685l1.672 6.24c.197.734.951 1.17 1.685.973l6.24-1.672a1.376 1.376 0 0 0 .973-1.685L12.945 6.2a1.375 1.375 0 0 0-1.685-.973Zm-6.566.459a2.632 2.632 0 0 0-1.86 3.223l1.672 6.24a2.632 2.632 0 0 0 3.223 1.861l6.24-1.672a2.631 2.631 0 0 0 1.861-3.223l-1.672-6.24a2.632 2.632 0 0 0-3.223-1.861l-6.24 1.672Z" clip-rule="evenodd"></path><path fill="url(#a)" fill-rule="evenodd" d="M15.138 18.411a4.606 4.606 0 1 0 0-9.211 4.606 4.606 0 0 0 0 9.211Zm0 1.257a5.862 5.862 0 1 0 0-11.724 5.862 5.862 0 0 0 0 11.724Z" clip-rule="evenodd"></path></svg> <div class="info"><p class="name s-15v965v">${Yr(d.name)}</p> <p class="creator s-15v965v">Starter pack by @${Yr(m.handle)}</p></div></div> <p class="description s-15v965v">${Yr(d.description)}</p></div></a>`}function qD(r,i){r.out+=`<div class="message s-azdpbr">${Yr(i)}</div>`}const J7=r=>{switch(r){case"app.bsky.feed.post":return"post";case"app.bsky.feed.generator":return"feed";case"app.bsky.graph.list":return"list";case"app.bsky.graph.starterpack":return"starter pack";case"app.bsky.labeler.service":return"labeler"}return null};function VM(r,i){const{post:s,embed:c,large:d=!1}=i;function m(a,g){const w=s&&y0(s.labels,s.author.did);q7(a,{warning:w,children:R=>{g.$type==="app.bsky.embed.external#view"?G7(R,{embed:g}):g.$type==="app.bsky.embed.images#view"?F1(R,{embed:g,standalone:!0}):g.$type==="app.bsky.embed.video#view"?q1(R,{post:s,embed:g,standalone:!0}):qD(R,"Unsupported media embed")}})}function e(a,g){const w=g.record;if(w.$type==="app.bsky.embed.record#viewRecord")W7(a,{embed:w,large:d});else if(w.$type==="app.bsky.feed.defs#generatorView")$7(a,{embed:w});else if(w.$type==="app.bsky.graph.defs#listView")X7(a,{embed:w});else if(w.$type==="app.bsky.graph.defs#starterPackViewBasic")Y7(a,{embed:w,large:d});else{const R=_u(w.uri),S=J7(R.collection),D=S&&(w.$type==="app.bsky.embed.record#viewNotFound"||w.$type==="app.bsky.embed.record#viewBlocked"||w.$type==="app.bsky.embed.record#viewDetached");qD(a,D?`This ${S} is unavailable`:"Unsupported record embed")}}r.out+='<div class="embeds s-azdpbr">',c.$type==="app.bsky.embed.recordWithMedia#view"?(m(r,c.media),r.out+=" ",e(r,c.record)):c.$type==="app.bsky.embed.record#view"?e(r,c):m(r,c),r.out+="</div>"}const Q7=r=>r?.find(i=>i.$type==="app.bsky.richtext.facet#link"||i.$type==="app.bsky.richtext.facet#mention"||i.$type==="app.bsky.richtext.facet#tag");function UM(r,i){const{text:s,facets:c,large:d}=i,m=C7(s,c);r.out+=`<p${Rr("class",`${cl("rich-text"+(d?" is-large":" is-small"))} s-1lecfnd`)}>`;for(let e=0,a=m.length;e<a;e++){let g=m[e];const w=Q7(g.features);w?w.$type==="app.bsky.richtext.facet#link"?r.out+=`<a target="_blank"${Rr("href",w.uri)} rel="noopener nofollow" class="link s-1lecfnd">${Yr(g.text)}</a>`:w.$type==="app.bsky.richtext.facet#mention"?r.out+=`<a target="_blank"${Rr("href",Gm(w.did))} class="mention s-1lecfnd">${Yr(g.text)}</a>`:w.$type==="app.bsky.richtext.facet#tag"&&(r.out+=`<a target="_blank"${Rr("href",B7(w.tag))} class="hashtag s-1lecfnd">${Yr(g.text)}</a>`):r.out+=Yr(g.text)}r.out+="</p>"}function e$(r,i){const{post:s,parent:c,prev:d=!1}=i,m=s.author,e=Gm(m.did),a=m.displayName?.trim(),g=s.record,w=m0(m.did,_u(s.uri).rkey),R=s.replyCount||0,S=s.likeCount||0,D=(s.repostCount||0)+(s.quoteCount||0),k=!!y0(m.labels,m.did);if(r.out+=`<div class="highlighted-post s-hik11q"><div class="meta s-hik11q"><a${Rr("href",e)} target="_blank" class="avatar-wrapper s-hik11q">`,m.avatar&&(r.out+=`<img loading="lazy"${Rr("src",m.avatar)} alt=""${Rr("class",`${cl("avatar"+(k?" is-blurred":""))} s-hik11q`)}>`),r.out+=`</a> <a${Rr("href",e)} target="_blank" class="name-wrapper s-hik11q">`,a&&(r.out+=`<bdi class="display-name-wrapper s-hik11q"><span class="display-name s-hik11q">${Yr(a)}</span></bdi>`),r.out+=` <span class="handle s-hik11q">@${Yr(m.handle)}</span></a> `,d||(r.out+='<svg class="logo s-hik11q" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg>'),r.out+="</div> ",!d&&g.reply){if(r.out+='<p class="context s-hik11q">',c){const B=c.author;r.out+=`Replying to <a target="_blank"${Rr("href",Gm(B.did))} dir="auto" class="s-hik11q">${Yr(B.displayName?.trim()||`@${B.handle}`)}</a>`}else r.out+="Replying to an unknown post";r.out+="</p>"}r.out+=" ",UM(r,{text:g.text,facets:g.facets,large:!0}),r.out+=" ",s.embed&&VM(r,{post:s,embed:s.embed,large:!0}),r.out+=` <time${Rr("datetime",g.createdAt)} class="date s-hik11q">${Yr(BM(g.createdAt))}</time> <div class="stats s-hik11q"><span class="stat s-hik11q"${Rr("title",S===1?`${vv(S)} like`:`${vv(S)} likes`)}><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M12 5.768c6.162-6.25 16.725 5.358 0 14.732C-4.725 11.126 5.838-.482 12 5.768Z"></path></svg> <span>${Yr(bv(S))}</span></span> <span class="stat s-hik11q"${Rr("title",D===1?`${vv(D)} repost`:`${vv(D)} reposts`)}><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="m17 3 3 3-3 3M7 21l-3-3 3-3m-2 3h15v-5M4 11V6h15"></path></svg> <span>${Yr(bv(D))}</span></span> <div class="gap s-hik11q"></div> <a${Rr("href",w)} target="_blank" class="permalink s-hik11q"><span>${Yr(R?R===1?`Read ${bv(R)} reply on Bluesky`:`Read ${bv(R)} replies on Bluesky`:"View on Bluesky")}</span></a></div></div>`}function t$(r,i){const{post:s,parent:c,prev:d}=i,m=s.author,e=Gm(m.did),a=m.displayName?.trim(),g=s.record,w=m0(m.did,_u(s.uri).rkey),R=!!y0(m.labels,m.did);if(r.out+='<div class="post s-12mzi62">',d||(r.out+='<svg class="logo s-12mzi62" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg>'),r.out+=` <div class="aside s-12mzi62"><a target="_blank"${Rr("href",e)} class="avatar-wrapper s-12mzi62">`,m.avatar&&(r.out+=`<img loading="lazy"${Rr("src",m.avatar)} alt=""${Rr("class",`${cl("avatar"+(R?" is-blurred":""))} s-12mzi62`)}>`),r.out+=`</a> <div class="line s-12mzi62"></div></div> <div class="main s-12mzi62"><div class="meta s-12mzi62"><a${Rr("href",e)} target="_blank" class="name-wrapper s-12mzi62">`,a&&(r.out+=`<bdi class="display-name-wrapper s-12mzi62"><span class="display-name s-12mzi62">${Yr(a)}</span></bdi>`),r.out+=` <span class="handle s-12mzi62">@${Yr(m.handle)}</span></a> <span aria-hidden="true" class="dot s-12mzi62">·</span> <a target="_blank"${Rr("href",w)}${Rr("title",BM(g.createdAt))} class="date s-12mzi62"><time${Rr("datetime",g.createdAt)}>${Yr(IM(g.createdAt))}</time></a></div> `,!d&&g.reply){if(r.out+='<p class="context s-12mzi62">',c){const S=c.author;r.out+=`Replying to <a target="_blank"${Rr("href",Gm(S.did))} dir="auto" class="s-12mzi62">${Yr(S.displayName?.trim()||`@${S.handle}`)}</a>`}else r.out+="Replying to an unknown post";r.out+="</p>"}r.out+=" ",UM(r,{text:g.text,facets:g.facets}),r.out+=" ",s.embed&&VM(r,{post:s,embed:s.embed}),r.out+="</div></div>"}function KD(r,i){LM(r,{children:s=>{s.out+=`<div class="message s-1q9cbx0">${Yr(i)}</div>`}})}const r$=(r,i,s)=>{const c=[];let d=0,m=i?1:2,e=r;for(;e&&!(e.$type==="app.bsky.feed.defs#notFoundPost"||e.$type==="app.bsky.feed.defs#blockedPost");){const a=e.post;if(d!==0&&(c[d-1].parent=a),++d>m)break;const g=a.author;if(!s&&g.labels?.some(w=>w.val==="!no-unauthenticated"))break;c.push({post:a,parent:null}),e=e.parent}return c.reverse()};function i$(r,i){const{thread:s,contextless:c,allowUnauthenticated:d}=i,m=!d&&s!==null&&s.$type==="app.bsky.feed.defs#threadViewPost"&&s.post.author.labels?.some(e=>e.val===I7);if(s===null)KD(r,"The post can't be found, it may have been deleted.");else if(m)KD(r,"The author has requested for their posts to not be displayed on external sites.");else{const e=r$(s,c,d);LM(r,{children:a=>{const g=e;for(let w=0,R=g.length;w<R;w++){let{post:S,parent:D}=g[w];const k=w!==0;w===e.length-1?e$(a,{post:S,parent:D,prev:k}):t$(a,{post:S,parent:D,prev:k})}}})}}const n$=async r=>{const i=new E7({handler:x7({service:r.serviceUri??D7})}),s=r.contextless??!1,{data:c}=await i.get("app.bsky.feed.getPostThread",{signal:r.signal,params:{uri:r.uri,parentHeight:s?1:2,depth:0}}).catch(m=>m instanceof Av&&m.kind==="NotFound"?{data:null}:Promise.reject(m));return{thread:c?.thread.$type==="app.bsky.feed.defs#threadViewPost"?c.thread:null,contextless:s,allowUnauthenticated:r.allowUnauthenticated??!1}},s$=r=>L7(i$,{props:r}).body;var o$=Bn("<bluesky-post><!></bluesky-post>",2);function a$(r,i){mn(i,!0);const s=!0,c=s$(i.data);var d={prerender:s},m=o$();no(()=>cV(m,"src",i.data.thread?.post.uri));var e=ei(m);return rV(e,()=>c),Zr(m),fr(r,m),yn(d)}async function l$(r,i){const s=i.match(/^https:\/\/bsky\.app\/profile\/([^/]+)\/post\/([^/]+)/);if(!s)throw new Error("invalid Bsky URL");const[,c,d]=s;return`at://${(await r.api.com.atproto.identity.resolveHandle({handle:c})).data.did}/app.bsky.feed.post/${d}`}async function GD(r,i){const s=await l$(r,i);return await n$({uri:s})}var u$=Bn("<img/>"),c$=Bn('<div class="photo-grid gap-4 grid grid-cols-1 md:grid-cols-3"></div>');function d$(r,i){mn(i,!1);const s=!0;let c=St(i,"agent",8),d=St(i,"photos",24,()=>[]);function m(g){return g.startsWith("https://bsky.app/")}var e={prerender:s};xf();var a=c$();return Cc(a,5,d,Tc,(g,w)=>{var R=ai(),S=Fr(R);{var D=B=>{var F=ai(),K=Fr(F);QO(K,()=>(eo(GD),eo(c()),Pe(w),is(()=>GD(c(),Pe(w)))),null,(U,ee)=>{a$(U,{get data(){return Pe(ee)}})},(U,ee)=>{}),fr(B,F)},k=B=>{var F=u$();no(()=>Ra(F,"src",Pe(w))),fr(B,F)};Qi(S,B=>{Pe(w),is(()=>m(Pe(w)))?B(D):B(k,!1)})}fr(g,R)}),Zr(a),fr(r,a),Ym(i,"prerender",s),yn(e)}var p$=Bn('<div class="text-sm font-semibold text-gray-800"> </div> <li class="grid-row"><span class="grid-column-full"> </span> <div class="grid-column-full"><button class="block link">View ></button></div></li>',1);function f$(r,i){mn(i,!1);const s=!0;let c=St(i,"cafe",8),d=St(i,"onClick",8,()=>{});var m={prerender:s};xf();var e=p$(),a=Fr(e),g=ei(a,!0);Zr(a);var w=Ji(a,2),R=ei(w),S=ei(R,!0);Zr(R);var D=Ji(R,2),k=ei(D);return Zr(D),Zr(w),no(B=>{Ea(g,(eo(c()),is(()=>c().name))),Ea(S,B)},[()=>(eo(c()),is(()=>new Date(c().date).toDateString()))]),Dc("click",k,kv(B=>d()(c()))),fr(r,e),Ym(i,"prerender",s),yn(m)}var h$=Bn('<li class="summary-list__row"><span class="summary-list__value"> </span> <div class="summary-list__actions"><button href="#" class="block link">View ></button></div></li>');function m$(r,i){mn(i,!1);const s=!0;let c=St(i,"cafe",8),d=St(i,"onClick",8,()=>{}),m=St(i,"isActive",8,!1),e=k=>(m()&&k.scrollIntoView({behavior:"smooth",block:"center"}),()=>{});var a={prerender:s};xf();var g=h$(),w=ei(g),R=ei(w);Zr(w);var S=Ji(w,2),D=ei(S);return Zr(S),Zr(g),OI(g,()=>e),no(k=>Ea(R,`${eo(c()),is(()=>c().name)??""} - ${k??""}`),[()=>(eo(c()),is(()=>new Date(c().date).toDateString()))]),Dc("click",D,kv(k=>d()(c()))),fr(r,g),Ym(i,"prerender",s),yn(a)}const y$="https://raw.githubusercontent.com/kiranandcode/cafe-map/refs/heads/main/static/cafe-data.json";async function g$(){let r=await fetch(y$);if(!r.ok)throw new Error("failed to retrieve cafe data :(");return await r.json()}function _$(r){return[...r].sort((i,s)=>new Date(s.date).valueOf()-new Date(i.date).valueOf())}var b$=Bn("<!> <!>",1),v$=Bn('<li><h3 class="heading-s"><button class="block link"> </button></h3></li> <ul class="summary-list"></ul>',1),x$=Bn('<span class="tag"><a class="link">GMaps ></a></span>'),w$=Bn('<main class="body"><div class="outline-container"><h3 class="heading-m"> </h3> <span class="date"><time> </time></span> <span class="tag"><button class="block link">View ></button></span> <!> <div class="grid-row"><div class="grid-column-full"><div class="body"><!></div></div></div> <div class="grid-row"><div class="grid-column-full"><!></div></div></div></main>'),E$=Bn(`<div class="body"><span class="caption-m">To all the cafes I've snacked at.</span> <h1 class="heading-l">Kiran's Cafe Hopping Adventures!</h1> One of my hobbies is going Cafe-hopping!  I just love cafe vibes for
doing work, getting stuff done etc. This is a little bit of fun, but I
thought I'd collate all of my cafe-related photos with a little map
view so we could track exactly which cafes I've gone to and like
thoughts or fun stories about each!

Have a look around, I hope you enjoy your stay!</div> <div class="grid-row"><div class="grid-column-one-half h-80 w-full"><!></div> <div class="grid-column-one-half body"><h2 class="heading-m">Cafe List</h2> <div class="overflow-y-scroll max-h-60"><ul></ul></div></div></div> <!>`,1);function A$(r,i){mn(i,!1);const s=!0;let c=tl(),d=tl({}),m=tl(null),e=tl(null),a=tl(null);function g(Q){Xt(m,Q),Xt(e,[Pe(m).location[1],Pe(m).location[0]]),Xt(a,15)}function w(Q){Xt(e,[Q.center[1],Q.center[0]]),Xt(a,Q.zoom)}Ic(()=>{Xt(c,new b7({service:"https://bsky.social"}))}),Ic(async()=>{Xt(d,await g$());let Q=Object.keys(Pe(d))[0];w(Pe(d)[Q])});var R={prerender:s};xf();var S=E$(),D=Ji(Fr(S),2),k=ei(D),B=ei(k);Cj(B,{standardControls:!0,class:"relative h-full w-full inset-0 body",style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",get center(){return Pe(e)},get zoom(){return Pe(a)},children:(Q,Te)=>{var pe=ai(),_e=Fr(pe);Cc(_e,1,()=>Object.keys(Pe(d)),Tc,(Xe,dt)=>{var He=ai(),et=Fr(He);Cc(et,1,()=>Pe(d)[Pe(dt)].cafes,Tc,(rt,te)=>{{let Be=Om(()=>[Pe(te).location[1],Pe(te).location[0]]);Mj(rt,{get lngLat(){return Pe(Be)},class:"group relative grid h-10 w-10 place-items-center rounded-full border border-gray-300 bg-black-200 shadow-lg transition hover:scale-110 hover:shadow-2xl",children:(fe,ye)=>{var nt=b$(),gt=Fr(nt);Yj(gt,{class:"h-5 w-5"});var lt=Ji(gt,2);Oj(lt,{openOn:"hover",offset:[0,-12],children:(be,Ft)=>{f$(be,{onClick:g,get cafe(){return Pe(te)}})},$$slots:{default:!0}}),fr(fe,nt)},$$slots:{default:!0}})}}),fr(Xe,He)}),fr(Q,pe)},$$slots:{default:!0}}),Zr(k);var F=Ji(k,2),K=Ji(ei(F),2),U=ei(K);Cc(U,5,()=>Object.keys(Pe(d)),Tc,(Q,Te)=>{var pe=v$(),_e=Fr(pe),Xe=ei(_e),dt=ei(Xe),He=ei(dt,!0);Zr(dt),Zr(Xe),Zr(_e);var et=Ji(_e,2);Cc(et,5,()=>_$(Pe(d)[Pe(Te)].cafes),Tc,(rt,te)=>{const Be=Om(()=>Pe(te)===Pe(m));m$(rt,{get isActive(){return Pe(Be)},get cafe(){return Pe(te)},onClick:g})}),Zr(et),no(()=>Ea(He,Pe(Te))),Dc("click",dt,kv(rt=>w(Pe(d)[Pe(Te)]))),fr(Q,pe)}),Zr(U),Zr(K),Zr(F),Zr(D);var ee=Ji(D,2);{var le=Q=>{var Te=w$(),pe=ei(Te),_e=ei(pe),Xe=ei(_e,!0);Zr(_e);var dt=Ji(_e,2),He=ei(dt),et=ei(He,!0);Zr(He),Zr(dt);var rt=Ji(dt,2),te=ei(rt),Be=Hr(()=>g(Pe(m)));Zr(rt);var fe=Ji(rt,2);{var ye=ur=>{var Tt=x$(),tr=ei(Tt);Zr(Tt),no(()=>Ra(tr,"href",Pe(m).mapsLink)),fr(ur,Tt)};Qi(fe,ur=>{Pe(m).mapsLink&&ur(ye)})}var nt=Ji(fe,2),gt=ei(nt),lt=ei(gt),be=ei(lt);FF(be,{get md(){return Pe(m).notes}}),Zr(lt),Zr(gt),Zr(nt);var Ft=Ji(nt,2),Ut=ei(Ft),Le=ei(Ut);d$(Le,{get agent(){return Pe(c)},get photos(){return Pe(m).photos}}),Zr(Ut),Zr(Ft),Zr(pe),Zr(Te),no(ur=>{Ea(Xe,Pe(m).name),Ra(He,"datetime",Pe(m).date),Ea(et,ur)},[()=>new Date(Pe(m).date).toDateString()]),Dc("click",te,kv(function(...ur){Pe(Be)?.apply(this,ur)})),fr(Q,Te)};Qi(ee,Q=>{Pe(m)!==null&&Q(le)})}return fr(r,S),Ym(i,"prerender",s),yn(R)}function R$(r,i){mn(i,!1);const s=!0;var c={prerender:s};return A$(r,{}),Ym(i,"prerender",s),yn(c)}const S$=Object.freeze(Object.defineProperty({__proto__:null,component:R$},Symbol.toStringTag,{value:"Module"}));export{FU as app,L$ as start};
